(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();/** @license

dhtmlxScheduler v.7.2.5 Standard

To use dhtmlxScheduler in non-GPL projects (and get Pro version of the product), please obtain Commercial/Enterprise or Ultimate license on our site https://dhtmlx.com/docs/products/dhtmlxScheduler/#licensing or contact us at sales@dhtmlx.com

(c) XB Software Ltd.

*/const ft=typeof window<"u"?window:global;function M_(e){let t=[],n=!1,r=null,a=null;function i(){return e.config.drag_highlight&&e.markTimespan}function o(d){const c=e.getView(d);return c?c.layout:d}function l(d){const{event:c,layout:u,viewName:f,sectionId:v,eventNode:g}=d;(function(y,x){switch(x){case"month":y.style.top="",y.style.left="";break;case"timeline":y.style.left="",y.style.marginLeft="1px";break;default:y.style.top=""}})(g,u);const h={};let p={start_date:c.start_date,end_date:c.end_date,css:"dhx_scheduler_dnd_marker",html:g};if(u=="timeline"){const y=e.getView(f);if(y.round_position){const x=e._get_date_index(y,c.start_date),S=y._trace_x[x];p.start_date=S}}return u!="timeline"&&u!="month"||(p={...p,end_date:e.date.add(c.start_date,1,"minute")}),v&&(h[f]=v,p.sections=h),p}function s(d){const{layout:c}=d;let u;switch(c){case"month":u=function(f){let v=[];const{event:g,layout:h,viewName:p,sectionId:y}=f,x=[];let S=new Date(g.start_date);for(;S.valueOf()<g.end_date.valueOf();){let I={start_date:S};x.push(I),S=e.date.week_start(e.date.add(S,1,"week"))}let O=e.$container.querySelectorAll(`[${e.config.event_attribute}='${g.id}']`);for(let I=0;I<O.length;I++){const N={event:x[I],layout:h,viewName:p,sectionId:y,eventNode:O[I].cloneNode(!0)};v.push(l(N))}return v}(d);break;case"timeline":case"units":u=function(f){let v=[];const{event:g,layout:h,viewName:p,eventNode:y}=f;let x=function(S){const O=e.getView(S);return O.y_property?O.y_property:O.map_to?O.map_to:void 0}(p);if(x){const S=String(g[x]).split(e.config.section_delimiter).map(I=>String(I)),O=[];for(let I=0;I<S.length;I++){O[I]=y.cloneNode(!0);const N={event:g,layout:h,viewName:p,sectionId:S[I],eventNode:O[I]};v.push(l(N))}}return v}(d);break;default:u=function(f){const{event:v,layout:g,viewName:h,sectionId:p}=f;let y=[],x=e.$container.querySelectorAll(`[${e.config.event_attribute}='${v.id}']:not(.dhx_cal_select_menu):not(.dhx_drag_marker)`);if(x)for(let S=0;S<x.length;S++){let O=x[S].cloneNode(!0);const I={event:{start_date:new Date(+O.getAttribute("data-bar-start")),end_date:new Date(+O.getAttribute("data-bar-end"))},layout:g,viewName:h,sectionId:p,eventNode:O};y.push(l(I))}return y}(d)}u.forEach(f=>{t.push(e.markTimespan(f))})}e.attachEvent("onBeforeDrag",function(d,c,u){return i()&&(n=!0,a=e.getEvent(d),r=u.target.closest(`[${e.config.event_attribute}]`),o(e.getState().mode)=="units"&&e.config.cascade_event_display&&(e.unselect(d),r=u.target.closest(`[${e.config.event_attribute}]`))),!0}),e.attachEvent("onEventDrag",function(d,c,u){if(n&&i()){n=!1;const f=e.getState().mode,v=o(f),g=e.getActionData(u).section;a&&s({event:a,layout:v,viewName:f,sectionId:g,eventNode:r})}}),e.attachEvent("onDragEnd",function(d,c,u){for(let f=0;f<t.length;f++)e.unmarkTimespan(t[f]);t=[],r=null,a=null})}function O_(e){e.config.mark_now=!0,e.config.display_marked_timespans=!0,e.config.overwrite_marked_timespans=!0;var t="dhx_time_block",n="default",r=function(i,o,l){var s=typeof i=="object"?i:{days:i};return s.type=t,s.css="",o&&(l&&(s.sections=l),s=function(d,c,u){return c instanceof Date&&u instanceof Date?(d.start_date=c,d.end_date=u):(d.days=c,d.zones=u),d}(s,i,o)),s};function a(i,o,l,s,d){var c=e,u=[],f={_props:"map_to",matrix:"y_property"};for(var v in f){var g=f[v];if(c[v])for(var h in c[v]){var p=c[v][h][g];i[p]&&(u=c._add_timespan_zones(u,e._get_blocked_zones(o[h],i[p],l,s,d)))}}return u=c._add_timespan_zones(u,e._get_blocked_zones(o,"global",l,s,d))}e.blockTime=function(i,o,l){var s=r(i,o,l);return e.addMarkedTimespan(s)},e.unblockTime=function(i,o,l){var s=r(i,o=o||"fullday",l);return e.deleteMarkedTimespan(s)},e.checkInMarkedTimespan=function(i,o,l){o=o||n;for(var s=!0,d=new Date(i.start_date.valueOf()),c=e.date.add(d,1,"day"),u=e._marked_timespans;d<i.end_date;d=e.date.date_part(c),c=e.date.add(d,1,"day")){var f=+e.date.date_part(new Date(d)),v=a(i,u,d.getDay(),f,o);if(v)for(var g=0;g<v.length;g+=2){var h=e._get_zone_minutes(d),p=i.end_date>c||i.end_date.getDate()!=d.getDate()?1440:e._get_zone_minutes(i.end_date),y=v[g],x=v[g+1];if(y<p&&x>h&&!(s=typeof l=="function"&&l(i,h,p,y,x)))break}}return!s},e.checkLimitViolation=function(i){if(!i||!e.config.check_limits)return!0;var o=e,l=o.config,s=[];if(i.rec_type&&i._end_date||i.rrule){const v=i._end_date||i.end_date;return!l.limit_start||!l.limit_end||v.valueOf()>=l.limit_start.valueOf()&&i.start_date.valueOf()<=l.limit_end.valueOf()}s=[i];for(var d=!0,c=0;c<s.length;c++){var u=!0,f=s[c];f._timed=e.isOneDayEvent(f),(u=!l.limit_start||!l.limit_end||f.start_date.valueOf()>=l.limit_start.valueOf()&&f.end_date.valueOf()<=l.limit_end.valueOf())&&(u=!e.checkInMarkedTimespan(f,t,function(v,g,h,p,y){var x=!0;return g<=y&&g>=p&&((y==1440||h<=y)&&(x=!1),v._timed&&o._drag_id&&o._drag_mode=="new-size"?(v.start_date.setHours(0),v.start_date.setMinutes(y)):x=!1),(h>=p&&h<=y||g<p&&h>y)&&(v._timed&&o._drag_id&&o._drag_mode=="new-size"?(v.end_date.setHours(0),v.end_date.setMinutes(p)):x=!1),x})),u||(u=o.checkEvent("onLimitViolation")?o.callEvent("onLimitViolation",[f.id,f]):u),d=d&&u}return d||(o._drag_id=null,o._drag_mode=null),d},e._get_blocked_zones=function(i,o,l,s,d){var c=[];if(i&&i[o])for(var u=i[o],f=this._get_relevant_blocked_zones(l,s,u,d),v=0;v<f.length;v++)c=this._add_timespan_zones(c,f[v].zones);return c},e._get_relevant_blocked_zones=function(i,o,l,s){var d;return e.config.overwrite_marked_timespans?d=l[o]&&l[o][s]?l[o][s]:l[i]&&l[i][s]?l[i][s]:[]:(d=[],l[o]&&l[o][s]&&(d=d.concat(l[o][s])),l[i]&&l[i][s]&&(d=d.concat(l[i][s]))),d},e._mark_now=function(i){var o="dhx_now_time";this._els[o]||(this._els[o]=[]);var l=e._currentDate(),s=this.config;if(e._remove_mark_now(),!i&&s.mark_now&&l<this._max_date&&l>this._min_date&&l.getHours()>=s.first_hour&&l.getHours()<s.last_hour){var d=this.locate_holder_day(l);this._els[o]=e._append_mark_now(d,l)}},e._append_mark_now=function(i,o){var l="dhx_now_time",s=e._get_zone_minutes(o),d={zones:[s,s+1],css:l,type:l};if(!this._table_view){if(this._props&&this._props[this._mode]){var c,u,f=this._props[this._mode],v=f.size||f.options.length;f.days>1?(f.size&&f.options.length&&(i=(f.position+i)/f.options.length*f.size),c=i,u=i+v):u=(c=0)+v;for(var g=[],h=c;h<u;h++){var p=h;d.days=p;var y=e._render_marked_timespan(d,null,p)[0];g.push(y)}return g}return d.days=i,e._render_marked_timespan(d,null,i)}if(this._mode=="month")return d.days=+e.date.date_part(o),e._render_marked_timespan(d,null,null)},e._remove_mark_now=function(){for(var i="dhx_now_time",o=this._els[i],l=0;l<o.length;l++){var s=o[l],d=s.parentNode;d&&d.removeChild(s)}this._els[i]=[]},e._marked_timespans={global:{}},e._get_zone_minutes=function(i){return 60*i.getHours()+i.getMinutes()},e._prepare_timespan_options=function(i){var o=[],l=[];if(i.days=="fullweek"&&(i.days=[0,1,2,3,4,5,6]),i.days instanceof Array){for(var s=i.days.slice(),d=0;d<s.length;d++){var c=e._lame_clone(i);c.days=s[d],o.push.apply(o,e._prepare_timespan_options(c))}return o}if(!i||!(i.start_date&&i.end_date&&i.end_date>i.start_date||i.days!==void 0&&i.zones)&&!i.type)return o;i.zones=="fullday"&&(i.zones=[0,1440]),i.zones&&i.invert_zones&&(i.zones=e.invertZones(i.zones)),i.id=e.uid(),i.css=i.css||"",i.type=i.type||n;var u=i.sections;if(u){for(var f in u)if(u.hasOwnProperty(f)){var v=u[f];for(v instanceof Array||(v=[v]),d=0;d<v.length;d++)(O=e._lame_copy({},i)).sections={},O.sections[f]=v[d],l.push(O)}}else l.push(i);for(var g=0;g<l.length;g++){var h=l[g],p=h.start_date,y=h.end_date;if(p&&y)for(var x=e.date.date_part(new Date(p)),S=e.date.add(x,1,"day");x<y;){var O;delete(O=e._lame_copy({},h)).start_date,delete O.end_date,O.days=x.valueOf();var I=p>x?e._get_zone_minutes(p):0,N=y>S||y.getDate()!=x.getDate()?1440:e._get_zone_minutes(y);O.zones=[I,N],o.push(O),x=S,S=e.date.add(S,1,"day")}else h.days instanceof Date&&(h.days=e.date.date_part(h.days).valueOf()),h.zones=i.zones.slice(),o.push(h)}return o},e._get_dates_by_index=function(i,o,l){var s=[];o=e.date.date_part(new Date(o||e._min_date)),l=new Date(l||e._max_date);for(var d=o.getDay(),c=i-d>=0?i-d:7-o.getDay()+i,u=e.date.add(o,c,"day");u<l;u=e.date.add(u,1,"week"))s.push(u);return s},e._get_css_classes_by_config=function(i){var o=[];return i.type==t&&(o.push(t),i.css&&o.push(t+"_reset")),o.push("dhx_marked_timespan",i.css),o.join(" ")},e._get_block_by_config=function(i){var o=document.createElement("div");return i.html&&(typeof i.html=="string"?o.innerHTML=i.html:o.appendChild(i.html)),o},e._render_marked_timespan=function(i,o,l){var s=[],d=e.config,c=this._min_date,u=this._max_date,f=!1;if(!d.display_marked_timespans)return s;if(!l&&l!==0){if(i.days<7)l=i.days;else{var v=new Date(i.days);if(f=+v,!(+u>+v&&+c<=+v))return s;l=v.getDay()}var g=c.getDay();g>l?l=7-(g-l):l-=g}var h=i.zones,p=e._get_css_classes_by_config(i);if(e._table_view&&e._mode=="month"){var y=[],x=[];if(o)y.push(o),x.push(l);else{x=f?[f]:e._get_dates_by_index(l);for(var S=0;S<x.length;S++)y.push(this._scales[x[S]])}for(S=0;S<y.length;S++){o=y[S],l=x[S];var O=this.locate_holder_day(l,!1)%this._cols.length;if(!this._ignores[O]){var I=e._get_block_by_config(i);I.className=p,I.style.top="0px",I.style.height="100%";for(var N=0;N<h.length;N+=2){var A=h[S];if((k=h[S+1])<=A)return[];(D=I.cloneNode(!0)).style.left="0px",D.style.width="100%",o.appendChild(D),s.push(D)}}}}else{var m=l;if(this._ignores[this.locate_holder_day(l,!1)])return s;if(this._props&&this._props[this._mode]&&i.sections&&i.sections[this._mode]){var b=this._props[this._mode];m=b.order[i.sections[this._mode]];var E=b.order[i.sections[this._mode]];b.days>1?m=m*(b.size||b.options.length)+E:(m=E,b.size&&m>b.position+b.size&&(m=0))}for(o=o||e.locate_holder(m),S=0;S<h.length;S+=2){var k,D;if(A=Math.max(h[S],60*d.first_hour),(k=Math.min(h[S+1],60*d.last_hour))<=A){if(S+2<h.length)continue;return[]}(D=e._get_block_by_config(i)).className=p;var C=24*this.config.hour_size_px+1,R=36e5;D.style.top=Math.round((60*A*1e3-this.config.first_hour*R)*this.config.hour_size_px/R)%C+"px",D.style.height=Math.max(Math.round(60*(k-A)*1e3*this.config.hour_size_px/R)%C,1)+"px",o.appendChild(D),s.push(D)}}return s},e._mark_timespans=function(){var i=this._els.dhx_cal_data[0],o=[];if(e._table_view&&e._mode=="month")for(var l in this._scales){var s=new Date(+l);o.push.apply(o,e._on_scale_add_marker(this._scales[l],s))}else{s=new Date(e._min_date);for(var d=0,c=i.childNodes.length;d<c;d++){var u=i.childNodes[d];u.firstChild&&e._getClassName(u.firstChild).indexOf("dhx_scale_hour")>-1||(o.push.apply(o,e._on_scale_add_marker(u,s)),s=e.date.add(s,1,"day"))}}return o},e.markTimespan=function(i){if(!this._els)throw new Error("`scheduler.markTimespan` can't be used before scheduler initialization. Place `scheduler.markTimespan` call after `scheduler.init`.");var o=!1;this._els.dhx_cal_data||(e.get_elements(),o=!0);var l=e._marked_timespans_ids,s=e._marked_timespans_types,d=e._marked_timespans;e.deleteMarkedTimespan(),e.addMarkedTimespan(i);var c=e._mark_timespans();return o&&(e._els=[]),e._marked_timespans_ids=l,e._marked_timespans_types=s,e._marked_timespans=d,c},e.unmarkTimespan=function(i){if(i)for(var o=0;o<i.length;o++){var l=i[o];l.parentNode&&l.parentNode.removeChild(l)}},e._addMarkerTimespanConfig=function(i){var o="global",l=e._marked_timespans,s=i.id,d=e._marked_timespans_ids;d[s]||(d[s]=[]);var c=i.days,u=i.sections,f=i.type;if(i.id=s,u){for(var v in u)if(u.hasOwnProperty(v)){l[v]||(l[v]={});var g=u[v],h=l[v];h[g]||(h[g]={}),h[g][c]||(h[g][c]={}),h[g][c][f]||(h[g][c][f]=[],e._marked_timespans_types||(e._marked_timespans_types={}),e._marked_timespans_types[f]||(e._marked_timespans_types[f]=!0));var p=h[g][c][f];i._array=p,p.push(i),d[s].push(i)}}else l[o][c]||(l[o][c]={}),l[o][c][f]||(l[o][c][f]=[]),e._marked_timespans_types||(e._marked_timespans_types={}),e._marked_timespans_types[f]||(e._marked_timespans_types[f]=!0),p=l[o][c][f],i._array=p,p.push(i),d[s].push(i)},e._marked_timespans_ids={},e.addMarkedTimespan=function(i){var o=e._prepare_timespan_options(i);if(o.length){for(var l=o[0].id,s=0;s<o.length;s++)e._addMarkerTimespanConfig(o[s]);return l}},e._add_timespan_zones=function(i,o){var l=i.slice();if(o=o.slice(),!l.length)return o;for(var s=0;s<l.length;s+=2)for(var d=l[s],c=l[s+1],u=s+2==l.length,f=0;f<o.length;f+=2){var v=o[f],g=o[f+1];if(g>c&&v<=c||v<d&&g>=d)l[s]=Math.min(d,v),l[s+1]=Math.max(c,g),s-=2;else{if(!u)continue;var h=d>v?0:2;l.splice(s+h,0,v,g)}o.splice(f--,2);break}return l},e._subtract_timespan_zones=function(i,o){for(var l=i.slice(),s=0;s<l.length;s+=2)for(var d=l[s],c=l[s+1],u=0;u<o.length;u+=2){var f=o[u],v=o[u+1];if(v>d&&f<c){var g=!1;d>=f&&c<=v&&l.splice(s,2),d<f&&(l.splice(s,2,d,f),g=!0),c>v&&l.splice(g?s+2:s,g?0:2,v,c),s-=2;break}}return l},e.invertZones=function(i){return e._subtract_timespan_zones([0,1440],i.slice())},e._delete_marked_timespan_by_id=function(i){var o=e._marked_timespans_ids[i];if(o){for(var l=0;l<o.length;l++)for(var s=o[l],d=s._array,c=0;c<d.length;c++)if(d[c]==s){d.splice(c,1);break}}},e._delete_marked_timespan_by_config=function(i){var o,l=e._marked_timespans,s=i.sections,d=i.days,c=i.type||n;if(s){for(var u in s)if(s.hasOwnProperty(u)&&l[u]){var f=s[u];l[u][f]&&(o=l[u][f])}}else o=l.global;if(o){if(d!==void 0)o[d]&&o[d][c]&&(e._addMarkerTimespanConfig(i),e._delete_marked_timespans_list(o[d][c],i));else for(var v in o)if(o[v][c]){var g=e._lame_clone(i);i.days=v,e._addMarkerTimespanConfig(g),e._delete_marked_timespans_list(o[v][c],i)}}},e._delete_marked_timespans_list=function(i,o){for(var l=0;l<i.length;l++){var s=i[l],d=e._subtract_timespan_zones(s.zones,o.zones);if(d.length)s.zones=d;else{i.splice(l,1),l--;for(var c=e._marked_timespans_ids[s.id],u=0;u<c.length;u++)if(c[u]==s){c.splice(u,1);break}}}},e.deleteMarkedTimespan=function(i){if(arguments.length||(e._marked_timespans={global:{}},e._marked_timespans_ids={},e._marked_timespans_types={}),typeof i!="object")e._delete_marked_timespan_by_id(i);else{i.start_date&&i.end_date||(i.days!==void 0||i.type||(i.days="fullweek"),i.zones||(i.zones="fullday"));var o=[];if(i.type)o.push(i.type);else for(var l in e._marked_timespans_types)o.push(l);for(var s=e._prepare_timespan_options(i),d=0;d<s.length;d++)for(var c=s[d],u=0;u<o.length;u++){var f=e._lame_clone(c);f.type=o[u],e._delete_marked_timespan_by_config(f)}}},e._get_types_to_render=function(i,o){var l=i?e._lame_copy({},i):{};for(var s in o||{})o.hasOwnProperty(s)&&(l[s]=o[s]);return l},e._get_configs_to_render=function(i){var o=[];for(var l in i)i.hasOwnProperty(l)&&o.push.apply(o,i[l]);return o},e._on_scale_add_marker=function(i,o){if(!e._table_view||e._mode=="month"){var l=o.getDay(),s=o.valueOf(),d=this._mode,c=e._marked_timespans,u=[],f=[];if(this._props&&this._props[d]){var v=this._props[d],g=v.options,h=g[e._get_unit_index(v,o)];if(v.days>1){var p=Math.round((o-e._min_date)/864e5),y=v.size||g.length;o=e.date.add(e._min_date,Math.floor(p/y),"day"),o=e.date.date_part(o)}else o=e.date.date_part(new Date(this._date));if(l=o.getDay(),s=o.valueOf(),c[d]&&c[d][h.key]){var x=c[d][h.key],S=e._get_types_to_render(x[l],x[s]);u.push.apply(u,e._get_configs_to_render(S))}}var O=c.global;if(e.config.overwrite_marked_timespans){var I=O[s]||O[l];u.push.apply(u,e._get_configs_to_render(I))}else O[s]&&u.push.apply(u,e._get_configs_to_render(O[s])),O[l]&&u.push.apply(u,e._get_configs_to_render(O[l]));for(var N=0;N<u.length;N++)f.push.apply(f,e._render_marked_timespan(u[N],i,o));return f}},e.attachEvent("onScaleAdd",function(){e._on_scale_add_marker.apply(e,arguments)}),e.dblclick_dhx_marked_timespan=function(i,o){e.callEvent("onScaleDblClick",[e.getActionData(i).date,o,i]),e.config.dblclick_create&&e.addEventNow(e.getActionData(i).date,null,i)}}function R_(e){var t={},n=!1;function r(s,d){d=typeof d=="function"?d:function(){},t[s]||(t[s]=this[s],this[s]=d)}function a(s){t[s]&&(this[s]=t[s],t[s]=null)}function i(s){for(var d in s)r.call(this,d,s[d])}function o(){for(var s in t)a.call(this,s)}function l(s){try{s()}catch(d){window.console.error(d)}}return e.$stateProvider.registerProvider("batchUpdate",function(){return{batch_update:n}},!1),function(s,d){if(n)return void l(s);var c,u=this._dp&&this._dp.updateMode!="off";u&&(c=this._dp.updateMode,this._dp.setUpdateMode("off"));const f={setModeDate:{date:null,mode:null},needRender:!1,needUpdateView:!1,repaintEvents:{}},v=(h,p)=>{h&&(f.setModeDate.date=h),p&&(f.setModeDate.mode=p)};var g={render:(h,p)=>{f.needRender=!0,v(h,p)},setCurrentView:(h,p)=>{f.needRender=!0,v(h,p)},updateView:(h,p)=>{f.needUpdateView=!0,v(h,p)},render_data:()=>f.needRender=!0,render_view_data:h=>{h&&h.length?h.forEach(p=>f.repaintEvents[p.id]=!0):f.needRender=!0}};if(i.call(this,g),n=!0,this.callEvent("onBeforeBatchUpdate",[]),l(s),this.callEvent("onAfterBatchUpdate",[]),o.call(this),n=!1,!d)if(f.needRender)e.render(f.setModeDate.date,f.setModeDate.mode);else if(f.needUpdateView)e.updateView(f.setModeDate.date,f.setModeDate.mode);else for(const h in f.repaintEvents)e.updateEvent(h);u&&(this._dp.setUpdateMode(c),this._dp.sendData())}}let P_=class{constructor(t){const{url:n,token:r}=t;this._url=n,this._token=r,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:"application/json","Content-Type":"application/json","Remote-Token":this._token}}fetch(t,n){const r={credentials:"include",headers:this.headers()};return n&&(r.method="POST",r.body=n),fetch(t,r).then(a=>a.json())}load(t){return t&&(this._url=t),this.fetch(this._url).then(n=>this.parse(n))}parse(t){const{key:n,websocket:r}=t;n&&(this._token=t.key);for(const a in t.data)this.data[a]=t.data[a];for(const a in t.api){const i=this.api[a]={},o=t.api[a];for(const l in o)i[l]=this._wrapper(a+"."+l)}return r&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(n,r,a,i){let o=r;o[0]==="/"&&(o=document.location.protocol+"//"+document.location.host+r),o=o.replace(/^http(s|):/,"ws$1:");const l=o.indexOf("?")!=-1?"&":"?";o=`${o}${l}token=${a}&ws=1`;const s=new WebSocket(o);return s.onclose=()=>setTimeout(()=>n.connect(),2e3),s.onmessage=d=>{const c=JSON.parse(d.data);switch(c.action){case"result":n.result(c.body,[]);break;case"event":n.fire(c.body.name,c.body.value);break;case"start":i();break;default:n.onError(c.data)}},s}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(t){return(function(){const n=[].slice.call(arguments);let r=null;const a=new Promise((i,o)=>{r={data:{id:this._uid(),name:t,args:n},status:1,resolve:i,reject:o},this._queue.push(r)});return this.onCall(r,a),this._mode===3?this._send(r):setTimeout(()=>this._send(),1),a}).bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(this._mode==2)return void setTimeout(()=>this._send(),100);const n=t?[t]:this._queue.filter(a=>a.status===1);if(!n.length)return;const r=n.map(a=>(a.status=2,a.data));this._mode!==3?this.fetch(this._url,JSON.stringify(r)).catch(a=>this.onError(a)).then(a=>this.result(a,r)):this._socket.send(JSON.stringify({action:"call",body:r}))}result(t,n){const r={};if(t)for(let a=0;a<t.length;a++)r[t[a].id]=t[a];else for(let a=0;a<n.length;a++)r[n[a].id]={id:n[a].id,error:"Network Error",data:null};for(let a=this._queue.length-1;a>=0;a--){const i=this._queue[a],o=r[i.data.id];o&&(this.onResponse(i,o),o.error?i.reject(o.error):i.resolve(o.data),this._queue.splice(a,1))}}on(t,n){const r=this._uid();let a=this._events[t];const i=!!a;return i||(a=this._events[t]=[]),a.push({id:r,handler:n}),i||this._mode!=3||this._socket.send(JSON.stringify({action:"subscribe",name:t})),{name:t,id:r}}_resubscribe(){if(this._mode==3)for(const t in this._events)this._socket.send(JSON.stringify({action:"subscribe",name:t}))}detach(t){if(!t){if(this._mode==3)for(const i in this._events)this._socket.send(JSON.stringify({action:"unsubscribe",key:i}));return void(this._events={})}const{id:n,name:r}=t,a=this._events[r];if(a){const i=a.filter(o=>o.id!=n);i.length?this._events[r]=i:(delete this._events[r],this._mode==3&&this._socket.send(JSON.stringify({action:"unsubscribe",name:r})))}}fire(t,n){const r=this._events[t];if(r)for(let a=0;a<r.length;a++)r[a].handler(n)}onError(t){return null}onCall(t,n){}onResponse(t,n){}},L_=class{constructor(t,n){const r=new P_({url:t,token:n});r.fetch=function(a,i){const o={headers:this.headers()};return i&&(o.method="POST",o.body=i),fetch(a,o).then(l=>l.json())},this._ready=r.load().then(a=>this._remote=a)}ready(){return this._ready}on(t,n){this.ready().then(r=>{if(typeof t=="string")r.on(t,n);else for(const a in t)r.on(a,t[a])})}};function V_(e){function t(r,a){switch(r){case"add-event":(function(i){if(e.getEvent(i.id))return void console.warn(`Event with ID ${i.id} already exists. Skipping add.`);i.start_date=e.templates.parse_date(i.start_date),i.end_date=e.templates.parse_date(i.end_date),i.original_start&&(i.original_start=e.templates.parse_date(i.original_start)),n(()=>{e.addEvent(i)})})(a);break;case"update-event":(function(i){const o=i.id;if(!e.getEvent(o))return void console.warn(`Event with ID ${o} does not exist. Skipping update.`);const l=e.getEvent(o);n(()=>{for(let s in i)s!=="start_date"&&s!=="end_date"&&(l[s]=i[s]);l.start_date=e.templates.parse_date(i.start_date),l.end_date=e.templates.parse_date(i.end_date),i.original_start&&(i.original_start=e.templates.parse_date(i.original_start)),e.callEvent("onEventChanged",[o,l]),e.updateEvent(o),o!==i.id&&e.changeEventId(o,i.id)})})(a);break;case"delete-event":(function(i){const o=i.id;if(!e.getEvent(o))return void(i.event_pid&&n(()=>{e.addEvent(i)}));n(()=>{const l=e.getEvent(o);if(l){if(l.rec_type||l.rrule){e._roll_back_dates(l);const s=e._get_rec_markers(o);for(const d in s)e.getEvent(d)&&e.deleteEvent(d,!0)}if(e.getState().lightbox_id==o&&(this._new_event=this._lightbox_id,i.id=this._lightbox_id,this._events[this._lightbox_id]=i,e.callEvent("onLiveUpdateCollision",[o,null,"delete",i])===!1))return void e.endLightbox(!1,e._lightbox);e.deleteEvent(o,!0)}})})(a)}}function n(r){e._dp?e._dp.ignore(r):r()}return{events:function(r){if(!r||!r.event||!r.event.id)return void console.error("Invalid message format:",r);const{type:a,event:i}=r;if(!e._dp._in_progress[i.id]){if(a==="add-event"){for(const o in e._dp._in_progress)if(e._dp.getState(o)==="inserted")return void e._dp.attachEvent("onFullSync",function(){e.getEvent(i.id)||t(a,i)},{once:!0})}t(a,i)}}}}function $_(e){(function(t){const n={};t.attachEvent("onConfirmedBeforeEventDelete",function(r){return n[r]=!0,!0}),t.attachEvent("onEventDeleted",function(r,a){if(!n[r])return;delete n[r];let i=t.copy(a);t.config.undo_deleted&&!t.getState().new_event&&t.message({text:`<div class="dhx_info_message">
                            <span class="undo_popup_text">Event deleted</span>
                            <button class="undo_button" data-deleted-event-id="${a.id}">Undo</button>
                        </div>`,expire:1e4,type:"popup_after_delete",callback:function(o){o.target.closest(`[data-deleted-event-id="${a.id}"]`)&&(i.rrule&&i.duration&&(i.end_date=new Date(i.start_date.valueOf()+1e3*i.duration),t.addEvent(i)),t.addEvent(i),t.render())}})})})(e),M_(e),O_(e),function(t){t.batchUpdate=R_(t)}(e),function(t){t.ext||(t.ext={}),t.ext.liveUpdates={RemoteEvents:L_,remoteUpdates:V_(t)}}(e)}var H_=Date.now();function Ka(e){return!(!e||typeof e!="object")&&!!(e.getFullYear&&e.getMonth&&e.getDate)}const tt={uid:function(){return H_++},mixin:function(e,t,n){for(var r in t)(e[r]===void 0||n)&&(e[r]=t[r]);return e},copy:function e(t){var n,r,a;if(t&&typeof t=="object")switch(!0){case Ka(t):r=new Date(t);break;case(a=t,Array.isArray?Array.isArray(a):a&&a.length!==void 0&&a.pop&&a.push):for(r=new Array(t.length),n=0;n<t.length;n++)r[n]=e(t[n]);break;case function(i){return i&&typeof i=="object"&&Function.prototype.toString.call(i.constructor)==="function String() { [native code] }"}(t):r=new String(t);break;case function(i){return i&&typeof i=="object"&&Function.prototype.toString.call(i.constructor)==="function Number() { [native code] }"}(t):r=new Number(t);break;case function(i){return i&&typeof i=="object"&&Function.prototype.toString.call(i.constructor)==="function Boolean() { [native code] }"}(t):r=new Boolean(t);break;default:for(n in r={},t){const i=typeof t[n];i==="string"||i==="number"||i==="boolean"?r[n]=t[n]:Ka(t[n])?r[n]=new Date(t[n]):Object.prototype.hasOwnProperty.apply(t,[n])&&(r[n]=e(t[n]))}}return r||t},defined:function(e){return e!==void 0},isDate:Ka,delay:function(e,t){var n,r=function(){r.$cancelTimeout(),r.$pending=!0;var a=Array.prototype.slice.call(arguments);n=setTimeout(function(){e.apply(this,a),r.$pending=!1},t)};return r.$pending=!1,r.$cancelTimeout=function(){clearTimeout(n),r.$pending=!1},r.$execute=function(){var a=Array.prototype.slice.call(arguments);e.apply(this,a),r.$cancelTimeout()},r}};function F_(e){function t(g){var h=document.createElement("div");return(g||"").split(" ").forEach(function(p){h.classList.add(p)}),h}var n=function(){return t("dhx_cal_navbar_rows_container")},r=function(){return t("dhx_cal_navbar_row")},a=function(g){var h=t("dhx_cal_tab");return h.setAttribute("name",g.view+"_tab"),h.setAttribute("data-tab",g.view),e.config.fix_tab_position&&(g.$firstTab?h.classList.add("dhx_cal_tab_first"):g.$lastTab?h.classList.add("dhx_cal_tab_last"):g.view!=="week"&&h.classList.add("dhx_cal_tab_standalone"),g.$segmentedTab&&h.classList.add("dhx_cal_tab_segmented")),h},i=function(){return t("dhx_cal_date")},o=function(g){return t("dhx_cal_nav_button dhx_cal_nav_button_custom dhx_cal_tab")},l=function(g){return t("dhx_cal_"+g.view+"_button dhx_cal_nav_button")},s=function(){return t("dhx_cal_line_spacer")},d=function(g){var h=t("dhx_minical_icon");return g.click||h.$_eventAttached||e.event(h,"click",function(){e.isCalendarVisible()?e.destroyCalendar():e.renderCalendar({position:this,date:e.getState().date,navigation:!0,handler:function(p,y){e.setCurrentView(p),e.destroyCalendar()}})}),h};function c(g){var h=function(x){var S;if(x.view)switch(x.view){case"today":case"next":case"prev":S=l;break;case"date":S=i;break;case"spacer":S=s;break;case"button":S=o;break;case"minicalendar":S=d;break;default:S=a}else x.rows?S=n:x.cols&&(S=r);return S}(g);if(h){var p=h(g);if(g.css&&p.classList.add(g.css),g.width&&((y=g.width)===1*y&&(y+="px"),p.style.width=y),g.height&&((y=g.height)===1*y&&(y+="px"),p.style.height=y),g.click&&e.event(p,"click",g.click),g.html&&(p.innerHTML=g.html),g.align){var y="";g.align=="right"?y="flex-end":g.align=="left"&&(y="flex-start"),p.style.justifyContent=y}return p}}function u(g){return typeof g=="string"&&(g={view:g}),g.view||g.rows||g.cols||(g.view="button"),g}function f(g){var h,p=document.createDocumentFragment();h=Array.isArray(g)?g:[g];for(var y=0;y<h.length;y++){var x,S=u(h[y]);S.view==="day"&&h[y+1]&&((x=u(h[y+1])).view!=="week"&&x.view!=="month"||(S.$firstTab=!0,S.$segmentedTab=!0)),S.view==="week"&&h[y-1]&&((x=u(h[y+1])).view!=="week"&&x.view!=="month"||(S.$segmentedTab=!0)),S.view==="month"&&h[y-1]&&((x=u(h[y-1])).view!=="week"&&x.view!=="day"||(S.$lastTab=!0,S.$segmentedTab=!0));var O=c(S);p.appendChild(O),(S.cols||S.rows)&&O.appendChild(f(S.cols||S.rows))}return p}e._init_nav_bar=function(g){var h=this.$container.querySelector(".dhx_cal_navline");return h||((h=document.createElement("div")).className="dhx_cal_navline dhx_cal_navline_flex",e._update_nav_bar(g,h),h)};var v=null;e._update_nav_bar=function(g,h){if(g){var p=!1,y=g.height||e.xy.nav_height;v!==null&&v===y||(p=!0),p&&(e.xy.nav_height=y),h.innerHTML="",h.appendChild(f(g)),e.unset_actions(),e._els=[],e.get_elements(),e.set_actions(),h.style.display=y===0?"none":"",v=y}}}function U_(e){function t(i){return i.isConnected!==void 0?i.isConnected:document.body.contains(i)}function n(i){return{w:i.innerWidth||document.documentElement.clientWidth,h:i.innerHeight||document.documentElement.clientHeight}}function r(i,o){var l,s=n(o);i.event(o,"resize",function(){clearTimeout(l),l=setTimeout(function(){if(t(i.$container)&&!i.$destroyed){var d,c,u=n(o);c=u,((d=s).w!=c.w||d.h!=c.h)&&(s=u,a(i))}},150)})}function a(i){i.$initialized&&!i.$destroyed&&i.$root&&t(i.$root)&&i.callEvent("onSchedulerResize",[])&&(i.updateView(),i.callEvent("onAfterSchedulerResize",[]))}(function(i){var o=i.$container;if(window.getComputedStyle(o).getPropertyValue("position")=="static"&&(o.style.position="relative"),window.ResizeObserver){let s=!0;const d=new ResizeObserver(function(c){s?s=!1:a(i)});d.observe(o),i.attachEvent("onDestroy",function(){d.unobserve(o)})}else{var l=document.createElement("iframe");l.className="scheduler_container_resize_watcher",l.tabIndex=-1,i.config.wai_aria_attributes&&(l.setAttribute("role","none"),l.setAttribute("aria-hidden",!0)),window.Sfdc||window.$A||window.Aura?function(s){var d=s.$root.offsetHeight,c=s.$root.offsetWidth;(function u(){s.$destroyed||(s.$root&&(s.$root.offsetHeight==d&&s.$root.offsetWidth==c||a(s),d=s.$root.offsetHeight,c=s.$root.offsetWidth),setTimeout(u,200))})()}(i):(o.appendChild(l),l.contentWindow?r(i,l.contentWindow):(o.removeChild(l),r(i,window)))}})(e)}let z_=class{constructor(){this._silent_mode=!1,this.listeners={}}_silentStart(){this._silent_mode=!0}_silentEnd(){this._silent_mode=!1}};function $i(e){const t=new z_;e.attachEvent=function(n,r,a){n="ev_"+n.toLowerCase(),t.listeners[n]||(t.listeners[n]=function(o){let l={},s=0;const d=function(){let c=!0;for(const u in l){const f=l[u].apply(o,arguments);c=c&&f}return c};return d.addEvent=function(c,u){if(typeof c=="function"){let f;if(u&&u.id?f=u.id:(f=s,s++),u&&u.once){const v=c;c=function(){v(),d.removeEvent(f)}}return l[f]=c,f}return!1},d.removeEvent=function(c){delete l[c]},d.clear=function(){l={}},d}(this)),a&&a.thisObject&&(r=r.bind(a.thisObject));let i=n+":"+t.listeners[n].addEvent(r,a);return a&&a.id&&(i=a.id),i},e.attachAll=function(n){this.attachEvent("listen_all",n)},e.callEvent=function(n,r){if(t._silent_mode)return!0;const a="ev_"+n.toLowerCase(),i=t.listeners;return i.ev_listen_all&&i.ev_listen_all.apply(this,[n].concat(r)),!i[a]||i[a].apply(this,r)},e.checkEvent=function(n){return!!t.listeners["ev_"+n.toLowerCase()]},e.detachEvent=function(n){if(n){let r=t.listeners;for(const i in r)r[i].removeEvent(n);const a=n.split(":");if(r=t.listeners,a.length===2){const i=a[0],o=a[1];r[i]&&r[i].removeEvent(o)}}},e.detachAllEvents=function(){for(const n in t.listeners)t.listeners[n].clear()}}const Ss={event:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},eventRemove:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}};function q_(e){var t=function(){var n=function(r,a){r=r||Ss.event,a=a||Ss.eventRemove;var i=[],o={attach:function(l,s,d,c){i.push({element:l,event:s,callback:d,capture:c}),r(l,s,d,c)},detach:function(l,s,d,c){a(l,s,d,c);for(var u=0;u<i.length;u++){var f=i[u];f.element===l&&f.event===s&&f.callback===d&&f.capture===c&&(i.splice(u,1),u--)}},detachAll:function(){for(var l=i.slice(),s=0;s<l.length;s++){var d=l[s];o.detach(d.element,d.event,d.callback,d.capture),o.detach(d.element,d.event,d.callback,void 0),o.detach(d.element,d.event,d.callback,!1),o.detach(d.element,d.event,d.callback,!0)}i.splice(0,i.length)},extend:function(){return n(this.event,this.eventRemove)}};return o};return n()}();e.event=t.attach,e.eventRemove=t.detach,e._eventRemoveAll=t.detachAll,e._createDomEventScope=t.extend,e._trim=function(n){return(String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")}).apply(n)},e._isDate=function(n){return!(!n||typeof n!="object")&&!!(n.getFullYear&&n.getMonth&&n.getDate)},e._isObject=function(n){return n&&typeof n=="object"}}function nd(e){if(!e)return"";var t=e.className||"";return t.baseVal&&(t=t.baseVal),t.indexOf||(t=""),t||""}function rd(e,t,n){n===void 0&&(n=!0);for(var r=e.target||e.srcElement,a="";r;){if(a=nd(r)){var i=a.indexOf(t);if(i>=0){if(!n)return r;var o=i===0||!(a.charAt(i-1)||"").trim(),l=i+t.length>=a.length||!a.charAt(i+t.length).trim();if(o&&l)return r}}r=r.parentNode}return null}function B_(e){var t=!1,n=!1;if(window.getComputedStyle){var r=window.getComputedStyle(e,null);t=r.display,n=r.visibility}else e.currentStyle&&(t=e.currentStyle.display,n=e.currentStyle.visibility);var a=!1,i=rd({target:e},"dhx_form_repeat",!1);return i&&(a=i.style.height=="0px"),a=a||!e.offsetHeight,t!="none"&&n!="hidden"&&!a}function j_(e){return!isNaN(e.getAttribute("tabindex"))&&1*e.getAttribute("tabindex")>=0}function Y_(e){return!{a:!0,area:!0}[e.nodeName.loLowerCase()]||!!e.getAttribute("href")}function W_(e){return!{input:!0,select:!0,textarea:!0,button:!0,object:!0}[e.nodeName.toLowerCase()]||!e.hasAttribute("disabled")}function ad(){return document.head.createShadowRoot||document.head.attachShadow}function Ds(e){if(!e||!ad())return document.body;for(;e.parentNode&&(e=e.parentNode);)if(e instanceof ShadowRoot)return e.host;return document.body}const kt={getAbsoluteLeft:function(e){return this.getOffset(e).left},getAbsoluteTop:function(e){return this.getOffset(e).top},getOffsetSum:function(e){for(var t=0,n=0;e;)t+=parseInt(e.offsetTop),n+=parseInt(e.offsetLeft),e=e.offsetParent;return{top:t,left:n}},getOffsetRect:function(e){var t=e.getBoundingClientRect(),n=0,r=0;if(/Mobi/.test(navigator.userAgent)){var a=document.createElement("div");a.style.position="absolute",a.style.left="0px",a.style.top="0px",a.style.width="1px",a.style.height="1px",document.body.appendChild(a);var i=a.getBoundingClientRect();n=t.top-i.top,r=t.left-i.left,a.parentNode.removeChild(a)}else{var o=document.body,l=document.documentElement,s=window.pageYOffset||l.scrollTop||o.scrollTop,d=window.pageXOffset||l.scrollLeft||o.scrollLeft,c=l.clientTop||o.clientTop||0,u=l.clientLeft||o.clientLeft||0;n=t.top+s-c,r=t.left+d-u}return{top:Math.round(n),left:Math.round(r)}},getOffset:function(e){return e.getBoundingClientRect?this.getOffsetRect(e):this.getOffsetSum(e)},closest:function(e,t){return e&&t?si(e,t):null},insertAfter:function(e,t){t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)},remove:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},isChildOf:function(e,t){return t.contains(e)},getFocusableNodes:function(e){for(var t=e.querySelectorAll(["a[href]","area[href]","input","select","textarea","button","iframe","object","embed","[tabindex]","[contenteditable]"].join(", ")),n=Array.prototype.slice.call(t,0),r=0;r<n.length;r++)n[r].$position=r;for(n.sort(function(i,o){return i.tabIndex===0&&o.tabIndex!==0?1:i.tabIndex!==0&&o.tabIndex===0?-1:i.tabIndex===o.tabIndex?i.$position-o.$position:i.tabIndex<o.tabIndex?-1:1}),r=0;r<n.length;r++){var a=n[r];(j_(a)||W_(a)||Y_(a))&&B_(a)||(n.splice(r,1),r--)}return n},getClassName:nd,locateCss:rd,getRootNode:Ds,hasShadowParent:function(e){return!!Ds(e)},isShadowDomSupported:ad,getActiveElement:function(){var e=document.activeElement;return e.shadowRoot&&(e=e.shadowRoot.activeElement),e===document.body&&document.getSelection&&(e=document.getSelection().focusNode||document.body),e},getRelativeEventPosition:function(e,t){var n=document.documentElement,r=function(a){var i=0,o=0,l=0,s=0;if(a.getBoundingClientRect){var d=a.getBoundingClientRect(),c=document.body,u=document.documentElement||document.body.parentNode||document.body,f=window.pageYOffset||u.scrollTop||c.scrollTop,v=window.pageXOffset||u.scrollLeft||c.scrollLeft,g=u.clientTop||c.clientTop||0,h=u.clientLeft||c.clientLeft||0;i=d.top+f-g,o=d.left+v-h,l=document.body.offsetWidth-d.right,s=document.body.offsetHeight-d.bottom}else{for(;a;)i+=parseInt(a.offsetTop,10),o+=parseInt(a.offsetLeft,10),a=a.offsetParent;l=document.body.offsetWidth-a.offsetWidth-o,s=document.body.offsetHeight-a.offsetHeight-i}return{y:Math.round(i),x:Math.round(o),width:a.offsetWidth,height:a.offsetHeight,right:Math.round(l),bottom:Math.round(s)}}(t);return{x:e.clientX-n.clientLeft-r.x+t.scrollLeft,y:e.clientY-n.clientTop-r.y+t.scrollTop}},getTargetNode:function(e){var t;return e.tagName?t=e:(t=(e=e||window.event).target||e.srcElement).shadowRoot&&e.composedPath&&(t=e.composedPath()[0]),t},getNodePosition:function(e){var t=0,n=0,r=0,a=0;if(e.getBoundingClientRect){var i=e.getBoundingClientRect(),o=document.body,l=document.documentElement||document.body.parentNode||document.body,s=window.pageYOffset||l.scrollTop||o.scrollTop,d=window.pageXOffset||l.scrollLeft||o.scrollLeft,c=l.clientTop||o.clientTop||0,u=l.clientLeft||o.clientLeft||0;t=i.top+s-c,n=i.left+d-u,r=document.body.offsetWidth-i.right,a=document.body.offsetHeight-i.bottom}else{for(;e;)t+=parseInt(e.offsetTop,10),n+=parseInt(e.offsetLeft,10),e=e.offsetParent;r=document.body.offsetWidth-e.offsetWidth-n,a=document.body.offsetHeight-e.offsetHeight-t}return{y:Math.round(t),x:Math.round(n),width:e.offsetWidth,height:e.offsetHeight,right:Math.round(r),bottom:Math.round(a)}}};var si;if(Element.prototype.closest)si=function(e,t){return e.closest(t)};else{var K_=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;si=function(e,t){var n=e;do{if(K_.call(n,t))return n;n=n.parentElement||n.parentNode}while(n!==null&&n.nodeType===1);return null}}var xt=typeof window<"u";const G_={isIE:xt&&(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0),isOpera:xt&&navigator.userAgent.indexOf("Opera")>=0,isChrome:xt&&navigator.userAgent.indexOf("Chrome")>=0,isKHTML:xt&&(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0),isFF:xt&&navigator.userAgent.indexOf("Firefox")>=0,isIPad:xt&&navigator.userAgent.search(/iPad/gi)>=0,isEdge:xt&&navigator.userAgent.indexOf("Edge")!=-1,isNode:!xt||typeof navigator>"u"};function Ga(e){if(typeof e=="string"||typeof e=="number")return e;var t="";for(var n in e){var r="";e.hasOwnProperty(n)&&(r=n+"="+(r=typeof e[n]=="string"?encodeURIComponent(e[n]):typeof e[n]=="number"?e[n]:encodeURIComponent(JSON.stringify(e[n]))),t.length&&(r="&"+r),t+=r)}return t}function J_(e){var t=function(i,o){for(var l="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",s=i.match(/%[a-zA-Z]/g),d=0;d<s.length;d++)switch(s[d]){case"%j":case"%d":l+="set[2]=temp["+d+"]||1;";break;case"%n":case"%m":l+="set[1]=(temp["+d+"]||1)-1;";break;case"%y":l+="set[0]=temp["+d+"]*1+(temp["+d+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":l+="set[3]=temp["+d+"]||0;";break;case"%i":l+="set[4]=temp["+d+"]||0;";break;case"%Y":l+="set[0]=temp["+d+"]||0;";break;case"%a":case"%A":l+="set[3]=set[3]%12+((temp["+d+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":l+="set[5]=temp["+d+"]||0;";break;case"%M":l+="set[1]=this.locale.date.month_short_hash[temp["+d+"]]||0;";break;case"%F":l+="set[1]=this.locale.date.month_full_hash[temp["+d+"]]||0;"}var c="set[0],set[1],set[2],set[3],set[4],set[5]";return o&&(c=" Date.UTC("+c+")"),new Function("date","var set=[0,0,1,0,0,0]; "+l+" return new Date("+c+");")},n=function(i,o){const l=i.match(/%[a-zA-Z]/g);return function(s){for(var d=[0,0,1,0,0,0],c=s.match(/[a-zA-Z]+|[0-9]+/g),u=0;u<l.length;u++)switch(l[u]){case"%j":case"%d":d[2]=c[u]||1;break;case"%n":case"%m":d[1]=(c[u]||1)-1;break;case"%y":d[0]=1*c[u]+(c[u]>50?1900:2e3);break;case"%g":case"%G":case"%h":case"%H":d[3]=c[u]||0;break;case"%i":d[4]=c[u]||0;break;case"%Y":d[0]=c[u]||0;break;case"%a":case"%A":d[3]=d[3]%12+((c[u]||"").toLowerCase()=="am"?0:12);break;case"%s":d[5]=c[u]||0;break;case"%M":d[1]=e.locale.date.month_short_hash[c[u]]||0;break;case"%F":d[1]=e.locale.date.month_full_hash[c[u]]||0}return o?new Date(Date.UTC(d[0],d[1],d[2],d[3],d[4],d[5])):new Date(d[0],d[1],d[2],d[3],d[4],d[5])}};let r;function a(){var i=!1;return e.config.csp==="auto"?(r===void 0&&(r=function(){try{new Function("cspEnabled = false;"),r=!1}catch{r=!0}return r}()),i=r):i=e.config.csp,i}e.date={init:function(){for(var i=e.locale.date.month_short,o=e.locale.date.month_short_hash={},l=0;l<i.length;l++)o[i[l]]=l;for(i=e.locale.date.month_full,o=e.locale.date.month_full_hash={},l=0;l<i.length;l++)o[i[l]]=l},date_part:function(i){const o=new Date(i);var l=new Date(o);return o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0),o.getHours()&&(o.getDate()<l.getDate()||o.getMonth()<l.getMonth()||o.getFullYear()<l.getFullYear())&&o.setTime(o.getTime()+36e5*(24-o.getHours())),o},time_part:function(i){return(i.valueOf()/1e3-60*i.getTimezoneOffset())%86400},week_start:function(i){var o=i.getDay();return e.config.start_on_monday&&(o===0?o=6:o--),this.date_part(this.add(i,-1*o,"day"))},month_start:function(i){const o=new Date(i);return o.setDate(1),this.date_part(o)},year_start:function(i){const o=new Date(i);return o.setMonth(0),this.month_start(o)},day_start:function(i){const o=new Date(i);return this.date_part(o)},_add_days:function(i,o){var l=new Date(i.valueOf());if(l.setDate(l.getDate()+o),o==Math.round(o)&&o>0){var s=(+l-+i)%864e5;if(s&&i.getTimezoneOffset()==l.getTimezoneOffset()){var d=s/36e5;l.setTime(l.getTime()+60*(24-d)*60*1e3)}}return o>=0&&!i.getHours()&&l.getHours()&&(l.getDate()<i.getDate()||l.getMonth()<i.getMonth()||l.getFullYear()<i.getFullYear())&&l.setTime(l.getTime()+36e5*(24-l.getHours())),l},add:function(i,o,l){var s=new Date(i.valueOf());switch(l){case"day":s=e.date._add_days(s,o);break;case"week":s=e.date._add_days(s,7*o);break;case"month":s.setMonth(s.getMonth()+o);break;case"year":s.setYear(s.getFullYear()+o);break;case"hour":s.setTime(s.getTime()+60*o*60*1e3);break;case"minute":s.setTime(s.getTime()+60*o*1e3);break;default:return e.date["add_"+l](i,o,l)}return s},to_fixed:function(i){return i<10?"0"+i:i},copy:function(i){return new Date(i.valueOf())},date_to_str:function(i,o){return a()?function(l,s){return function(d){return l.replace(/%[a-zA-Z]/g,function(c){switch(c){case"%d":return s?e.date.to_fixed(d.getUTCDate()):e.date.to_fixed(d.getDate());case"%m":return s?e.date.to_fixed(d.getUTCMonth()+1):e.date.to_fixed(d.getMonth()+1);case"%j":return s?d.getUTCDate():d.getDate();case"%n":return s?d.getUTCMonth()+1:d.getMonth()+1;case"%y":return s?e.date.to_fixed(d.getUTCFullYear()%100):e.date.to_fixed(d.getFullYear()%100);case"%Y":return s?d.getUTCFullYear():d.getFullYear();case"%D":return s?e.locale.date.day_short[d.getUTCDay()]:e.locale.date.day_short[d.getDay()];case"%l":return s?e.locale.date.day_full[d.getUTCDay()]:e.locale.date.day_full[d.getDay()];case"%M":return s?e.locale.date.month_short[d.getUTCMonth()]:e.locale.date.month_short[d.getMonth()];case"%F":return s?e.locale.date.month_full[d.getUTCMonth()]:e.locale.date.month_full[d.getMonth()];case"%h":return s?e.date.to_fixed((d.getUTCHours()+11)%12+1):e.date.to_fixed((d.getHours()+11)%12+1);case"%g":return s?(d.getUTCHours()+11)%12+1:(d.getHours()+11)%12+1;case"%G":return s?d.getUTCHours():d.getHours();case"%H":return s?e.date.to_fixed(d.getUTCHours()):e.date.to_fixed(d.getHours());case"%i":return s?e.date.to_fixed(d.getUTCMinutes()):e.date.to_fixed(d.getMinutes());case"%a":return s?d.getUTCHours()>11?"pm":"am":d.getHours()>11?"pm":"am";case"%A":return s?d.getUTCHours()>11?"PM":"AM":d.getHours()>11?"PM":"AM";case"%s":return s?e.date.to_fixed(d.getUTCSeconds()):e.date.to_fixed(d.getSeconds());case"%W":return s?e.date.to_fixed(e.date.getUTCISOWeek(d)):e.date.to_fixed(e.date.getISOWeek(d));default:return c}})}}(i,o):(i=i.replace(/%[a-zA-Z]/g,function(l){switch(l){case"%d":return'"+this.date.to_fixed(date.getDate())+"';case"%m":return'"+this.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+this.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+this.locale.date.day_short[date.getDay()]+"';case"%l":return'"+this.locale.date.day_full[date.getDay()]+"';case"%M":return'"+this.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+this.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+this.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+this.date.to_fixed(date.getHours())+"';case"%i":return'"+this.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+this.date.to_fixed(date.getSeconds())+"';case"%W":return'"+this.date.to_fixed(this.date.getISOWeek(date))+"';default:return l}}),o&&(i=i.replace(/date\.get/g,"date.getUTC")),new Function("date",'return "'+i+'";').bind(e))},str_to_date:function(i,o,l){var s=a()?n:t,d=s(i,o),c=/^[0-9]{4}(\-|\/)[0-9]{2}(\-|\/)[0-9]{2} ?(([0-9]{1,2}:[0-9]{1,2})(:[0-9]{1,2})?)?$/,u=/^[0-9]{2}\/[0-9]{2}\/[0-9]{4} ?(([0-9]{1,2}:[0-9]{2})(:[0-9]{1,2})?)?$/,f=/^[0-9]{2}\-[0-9]{2}\-[0-9]{4} ?(([0-9]{1,2}:[0-9]{1,2})(:[0-9]{1,2})?)?$/,v=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,g=s("%Y-%m-%d %H:%i:%s",o),h=s("%m/%d/%Y %H:%i:%s",o),p=s("%d-%m-%Y %H:%i:%s",o);return function(y){if(!l&&!e.config.parse_exact_format){if(y&&y.getISOWeek)return new Date(y);if(typeof y=="number")return new Date(y);if(x=y,c.test(String(x)))return g(y);if(function(S){return u.test(String(S))}(y))return h(y);if(function(S){return f.test(String(S))}(y))return p(y);if(function(S){return v.test(S)}(y))return new Date(y)}var x;return d.call(e,y)}},getISOWeek:function(i){if(!i)return!1;var o=(i=this.date_part(new Date(i))).getDay();o===0&&(o=7);var l=new Date(i.valueOf());l.setDate(i.getDate()+(4-o));var s=l.getFullYear(),d=Math.round((l.getTime()-new Date(s,0,1).getTime())/864e5);return 1+Math.floor(d/7)},getUTCISOWeek:function(i){return this.getISOWeek(this.convert_to_utc(i))},convert_to_utc:function(i){return new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds())}}}function id(e){return(function(){var t={};for(var n in this._events){var r=this._events[n];r.id.toString().indexOf("#")==-1&&(t[r.id]=r)}return t}).bind(e)}function Q_(e){e._loaded={},e._load=function(n,r){if(n=n||this._load_url){var a;if(n+=(n.indexOf("?")==-1?"?":"&")+"timeshift="+new Date().getTimezoneOffset(),this.config.prevent_cache&&(n+="&uid="+this.uid()),r=r||this._date,this._load_mode){var i=this.templates.load_format;for(r=this.date[this._load_mode+"_start"](new Date(r.valueOf()));r>this._min_date;)r=this.date.add(r,-1,this._load_mode);a=r;for(var o=!0;a<this._max_date;)a=this.date.add(a,1,this._load_mode),this._loaded[i(r)]&&o?r=this.date.add(r,1,this._load_mode):o=!1;var l=a;do a=l,l=this.date.add(a,-1,this._load_mode);while(l>r&&this._loaded[i(l)]);if(a<=r)return!1;for(e.ajax.get(n+"&from="+i(r)+"&to="+i(a),s);r<a;)this._loaded[i(r)]=!0,r=this.date.add(r,1,this._load_mode)}else e.ajax.get(n,s);return this.callEvent("onXLS",[]),this.callEvent("onLoadStart",[]),!0}function s(d){e.on_load(d),e.callEvent("onLoadEnd",[])}},e._parsers={},function(n){n._parsers.xml={canParse:function(r,a){if(a.responseXML&&a.responseXML.firstChild)return!0;try{var i=n.ajax.parse(a.responseText),o=n.ajax.xmltop("data",i);if(o&&o.tagName==="data")return!0}catch{}return!1},parse:function(r){var a;if(r.xmlDoc.responseXML||(r.xmlDoc.responseXML=n.ajax.parse(r.xmlDoc.responseText)),(a=n.ajax.xmltop("data",r.xmlDoc)).tagName!="data")return null;var i=a.getAttribute("dhx_security");i&&(window.dhtmlx&&(window.dhtmlx.security_key=i),n.security_key=i);for(var o=n.ajax.xpath("//coll_options",r.xmlDoc),l=0;l<o.length;l++){var s=o[l].getAttribute("for"),d=n.serverList[s];d||(n.serverList[s]=d=[]),d.splice(0,d.length);for(var c=n.ajax.xpath(".//item",o[l]),u=0;u<c.length;u++){for(var f=c[u].attributes,v={key:c[u].getAttribute("value"),label:c[u].getAttribute("label")},g=0;g<f.length;g++){var h=f[g];h.nodeName!="value"&&h.nodeName!="label"&&(v[h.nodeName]=h.nodeValue)}d.push(v)}}o.length&&n.callEvent("onOptionsLoad",[]);var p=n.ajax.xpath("//userdata",r.xmlDoc);for(l=0;l<p.length;l++){var y=n._xmlNodeToJSON(p[l]);n._userdata[y.name]=y.text}var x=[];for(a=n.ajax.xpath("//event",r.xmlDoc),l=0;l<a.length;l++){var S=x[l]=n._xmlNodeToJSON(a[l]);n._init_event(S)}return x}}}(e),function(n){n.json=n._parsers.json={canParse:function(r){if(r&&typeof r=="object")return!0;if(typeof r=="string")try{var a=JSON.parse(r);return Object.prototype.toString.call(a)==="[object Object]"||Object.prototype.toString.call(a)==="[object Array]"}catch{return!1}return!1},parse:function(r){var a=[];typeof r=="string"&&(r=JSON.parse(r)),Object.prototype.toString.call(r)==="[object Array]"?a=r:r&&(r.events?a=r.events:r.data&&(a=r.data)),a=a||[],r.dhx_security&&(window.dhtmlx&&(window.dhtmlx.security_key=r.dhx_security),n.security_key=r.dhx_security);var i=r&&r.collections?r.collections:{},o=!1;for(var l in i)if(i.hasOwnProperty(l)){o=!0;var s=i[l],d=n.serverList[l];d||(n.serverList[l]=d=[]),d.splice(0,d.length);for(var c=0;c<s.length;c++){var u=s[c],f={key:u.value,label:u.label};for(var v in u)if(u.hasOwnProperty(v)){if(v=="value"||v=="label")continue;f[v]=u[v]}d.push(f)}}o&&n.callEvent("onOptionsLoad",[]);for(var g=[],h=0;h<a.length;h++){var p=a[h];n._init_event(p),g.push(p)}return g}}}(e),function(n){n.ical=n._parsers.ical={canParse:function(r){return typeof r=="string"&&new RegExp("^BEGIN:VCALENDAR").test(r)},parse:function(r){var a=r.match(RegExp(this.c_start+"[^\f]*"+this.c_end,""));if(a.length){a[0]=a[0].replace(/[\r\n]+ /g,""),a[0]=a[0].replace(/[\r\n]+(?=[a-z \t])/g," "),a[0]=a[0].replace(/;[^:\r\n]*:/g,":");for(var i,o=[],l=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");(i=l.exec(a))!==null;){for(var s,d={},c=/[^\r\n]+[\r\n]+/g;(s=c.exec(i[1]))!==null;)this.parse_param(s.toString(),d);d.uid&&!d.id&&(d.id=d.uid),o.push(d)}return o}},parse_param:function(r,a){var i=r.indexOf(":");if(i!=-1){var o=r.substr(0,i).toLowerCase(),l=r.substr(i+1).replace(/\\,/g,",").replace(/[\r\n]+$/,"");o=="summary"?o="text":o=="dtstart"?(o="start_date",l=this.parse_date(l,0,0)):o=="dtend"&&(o="end_date",l=this.parse_date(l,0,0)),a[o]=l}},parse_date:function(r,a,i){var o=r.split("T"),l=!1;o[1]&&(a=o[1].substr(0,2),i=o[1].substr(2,2),l=o[1][6]=="Z");var s=o[0].substr(0,4),d=parseInt(o[0].substr(4,2),10)-1,c=o[0].substr(6,2);return n.config.server_utc||l?new Date(Date.UTC(s,d,c,a,i)):new Date(s,d,c,a,i)},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"}}(e),e.on_load=function(n){var r;this.callEvent("onBeforeParse",[]);var a=!1,i=!1;for(var o in this._parsers){var l=this._parsers[o];if(l.canParse(n.xmlDoc.responseText,n.xmlDoc)){try{var s=n.xmlDoc.responseText;o==="xml"&&(s=n),(r=l.parse(s))||(a=!0)}catch{a=!0}i=!0;break}}if(!i)if(this._process&&this[this._process])try{r=this[this._process].parse(n.xmlDoc.responseText)}catch{a=!0}else a=!0;(a||n.xmlDoc.status&&n.xmlDoc.status>=400)&&(this.callEvent("onLoadError",[n.xmlDoc]),r=[]),this._process_loading(r),this.callEvent("onXLE",[]),this.callEvent("onParse",[])},e._process_loading=function(n){this._loading=!0,this._not_render=!0;for(var r=0;r<n.length;r++)this.callEvent("onEventLoading",[n[r]])&&this.addEvent(n[r]);this._not_render=!1,this._render_wait&&this.render_view_data(),this._loading=!1,this._after_call&&this._after_call(),this._after_call=null},e._init_event=function(n){n.text=n.text||n._tagvalue||"",n.start_date=e._init_date(n.start_date),n.end_date=e._init_date(n.end_date)},e._init_date=function(n){return n?typeof n=="string"?e._helpers.parseDate(n):new Date(n):null};const t=id(e);e.serialize=function(){const n=[],r=t();for(var a in r){const l={};var i=r[a];for(var o in i){if(o.charAt(0)=="$"||o.charAt(0)=="_")continue;let s;const d=i[o];s=e.utils.isDate(d)?e.defined(e.templates.xml_format)?e.templates.xml_format(d):e.templates.format_date(d):d,l[o]=s}n.push(l)}return n},e.parse=function(n,r){this._process=r,this.on_load({xmlDoc:{responseText:n}})},e.load=function(n,r){typeof r=="string"&&(this._process=r,r=arguments[2]),this._load_url=n,this._after_call=r,this._load(n,this._date)},e.setLoadMode=function(n){n=="all"&&(n=""),this._load_mode=n},e.serverList=function(n,r){return r?(this.serverList[n]=r.slice(0),this.serverList[n]):(this.serverList[n]=this.serverList[n]||[],this.serverList[n])},e._userdata={},e._xmlNodeToJSON=function(n){for(var r={},a=0;a<n.attributes.length;a++)r[n.attributes[a].name]=n.attributes[a].value;for(a=0;a<n.childNodes.length;a++){var i=n.childNodes[a];i.nodeType==1&&(r[i.tagName]=i.firstChild?i.firstChild.nodeValue:"")}return r.text||(r.text=n.firstChild?n.firstChild.nodeValue:""),r},e.attachEvent("onXLS",function(){var n;this.config.show_loading===!0&&((n=this.config.show_loading=document.createElement("div")).className="dhx_loading",n.style.left=Math.round((this._x-128)/2)+"px",n.style.top=Math.round((this._y-15)/2)+"px",this._obj.appendChild(n))}),e.attachEvent("onXLE",function(){var n=this.config.show_loading;n&&typeof n=="object"&&(n.parentNode&&n.parentNode.removeChild(n),this.config.show_loading=!0)})}function X_(e){function t(){const n=e.config.csp===!0,r=!!window.Sfdc||!!window.$A||window.Aura||"$shadowResolver$"in document.body;return n||r?e.$root:document.body}e._lightbox_controls={},e.formSection=function(n){for(var r=this.config.lightbox.sections,a=0;a<r.length&&r[a].name!=n;a++);if(a===r.length)return null;var i=r[a];e._lightbox||e.getLightbox();var o=e._lightbox.querySelector(`#${i.id}`),l=o.nextSibling,s={section:i,header:o,node:l,getValue:function(c){return e.form_blocks[i.type].get_value(l,c||{},i)},setValue:function(c,u){return e.form_blocks[i.type].set_value(l,c,u||{},i)}},d=e._lightbox_controls["get_"+i.type+"_control"];return d?d(s):s},e._lightbox_controls.get_template_control=function(n){return n.control=n.node,n},e._lightbox_controls.get_select_control=function(n){return n.control=n.node.getElementsByTagName("select")[0],n},e._lightbox_controls.get_textarea_control=function(n){return n.control=n.node.getElementsByTagName("textarea")[0],n},e._lightbox_controls.get_time_control=function(n){return n.control=n.node.getElementsByTagName("select"),n},e._lightbox_controls.defaults={template:{height:30},textarea:{height:200},select:{height:23},time:{height:20}},e.form_blocks={template:{render:function(n){return`<div class='dhx_cal_ltext dhx_cal_template' ${n.height?`style='height:${n.height}px;'`:""}></div>`},set_value:function(n,r,a,i){n.innerHTML=r||""},get_value:function(n,r,a){return n.innerHTML||""},focus:function(n){}},textarea:{render:function(n){return`<div class='dhx_cal_ltext' ${n.height?`style='height:${n.height}px;'`:""}><textarea ${n.placeholder?`placeholder='${n.placeholder}'`:""}></textarea></div>`},set_value:function(n,r,a){e.form_blocks.textarea._get_input(n).value=r||""},get_value:function(n,r){return e.form_blocks.textarea._get_input(n).value},focus:function(n){var r=e.form_blocks.textarea._get_input(n);e._focus(r,!0)},_get_input:function(n){return n.getElementsByTagName("textarea")[0]}},select:{render:function(n){for(var r=`<div class='dhx_cal_ltext dhx_cal_select' ${n.height?`style='height:${n.height}px;'`:""}><select style='width:100%;'>`,a=0;a<n.options.length;a++)r+="<option value='"+n.options[a].key+"'>"+n.options[a].label+"</option>";return r+="</select></div>"},set_value:function(n,r,a,i){var o=n.firstChild;!o._dhx_onchange&&i.onchange&&(e.event(o,"change",i.onchange),o._dhx_onchange=!0),r===void 0&&(r=(o.options[0]||{}).value),o.value=r||""},get_value:function(n,r){return n.firstChild.value},focus:function(n){var r=n.firstChild;e._focus(r,!0)}},time:{render:function(n){n.time_format||(n.time_format=["%H:%i","%d","%m","%Y"]),n._time_format_order={};var r=n.time_format,a=e.config,i=e.date.date_part(e._currentDate()),o=1440,l=0;e.config.limit_time_select&&(o=60*a.last_hour+1,l=60*a.first_hour,i.setHours(a.first_hour));for(var s="",d=0;d<r.length;d++){var c=r[d];d>0&&(s+=" ");var u="",f="";switch(c){case"%Y":var v,g,h;u="dhx_lightbox_year_select",n._time_format_order[3]=d,n.year_range&&(isNaN(n.year_range)?n.year_range.push&&(g=n.year_range[0],h=n.year_range[1]):v=n.year_range),v=v||10;var p=p||Math.floor(v/2);g=g||i.getFullYear()-p,h=h||g+v;for(var y=g;y<h;y++)f+="<option value='"+y+"'>"+y+"</option>";break;case"%m":for(u="dhx_lightbox_month_select",n._time_format_order[2]=d,y=0;y<12;y++)f+="<option value='"+y+"'>"+this.locale.date.month_full[y]+"</option>";break;case"%d":for(u="dhx_lightbox_day_select",n._time_format_order[1]=d,y=1;y<32;y++)f+="<option value='"+y+"'>"+y+"</option>";break;case"%H:%i":u="dhx_lightbox_time_select",n._time_format_order[0]=d,y=l;var x=i.getDate();for(n._time_values=[];y<o;)f+="<option value='"+y+"'>"+this.templates.time_picker(i)+"</option>",n._time_values.push(y),i.setTime(i.valueOf()+60*this.config.time_step*1e3),y=24*(i.getDate()!=x?1:0)*60+60*i.getHours()+i.getMinutes()}if(f){var S=e._waiAria.lightboxSelectAttrString(c);s+="<select class='"+u+"' "+(n.readonly?"disabled='disabled'":"")+S+">"+f+"</select> "}}return`<div class='dhx_section_time' ${n.height?`style='height:${n.height}px;'`:""}>${s}<span style='font-weight:normal; font-size:10pt;' class='dhx_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>${s}</div>`},set_value:function(n,r,a,i){var o,l,s=e.config,d=n.getElementsByTagName("select"),c=i._time_format_order;if(s.full_day){if(!n._full_day){var u="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+e.locale.labels.full_day+"&nbsp;</label></input>";e.config.wide_form||(u=n.previousSibling.innerHTML+u),n.previousSibling.innerHTML=u,n._full_day=!0}var f=n.previousSibling.getElementsByTagName("input")[0];f.checked=e.date.time_part(a.start_date)===0&&e.date.time_part(a.end_date)===0,d[c[0]].disabled=f.checked,d[c[0]+d.length/2].disabled=f.checked,f.$_eventAttached||(f.$_eventAttached=!0,e.event(f,"click",function(){if(f.checked){var p={};e.form_blocks.time.get_value(n,p,i),o=e.date.date_part(p.start_date),(+(l=e.date.date_part(p.end_date))==+o||+l>=+o&&(a.end_date.getHours()!==0||a.end_date.getMinutes()!==0))&&(l=e.date.add(l,1,"day"))}else o=null,l=null;d[c[0]].disabled=f.checked,d[c[0]+d.length/2].disabled=f.checked,h(d,0,o||a.start_date),h(d,4,l||a.end_date)}))}if(s.auto_end_date&&s.event_duration)for(var v=function(){s.auto_end_date&&s.event_duration&&(o=new Date(d[c[3]].value,d[c[2]].value,d[c[1]].value,0,d[c[0]].value),l=new Date(o.getTime()+60*e.config.event_duration*1e3),h(d,4,l))},g=0;g<4;g++)d[g].$_eventAttached||(d[g].$_eventAttached=!0,e.event(d[g],"change",v));function h(p,y,x){for(var S=i._time_values,O=60*x.getHours()+x.getMinutes(),I=O,N=!1,A=0;A<S.length;A++){var m=S[A];if(m===O){N=!0;break}m<O&&(I=m)}p[y+c[0]].value=N?O:I,N||I||(p[y+c[0]].selectedIndex=-1),p[y+c[1]].value=x.getDate(),p[y+c[2]].value=x.getMonth(),p[y+c[3]].value=x.getFullYear()}h(d,0,a.start_date),h(d,4,a.end_date)},get_value:function(n,r,a){var i=n.getElementsByTagName("select"),o=a._time_format_order;if(r.start_date=new Date(i[o[3]].value,i[o[2]].value,i[o[1]].value,0,i[o[0]].value),r.end_date=new Date(i[o[3]+4].value,i[o[2]+4].value,i[o[1]+4].value,0,i[o[0]+4].value),!i[o[3]].value||!i[o[3]+4].value){var l=e.getEvent(e._lightbox_id);l&&(r.start_date=l.start_date,r.end_date=l.end_date)}return r.end_date<=r.start_date&&(r.end_date=e.date.add(r.start_date,e.config.time_step,"minute")),{start_date:new Date(r.start_date),end_date:new Date(r.end_date)}},focus:function(n){e._focus(n.getElementsByTagName("select")[0])}}},e._setLbPosition=function(n){n&&(n.style.top=Math.max(t().offsetHeight/2-n.offsetHeight/2,0)+"px",n.style.left=Math.max(t().offsetWidth/2-n.offsetWidth/2,0)+"px")},e.showCover=function(n){n&&(n.style.display="block",this._setLbPosition(n)),e.config.responsive_lightbox&&(document.documentElement.classList.add("dhx_cal_overflow_container"),t().classList.add("dhx_cal_overflow_container")),this.show_cover(),this._cover.style.display=""},e.showLightbox=function(n){if(n)if(this.callEvent("onBeforeLightbox",[n])){this.showCover(r);var r=this.getLightbox();this._setLbPosition(r),this._fill_lightbox(n,r),this._waiAria.lightboxVisibleAttr(r),this.callEvent("onLightbox",[n])}else this._new_event&&(this._new_event=null)},e._fill_lightbox=function(n,r){var a=this.getEvent(n),i=r.getElementsByTagName("span"),o=[];if(e.templates.lightbox_header){o.push("");var l=e.templates.lightbox_header(a.start_date,a.end_date,a);o.push(l),i[1].innerHTML="",i[2].innerHTML=l}else{var s=this.templates.event_header(a.start_date,a.end_date,a),d=(this.templates.event_bar_text(a.start_date,a.end_date,a)||"").substr(0,70);o.push(s),o.push(d),i[1].innerHTML=s,i[2].innerHTML=d}this._waiAria.lightboxHeader(r,o.join(" "));for(var c=this.config.lightbox.sections,u=0;u<c.length;u++){var f=c[u],v=e._get_lightbox_section_node(f),g=this.form_blocks[f.type],h=a[f.map_to]!==void 0?a[f.map_to]:f.default_value;g.set_value.call(this,v,h,a,f),c[u].focus&&g.focus.call(this,v)}e._lightbox_id=n},e._get_lightbox_section_node=function(n){return e._lightbox.querySelector(`#${n.id}`).nextSibling},e._lightbox_out=function(n){for(var r=this.config.lightbox.sections,a=0;a<r.length;a++){var i=e._lightbox.querySelector(`#${r[a].id}`);i=i&&i.nextSibling;var o=this.form_blocks[r[a].type].get_value.call(this,i,n,r[a]);r[a].map_to!="auto"&&(n[r[a].map_to]=o)}return n},e._empty_lightbox=function(n){var r=e._lightbox_id,a=this.getEvent(r);this._lame_copy(a,n),this.setEvent(a.id,a),this._edit_stop_event(a,!0),this.render_view_data()},e.hide_lightbox=function(n){e.endLightbox(!1,this.getLightbox())},e.hideCover=function(n){n&&(n.style.display="none"),this.hide_cover(),e.config.responsive_lightbox&&(document.documentElement.classList.remove("dhx_cal_overflow_container"),t().classList.remove("dhx_cal_overflow_container"))},e.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},e.show_cover=function(){this._cover||(this._cover=document.createElement("div"),this._cover.className="dhx_cal_cover",this._cover.style.display="none",e.event(this._cover,"mousemove",e._move_while_dnd),e.event(this._cover,"mouseup",e._finish_dnd),t().appendChild(this._cover))},e.save_lightbox=function(){var n=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));this.checkEvent("onEventSave")&&!this.callEvent("onEventSave",[this._lightbox_id,n,this._new_event])||(this._empty_lightbox(n),this.hide_lightbox())},e.startLightbox=function(n,r){this._lightbox_id=n,this._custom_lightbox=!0,this._temp_lightbox=this._lightbox,this._lightbox=r,this.showCover(r)},e.endLightbox=function(n,r){r=r||e.getLightbox();var a=e.getEvent(this._lightbox_id);a&&this._edit_stop_event(a,n),n&&e.render_view_data(),this.hideCover(r),this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1),this._temp_lightbox=this._lightbox_id=null,this._waiAria.lightboxHiddenAttr(r),this.resetLightbox(),this.callEvent("onAfterLightbox",[])},e.resetLightbox=function(){e._lightbox&&!e._custom_lightbox&&e._lightbox.parentNode.removeChild(e._lightbox),e._lightbox=null},e.cancel_lightbox=function(){this._lightbox_id&&this.callEvent("onEventCancel",[this._lightbox_id,!!this._new_event]),this.hide_lightbox()},e.hideLightbox=e.cancel_lightbox,e._init_lightbox_events=function(){if(this.getLightbox().$_eventAttached)return;const n=this.getLightbox();n.$_eventAttached=!0,e.event(n,"click",function(r){r.target.closest(".dhx_cal_ltitle_close_btn")&&e.cancel_lightbox();const a=e.$domHelpers.closest(r.target,".dhx_btn_set");if(!a){const l=e.$domHelpers.closest(r.target,".dhx_custom_button[data-section-index]");if(l){const s=Number(l.getAttribute("data-section-index"));e.form_blocks[e.config.lightbox.sections[s].type].button_click(e.$domHelpers.closest(l,".dhx_cal_lsection"),l,r)}return}const i=a?a.getAttribute("data-action"):null;switch(i){case"dhx_save_btn":case"save":if(e.config.readonly_active)return;e.save_lightbox();break;case"dhx_delete_btn":case"delete":if(e.config.readonly_active)return;var o=e.locale.labels.confirm_deleting;e._dhtmlx_confirm({message:o,title:e.locale.labels.title_confirm_deleting,callback:function(){let l=e.getEvent(e._lightbox_id);l._thisAndFollowing?(l._removeFollowing=!0,e.callEvent("onEventSave",[l.id,l,e._new_event])):e.deleteEvent(e._lightbox_id),e._new_event=null,e.hide_lightbox()},config:{ok:e.locale.labels.icon_delete}});break;case"dhx_cancel_btn":case"cancel":e.cancel_lightbox();break;default:e.callEvent("onLightboxButton",[i,a,r])}}),e.event(n,"keydown",function(r){var a=r||window.event,i=r.target||r.srcElement,o=i.querySelector("[dhx_button]");switch(o||(o=i.parentNode.querySelector(".dhx_custom_button, .dhx_readonly")),(r||a).keyCode){case 32:if((r||a).shiftKey)return;o&&o.click&&o.click();break;case e.keys.edit_save:if((r||a).shiftKey)return;if(o&&o.click)o.click();else{if(e.config.readonly_active)return;e.save_lightbox()}break;case e.keys.edit_cancel:e.cancel_lightbox()}}),e.event(n,"click",function(r){if(r.target.closest(".dhx_lightbox_day_select")||r.target.closest(".dhx_lightbox_month_select")){const a=n.querySelectorAll(".dhx_lightbox_month_select"),i=n.querySelectorAll(".dhx_lightbox_day_select"),o=n.querySelectorAll(".dhx_lightbox_year_select");a.length&&i.length&&o&&a.forEach((l,s)=>{const d=i[s],c=parseInt(l.value,10);let u=parseInt(o[s].value,10);u||(u=new Date(e.getState().date).getFullYear());const f=function(h,p){return new Date(h,p+1,0).getDate()}(u,c),v=f||31;let g=d.value;d.innerHTML="";for(let h=1;h<=v;h++){const p=document.createElement("option");p.value=h,p.textContent=h,d.appendChild(p)}d.value=Math.min(g,v)})}})},e.setLightboxSize=function(){},e._init_dnd_events=function(){e.event(t(),"mousemove",e._move_while_dnd),e.event(t(),"mouseup",e._finish_dnd),e._init_dnd_events=function(){}},e._move_while_dnd=function(n){if(e._dnd_start_lb){document.dhx_unselectable||(t().classList.add("dhx_unselectable"),document.dhx_unselectable=!0);var r=e.getLightbox(),a=[n.pageX,n.pageY];r.style.top=e._lb_start[1]+a[1]-e._dnd_start_lb[1]+"px",r.style.left=e._lb_start[0]+a[0]-e._dnd_start_lb[0]+"px"}},e._ready_to_dnd=function(n){var r=e.getLightbox();e._lb_start=[r.offsetLeft,r.offsetTop],e._dnd_start_lb=[n.pageX,n.pageY]},e._finish_dnd=function(){e._lb_start&&(e._lb_start=e._dnd_start_lb=!1,t().classList.remove("dhx_unselectable"),document.dhx_unselectable=!1)},e.getLightbox=function(){if(!this._lightbox){var n=document.createElement("div");n.className="dhx_cal_light",e.config.wide_form&&(n.className+=" dhx_cal_light_wide"),e.form_blocks.recurring&&(n.className+=" dhx_cal_light_rec"),e.config.rtl&&(n.className+=" dhx_cal_light_rtl"),e.config.responsive_lightbox&&(n.className+=" dhx_cal_light_responsive"),n.style.visibility="hidden";var r=this._lightbox_template,a=this.config.buttons_right;r+="<div class='dhx_cal_lcontrols'>";for(var i=0;i<a.length;i++)r+="<div "+this._waiAria.lightboxButtonAttrString(a[i])+" data-action='"+a[i]+"' class='dhx_btn_set dhx_"+(e.config.rtl?"right":"left")+"_btn_set "+a[i]+"_set'><div class='dhx_btn_inner "+a[i]+"'></div><div>"+e.locale.labels[a[i]]+"</div></div>";a=this.config.buttons_left;var o=e.config.rtl;for(i=0;i<a.length;i++)r+="<div class='dhx_cal_lcontrols_push_right'></div>",r+="<div "+this._waiAria.lightboxButtonAttrString(a[i])+" data-action='"+a[i]+"' class='dhx_btn_set dhx_"+(o?"left":"right")+"_btn_set "+a[i]+"_set'><div class='dhx_btn_inner "+a[i]+"'></div><div>"+e.locale.labels[a[i]]+"</div></div>";r+="</div>",r+="</div>",n.innerHTML=r,e.config.drag_lightbox&&(e.event(n.firstChild,"mousedown",e._ready_to_dnd),e.event(n.firstChild,"selectstart",function(v){return v.preventDefault(),!1}),n.firstChild.style.cursor="move",e._init_dnd_events()),this._waiAria.lightboxAttr(n),this.show_cover(),this._cover.insertBefore(n,this._cover.firstChild),this._lightbox=n;var l=this.config.lightbox.sections;for(r="",i=0;i<l.length;i++){var s=this.form_blocks[l[i].type];if(s){l[i].id="area_"+this.uid();var d="";l[i].button&&(d="<div "+e._waiAria.lightboxSectionButtonAttrString(this.locale.labels["button_"+l[i].button])+" class='dhx_custom_button' data-section-index='"+i+"' index='"+i+"'><div class='dhx_custom_button_"+l[i].button+"'></div><div>"+this.locale.labels["button_"+l[i].button]+"</div></div>"),this.config.wide_form&&(r+="<div class='dhx_wrap_section'>");var c=this.locale.labels["section_"+l[i].name];typeof c!="string"&&(c=l[i].name),r+="<div id='"+l[i].id+"' class='dhx_cal_lsection dhx_cal_lsection_"+l[i].name+"'>"+d+"<label>"+c+"</label></div>"+s.render.call(this,l[i]),r+="</div>"}}var u=n.getElementsByTagName("div");for(i=0;i<u.length;i++){var f=u[i];if(e._getClassName(f)=="dhx_cal_larea"){f.innerHTML=r;break}}e._bindLightboxLabels(l),this.setLightboxSize(),this._init_lightbox_events(this),n.style.visibility="visible"}return this._lightbox},e._bindLightboxLabels=function(n){for(var r=0;r<n.length;r++){var a=n[r];if(a.id&&e._lightbox.querySelector(`#${a.id}`)){for(var i=e._lightbox.querySelector(`#${a.id}`).querySelector("label"),o=e._get_lightbox_section_node(a);o&&!o.querySelector;)o=o.nextSibling;var l=!0;if(o){var s=o.querySelector("input, select, textarea");s&&(a.inputId=s.id||"input_"+e.uid(),s.id||(s.id=a.inputId),i.setAttribute("for",a.inputId),l=!1)}l&&e.form_blocks[a.type].focus&&e.event(i,"click",function(d){return function(){var c=e.form_blocks[d.type],u=e._get_lightbox_section_node(d);c&&c.focus&&c.focus.call(e,u)}}(a))}}},e.attachEvent("onEventIdChange",function(n,r){this._lightbox_id==n&&(this._lightbox_id=r)}),e._lightbox_template=`<div class='dhx_cal_ltitle'><div class="dhx_cal_ltitle_descr"><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span>
</div>
<div class="dhx_cal_ltitle_controls">
<a class="dhx_cal_ltitle_close_btn scheduler_icon close"></a>
</div></div><div class='dhx_cal_larea'></div>`}function Z_(e){e._init_touch_events=function(){if((this.config.touch&&(navigator.userAgent.indexOf("Mobile")!=-1||navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("Android")!=-1||navigator.userAgent.indexOf("Touch")!=-1)&&!window.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&(this.xy.scroll_width=0,this._mobile=!0),this.config.touch){var t=!0;try{document.createEvent("TouchEvent")}catch{t=!1}t?this._touch_events(["touchmove","touchstart","touchend"],function(n){return n.touches&&n.touches.length>1?null:n.touches[0]?{target:n.target,pageX:n.touches[0].pageX,pageY:n.touches[0].pageY,clientX:n.touches[0].clientX,clientY:n.touches[0].clientY}:n},function(){return!1}):window.PointerEvent||window.navigator.pointerEnabled?this._touch_events(["pointermove","pointerdown","pointerup"],function(n){return n.pointerType=="mouse"?null:n},function(n){return!n||n.pointerType=="mouse"}):window.navigator.msPointerEnabled&&this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(n){return n.pointerType==n.MSPOINTER_TYPE_MOUSE?null:n},function(n){return!n||n.pointerType==n.MSPOINTER_TYPE_MOUSE})}},e._touch_events=function(t,n,r){var a,i,o,l,s,d,c=0;function u(v,g,h){e.event(v,g,function(p){return!!e._is_lightbox_open()||(r(p)?void 0:h(p))},{passive:!1})}function f(v){r(v)||(e._hide_global_tip(),l&&(e._on_mouse_up(n(v)),e._temp_touch_block=!1),e._drag_id=null,e._drag_mode=null,e._drag_pos=null,e._pointerDragId=null,clearTimeout(o),l=d=!1,s=!0)}u(document.body,t[0],function(v){if(!r(v)){var g=n(v);if(g){if(l)return function(h){if(!r(h)){var p=e.getState().drag_mode,y=!!e.matrix&&e.matrix[e._mode],x=e.render_view_data;p=="create"&&y&&(e.render_view_data=function(){for(var S=e.getState().drag_id,O=e.getEvent(S),I=y.y_property,N=e.getEvents(O.start_date,O.end_date),A=0;A<N.length;A++)N[A][I]!=O[I]&&(N.splice(A,1),A--);O._sorder=N.length-1,O._count=N.length,this.render_data([O],e.getState().mode)}),e._on_mouse_move(h),p=="create"&&y&&(e.render_view_data=x),h.preventDefault&&h.preventDefault(),h.cancelBubble=!0}}(g),v.preventDefault&&v.preventDefault(),v.cancelBubble=!0,e._update_global_tip(),!1;i=n(v),d&&(i?(a.target!=i.target||Math.abs(a.pageX-i.pageX)>5||Math.abs(a.pageY-i.pageY)>5)&&(s=!0,clearTimeout(o)):s=!0)}}}),u(this._els.dhx_cal_data[0],"touchcancel",f),u(this._els.dhx_cal_data[0],"contextmenu",function(v){if(!r(v))return d?(v&&v.preventDefault&&v.preventDefault(),v.cancelBubble=!0,!1):void 0}),u(this._obj,t[1],function(v){var g;if(document&&document.body&&document.body.classList.add("dhx_cal_touch_active"),!r(v))if(e._pointerDragId=v.pointerId,l=s=!1,d=!0,g=i=n(v)){var h=new Date;if(!s&&!l&&h-c<250)return e._click.dhx_cal_data(g),window.setTimeout(function(){e.$destroyed||e._on_dbl_click(g)},50),v.preventDefault&&v.preventDefault(),v.cancelBubble=!0,e._block_next_stop=!0,!1;if(c=h,!s&&!l&&e.config.touch_drag){var p=e._locate_event(document.activeElement),y=e._locate_event(g.target),x=a?e._locate_event(a.target):null;if(p&&y&&p==y&&p!=x)return v.preventDefault&&v.preventDefault(),v.cancelBubble=!0,e._ignore_next_click=!1,e._click.dhx_cal_data(g),a=g,!1;o=setTimeout(function(){if(!e.$destroyed){l=!0;var S=a.target,O=e._getClassName(S);S&&O.indexOf("dhx_body")!=-1&&(S=S.previousSibling),e._on_mouse_down(a,S),e._drag_mode&&e._drag_mode!="create"&&e.for_rendered(e._drag_id,function(I,N){I.style.display="none",e._rendered.splice(N,1)}),e.config.touch_tip&&e._show_global_tip(),e.updateEvent(e._drag_id)}},e.config.touch_drag),a=g}}else s=!0}),u(this._els.dhx_cal_data[0],t[2],function(v){if(document&&document.body&&document.body.classList.remove("dhx_cal_touch_active"),!r(v))return e.config.touch_swipe_dates&&!l&&function(g,h,p,y){if(!g||!h)return!1;for(var x=g.target;x&&x!=e._obj;)x=x.parentNode;if(x!=e._obj||e.matrix&&e.matrix[e.getState().mode]&&e.matrix[e.getState().mode].scrollable)return!1;var S=Math.abs(g.pageY-h.pageY),O=Math.abs(g.pageX-h.pageX);return S<y&&O>p&&(!S||O/S>3)&&(g.pageX>h.pageX?e._click.dhx_cal_next_button():e._click.dhx_cal_prev_button(),!0)}(a,i,200,100)&&(e._block_next_stop=!0),l&&(e._ignore_next_click=!0,setTimeout(function(){e._ignore_next_click=!1},100)),f(v),e._block_next_stop?(e._block_next_stop=!1,v.preventDefault&&v.preventDefault(),v.cancelBubble=!0,!1):void 0}),e.event(document.body,t[2],f)},e._show_global_tip=function(){e._hide_global_tip();var t=e._global_tip=document.createElement("div");t.className="dhx_global_tip",e._update_global_tip(1),document.body.appendChild(t)},e._update_global_tip=function(t){var n=e._global_tip;if(n){var r="";if(e._drag_id&&!t){var a=e.getEvent(e._drag_id);a&&(r="<div>"+(a._timed?e.templates.event_header(a.start_date,a.end_date,a):e.templates.day_date(a.start_date,a.end_date,a))+"</div>")}e._drag_mode=="create"||e._drag_mode=="new-size"?n.innerHTML=(e.locale.labels.drag_to_create||"Drag to create")+r:n.innerHTML=(e.locale.labels.drag_to_move||"Drag to move")+r}},e._hide_global_tip=function(){var t=e._global_tip;t&&t.parentNode&&(t.parentNode.removeChild(t),e._global_tip=0)}}function eu(e){var t,n;function r(){if(e._is_material_skin())return!0;if(n!==void 0)return n;var l=document.createElement("div");l.style.position="absolute",l.style.left="-9999px",l.style.top="-9999px",l.innerHTML="<div class='dhx_cal_container'><div class='dhx_cal_data'><div class='dhx_cal_event'><div class='dhx_body'></div></div><div>",document.body.appendChild(l);var s=window.getComputedStyle(l.querySelector(".dhx_body")).getPropertyValue("box-sizing");document.body.removeChild(l),(n=s==="border-box")||setTimeout(function(){n=void 0},1e3)}function a(){if(!e._is_material_skin()&&!e._border_box_events()){var l=n;n=void 0,t=void 0,l!==r()&&e.$container&&e.getState().mode&&e.setCurrentView()}}function i(l){var s=l.getMinutes();return s=s<10?"0"+s:s,"<span class='dhx_scale_h'>"+l.getHours()+"</span><span class='dhx_scale_m'>&nbsp;"+s+"</span>"}e._addThemeClass=function(){document.documentElement.setAttribute("data-scheduler-theme",e.skin)},e._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]},e._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]},e._is_material_skin=function(){return e.skin?(e.skin+"").indexOf("material")>-1:function(){if(t===void 0){var l=document.createElement("div");l.style.position="absolute",l.style.left="-9999px",l.style.top="-9999px",l.innerHTML="<div class='dhx_cal_container'><div class='dhx_cal_scale_placeholder'></div><div>",document.body.appendChild(l);var s=window.getComputedStyle(l.querySelector(".dhx_cal_scale_placeholder")).getPropertyValue("position");t=s==="absolute",setTimeout(function(){t=null,l&&l.parentNode&&l.parentNode.removeChild(l)},500)}return t}()},e._build_skin_info=function(){(function(){const v=e.$container;clearInterval(o),v&&(o=setInterval(()=>{const g=getComputedStyle(v).getPropertyValue("--dhx-scheduler-theme");g&&g!==e.skin&&e.setSkin(g)},100))})();const l=getComputedStyle(this.$container),s=l.getPropertyValue("--dhx-scheduler-theme");let d,c=!!s,u={},f=!1;if(c){d=s;for(let v in e.xy)u[v]=l.getPropertyValue(`--dhx-scheduler-xy-${v}`);u.hour_size_px=l.getPropertyValue("--dhx-scheduler-config-hour_size_px"),u.wide_form=l.getPropertyValue("--dhx-scheduler-config-form_wide")}else d=function(){for(var v=document.getElementsByTagName("link"),g=0;g<v.length;g++){var h=v[g].href.match("dhtmlxscheduler_([a-z]+).css");if(h)return h[1]}}(),f=e._is_material_skin();if(e._theme_info={theme:d,cssVarTheme:c,oldMaterialTheme:f,values:u},e._theme_info.cssVarTheme){const v=this._theme_info.values;for(let g in e.xy)isNaN(parseInt(v[g]))||(e.xy[g]=parseInt(v[g]))}},e.event(window,"DOMContentLoaded",a),e.event(window,"load",a),e._border_box_events=function(){return r()},e._configure=function(l,s,d){for(var c in s)l[c]===void 0&&(l[c]=s[c][d])},e.setSkin=function(l){this.skin=l,e._addThemeClass(),e.$container&&(this._skin_init(),this.render())};let o=null;e.attachEvent("onDestroy",function(){clearInterval(o)}),e._skin_init=function(){this._build_skin_info(),this.skin||(this.skin=this._theme_info.theme),e._addThemeClass(),e.skin==="flat"?e.templates.hour_scale=i:e.templates.hour_scale===i&&(e.templates.hour_scale=e.date.date_to_str(e.config.hour_date)),e.attachEvent("onTemplatesReady",function(){var l=e.date.date_to_str("%d");e.templates._old_month_day||(e.templates._old_month_day=e.templates.month_day);var s=e.templates._old_month_day;e.templates.month_day=function(d){if(this._mode=="month"){var c=l(d);return d.getDate()==1&&(c=e.locale.date.month_full[d.getMonth()]+" "+c),+d==+e.date.date_part(this._currentDate())&&(c=e.locale.labels.dhx_cal_today_button+" "+c),c}return s.call(this,d)},e.config.fix_tab_position&&(e._els.dhx_cal_navline[0].querySelectorAll("[data-tab]").forEach(d=>{switch(d.getAttribute("data-tab")||d.getAttribute("name")){case"day":case"day_tab":d.classList.add("dhx_cal_tab_first"),d.classList.add("dhx_cal_tab_segmented");break;case"week":case"week_tab":d.classList.add("dhx_cal_tab_segmented");break;case"month":case"month_tab":d.classList.add("dhx_cal_tab_last"),d.classList.add("dhx_cal_tab_segmented");break;default:d.classList.add("dhx_cal_tab_standalone")}}),function(d){if(e.config.header)return;const c=Array.from(d.querySelectorAll(".dhx_cal_tab")),u=["day","week","month"].map(v=>c.find(g=>g.getAttribute("data-tab")===v)).filter(v=>v!==void 0);let f=c.length>0?c[0]:null;u.reverse().forEach(v=>{d.insertBefore(v,f),f=v})}(e._els.dhx_cal_navline[0]))},{once:!0})}}function tu(e,t){this.$scheduler=e,this.$dp=t,this._dataProcessorHandlers=[],this.attach=function(){var n=this.$dp,r=this.$scheduler;this._dataProcessorHandlers.push(r.attachEvent("onEventAdded",function(a){!this._loading&&this._validId(a)&&n.setUpdated(a,!0,"inserted")})),this._dataProcessorHandlers.push(r.attachEvent("onConfirmedBeforeEventDelete",function(a){if(this._validId(a)){var i=n.getState(a);return i=="inserted"||this._new_event?(n.setUpdated(a,!1),!0):i!="deleted"&&(i=="true_deleted"||(n.setUpdated(a,!0,"deleted"),!1))}})),this._dataProcessorHandlers.push(r.attachEvent("onEventChanged",function(a){!this._loading&&this._validId(a)&&n.setUpdated(a,!0,"updated")})),this._dataProcessorHandlers.push(r.attachEvent("onClearAll",function(){n._in_progress={},n._invalid={},n.updatedRows=[],n._waitMode=0})),n.attachEvent("insertCallback",r._update_callback),n.attachEvent("updateCallback",r._update_callback),n.attachEvent("deleteCallback",function(a,i){r.getEvent(i)?(r.setUserData(i,this.action_param,"true_deleted"),r.deleteEvent(i)):r._add_rec_marker&&r._update_callback(a,i)})},this.detach=function(){for(var n in this._dataProcessorHandlers){var r=this._dataProcessorHandlers[n];this.$scheduler.detachEvent(r)}this._dataProcessorHandlers=[]}}function li(e){return this.serverProcessor=e,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this._headers=null,this._payload=null,this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),$i(this),this}function nu(e){var t="data-dhxbox",n=null;function r(y,x,S){var O=y.callback;O&&O(x,S),g.hide(y.box),n=y.box=null}function a(y){if(n){var x=y.which||y.keyCode,S=!1;if(h.keyboard){if(x==13||x==32){var O=y.target||y.srcElement;kt.getClassName(O).indexOf("scheduler_popup_button")>-1&&O.click?O.click():(r(n,!0),S=!0)}x==27&&(r(n,!1),S=!0)}return S?(y.preventDefault&&y.preventDefault(),!(y.cancelBubble=!0)):void 0}}function i(y){i.cover||(i.cover=document.createElement("div"),e.event(i.cover,"keydown",a),i.cover.className="dhx_modal_cover",document.body.appendChild(i.cover)),i.cover.style.display=y?"inline-block":"none"}function o(y,x,S){var O=e._waiAria.messageButtonAttrString(y),I=(x||"").toLowerCase().replace(/ /g,"_");return`<div ${O} class='scheduler_popup_button dhtmlx_popup_button ${`scheduler_${I}_button dhtmlx_${I}_button`}' data-result='${S}' result='${S}' ><div>${y}</div></div>`}function l(){for(var y=[].slice.apply(arguments,[0]),x=0;x<y.length;x++)if(y[x])return y[x]}function s(y,x,S){var O=y.tagName?y:function(A,m,b){var E=document.createElement("div"),k=tt.uid();e._waiAria.messageModalAttr(E,k),E.className=" scheduler_modal_box dhtmlx_modal_box scheduler-"+A.type+" dhtmlx-"+A.type,E.setAttribute(t,1);var D="";if(A.width&&(E.style.width=A.width),A.height&&(E.style.height=A.height),A.title&&(D+='<div class="scheduler_popup_title dhtmlx_popup_title">'+A.title+"</div>"),D+='<div class="scheduler_popup_text dhtmlx_popup_text" id="'+k+'"><span>'+(A.content?"":A.text)+'</span></div><div  class="scheduler_popup_controls dhtmlx_popup_controls">',m&&(D+=o(l(A.ok,e.locale.labels.message_ok,"OK"),"ok",!0)),b&&(D+=o(l(A.cancel,e.locale.labels.message_cancel,"Cancel"),"cancel",!1)),A.buttons)for(var C=0;C<A.buttons.length;C++){var R=A.buttons[C];D+=typeof R=="object"?o(R.label,R.css||"scheduler_"+R.label.toLowerCase()+"_button dhtmlx_"+R.label.toLowerCase()+"_button",R.value||C):o(R,R,C)}if(D+="</div>",E.innerHTML=D,A.content){var P=A.content;typeof P=="string"&&(P=document.getElementById(P)),P.style.display=="none"&&(P.style.display=""),E.childNodes[A.title?1:0].appendChild(P)}return e.event(E,"click",function(U){var q=U.target||U.srcElement;if(q.className||(q=q.parentNode),kt.closest(q,".scheduler_popup_button")){var $=q.getAttribute("data-result");r(A,$=$=="true"||$!="false"&&$,U)}}),A.box=E,(m||b)&&(n=A),E}(y,x,S);y.hidden||i(!0),document.body.appendChild(O);var I=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-O.offsetWidth)/2)),N=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-O.offsetHeight)/2));return y.position=="top"?O.style.top="-3px":O.style.top=N+"px",O.style.left=I+"px",e.event(O,"keydown",a),g.focus(O),y.hidden&&g.hide(O),e.callEvent("onMessagePopup",[O]),O}function d(y){return s(y,!0,!1)}function c(y){return s(y,!0,!0)}function u(y){return s(y)}function f(y,x,S){return typeof y!="object"&&(typeof x=="function"&&(S=x,x=""),y={text:y,type:x,callback:S}),y}function v(y,x,S,O,I){return typeof y!="object"&&(y={text:y,type:x,expire:S,id:O,callback:I}),y.id=y.id||tt.uid(),y.expire=y.expire||h.expire,y}e.event(document,"keydown",a,!0);var g=function(){var y=f.apply(this,arguments);return y.type=y.type||"alert",u(y)};g.hide=function(y){for(;y&&y.getAttribute&&!y.getAttribute(t);)y=y.parentNode;y&&(y.parentNode.removeChild(y),i(!1),e.callEvent("onAfterMessagePopup",[y]))},g.focus=function(y){setTimeout(function(){var x=kt.getFocusableNodes(y);x.length&&x[0].focus&&x[0].focus()},1)};var h=function(y,x,S,O){switch((y=v.apply(this,arguments)).type=y.type||"info",y.type.split("-")[0]){case"alert":return d(y);case"confirm":return c(y);case"modalbox":return u(y);default:return function(I){h.area||(h.area=document.createElement("div"),h.area.className="scheduler_message_area dhtmlx_message_area",h.area.style[h.position]="5px",document.body.appendChild(h.area)),h.hide(I.id);var N=document.createElement("div");return N.innerHTML="<div>"+I.text+"</div>",N.className="scheduler-info dhtmlx-info scheduler-"+I.type+" dhtmlx-"+I.type,e.event(N,"click",function(A){I.callback&&I.callback.call(this,A),h.hide(I.id),I=null}),e._waiAria.messageInfoAttr(N),h.position=="bottom"&&h.area.firstChild?h.area.insertBefore(N,h.area.firstChild):h.area.appendChild(N),I.expire>0&&(h.timers[I.id]=window.setTimeout(function(){h&&h.hide(I.id)},I.expire)),h.pull[I.id]=N,N=null,I.id}(y)}};h.seed=new Date().valueOf(),h.uid=tt.uid,h.expire=4e3,h.keyboard=!0,h.position="top",h.pull={},h.timers={},h.hideAll=function(){for(var y in h.pull)h.hide(y)},h.hide=function(y){var x=h.pull[y];x&&x.parentNode&&(window.setTimeout(function(){x.parentNode.removeChild(x),x=null},2e3),x.className+=" hidden",h.timers[y]&&window.clearTimeout(h.timers[y]),delete h.pull[y])};var p=[];return e.attachEvent("onMessagePopup",function(y){p.push(y)}),e.attachEvent("onAfterMessagePopup",function(y){for(var x=0;x<p.length;x++)p[x]===y&&(p.splice(x,1),x--)}),e.attachEvent("onDestroy",function(){i.cover&&i.cover.parentNode&&i.cover.parentNode.removeChild(i.cover);for(var y=0;y<p.length;y++)p[y].parentNode&&p[y].parentNode.removeChild(p[y]);p=null,h.area&&h.area.parentNode&&h.area.parentNode.removeChild(h.area),h=null}),{alert:function(){var y=f.apply(this,arguments);return y.type=y.type||"confirm",d(y)},confirm:function(){var y=f.apply(this,arguments);return y.type=y.type||"alert",c(y)},message:h,modalbox:g}}li.prototype={setTransactionMode:function(e,t){typeof e=="object"?(this._tMode=e.mode||this._tMode,e.headers!==void 0&&(this._headers=e.headers),e.payload!==void 0&&(this._payload=e.payload),this._tSend=!!t):(this._tMode=e,this._tSend=t),this._tMode=="REST"&&(this._tSend=!1,this._endnm=!0),this._tMode==="JSON"||this._tMode==="REST-JSON"?(this._tSend=!1,this._endnm=!0,this._serializeAsJson=!0,this._headers=this._headers||{},this._headers["Content-Type"]="application/json"):this._headers&&!this._headers["Content-Type"]&&(this._headers["Content-Type"]="application/x-www-form-urlencoded"),this._tMode==="CUSTOM"&&(this._tSend=!1,this._endnm=!0,this._router=e.router)},escape:function(e){return this._utf?encodeURIComponent(e):escape(e)},enableUTFencoding:function(e){this._utf=!!e},setDataColumns:function(e){this._columns=typeof e=="string"?e.split(","):e},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(e){this._endnm=!!e},enablePartialDataSend:function(e){this._changed=!!e},setUpdateMode:function(e,t){this.autoUpdate=e=="cell",this.updateMode=e,this.dnd=t},ignore:function(e,t){this._silent_mode=!0,e.call(t||window),this._silent_mode=!1},setUpdated:function(e,t,n){if(!this._silent_mode){var r=this.findRow(e);n=n||"updated";var a=this.$scheduler.getUserData(e,this.action_param);a&&n=="updated"&&(n=a),t?(this.set_invalid(e,!1),this.updatedRows[r]=e,this.$scheduler.setUserData(e,this.action_param,n),this._in_progress[e]&&(this._in_progress[e]="wait")):this.is_invalid(e)||(this.updatedRows.splice(r,1),this.$scheduler.setUserData(e,this.action_param,"")),this.markRow(e,t,n),t&&this.autoUpdate&&this.sendData(e)}},markRow:function(e,t,n){var r="",a=this.is_invalid(e);if(a&&(r=this.styles[a],t=!0),this.callEvent("onRowMark",[e,t,n,a])&&(r=this.styles[t?n:"clear"]+r,this.$scheduler[this._methods[0]](e,r),a&&a.details)){r+=this.styles[a+"_cell"];for(var i=0;i<a.details.length;i++)a.details[i]&&this.$scheduler[this._methods[1]](e,i,r)}},getActionByState:function(e){return e==="inserted"?"create":e==="updated"?"update":e==="deleted"?"delete":"update"},getState:function(e){return this.$scheduler.getUserData(e,this.action_param)},is_invalid:function(e){return this._invalid[e]},set_invalid:function(e,t,n){n&&(t={value:t,details:n,toString:function(){return this.value.toString()}}),this._invalid[e]=t},checkBeforeUpdate:function(e){return!0},sendData:function(e){return this.$scheduler.editStop&&this.$scheduler.editStop(),e===void 0||this._tSend?this.sendAllData():!this._in_progress[e]&&(this.messages=[],!(!this.checkBeforeUpdate(e)&&this.callEvent("onValidationError",[e,this.messages]))&&void this._beforeSendData(this._getRowData(e),e))},_beforeSendData:function(e,t){if(!this.callEvent("onBeforeUpdate",[t,this.getState(t),e]))return!1;this._sendData(e,t)},serialize:function(e,t){if(this._serializeAsJson)return this._serializeAsJSON(e);if(typeof e=="string")return e;if(t!==void 0)return this.serialize_one(e,"");var n=[],r=[];for(var a in e)e.hasOwnProperty(a)&&(n.push(this.serialize_one(e[a],a+this.post_delim)),r.push(a));return n.push("ids="+this.escape(r.join(","))),this.$scheduler.security_key&&n.push("dhx_security="+this.$scheduler.security_key),n.join("&")},serialize_one:function(e,t){if(typeof e=="string")return e;var n=[],r="";for(var a in e)if(e.hasOwnProperty(a)){if((a=="id"||a==this.action_param)&&this._tMode=="REST")continue;r=typeof e[a]=="string"||typeof e[a]=="number"?e[a]:JSON.stringify(e[a]),n.push(this.escape((t||"")+a)+"="+this.escape(r))}return n.join("&")},_applyPayload:function(e){var t=this.$scheduler.ajax;if(this._payload)for(var n in this._payload)e=e+t.urlSeparator(e)+this.escape(n)+"="+this.escape(this._payload[n]);return e},_sendData:function(e,t){if(e){if(!this.callEvent("onBeforeDataSending",t?[t,this.getState(t),e]:[null,null,e]))return!1;t&&(this._in_progress[t]=new Date().valueOf());var n=this,r=this.$scheduler.ajax;if(this._tMode!=="CUSTOM"){var a,i={callback:function(g){var h=[];if(t)h.push(t);else if(e)for(var p in e)h.push(p);return n.afterUpdate(n,g,h)},headers:n._headers},o=this.serverProcessor+(this._user?r.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.$scheduler.getUserData(0,"version")].join("&"):""),l=this._applyPayload(o);switch(this._tMode){case"GET":a=this._cleanupArgumentsBeforeSend(e),i.url=l+r.urlSeparator(l)+this.serialize(a,t),i.method="GET";break;case"POST":a=this._cleanupArgumentsBeforeSend(e),i.url=l,i.method="POST",i.data=this.serialize(a,t);break;case"JSON":a={};var s=this._cleanupItemBeforeSend(e);for(var d in s)d!==this.action_param&&d!=="id"&&d!=="gr_id"&&(a[d]=s[d]);i.url=l,i.method="POST",i.data=JSON.stringify({id:t,action:e[this.action_param],data:a});break;case"REST":case"REST-JSON":switch(l=o.replace(/(&|\?)editing=true/,""),a="",this.getState(t)){case"inserted":i.method="POST",i.data=this.serialize(e,t);break;case"deleted":i.method="DELETE",l=l+(l.slice(-1)==="/"?"":"/")+t;break;default:i.method="PUT",i.data=this.serialize(e,t),l=l+(l.slice(-1)==="/"?"":"/")+t}i.url=this._applyPayload(l)}return this._waitMode++,r.query(i)}{var c=this.getState(t),u=this.getActionByState(c),f=function(h){var p=c;if(h&&h.responseText&&h.setRequestHeader){h.status!==200&&(p="error");try{h=JSON.parse(h.responseText)}catch{}}p=p||"updated";var y=t,x=t;h&&(p=h.action||p,y=h.sid||y,x=h.id||h.tid||x),n.afterUpdateCallback(y,x,p,h)};const g="event";var v;if(this._router instanceof Function)v=this._router(g,u,e,t);else switch(c){case"inserted":v=this._router[g].create(e);break;case"deleted":v=this._router[g].delete(t);break;default:v=this._router[g].update(e,t)}if(v){if(!v.then&&v.id===void 0&&v.tid===void 0&&v.action===void 0)throw new Error("Incorrect router return value. A Promise or a response object is expected");v.then?v.then(f).catch(function(h){h&&h.action?f(h):f({action:"error",value:h})}):f(v)}else f(null)}}},sendAllData:function(){if(this.updatedRows.length&&this.updateMode!=="off"){this.messages=[];var e=!0;if(this._forEachUpdatedRow(function(t){e=e&&this.checkBeforeUpdate(t)}),!e&&!this.callEvent("onValidationError",["",this.messages]))return!1;this._tSend?this._sendData(this._getAllData()):this._forEachUpdatedRow(function(t){if(!this._in_progress[t]){if(this.is_invalid(t))return;this._beforeSendData(this._getRowData(t),t)}})}},_getAllData:function(e){var t={},n=!1;return this._forEachUpdatedRow(function(r){if(!this._in_progress[r]&&!this.is_invalid(r)){var a=this._getRowData(r);this.callEvent("onBeforeUpdate",[r,this.getState(r),a])&&(t[r]=a,n=!0,this._in_progress[r]=new Date().valueOf())}}),n?t:null},findRow:function(e){var t=0;for(t=0;t<this.updatedRows.length&&e!=this.updatedRows[t];t++);return t},defineAction:function(e,t){this._uActions||(this._uActions={}),this._uActions[e]=t},afterUpdateCallback:function(e,t,n,r){if(this.$scheduler){var a=e,i=n!=="error"&&n!=="invalid";if(i||this.set_invalid(e,n),this._uActions&&this._uActions[n]&&!this._uActions[n](r))return delete this._in_progress[a];this._in_progress[a]!=="wait"&&this.setUpdated(e,!1);var o=e;switch(n){case"inserted":case"insert":t!=e&&(this.setUpdated(e,!1),this.$scheduler[this._methods[2]](e,t),e=t);break;case"delete":case"deleted":return this.$scheduler.setUserData(e,this.action_param,"true_deleted"),this.$scheduler[this._methods[3]](e,t),delete this._in_progress[a],this.callEvent("onAfterUpdate",[e,n,t,r])}this._in_progress[a]!=="wait"?(i&&this.$scheduler.setUserData(e,this.action_param,""),delete this._in_progress[a]):(delete this._in_progress[a],this.setUpdated(t,!0,this.$scheduler.getUserData(e,this.action_param))),this.callEvent("onAfterUpdate",[o,n,t,r])}},_errorResponse:function(e,t){return this.$scheduler&&this.$scheduler.callEvent&&this.$scheduler.callEvent("onSaveError",[t,e.xmlDoc]),this.cleanUpdate(t)},_setDefaultTransactionMode:function(){this.serverProcessor&&(this.setTransactionMode("POST",!0),this.serverProcessor+=(this.serverProcessor.indexOf("?")!==-1?"&":"?")+"editing=true",this._serverProcessor=this.serverProcessor)},afterUpdate:function(e,t,n){var r=this.$scheduler.ajax;if(t.xmlDoc.status===200){var a;try{a=JSON.parse(t.xmlDoc.responseText)}catch{t.xmlDoc.responseText.length||(a={})}if(a){var i=a.action||this.getState(n)||"updated",o=a.sid||n[0],l=a.tid||n[0];return e.afterUpdateCallback(o,l,i,a),void e.finalizeUpdate()}var s=r.xmltop("data",t.xmlDoc);if(!s)return this._errorResponse(t,n);var d=r.xpath("//data/action",s);if(!d.length)return this._errorResponse(t,n);for(var c=0;c<d.length;c++){var u=d[c];i=u.getAttribute("type"),o=u.getAttribute("sid"),l=u.getAttribute("tid"),e.afterUpdateCallback(o,l,i,u)}e.finalizeUpdate()}else this._errorResponse(t,n)},cleanUpdate:function(e){if(e)for(var t=0;t<e.length;t++)delete this._in_progress[e[t]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--,this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(e){if(!this._initialized){this.$scheduler=e,this.$scheduler._dp_init&&this.$scheduler._dp_init(this),this._setDefaultTransactionMode(),this._methods=this._methods||["_set_event_text_style","","_dp_change_event_id","_dp_hook_delete"],function(n,r){n._validId=function(a){return!this._is_virtual_event||!this._is_virtual_event(a)},n.setUserData=function(a,i,o){if(a){var l=this.getEvent(a);l&&(l[i]=o)}else this._userdata[i]=o},n.getUserData=function(a,i){if(a){var o=this.getEvent(a);return o?o[i]:null}return this._userdata[i]},n._set_event_text_style=function(a,i){if(n.getEvent(a)){this.for_rendered(a,function(l){l.style.cssText+=";"+i});var o=this.getEvent(a);o._text_style=i,this.event_updated(o)}},n._update_callback=function(a,i){var o=n._xmlNodeToJSON(a.firstChild);o.rec_type=="none"&&(o.rec_pattern="none"),o.text=o.text||o._tagvalue,o.start_date=n._helpers.parseDate(o.start_date),o.end_date=n._helpers.parseDate(o.end_date),n.addEvent(o),n._add_rec_marker&&n.setCurrentView()},n._dp_change_event_id=function(a,i){n.getEvent(a)&&n.changeEventId(a,i)},n._dp_hook_delete=function(a,i){if(n.getEvent(a))return i&&a!=i&&(this.getUserData(a,r.action_param)=="true_deleted"&&this.setUserData(a,r.action_param,"updated"),this.changeEventId(a,i)),this.deleteEvent(i,!0)},n.setDp=function(){this._dp=r},n.setDp()}(this.$scheduler,this);var t=new tu(this.$scheduler,this);t.attach(),this.attachEvent("onDestroy",function(){delete this._getRowData,delete this.$scheduler._dp,delete this.$scheduler._dataprocessor,delete this.$scheduler._set_event_text_style,delete this.$scheduler._dp_change_event_id,delete this.$scheduler._dp_hook_delete,delete this.$scheduler,t.detach()}),this.$scheduler.callEvent("onDataProcessorReady",[this]),this._initialized=!0,e._dataprocessor=this}},setOnAfterUpdate:function(e){this.attachEvent("onAfterUpdate",e)},setOnBeforeUpdateHandler:function(e){this.attachEvent("onBeforeDataSending",e)},setAutoUpdate:function(e,t){e=e||2e3,this._user=t||new Date().valueOf(),this._need_update=!1,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(a,i,o,l){this.afterAutoUpdate(a,i,o,l)}),this.attachEvent("onFullSync",function(){this.fullSync()});var n=this;let r=ft.setInterval(function(){n.loadUpdate()},e);this.attachEvent("onDestroy",function(){clearInterval(r)})},afterAutoUpdate:function(e,t,n,r){return t!="collision"||(this._need_update=!0,!1)},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(e,t){var n=this.$scheduler.ajax;if(this._update_busy)return!1;this._update_busy=!0,n.get(e,t)},_getXmlNodeValue:function(e){return e.firstChild?e.firstChild.nodeValue:""},loadUpdate:function(){var e=this,t=this.$scheduler.ajax,n=this.$scheduler.getUserData(0,"version"),r=this.serverProcessor+t.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+n].join("&");r=r.replace("editing=true&",""),this.getUpdates(r,function(a){var i=t.xpath("//userdata",a);e.$scheduler.setUserData(0,"version",e._getXmlNodeValue(i[0]));var o=t.xpath("//update",a);if(o.length){e._silent_mode=!0;for(var l=0;l<o.length;l++){var s=o[l].getAttribute("status"),d=o[l].getAttribute("id"),c=o[l].getAttribute("parent");switch(s){case"inserted":this.callEvent("insertCallback",[o[l],d,c]);break;case"updated":this.callEvent("updateCallback",[o[l],d,c]);break;case"deleted":this.callEvent("deleteCallback",[o[l],d,c])}}e._silent_mode=!1}e._update_busy=!1,e=null})},destructor:function(){this.callEvent("onDestroy",[]),this.detachAllEvents(),this.updatedRows=[],this._in_progress={},this._invalid={},this._headers=null,this._payload=null,delete this._initialized},url:function(e){this.serverProcessor=this._serverProcessor=e},_serializeAsJSON:function(e){if(typeof e=="string")return e;var t=this.$scheduler.utils.copy(e);return this._tMode==="REST-JSON"&&(delete t.id,delete t[this.action_param]),JSON.stringify(t)},_cleanupArgumentsBeforeSend:function(e){var t;if(e[this.action_param]===void 0)for(var n in t={},e)t[n]=this._cleanupArgumentsBeforeSend(e[n]);else t=this._cleanupItemBeforeSend(e);return t},_cleanupItemBeforeSend:function(e){var t=null;return e&&(e[this.action_param]==="deleted"?((t={}).id=e.id,t[this.action_param]=e[this.action_param]):t=e),t},_forEachUpdatedRow:function(e){for(var t=this.updatedRows.slice(),n=0;n<t.length;n++){var r=t[n];this.$scheduler.getUserData(r,this.action_param)&&e.call(this,r)}},_prepareItemForJson(e){const t={},n=this.$scheduler,r=n.utils.copy(e);for(let a in r){let i=r[a];a.indexOf("_")!==0&&(i?i.getUTCFullYear?t[a]=n._helpers.formatDate(i):t[a]=typeof i=="object"?this._prepareItemForJson(i):i:i!==void 0&&(t[a]=i))}return t[this.action_param]=n.getUserData(e.id,this.action_param),t},_prepareItemForForm(e){const t={},n=this.$scheduler,r=n.utils.copy(e);for(var a in r){let i=r[a];a.indexOf("_")!==0&&(i?i.getUTCFullYear?t[a]=n._helpers.formatDate(i):t[a]=typeof i=="object"?this._prepareItemForForm(i):i:t[a]="")}return t[this.action_param]=n.getUserData(e.id,this.action_param),t},_prepareDataItem:function(e){return this._serializeAsJson?this._prepareItemForJson(e):this._prepareItemForForm(e)},_getRowData:function(e){var t=this.$scheduler.getEvent(e);return t||(t={id:e}),this._prepareDataItem(t)}};const ru={date:{month_full:[" ","","","","","","","",""," "," "," "],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"  ,   ",confirm_deleting:"       ",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"       ",section_recurring:" ",button_recurring:"",button_recurring_open:"",button_edit_series:" ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"  ",repeat_week:"  ",repeat_text_week_count:"   :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:" ",repeat_text_month_count:"",repeat_text_month_count2_before:"",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end2:"",repeat_radio_end3:" ",repeat_never:"",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},au={date:{month_full:["","","","","Ma","","","","","","",""],month_short:["","","","","Ma","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"   , ?",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"      ?",section_recurring:"",button_recurring:"",button_recurring_open:"",button_edit_series:" ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"ic",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"  ",repeat_week:"  ",repeat_text_week_count:"",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:"  ",repeat_text_month_count:"",repeat_text_month_count2_before:" ",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end2:"",repeat_radio_end3:" ",repeat_never:"",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","e","","","","",""],day_for_recurring:["","","","","","",""]}},iu={date:{month_full:["Gener","Febrer","Mar","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],month_short:["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],day_full:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"],day_short:["Dg","Dl","Dm","Dc","Dj","Dv","Ds"]},labels:{dhx_cal_today_button:"Hui",day_tab:"Dia",week_tab:"Setmana",month_tab:"Mes",new_event:"Nou esdeveniment",icon_save:"Guardar",icon_cancel:"Cancellar",icon_details:"Detalls",icon_edit:"Editar",icon_delete:"Esborrar",confirm_closing:"",confirm_deleting:"L'esdeveniment s'esborrar definitivament, continuar ?",section_description:"Descripci",section_time:"Periode de temps",full_day:"Tot el dia",confirm_recurring:"Desitja modificar el conjunt d'esdeveniments repetits?",section_recurring:"Repeteixca l'esdeveniment",button_recurring:"Impedit",button_recurring_open:"Perms",button_edit_series:"Edit srie",button_edit_occurrence:"Edita Instncia",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Data",description:"Descripci",year_tab:"Any",week_agenda_tab:"Agenda",grid_tab:"Taula",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Diari",repeat_radio_week:"Setmanal",repeat_radio_month:"Mensual",repeat_radio_year:"Anual",repeat_radio_day_type:"Cada",repeat_text_day_count:"dia",repeat_radio_day_type2:"Cada dia laborable",repeat_week:" Repetir cada",repeat_text_week_count:"setmana els dies segents:",repeat_radio_month_type:"Repetir",repeat_radio_month_start:"El",repeat_text_month_day:"dia cada",repeat_text_month_count:"mes",repeat_text_month_count2_before:"cada",repeat_text_month_count2_after:"mes",repeat_year_label:"El",select_year_day2:"de",repeat_text_year_day:"dia",select_year_month:"mes",repeat_radio_end:"Sense data de finalitzaci",repeat_text_occurrences_count:"ocurrncies",repeat_radio_end2:"Desprs",repeat_radio_end3:"Finalitzar el",repeat_never:"Mai",repeat_daily:"Cada dia",repeat_workdays:"Cada dia laborable",repeat_weekly:"Cada setmana",repeat_monthly:"Cada mes",repeat_yearly:"Cada any",repeat_custom:"Personalitzat",repeat_freq_day:"Dia",repeat_freq_week:"Setmana",repeat_freq_month:"Mes",repeat_freq_year:"Any",repeat_on_date:"En la data",repeat_ends:"Finalitza",month_for_recurring:["Gener","Febrer","Mar","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],day_for_recurring:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"]}},ou={date:{month_full:["","","","","","","","","","","",""],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:"",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"!",confirm_deleting:"?",section_description:"",section_time:"",full_day:"",confirm_recurring:"?",section_recurring:"",button_recurring:"",button_recurring_open:"",button_edit_series:"",button_edit_occurrence:"",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"",repeat_week:"  ",repeat_text_week_count:":",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:" ",repeat_text_month_count:"",repeat_text_month_count2_before:"",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"",repeat_text_occurrences_count:"",repeat_radio_end2:"",repeat_radio_end3:"",repeat_never:"",repeat_daily:"",repeat_workdays:"",repeat_weekly:"",repeat_monthly:"",repeat_yearly:"",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:"",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},su={date:{month_full:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],month_short:["Led","n","Be","Dub","Kv","er","ec","Srp","Z","j","List","Pro"],day_full:["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota"],day_short:["Ne","Po","t","St","t","P","So"]},labels:{dhx_cal_today_button:"Dnes",day_tab:"Den",week_tab:"Tden",month_tab:"Msc",new_event:"Nov udlost",icon_save:"Uloit",icon_cancel:"Zpt",icon_details:"Detail",icon_edit:"Edituj",icon_delete:"Smazat",confirm_closing:"",confirm_deleting:"Udlost bude trvale smazna, opravdu?",section_description:"Poznmky",section_time:"Doba platnosti",confirm_recurring:"Pejete si upravit celou adu opakovanch udlost?",section_recurring:"Opakovn udlosti",button_recurring:"Vypnuto",button_recurring_open:"Zapnuto",button_edit_series:"Edit series",button_edit_occurrence:"Upravit instance",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Program",date:"Datum",description:"Poznmka",year_tab:"Rok",full_day:"Full day",week_agenda_tab:"Program",grid_tab:"Mka",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Denn",repeat_radio_week:"Tdn",repeat_radio_month:"Msn",repeat_radio_year:"Ron",repeat_radio_day_type:"kad",repeat_text_day_count:"Den",repeat_radio_day_type2:"pracovn dny",repeat_week:"Opakuje kadch",repeat_text_week_count:"Tdn na:",repeat_radio_month_type:"u kadho",repeat_radio_month_start:"na",repeat_text_month_day:"Den kadho",repeat_text_month_count:"Msc",repeat_text_month_count2_before:"kad",repeat_text_month_count2_after:"Msc",repeat_year_label:"na",select_year_day2:"v",repeat_text_year_day:"Den v",select_year_month:"",repeat_radio_end:"bez data ukonen",repeat_text_occurrences_count:"Udlosti",repeat_radio_end2:"po",repeat_radio_end3:"Konec",repeat_never:"Nikdy",repeat_daily:"Kad den",repeat_workdays:"Kad pracovn den",repeat_weekly:"Kad tden",repeat_monthly:"Kad msc",repeat_yearly:"Kad rok",repeat_custom:"Vlastn",repeat_freq_day:"Den",repeat_freq_week:"Tden",repeat_freq_month:"Msc",repeat_freq_year:"Rok",repeat_on_date:"Na datum",repeat_ends:"Kon",month_for_recurring:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],day_for_recurring:["Nedle ","Pondl","ter","Steda","tvrtek","Ptek","Sobota"]}},lu={date:{month_full:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Man","Tir","Ons","Tor","Fre","Lr"]},labels:{dhx_cal_today_button:"Idag",day_tab:"Dag",week_tab:"Uge",month_tab:"Mned",new_event:"Ny begivenhed",icon_save:"Gem",icon_cancel:"Fortryd",icon_details:"Detaljer",icon_edit:"Tilret",icon_delete:"Slet",confirm_closing:"Dine rettelser vil g tabt.. Er dy sikker?",confirm_deleting:"Bigivenheden vil blive slettet permanent. Er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",confirm_recurring:"Vil du tilrette hele serien af gentagne begivenheder?",section_recurring:"Gentag begivenhed",button_recurring:"Frakoblet",button_recurring_open:"Tilkoblet",button_edit_series:"Rediger serien",button_edit_occurrence:"Rediger en kopi",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Dagsorden",date:"Dato",description:"Beskrivelse",year_tab:"r",week_agenda_tab:"Dagsorden",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daglig",repeat_radio_week:"Ugenlig",repeat_radio_month:"Mnedlig",repeat_radio_year:"rlig",repeat_radio_day_type:"Hver",repeat_text_day_count:"dag",repeat_radio_day_type2:"P hver arbejdsdag",repeat_week:" Gentager sig hver",repeat_text_week_count:"uge p flgende dage:",repeat_radio_month_type:"Hver den",repeat_radio_month_start:"Den",repeat_text_month_day:" i hver",repeat_text_month_count:"mned",repeat_text_month_count2_before:"hver",repeat_text_month_count2_after:"mned",repeat_year_label:"Den",select_year_day2:"i",repeat_text_year_day:"dag i",select_year_month:"",repeat_radio_end:"Ingen slutdato",repeat_text_occurrences_count:"gentagelse",repeat_radio_end2:"Efter",repeat_radio_end3:"Slut",repeat_never:"Aldrig",repeat_daily:"Hver dag",repeat_workdays:"Hver hverdag",repeat_weekly:"Hver uge",repeat_monthly:"Hver mned",repeat_yearly:"Hvert r",repeat_custom:"Brugerdefineret",repeat_freq_day:"Dag",repeat_freq_week:"Uge",repeat_freq_month:"Mned",repeat_freq_year:"r",repeat_on_date:"P dato",repeat_ends:"Slutter",month_for_recurring:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],day_for_recurring:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"]}},du={date:{month_full:[" Januar"," Februar"," Mrz "," April"," Mai"," Juni"," Juli"," August"," September "," Oktober"," November "," Dezember"],month_short:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],day_full:["Sonntag","Montag","Dienstag"," Mittwoch"," Donnerstag","Freitag","Samstag"],day_short:["So","Mo","Di","Mi","Do","Fr","Sa"]},labels:{dhx_cal_today_button:"Heute",day_tab:"Tag",week_tab:"Woche",month_tab:"Monat",new_event:"neuer Eintrag",icon_save:"Speichern",icon_cancel:"Abbrechen",icon_details:"Details",icon_edit:"ndern",icon_delete:"Lschen",confirm_closing:"",confirm_deleting:"Der Eintrag wird gelscht",section_description:"Beschreibung",section_time:"Zeitspanne",full_day:"Ganzer Tag",confirm_recurring:"Wollen Sie alle Eintrge bearbeiten oder nur diesen einzelnen Eintrag?",section_recurring:"Wiederholung",button_recurring:"Aus",button_recurring_open:"An",button_edit_series:"Bearbeiten Sie die Serie",button_edit_occurrence:"Bearbeiten Sie eine Kopie",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Datum",description:"Beschreibung",year_tab:"Jahre",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Tglich",repeat_radio_week:"Wchentlich",repeat_radio_month:"Monatlich",repeat_radio_year:"Jhrlich",repeat_radio_day_type:"jeden",repeat_text_day_count:"Tag",repeat_radio_day_type2:"an jedem Arbeitstag",repeat_week:" Wiederholt sich jede",repeat_text_week_count:"Woche am:",repeat_radio_month_type:"an jedem",repeat_radio_month_start:"am",repeat_text_month_day:"Tag eines jeden",repeat_text_month_count:"Monats",repeat_text_month_count2_before:"jeden",repeat_text_month_count2_after:"Monats",repeat_year_label:"am",select_year_day2:"im",repeat_text_year_day:"Tag im",select_year_month:"",repeat_radio_end:"kein Enddatum",repeat_text_occurrences_count:"Ereignissen",repeat_radio_end3:"Schlu",repeat_radio_end2:"nach",repeat_never:"Nie",repeat_daily:"Jeden Tag",repeat_workdays:"Jeden Werktag",repeat_weekly:"Jede Woche",repeat_monthly:"Jeden Monat",repeat_yearly:"Jedes Jahr",repeat_custom:"Benutzerdefiniert",repeat_freq_day:"Tag",repeat_freq_week:"Woche",repeat_freq_month:"Monat",repeat_freq_year:"Jahr",repeat_on_date:"Am Datum",repeat_ends:"Endet",month_for_recurring:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],day_for_recurring:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]}},cu={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"    .   ;",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"        ;",section_recurring:" ",button_recurring:"",button_recurring_open:"",button_edit_series:"  ",button_edit_occurrence:"  ",button_edit_occurrence_and_following:"This and following events",agenda_tab:" ",date:"",description:"",year_tab:"",week_agenda_tab:" ",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:" ",repeat_week:"  ",repeat_text_week_count:"   :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:" ",repeat_text_month_count:"",repeat_text_month_count2_before:"",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end3:" ",repeat_radio_end2:" ",repeat_never:"",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},_u={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Edit recurring event",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"All events",button_edit_occurrence:"This event",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Date",description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daily",repeat_radio_week:"Weekly",repeat_radio_month:"Monthly",repeat_radio_year:"Yearly",repeat_radio_day_type:"Every",repeat_text_day_count:"day",repeat_radio_day_type2:"Every workday",repeat_week:" Repeat every",repeat_text_week_count:"week next days:",repeat_radio_month_type:"Repeat",repeat_radio_month_start:"On",repeat_text_month_day:"day every",repeat_text_month_count:"month",repeat_text_month_count2_before:"every",repeat_text_month_count2_after:"month",repeat_year_label:"On",select_year_day2:"of",repeat_text_year_day:"day",select_year_month:"month",repeat_radio_end:"No end date",repeat_text_occurrences_count:"occurrences",repeat_radio_end2:"After",repeat_radio_end3:"End by",repeat_never:"Never",repeat_daily:"Every day",repeat_workdays:"Every weekday",repeat_weekly:"Every week",repeat_monthly:"Every month",repeat_yearly:"Every year",repeat_custom:"Custom",repeat_freq_day:"Day",repeat_freq_week:"Week",repeat_freq_month:"Month",repeat_freq_year:"Year",repeat_on_date:"On date",repeat_ends:"Ends",month_for_recurring:["January","February","March","April","May","June","July","August","September","October","November","December"],day_for_recurring:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},uu={date:{month_full:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],month_short:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],day_full:["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"],day_short:["Dom","Lun","Mar","Mi","Jue","Vie","Sb"]},labels:{dhx_cal_today_button:"Hoy",day_tab:"Da",week_tab:"Semana",month_tab:"Mes",new_event:"Nuevo evento",icon_save:"Guardar",icon_cancel:"Cancelar",icon_details:"Detalles",icon_edit:"Editar",icon_delete:"Eliminar",confirm_closing:"",confirm_deleting:"El evento se borrar definitivamente, continuar?",section_description:"Descripcin",section_time:"Perodo",full_day:"Todo el da",confirm_recurring:"Desea modificar el conjunto de eventos repetidos?",section_recurring:"Repita el evento",button_recurring:"Impedido",button_recurring_open:"Permitido",button_edit_series:"Editar la serie",button_edit_occurrence:"Editar este evento",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Da",date:"Fecha",description:"Descripcin",year_tab:"Ao",week_agenda_tab:"Da",grid_tab:"Reja",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Diariamente",repeat_radio_week:"Semanalmente",repeat_radio_month:"Mensualmente",repeat_radio_year:"Anualmente",repeat_radio_day_type:"Cada",repeat_text_day_count:"dia",repeat_radio_day_type2:"Cada jornada de trabajo",repeat_week:" Repetir cada",repeat_text_week_count:"semana:",repeat_radio_month_type:"Repita",repeat_radio_month_start:"El",repeat_text_month_day:"dia cada ",repeat_text_month_count:"mes",repeat_text_month_count2_before:"cada",repeat_text_month_count2_after:"mes",repeat_year_label:"El",select_year_day2:"del",repeat_text_year_day:"dia",select_year_month:"mes",repeat_radio_end:"Sin fecha de finalizacin",repeat_text_occurrences_count:"ocurrencias",repeat_radio_end3:"Fin",repeat_radio_end2:"Despus de",repeat_never:"Nunca",repeat_daily:"Cada da",repeat_workdays:"Cada da laborable",repeat_weekly:"Cada semana",repeat_monthly:"Cada mes",repeat_yearly:"Cada ao",repeat_custom:"Personalizado",repeat_freq_day:"Da",repeat_freq_week:"Semana",repeat_freq_month:"Mes",repeat_freq_year:"Ao",repeat_on_date:"En la fecha",repeat_ends:"Termina",month_for_recurring:["Enero","Febrero","rzo","bril","Mayo","Junio","Julio","gosto","Setiembre","Octubre","Noviembre","Diciembre"],day_for_recurring:["Domingo","Lunes","Martes","Mircoles","Jeuves","Viernes","Sabado"]}},hu={date:{month_full:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes&auml;kuu","Hein&auml;kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],month_short:["Tam","Hel","Maa","Huh","Tou","Kes","Hei","Elo","Syy","Lok","Mar","Jou"],day_full:["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"],day_short:["Su","Ma","Ti","Ke","To","Pe","La"]},labels:{dhx_cal_today_button:"Tnn",day_tab:"Piv",week_tab:"Viikko",month_tab:"Kuukausi",new_event:"Uusi tapahtuma",icon_save:"Tallenna",icon_cancel:"Peru",icon_details:"Tiedot",icon_edit:"Muokkaa",icon_delete:"Poista",confirm_closing:"",confirm_deleting:"Haluatko varmasti poistaa tapahtuman?",section_description:"Kuvaus",section_time:"Aikajakso",full_day:"Koko piv",confirm_recurring:"Haluatko varmasti muokata toistuvan tapahtuman kaikkia jaksoja?",section_recurring:"Toista tapahtuma",button_recurring:"Ei k&auml;yt&ouml;ss&auml;",button_recurring_open:"K&auml;yt&ouml;ss&auml;",button_edit_series:"Muokkaa sarja",button_edit_occurrence:"Muokkaa kopio",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Esityslista",date:"Pivmr",description:"Kuvaus",year_tab:"Vuoden",week_agenda_tab:"Esityslista",grid_tab:"Ritil",drag_to_create:"Luo uusi vetmll",drag_to_move:"Siirr vetmll",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"P&auml;ivitt&auml;in",repeat_radio_week:"Viikoittain",repeat_radio_month:"Kuukausittain",repeat_radio_year:"Vuosittain",repeat_radio_day_type:"Joka",repeat_text_day_count:"p&auml;iv&auml;",repeat_radio_day_type2:"Joka arkip&auml;iv&auml;",repeat_week:"Toista joka",repeat_text_week_count:"viikko n&auml;in&auml; p&auml;ivin&auml;:",repeat_radio_month_type:"Toista",repeat_radio_month_start:"",repeat_text_month_day:"p&auml;iv&auml;n&auml; joka",repeat_text_month_count:"kuukausi",repeat_text_month_count2_before:"joka",repeat_text_month_count2_after:"kuukausi",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"p&auml;iv&auml;",select_year_month:"kuukausi",repeat_radio_end:"Ei loppumisaikaa",repeat_text_occurrences_count:"Toiston j&auml;lkeen",repeat_radio_end3:"Loppuu",repeat_radio_end2:"",repeat_never:"Ei koskaan",repeat_daily:"Joka piv",repeat_workdays:"Joka arkipiv",repeat_weekly:"Joka viikko",repeat_monthly:"Joka kuukausi",repeat_yearly:"Joka vuosi",repeat_custom:"Mukautettu",repeat_freq_day:"Piv",repeat_freq_week:"Viikko",repeat_freq_month:"Kuukausi",repeat_freq_year:"Vuosi",repeat_on_date:"Tiettyn pivn",repeat_ends:"Pttyy",month_for_recurring:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes&auml;kuu","Hein&auml;kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],day_for_recurring:["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"]}},fu={date:{month_full:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],month_short:["Jan","Fv","Mar","Avr","Mai","Juin","Juil","Ao","Sep","Oct","Nov","Dc"],day_full:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],day_short:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},labels:{dhx_cal_today_button:"Aujourd'hui",day_tab:"Jour",week_tab:"Semaine",month_tab:"Mois",new_event:"Nouvel vnement",icon_save:"Enregistrer",icon_cancel:"Annuler",icon_details:"Dtails",icon_edit:"Modifier",icon_delete:"Effacer",confirm_closing:"",confirm_deleting:"L'vnement sera effac sans appel, tes-vous sr ?",section_description:"Description",section_time:"Priode",full_day:"Journe complte",confirm_recurring:"Voulez-vous diter toute une srie d'vnements rpts?",section_recurring:"Priodicit",button_recurring:"Dsactiv",button_recurring_open:"Activ",button_edit_series:"Modifier la srie",button_edit_occurrence:"Modifier une copie",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Jour",date:"Date",description:"Description",year_tab:"Anne",week_agenda_tab:"Jour",grid_tab:"Grille",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Quotidienne",repeat_radio_week:"Hebdomadaire",repeat_radio_month:"Mensuelle",repeat_radio_year:"Annuelle",repeat_radio_day_type:"Chaque",repeat_text_day_count:"jour",repeat_radio_day_type2:"Chaque journe de travail",repeat_week:" Rpter toutes les",repeat_text_week_count:"semaine:",repeat_radio_month_type:"Rpter",repeat_radio_month_start:"Le",repeat_text_month_day:"jour chaque",repeat_text_month_count:"mois",repeat_text_month_count2_before:"chaque",repeat_text_month_count2_after:"mois",repeat_year_label:"Le",select_year_day2:"du",repeat_text_year_day:"jour",select_year_month:"mois",repeat_radio_end:"Pas de date d&quot;achvement",repeat_text_occurrences_count:"occurrences",repeat_radio_end3:"Fin",repeat_radio_end2:"Aprs",repeat_never:"Jamais",repeat_daily:"Chaque jour",repeat_workdays:"Chaque jour ouvrable",repeat_weekly:"Chaque semaine",repeat_monthly:"Chaque mois",repeat_yearly:"Chaque anne",repeat_custom:"Personnalis",repeat_freq_day:"Jour",repeat_freq_week:"Semaine",repeat_freq_month:"Mois",repeat_freq_year:"Anne",repeat_on_date:" la date",repeat_ends:"Se termine",month_for_recurring:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],day_for_recurring:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"]}},pu={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"  .?",section_description:"",section_time:"",confirm_recurring:"      ?",section_recurring:" ",button_recurring:" ",button_recurring_open:"",full_day:" ",button_edit_series:"  ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",agenda_tab:" ",date:"",description:"",year_tab:"",week_agenda_tab:" ",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"  ",message_ok:"OK",message_cancel:"",next:"",prev:"",year:"",month:"",day:"",hour:"",minute:"",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:" ",repeat_text_day_count:"",repeat_radio_day_type2:"   ",repeat_week:"  ",repeat_text_week_count:"  :",repeat_radio_month_type:" ",repeat_radio_month_start:"",repeat_text_month_day:" ",repeat_text_month_count:"",repeat_text_month_count2_before:" ",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end3:" ",repeat_radio_end2:"",repeat_never:" ",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:" ",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:"",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},mu={date:{month_full:["Janur","Februr","Mrcius","prilis","Mjus","Jnius","Jlius","Augusztus","Szeptember","Oktber","November","December"],month_short:["Jan","Feb","Mr","pr","Mj","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],day_full:["Vasrnap","Htf","Kedd","Szerda","Cstrtk","Pntek","szombat"],day_short:["Va","H","Ke","Sze","Cs","P","Szo"]},labels:{dhx_cal_today_button:"Ma",day_tab:"Nap",week_tab:"Ht",month_tab:"Hnap",new_event:"j esemny",icon_save:"Ments",icon_cancel:"Mgse",icon_details:"Rszletek",icon_edit:"Szerkeszts",icon_delete:"Trls",confirm_closing:"",confirm_deleting:"Az esemny trlve lesz, biztosan folytatja?",section_description:"Lers",section_time:"Idszak",full_day:"Egesz napos",confirm_recurring:"Biztosan szerkeszteni akarod az sszes ismtld esemny belltst?",section_recurring:"Esemny ismtlse",button_recurring:"Tilts",button_recurring_open:"Engedlyezs",button_edit_series:"Edit series",button_edit_occurrence:"Szerkeszts brsg",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Napirend",date:"Dtum",description:"Lers",year_tab:"v",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Napi",repeat_radio_week:"Heti",repeat_radio_month:"Havi",repeat_radio_year:"ves",repeat_radio_day_type:"Minden",repeat_text_day_count:"nap",repeat_radio_day_type2:"Minden munkanap",repeat_week:" Ismtelje meg minden",repeat_text_week_count:"hten a kvetkez napokon:",repeat_radio_month_type:"Ismtls",repeat_radio_month_start:"Ekkor",repeat_text_month_day:"nap minden",repeat_text_month_count:"hnapban",repeat_text_month_count2_before:"minden",repeat_text_month_count2_after:"hnapban",repeat_year_label:"Ekkor",select_year_day2:"-n/-n",repeat_text_year_day:"nap",select_year_month:"hnap",repeat_radio_end:"Nincs befejezsi dtum",repeat_text_occurrences_count:"esemny",repeat_radio_end2:"Utn",repeat_radio_end3:"Befejez dtum",repeat_never:"Soha",repeat_daily:"Minden nap",repeat_workdays:"Minden munkanap",repeat_weekly:"Minden hten",repeat_monthly:"Minden hnapban",repeat_yearly:"Minden vben",repeat_custom:"Egyedi",repeat_freq_day:"Nap",repeat_freq_week:"Ht",repeat_freq_month:"Hnap",repeat_freq_year:"v",repeat_on_date:"Dtum szerint",repeat_ends:"Befejezdik",month_for_recurring:["Janur","Februr","Mrcius","prilis","Mjus","Jnius","Jlius","Augusztus","Szeptember","Oktber","November","December"],day_for_recurring:["Vasrnap","Htf","Kedd","Szerda","Cstrtk","Pntek","Szombat"]}},gu={date:{month_full:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],day_full:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],day_short:["Ming","Sen","Sel","Rab","Kam","Jum","Sab"]},labels:{dhx_cal_today_button:"Hari Ini",day_tab:"Hari",week_tab:"Minggu",month_tab:"Bulan",new_event:"Acara Baru",icon_save:"Simpan",icon_cancel:"Batal",icon_details:"Detail",icon_edit:"Edit",icon_delete:"Hapus",confirm_closing:"",confirm_deleting:"Acara akan dihapus",section_description:"Keterangan",section_time:"Periode",full_day:"Hari penuh",confirm_recurring:"Apakah acara ini akan berulang?",section_recurring:"Acara Rutin",button_recurring:"Tidak Difungsikan",button_recurring_open:"Difungsikan",button_edit_series:"Mengedit seri",button_edit_occurrence:"Mengedit salinan",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Tanggal",description:"Keterangan",year_tab:"Tahun",week_agenda_tab:"Agenda",grid_tab:"Tabel",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Harian",repeat_radio_week:"Mingguan",repeat_radio_month:"Bulanan",repeat_radio_year:"Tahunan",repeat_radio_day_type:"Setiap",repeat_text_day_count:"hari",repeat_radio_day_type2:"Setiap hari kerja",repeat_week:" Ulangi setiap",repeat_text_week_count:"minggu pada hari berikut:",repeat_radio_month_type:"Ulangi",repeat_radio_month_start:"Pada",repeat_text_month_day:"hari setiap",repeat_text_month_count:"bulan",repeat_text_month_count2_before:"setiap",repeat_text_month_count2_after:"bulan",repeat_year_label:"Pada",select_year_day2:"dari",repeat_text_year_day:"hari",select_year_month:"bulan",repeat_radio_end:"Tanpa tanggal akhir",repeat_text_occurrences_count:"kejadian",repeat_radio_end2:"Setelah",repeat_radio_end3:"Berakhir pada",repeat_never:"Tidak pernah",repeat_daily:"Setiap hari",repeat_workdays:"Setiap hari kerja",repeat_weekly:"Setiap minggu",repeat_monthly:"Setiap bulan",repeat_yearly:"Setiap tahun",repeat_custom:"Kustom",repeat_freq_day:"Hari",repeat_freq_week:"Minggu",repeat_freq_month:"Bulan",repeat_freq_year:"Tahun",repeat_on_date:"Pada tanggal",repeat_ends:"Berakhir",month_for_recurring:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],day_for_recurring:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]}},vu={date:{month_full:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],month_short:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],day_full:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato"],day_short:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]},labels:{dhx_cal_today_button:"Oggi",day_tab:"Giorno",week_tab:"Settimana",month_tab:"Mese",new_event:"Nuovo evento",icon_save:"Salva",icon_cancel:"Chiudi",icon_details:"Dettagli",icon_edit:"Modifica",icon_delete:"Elimina",confirm_closing:"",confirm_deleting:"L'evento sar eliminato, siete sicuri?",section_description:"Descrizione",section_time:"Periodo di tempo",full_day:"Intera giornata",confirm_recurring:"Vuoi modificare l'intera serie di eventi?",section_recurring:"Ripetere l'evento",button_recurring:"Disattivato",button_recurring_open:"Attivato",button_edit_series:"Modificare la serie",button_edit_occurrence:"Modificare una copia",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Data",description:"Descrizione",year_tab:"Anno",week_agenda_tab:"Agenda",grid_tab:"Griglia",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Quotidiano",repeat_radio_week:"Settimanale",repeat_radio_month:"Mensile",repeat_radio_year:"Annuale",repeat_radio_day_type:"Ogni",repeat_text_day_count:"giorno",repeat_radio_day_type2:"Ogni giornata lavorativa",repeat_week:" Ripetere ogni",repeat_text_week_count:"settimana:",repeat_radio_month_type:"Ripetere",repeat_radio_month_start:"Il",repeat_text_month_day:"giorno ogni",repeat_text_month_count:"mese",repeat_text_month_count2_before:"ogni",repeat_text_month_count2_after:"mese",repeat_year_label:"Il",select_year_day2:"del",repeat_text_year_day:"giorno",select_year_month:"mese",repeat_radio_end:"Senza data finale",repeat_text_occurrences_count:"occorenze",repeat_radio_end3:"Fine",repeat_radio_end2:"Dopo",repeat_never:"Mai",repeat_daily:"Ogni giorno",repeat_workdays:"Ogni giorno feriale",repeat_weekly:"Ogni settimana",repeat_monthly:"Ogni mese",repeat_yearly:"Ogni anno",repeat_custom:"Personalizzato",repeat_freq_day:"Giorno",repeat_freq_week:"Settimana",repeat_freq_month:"Mese",repeat_freq_year:"Anno",repeat_on_date:"Alla data",repeat_ends:"Finisce",month_for_recurring:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Jiugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],day_for_recurring:["Domenica","Luned","Marted","Mercoled","Joved","Venerd","Sabato"]}},yu={date:{month_full:["1","2","3","4","5","6","7","8","9","10","11","12"],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:"",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"",section_description:"",section_time:"",confirm_recurring:"",section_recurring:"",button_recurring:"",button_recurring_open:"",full_day:"",button_edit_series:"",button_edit_occurrence:"",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"",repeat_week:" ",repeat_text_week_count:" :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:"",repeat_text_month_count:"",repeat_text_month_count2_before:"",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"",repeat_text_occurrences_count:"",repeat_radio_end2:"",repeat_radio_end3:"",repeat_never:"",repeat_daily:"",repeat_workdays:"",repeat_weekly:"",repeat_monthly:"",repeat_yearly:"",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:"",repeat_ends:"",month_for_recurring:["1","2","3","4","5","6","7","8","9","10","11","12"],day_for_recurring:["","","","","","",""]}};class bu{constructor(t){this._locales={};for(const n in t)this._locales[n]=t[n]}addLocale(t,n){this._locales[t]=n}getLocale(t){return this._locales[t]}}const wu={date:{month_full:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Mon","Tir","Ons","Tor","Fre","Lr"]},labels:{dhx_cal_today_button:"I dag",day_tab:"Dag",week_tab:"Uke",month_tab:"Mned",new_event:"Ny hendelse",icon_save:"Lagre",icon_cancel:"Avbryt",icon_details:"Detaljer",icon_edit:"Rediger",icon_delete:"Slett",confirm_closing:"",confirm_deleting:"Hendelsen vil bli slettet permanent. Er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",confirm_recurring:"Vil du forandre hele dette settet av repeterende hendelser?",section_recurring:"Repeter hendelsen",button_recurring:"Av",button_recurring_open:"P",button_edit_series:"Rediger serien",button_edit_occurrence:"Redigere en kopi",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Dato",description:"Beskrivelse",year_tab:"r",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daglig",repeat_radio_week:"Ukentlig",repeat_radio_month:"Mnedlig",repeat_radio_year:"rlig",repeat_radio_day_type:"Hver",repeat_text_day_count:"dag",repeat_radio_day_type2:"Alle hverdager",repeat_week:" Gjentas hver",repeat_text_week_count:"uke p:",repeat_radio_month_type:"P hver",repeat_radio_month_start:"P",repeat_text_month_day:"dag hver",repeat_text_month_count:"mned",repeat_text_month_count2_before:"hver",repeat_text_month_count2_after:"mned",repeat_year_label:"p",select_year_day2:"i",repeat_text_year_day:"dag i",select_year_month:"",repeat_radio_end:"Ingen sluttdato",repeat_text_occurrences_count:"forekomst",repeat_radio_end3:"Stop den",repeat_radio_end2:"Etter",repeat_never:"Aldri",repeat_daily:"Hver dag",repeat_workdays:"Hver ukedag",repeat_weekly:"Hver uke",repeat_monthly:"Hver mned",repeat_yearly:"Hvert r",repeat_custom:"Tilpasset",repeat_freq_day:"Dag",repeat_freq_week:"Uke",repeat_freq_month:"Mned",repeat_freq_year:"r",repeat_on_date:"P dato",repeat_ends:"Slutter",month_for_recurring:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],day_for_recurring:["Sondag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"]}},xu={date:{month_full:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],month_short:["Jan","Feb","mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"],day_short:["Zo","Ma","Di","Wo","Do","Vr","Za"]},labels:{dhx_cal_today_button:"Vandaag",day_tab:"Dag",week_tab:"Week",month_tab:"Maand",new_event:"Nieuw item",icon_save:"Opslaan",icon_cancel:"Annuleren",icon_details:"Details",icon_edit:"Bewerken",icon_delete:"Verwijderen",confirm_closing:"",confirm_deleting:"Item zal permanent worden verwijderd, doorgaan?",section_description:"Beschrijving",section_time:"Tijd periode",full_day:"Hele dag",confirm_recurring:"Wilt u alle terugkerende items bijwerken?",section_recurring:"Item herhalen",button_recurring:"Uit",button_recurring_open:"Aan",button_edit_series:"Bewerk de serie",button_edit_occurrence:"Bewerk een kopie",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Datum",description:"Omschrijving",year_tab:"Jaar",week_agenda_tab:"Agenda",grid_tab:"Tabel",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Dagelijks",repeat_radio_week:"Wekelijks",repeat_radio_month:"Maandelijks",repeat_radio_year:"Jaarlijks",repeat_radio_day_type:"Elke",repeat_text_day_count:"dag(en)",repeat_radio_day_type2:"Elke werkdag",repeat_week:" Herhaal elke",repeat_text_week_count:"week op de volgende dagen:",repeat_radio_month_type:"Herhaal",repeat_radio_month_start:"Op",repeat_text_month_day:"dag iedere",repeat_text_month_count:"maanden",repeat_text_month_count2_before:"iedere",repeat_text_month_count2_after:"maanden",repeat_year_label:"Op",select_year_day2:"van",repeat_text_year_day:"dag",select_year_month:"maand",repeat_radio_end:"Geen eind datum",repeat_text_occurrences_count:"keren",repeat_radio_end3:"Eindigd per",repeat_radio_end2:"Na",repeat_never:"Nooit",repeat_daily:"Elke dag",repeat_workdays:"Elke werkdag",repeat_weekly:"Elke week",repeat_monthly:"Elke maand",repeat_yearly:"Elk jaar",repeat_custom:"Aangepast",repeat_freq_day:"Dag",repeat_freq_week:"Week",repeat_freq_month:"Maand",repeat_freq_year:"Jaar",repeat_on_date:"Op datum",repeat_ends:"Eindigt",month_for_recurring:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],day_for_recurring:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"]}},Eu={date:{month_full:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Man","Tir","Ons","Tor","Fre","Lr"]},labels:{dhx_cal_today_button:"Idag",day_tab:"Dag",week_tab:"Uke",month_tab:"Mned",new_event:"Ny",icon_save:"Lagre",icon_cancel:"Avbryt",icon_details:"Detaljer",icon_edit:"Endre",icon_delete:"Slett",confirm_closing:"Endringer blir ikke lagret, er du sikker?",confirm_deleting:"Oppfringen vil bli slettet, er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",full_day:"Full dag",confirm_recurring:"Vil du endre hele settet med repeterende oppfringer?",section_recurring:"Repeterende oppfring",button_recurring:"Ikke aktiv",button_recurring_open:"Aktiv",button_edit_series:"Rediger serien",button_edit_occurrence:"Redigere en kopi",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Dato",description:"Beskrivelse",year_tab:"r",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daglig",repeat_radio_week:"Ukentlig",repeat_radio_month:"Mnedlig",repeat_radio_year:"rlig",repeat_radio_day_type:"Hver",repeat_text_day_count:"dag",repeat_radio_day_type2:"Hver arbeidsdag",repeat_week:" Gjenta hver",repeat_text_week_count:"uke neste dager:",repeat_radio_month_type:"Gjenta",repeat_radio_month_start:"P",repeat_text_month_day:"dag hver",repeat_text_month_count:"mned",repeat_text_month_count2_before:"hver",repeat_text_month_count2_after:"mned",repeat_year_label:"P",select_year_day2:"av",repeat_text_year_day:"dag",select_year_month:"mned",repeat_radio_end:"Ingen sluttdato",repeat_text_occurrences_count:"forekomster",repeat_radio_end2:"Etter",repeat_radio_end3:"Slutt innen",repeat_never:"Aldri",repeat_daily:"Hver dag",repeat_workdays:"Hver ukedag",repeat_weekly:"Hver uke",repeat_monthly:"Hver mned",repeat_yearly:"Hvert r",repeat_custom:"Tilpasset",repeat_freq_day:"Dag",repeat_freq_week:"Uke",repeat_freq_month:"Mned",repeat_freq_year:"r",repeat_on_date:"P dato",repeat_ends:"Slutter",month_for_recurring:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],day_for_recurring:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"]}},ku={date:{month_full:["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],month_short:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],day_full:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota"],day_short:["Nie","Pon","Wto","ro","Czw","Pi","Sob"]},labels:{dhx_cal_today_button:"Dzi",day_tab:"Dzie",week_tab:"Tydzie",month_tab:"Miesic",new_event:"Nowe zdarzenie",icon_save:"Zapisz",icon_cancel:"Anuluj",icon_details:"Szczegy",icon_edit:"Edytuj",icon_delete:"Usu",confirm_closing:"",confirm_deleting:"Zdarzenie zostanie usunite na zawsze, kontynuowa?",section_description:"Opis",section_time:"Okres czasu",full_day:"Cay dzie",confirm_recurring:"Czy chcesz edytowa cay zbir powtarzajcych si zdarze?",section_recurring:"Powtrz zdarzenie",button_recurring:"Nieaktywne",button_recurring_open:"Aktywne",button_edit_series:"Edytuj seri",button_edit_occurrence:"Edytuj kopi",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Data",description:"Opis",year_tab:"Rok",week_agenda_tab:"Agenda",grid_tab:"Tabela",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Codziennie",repeat_radio_week:"Co tydzie",repeat_radio_month:"Co miesic",repeat_radio_year:"Co rok",repeat_radio_day_type:"Kadego",repeat_text_day_count:"dnia",repeat_radio_day_type2:"Kadego dnia roboczego",repeat_week:" Powtarzaj kadego",repeat_text_week_count:"tygodnia w dni:",repeat_radio_month_type:"Powtrz",repeat_radio_month_start:"W",repeat_text_month_day:"dnia kadego",repeat_text_month_count:"miesica",repeat_text_month_count2_before:"kadego",repeat_text_month_count2_after:"miesica",repeat_year_label:"W",select_year_day2:"miesica",repeat_text_year_day:"dnia miesica",select_year_month:"",repeat_radio_end:"Bez daty kocowej",repeat_text_occurrences_count:"wystpieniu/ach",repeat_radio_end3:"Zakocz w",repeat_radio_end2:"Po",repeat_never:"Nigdy",repeat_daily:"Codziennie",repeat_workdays:"Kady dzie roboczy",repeat_weekly:"Co tydzie",repeat_monthly:"Co miesic",repeat_yearly:"Co rok",repeat_custom:"Niestandardowy",repeat_freq_day:"Dzie",repeat_freq_week:"Tydzie",repeat_freq_month:"Miesic",repeat_freq_year:"Rok",repeat_on_date:"W dniu",repeat_ends:"Koczy si",month_for_recurring:["Stycznia","Lutego","Marca","Kwietnia","Maja","Czerwca","Lipca","Sierpnia","Wrzenia","Padziernka","Listopada","Grudnia"],day_for_recurring:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota"]}},Tu={date:{month_full:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],month_short:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],day_full:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],day_short:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},labels:{dhx_cal_today_button:"Hoje",day_tab:"Dia",week_tab:"Semana",month_tab:"Ms",new_event:"Novo evento",icon_save:"Salvar",icon_cancel:"Cancelar",icon_details:"Detalhes",icon_edit:"Editar",icon_delete:"Deletar",confirm_closing:"",confirm_deleting:"Tem certeza que deseja excluir?",section_description:"Descrio",section_time:"Perodo de tempo",full_day:"Dia inteiro",confirm_recurring:"Deseja editar todos esses eventos repetidos?",section_recurring:"Repetir evento",button_recurring:"Desabilitar",button_recurring_open:"Habilitar",button_edit_series:"Editar a srie",button_edit_occurrence:"Editar uma cpia",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Dia",date:"Data",description:"Descrio",year_tab:"Ano",week_agenda_tab:"Dia",grid_tab:"Grade",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Dirio",repeat_radio_week:"Semanal",repeat_radio_month:"Mensal",repeat_radio_year:"Anual",repeat_radio_day_type:"Cada",repeat_text_day_count:"dia(s)",repeat_radio_day_type2:"Cada trabalho dirio",repeat_week:" Repita cada",repeat_text_week_count:"semana:",repeat_radio_month_type:"Repetir",repeat_radio_month_start:"Em",repeat_text_month_day:"todo dia",repeat_text_month_count:"ms",repeat_text_month_count2_before:"todo",repeat_text_month_count2_after:"ms",repeat_year_label:"Em",select_year_day2:"of",repeat_text_year_day:"dia",select_year_month:"ms",repeat_radio_end:"Sem data final",repeat_text_occurrences_count:"ocorrncias",repeat_radio_end3:"Fim",repeat_radio_end2:"Depois",repeat_never:"Nunca",repeat_daily:"Todos os dias",repeat_workdays:"Todos os dias teis",repeat_weekly:"Toda semana",repeat_monthly:"Todo ms",repeat_yearly:"Todo ano",repeat_custom:"Personalizado",repeat_freq_day:"Dia",repeat_freq_week:"Semana",repeat_freq_month:"Ms",repeat_freq_year:"Ano",repeat_on_date:"Na data",repeat_ends:"Termina",month_for_recurring:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],day_for_recurring:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"]}},Au={date:{month_full:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","November","December"],month_short:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Nov","Dec"],day_full:["Duminica","Luni","Marti","Miercuri","Joi","Vineri","Sambata"],day_short:["Du","Lu","Ma","Mi","Jo","Vi","Sa"]},labels:{dhx_cal_today_button:"Astazi",day_tab:"Zi",week_tab:"Saptamana",month_tab:"Luna",new_event:"Eveniment nou",icon_save:"Salveaza",icon_cancel:"Anuleaza",icon_details:"Detalii",icon_edit:"Editeaza",icon_delete:"Sterge",confirm_closing:"Schimbarile nu vor fi salvate, esti sigur?",confirm_deleting:"Evenimentul va fi sters permanent, esti sigur?",section_description:"Descriere",section_time:"Interval",full_day:"Toata ziua",confirm_recurring:"Vrei sa editezi toata seria de evenimente repetate?",section_recurring:"Repetare",button_recurring:"Dezactivata",button_recurring_open:"Activata",button_edit_series:"Editeaza serie",button_edit_occurrence:"Editeaza doar intrare",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Data",description:"Descriere",year_tab:"An",week_agenda_tab:"Agenda",grid_tab:"Lista",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Zilnic",repeat_radio_week:"Saptamanal",repeat_radio_month:"Lunar",repeat_radio_year:"Anual",repeat_radio_day_type:"La fiecare",repeat_text_day_count:"zi(le)",repeat_radio_day_type2:"Fiecare zi lucratoare",repeat_week:" Repeta la fiecare",repeat_text_week_count:"saptamana in urmatoarele zile:",repeat_radio_month_type:"Repeta in",repeat_radio_month_start:"In a",repeat_text_month_day:"zi la fiecare",repeat_text_month_count:"luni",repeat_text_month_count2_before:"la fiecare",repeat_text_month_count2_after:"luni",repeat_year_label:"In",select_year_day2:"a lunii",repeat_text_year_day:"zi a lunii",select_year_month:"",repeat_radio_end:"Fara data de sfarsit",repeat_text_occurrences_count:"evenimente",repeat_radio_end3:"La data",repeat_radio_end2:"Dupa",repeat_never:"Niciodat",repeat_daily:"n fiecare zi",repeat_workdays:"n fiecare zi lucrtoare",repeat_weekly:"n fiecare sptmn",repeat_monthly:"n fiecare lun",repeat_yearly:"n fiecare an",repeat_custom:"Personalizat",repeat_freq_day:"Zi",repeat_freq_week:"Sptmn",repeat_freq_month:"Lun",repeat_freq_year:"An",repeat_on_date:"La data",repeat_ends:"Se termin",month_for_recurring:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],day_for_recurring:["Duminica","Luni","Marti","Miercuri","Joi","Vineri","Sambata"]}},Su={date:{month_full:["","","","","Ma","","","","","O","",""],month_short:["","","Ma","A","Ma","","","A","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"   , ?",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"      ?",section_recurring:"",button_recurring:"",button_recurring_open:"",button_edit_series:" ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"  ",repeat_week:"  ",repeat_text_week_count:" , :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:"   ",repeat_text_month_count:"",repeat_text_month_count2_before:" ",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end3:" ",repeat_radio_end2:"",repeat_never:"",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},Du={date:{month_full:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota"],day_short:["Ned","Pon","Tor","Sre","et","Pet","Sob"]},labels:{dhx_cal_today_button:"Danes",day_tab:"Dan",week_tab:"Teden",month_tab:"Mesec",new_event:"Nov dogodek",icon_save:"Shrani",icon_cancel:"Preklii",icon_details:"Podrobnosti",icon_edit:"Uredi",icon_delete:"Izbrii",confirm_closing:"",confirm_deleting:"Dogodek bo izbrisan. elite nadaljevati?",section_description:"Opis",section_time:"asovni okvir",full_day:"Ves dan",confirm_recurring:"elite urediti celoten set ponavljajoih dogodkov?",section_recurring:"Ponovi dogodek",button_recurring:"Onemogoeno",button_recurring_open:"Omogoeno",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Zadeva",date:"Datum",description:"Opis",year_tab:"Leto",week_agenda_tab:"Zadeva",grid_tab:"Miza",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Dnevno",repeat_radio_week:"Tedensko",repeat_radio_month:"Meseno",repeat_radio_year:"Letno",repeat_radio_day_type:"Vsak",repeat_text_day_count:"dan",repeat_radio_day_type2:"Vsak delovni dan",repeat_week:" Ponavljaj vsak",repeat_text_week_count:"teden na naslednje dni:",repeat_radio_month_type:"Ponavljaj",repeat_radio_month_start:"Na",repeat_text_month_day:"dan vsak",repeat_text_month_count:"mesec",repeat_text_month_count2_before:"vsak",repeat_text_month_count2_after:"mesec",repeat_year_label:"Na",select_year_day2:"od",repeat_text_year_day:"dan",select_year_month:"mesec",repeat_radio_end:"Brez konnega datuma",repeat_text_occurrences_count:"pojavitve",repeat_radio_end2:"Po",repeat_radio_end3:"Konaj do",repeat_never:"Nikoli",repeat_daily:"Vsak dan",repeat_workdays:"Vsak delovni dan",repeat_weekly:"Vsak teden",repeat_monthly:"Vsak mesec",repeat_yearly:"Vsako leto",repeat_custom:"Po meri",repeat_freq_day:"Dan",repeat_freq_week:"Teden",repeat_freq_month:"Mesec",repeat_freq_year:"Leto",repeat_on_date:"Na datum",repeat_ends:"Kona se",month_for_recurring:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],day_for_recurring:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota"]}},Cu={date:{month_full:["Janur","Februr","Marec","Aprl","Mj","Jn","Jl","August","September","Oktber","November","December"],month_short:["Jan","Feb","Mar","Apr","Mj","Jn","Jl","Aug","Sept","Okt","Nov","Dec"],day_full:["Nedea","Pondelok","Utorok","Streda","tvrtok","Piatok","Sobota"],day_short:["Ne","Po","Ut","St","t","Pi","So"]},labels:{dhx_cal_today_button:"Dnes",day_tab:"De",week_tab:"Tde",month_tab:"Mesiac",new_event:"Nov udalos",icon_save:"Uloi",icon_cancel:"Sp",icon_details:"Detail",icon_edit:"Edituj",icon_delete:"Zmaza",confirm_closing:"Vae zmeny nebud uloen. Skutone?",confirm_deleting:"Udalos bude natrvalo vymazan. Skutone?",section_description:"Poznmky",section_time:"Doba platnosti",confirm_recurring:"Prajete si upravi cel radu opakovanch udalost?",section_recurring:"Opakovanie udalosti",button_recurring:"Vypnut",button_recurring_open:"Zapnut",button_edit_series:"Upravi opakovania",button_edit_occurrence:"Upravi intancie",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Program",date:"Dtum",description:"Poznmka",year_tab:"Rok",full_day:"Cel de",week_agenda_tab:"Program",grid_tab:"Mrieka",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Denne",repeat_radio_week:"Tdenne",repeat_radio_month:"Mesane",repeat_radio_year:"Rone",repeat_radio_day_type:"Kad",repeat_text_day_count:"de",repeat_radio_day_type2:"Kad prac. de",repeat_week:"Opakova kad",repeat_text_week_count:"tde v doch:",repeat_radio_month_type:"Opakova",repeat_radio_month_start:"On",repeat_text_month_day:"de kad",repeat_text_month_count:"mesiac",repeat_text_month_count2_before:"kad",repeat_text_month_count2_after:"mesiac",repeat_year_label:"On",select_year_day2:"poas",repeat_text_year_day:"de",select_year_month:"mesiac",repeat_radio_end:"Bez dtumu ukonenia",repeat_text_occurrences_count:"udalostiach",repeat_radio_end3:"Ukoni",repeat_radio_end2:"Po",repeat_never:"Nikdy",repeat_daily:"Kad de",repeat_workdays:"Kad pracovn de",repeat_weekly:"Kad tde",repeat_monthly:"Kad mesiac",repeat_yearly:"Kad rok",repeat_custom:"Vlastn",repeat_freq_day:"De",repeat_freq_week:"Tde",repeat_freq_month:"Mesiac",repeat_freq_year:"Rok",repeat_on_date:"Na dtum",repeat_ends:"Koniec",month_for_recurring:["Janur","Februr","Marec","Aprl","Mj","Jn","Jl","August","September","Oktber","November","December"],day_for_recurring:["Nedea","Pondelok","Utorok","Streda","tvrtok","Piatok","Sobota"]}},Iu={date:{month_full:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Mn","Tis","Ons","Tor","Fre","Lr"]},labels:{dhx_cal_today_button:"Idag",day_tab:"Dag",week_tab:"Vecka",month_tab:"Mnad",new_event:"Ny hndelse",icon_save:"Spara",icon_cancel:"ngra",icon_details:"Detaljer",icon_edit:"ndra",icon_delete:"Ta bort",confirm_closing:"",confirm_deleting:"r du sker p att du vill ta bort hndelsen permanent?",section_description:"Beskrivning",section_time:"Tid",full_day:"Hela dagen",confirm_recurring:"Vill du redigera hela serien med repeterande hndelser?",section_recurring:"Upprepa hndelse",button_recurring:"Inaktiverat",button_recurring_open:"Aktiverat",button_edit_series:"Redigera serien",button_edit_occurrence:"Redigera en kopia",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Dagordning",date:"Datum",description:"Beskrivning",year_tab:"r",week_agenda_tab:"Dagordning",grid_tab:"Galler",drag_to_create:"Dra fr att skapa ny",drag_to_move:"Dra fr att flytta",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Dagligen",repeat_radio_week:"Veckovis",repeat_radio_month:"Mnadsvis",repeat_radio_year:"rligen",repeat_radio_day_type:"Var",repeat_text_day_count:"dag",repeat_radio_day_type2:"Varje arbetsdag",repeat_week:" Upprepa var",repeat_text_week_count:"vecka dessa dagar:",repeat_radio_month_type:"Upprepa",repeat_radio_month_start:"Den",repeat_text_month_day:"dagen var",repeat_text_month_count:"mnad",repeat_text_month_count2_before:"var",repeat_text_month_count2_after:"mnad",repeat_year_label:"Den",select_year_day2:"i",repeat_text_year_day:"dag i",select_year_month:"mnad",repeat_radio_end:"Inget slutdatum",repeat_text_occurrences_count:"upprepningar",repeat_radio_end3:"Sluta efter",repeat_radio_end2:"Efter",repeat_never:"Aldrig",repeat_daily:"Varje dag",repeat_workdays:"Varje vardag",repeat_weekly:"Varje vecka",repeat_monthly:"Varje mnad",repeat_yearly:"Varje r",repeat_custom:"Anpassad",repeat_freq_day:"Dag",repeat_freq_week:"Vecka",repeat_freq_month:"Mnad",repeat_freq_year:"r",repeat_on_date:"P datum",repeat_ends:"Slutar",month_for_recurring:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],day_for_recurring:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag"]}},Nu={date:{month_full:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],month_short:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],day_full:["Pazar","Pazartes,","Sal","aramba","Perembe","Cuma","Cumartesi"],day_short:["Paz","Pts","Sal","ar","Per","Cum","Cts"]},labels:{dhx_cal_today_button:"Bugn",day_tab:"Gn",week_tab:"Hafta",month_tab:"Ay",new_event:"Uygun",icon_save:"Kaydet",icon_cancel:"ptal",icon_details:"Detaylar",icon_edit:"Dzenle",icon_delete:"Sil",confirm_closing:"",confirm_deleting:"Etkinlik silinecek, devam?",section_description:"Aklama",section_time:"Zaman aral",full_day:"Tam gn",confirm_recurring:"Tm tekrar eden etkinlikler silinecek, devam?",section_recurring:"Etkinlii tekrarla",button_recurring:"Pasif",button_recurring_open:"Aktif",button_edit_series:"Dizi dzenleme",button_edit_occurrence:"Bir kopyasn dzenleyin",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Ajanda",date:"Tarih",description:"Aklama",year_tab:"Yl",week_agenda_tab:"Ajanda",grid_tab:"Izgara",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Gnlk",repeat_radio_week:"Haftalk",repeat_radio_month:"Aylk",repeat_radio_year:"Yllk",repeat_radio_day_type:"Her",repeat_text_day_count:"gn",repeat_radio_day_type2:"Her i gn",repeat_week:" Tekrar her",repeat_text_week_count:"hafta u gnlerde:",repeat_radio_month_type:"Tekrar et",repeat_radio_month_start:"Tarihinde",repeat_text_month_day:"gn her",repeat_text_month_count:"ay",repeat_text_month_count2_before:"her",repeat_text_month_count2_after:"ay",repeat_year_label:"Tarihinde",select_year_day2:"ayn",repeat_text_year_day:"gn",select_year_month:"ay",repeat_radio_end:"Biti tarihi yok",repeat_text_occurrences_count:"olay",repeat_radio_end2:"Sonra",repeat_radio_end3:"Tarihinde bitir",repeat_never:"Asla",repeat_daily:"Her gn",repeat_workdays:"Her i gn",repeat_weekly:"Her hafta",repeat_monthly:"Her ay",repeat_yearly:"Her yl",repeat_custom:"zel",repeat_freq_day:"Gn",repeat_freq_week:"Hafta",repeat_freq_month:"Ay",repeat_freq_year:"Yl",repeat_on_date:"Tarihinde",repeat_ends:"Biter",month_for_recurring:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],day_for_recurring:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"]}},Mu={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","'",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"  .  ?",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"     ?",section_recurring:" ",button_recurring:"",button_recurring_open:"",button_edit_series:" ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"  ",repeat_week:"  ",repeat_text_week_count:" , :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:"   ",repeat_text_month_count:"",repeat_text_month_count2_before:" ",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end3:" ",repeat_radio_end2:"",repeat_never:"",repeat_daily:"",repeat_workdays:"   ",repeat_weekly:"",repeat_monthly:"",repeat_yearly:"",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","'",""]}};class Ou{constructor(t,n,r={}){this.state={date:new Date,modes:["days","months","years"],currentRange:[],eventDates:[],filterDays:null,currentModeIndex:0,...r},this.container=null,this.element=null,this.onStateChangeHandlers=[],this.scheduler=t,this._domEvents=t._createDomEventScope(),this.state=this.getState(),$i(this),n&&(this.container=n,this.render(this.container)),this.onStateChange((a,i)=>{this.callEvent("onStateChange",[i,a])})}getState(){return{...this.state,mode:this.state.modes[this.state.currentModeIndex]}}setState(t){const n={...this.state};t.mode&&(t.currentModeIndex=this.state.modes.indexOf(t.mode)),this.state={...this.state,...t},this._notifyStateChange(n,this.state),this.container&&this.render(this.container)}onStateChange(t){return this.onStateChangeHandlers.push(t),()=>{const n=this.onStateChangeHandlers.indexOf(t);n!==-1&&this.onStateChangeHandlers.splice(n,1)}}_notifyStateChange(t,n){this.onStateChangeHandlers.forEach(r=>r(t,n))}_adjustDate(t){const{mode:n,date:r}=this.getState(),a=new Date(r);n==="days"?a.setMonth(r.getMonth()+t):n==="months"?a.setFullYear(r.getFullYear()+t):a.setFullYear(r.getFullYear()+10*t),this.setState({date:a})}_toggleMode(){const t=(this.state.currentModeIndex+1)%this.state.modes.length;this.setState({currentModeIndex:t})}_renderCalendarHeader(t){const{mode:n,date:r}=this.getState(),a=document.createElement("div");a.classList.add("dhx_cal_datepicker_header");const i=document.createElement("button");i.classList.add("dhx_cal_datepicker_arrow","scheduler_icon","arrow_left"),a.appendChild(i);const o=document.createElement("div");if(o.classList.add("dhx_cal_datepicker_title"),n==="days")o.innerText=r.toLocaleString("default",{month:"long"})+" "+r.getFullYear();else if(n==="months")o.innerText=r.getFullYear();else{const s=10*Math.floor(r.getFullYear()/10);o.innerText=`${s} - ${s+9}`}this._domEvents.attach(o,"click",this._toggleMode.bind(this)),a.appendChild(o);const l=document.createElement("button");l.classList.add("dhx_cal_datepicker_arrow","scheduler_icon","arrow_right"),a.appendChild(l),t.appendChild(a),this._domEvents.attach(i,"click",this._adjustDate.bind(this,-1)),this._domEvents.attach(l,"click",this._adjustDate.bind(this,1))}render(t){this._domEvents.detachAll(),this.container=t||this.container,this.container.innerHTML="",this.element||(this.element=document.createElement("div"),this.element.classList.add("dhx_cal_datepicker")),this.element.innerHTML="",this.container.appendChild(this.element),this._renderCalendarHeader(this.element);const n=document.createElement("div");n.classList.add("dhx_cal_datepicker_data"),this.element.appendChild(n);const{mode:r}=this.getState();r==="days"?this._renderDayGrid(n):r==="months"?this._renderMonthGrid(n):this._renderYearGrid(n)}_renderDayGridHeader(t){const{date:n,filterDays:r}=this.getState(),a=this.scheduler;let i=a.date.week_start(new Date(n));const o=a.date.add(a.date.week_start(new Date(n)),1,"week");t.classList.add("dhx_cal_datepicker_days");const l=a.date.date_to_str("%D");for(;i.valueOf()<o.valueOf();){if(!r||!r(i)){const s=l(i),d=document.createElement("div");d.setAttribute("data-day",i.getDay()),d.classList.add("dhx_cal_datepicker_dayname"),d.innerText=s,t.appendChild(d)}i=a.date.add(i,1,"day")}}_weeksBetween(t,n){const r=this.scheduler;let a=0,i=new Date(t);for(;i.valueOf()<n.valueOf();)a+=1,i=r.date.week_start(r.date.add(i,1,"week"));return a}_renderDayGrid(t){const{date:n,currentRange:r,eventDates:a,minWeeks:i,filterDays:o}=this.getState();let l=r[0],s=r[1];const d=a.reduce((I,N)=>(I[this.scheduler.date.day_start(new Date(N)).valueOf()]=!0,I),{}),c=document.createElement("div");this._renderDayGridHeader(c);const u=c.children.length;t.appendChild(c),u!==7&&t.style.setProperty("--dhx-scheduler-week-length",u);const f=this.scheduler,v=f.date.week_start(f.date.month_start(new Date(n))),g=f.date.month_start(new Date(n)),h=f.date.add(f.date.month_start(new Date(n)),1,"month");let p=f.date.add(f.date.month_start(new Date(n)),1,"month");const y=f.date.date_part(f._currentDate());p.getDay()!==0&&(p=f.date.add(f.date.week_start(p),1,"week"));let x=this._weeksBetween(v,p);i&&x<i&&(p=f.date.add(p,i-x,"week"));let S=v;const O=document.createElement("div");for(O.classList.add("dhx_cal_datepicker_days"),this._domEvents.attach(O,"click",I=>{const N=I.target.closest("[data-cell-date]"),A=new Date(N.getAttribute("data-cell-date"));this.callEvent("onDateClick",[A,I])});S.valueOf()<p.valueOf();){if(!o||!o(S)){const I=document.createElement("div");I.setAttribute("data-cell-date",f.templates.format_date(S)),I.setAttribute("data-day",S.getDay()),I.innerHTML=f.templates.month_day(S),S.valueOf()<g.valueOf()?I.classList.add("dhx_before"):S.valueOf()>=h.valueOf()&&I.classList.add("dhx_after"),S.getDay()!==0&&S.getDay()!==6||I.classList.add("dhx_cal_datepicker_weekend"),S.valueOf()==y.valueOf()&&I.classList.add("dhx_now"),l&&s&&S.valueOf()>=l.valueOf()&&S.valueOf()<s.valueOf()&&I.classList.add("dhx_cal_datepicker_current"),d[S.valueOf()]&&I.classList.add("dhx_cal_datepicker_event"),I.classList.add("dhx_cal_datepicker_date"),O.appendChild(I)}S=f.date.add(S,1,"day")}t.appendChild(O)}_renderMonthGrid(t){const{date:n}=this.getState(),r=document.createElement("div");r.classList.add("dhx_cal_datepicker_months");const a=[];for(let s=0;s<12;s++)a.push(new Date(n.getFullYear(),s,1));const i=this.scheduler.date.date_to_str("%M");a.forEach(s=>{const d=document.createElement("div");d.classList.add("dhx_cal_datepicker_month"),n.getMonth()===s.getMonth()&&d.classList.add("dhx_cal_datepicker_current"),d.setAttribute("data-month",s.getMonth()),d.innerHTML=i(s),this._domEvents.attach(d,"click",()=>{const c=new Date(s);this.setState({date:c,mode:"days"})}),r.appendChild(d)}),t.appendChild(r);const o=document.createElement("div");o.classList.add("dhx_cal_datepicker_done");const l=document.createElement("button");l.innerText="Done",l.classList.add("dhx_cal_datepicker_done_btn"),this._domEvents.attach(l,"click",()=>{this.setState({mode:"days"})}),o.appendChild(l),t.appendChild(o)}_renderYearGrid(t){const{date:n}=this.getState(),r=10*Math.floor(n.getFullYear()/10),a=document.createElement("div");a.classList.add("dhx_cal_datepicker_years");for(let l=r-1;l<=r+10;l++){const s=document.createElement("div");s.innerText=l,s.classList.add("dhx_cal_datepicker_year"),s.setAttribute("data-year",l),n.getFullYear()===l&&s.classList.add("dhx_cal_datepicker_current"),this._domEvents.attach(s,"click",()=>{this.setState({date:new Date(l,n.getMonth(),1),mode:"months"})}),a.appendChild(s)}t.appendChild(a);const i=document.createElement("div");i.classList.add("dhx_cal_datepicker_done");const o=document.createElement("button");o.innerText="Done",o.classList.add("dhx_cal_datepicker_done_btn"),this._domEvents.attach(o,"click",()=>{this.setState({mode:"months"})}),i.appendChild(o),t.appendChild(i)}destructor(){this.onStateChangeHandlers=[],this.element&&(this.element.innerHTML="",this.element.remove()),this._domEvents.detachAll(),this.callEvent("onDestroy",[]),this.detachAllEvents(),this.scheduler=null}}function Ru(e){const t={version:"7.2.5"};t.$stateProvider=function(){const s={};return{getState:function(d){if(s[d])return s[d].method();{const c={};for(const u in s)s[u].internal||tt.mixin(c,s[u].method(),!0);return c}},registerProvider:function(d,c,u){s[d]={method:c,internal:u}},unregisterProvider:function(d){delete s[d]}}}(),t.getState=t.$stateProvider.getState,function(s){var d={agenda:"https://docs.dhtmlx.com/scheduler/agenda_view.html",grid:"https://docs.dhtmlx.com/scheduler/grid_view.html",map:"https://docs.dhtmlx.com/scheduler/map_view.html",unit:"https://docs.dhtmlx.com/scheduler/units_view.html",timeline:"https://docs.dhtmlx.com/scheduler/timeline_view.html",week_agenda:"https://docs.dhtmlx.com/scheduler/weekagenda_view.html",year:"https://docs.dhtmlx.com/scheduler/year_view.html",anythingElse:"https://docs.dhtmlx.com/scheduler/views.html"},c={agenda:"ext/dhtmlxscheduler_agenda_view.js",grid:"ext/dhtmlxscheduler_grid_view.js",map:"ext/dhtmlxscheduler_map_view.js",unit:"ext/dhtmlxscheduler_units.js",timeline:"ext/dhtmlxscheduler_timeline.js, ext/dhtmlxscheduler_treetimeline.js, ext/dhtmlxscheduler_daytimeline.js",week_agenda:"ext/dhtmlxscheduler_week_agenda.js",year:"ext/dhtmlxscheduler_year_view.js",limit:"ext/dhtmlxscheduler_limit.js"};s._commonErrorMessages={unknownView:function(u){var f=c[u]?"You're probably missing "+c[u]+".":"";return"`"+u+"` view is not defined. \nPlease check parameters you pass to `scheduler.init` or `scheduler.setCurrentView` in your code and ensure you've imported appropriate extensions. \nRelated docs: "+(d[u]||d.anythingElse)+`
`+(f?f+`
`:"")},collapsedContainer:function(u){return`Scheduler container height is set to *100%* but the rendered height is zero and the scheduler is not visible. 
Make sure that the container has some initial height or use different units. For example:
<div id='scheduler_here' class='dhx_cal_container' style='width:100%; height:600px;'> 
`}},s.createTimelineView=function(){throw new Error("scheduler.createTimelineView is not implemented. Be sure to add the required extension: "+c.timeline+`
Related docs: `+d.timeline)},s.createUnitsView=function(){throw new Error("scheduler.createUnitsView is not implemented. Be sure to add the required extension: "+c.unit+`
Related docs: `+d.unit)},s.createGridView=function(){throw new Error("scheduler.createGridView is not implemented. Be sure to add the required extension: "+c.grid+`
Related docs: `+d.grid)},s.addMarkedTimespan=function(){throw new Error(`scheduler.addMarkedTimespan is not implemented. Be sure to add the required extension: ext/dhtmlxscheduler_limit.js
Related docs: https://docs.dhtmlx.com/scheduler/limits.html`)},s.renderCalendar=function(){throw new Error(`scheduler.renderCalendar is not implemented. Be sure to add the required extension: ext/dhtmlxscheduler_minical.js
https://docs.dhtmlx.com/scheduler/minicalendar.html`)},s.exportToPNG=function(){throw new Error(["scheduler.exportToPNG is not implemented.","This feature requires an additional module, be sure to check the related doc here https://docs.dhtmlx.com/scheduler/png.html","Licensing info: https://dhtmlx.com/docs/products/dhtmlxScheduler/export.shtml"].join(`
`))},s.exportToPDF=function(){throw new Error(["scheduler.exportToPDF is not implemented.","This feature requires an additional module, be sure to check the related doc here https://docs.dhtmlx.com/scheduler/pdf.html","Licensing info: https://dhtmlx.com/docs/products/dhtmlxScheduler/export.shtml"].join(`
`))}}(t),q_(t),function(s){$i(s),F_(s),s._detachDomEvent=function(h,p,y){h.removeEventListener?h.removeEventListener(p,y,!1):h.detachEvent&&h.detachEvent("on"+p,y)},s._init_once=function(){U_(s),s._init_once=function(){}};const d={render:function(h){return s._init_nav_bar(h)}},c={render:function(h){const p=document.createElement("div");return p.className="dhx_cal_header",p}},u={render:function(h){const p=document.createElement("div");return p.className="dhx_cal_data",p}};function f(h){return!!(h.querySelector(".dhx_cal_header")&&h.querySelector(".dhx_cal_data")&&h.querySelector(".dhx_cal_navline"))}s.init=function(h,p,y){if(!this.$destroyed){if(p=p||s._currentDate(),y=y||"week",this._obj&&this.unset_actions(),this._obj=typeof h=="string"?document.getElementById(h):h,this.$container=this._obj,this.$root=this._obj,!this.$container.offsetHeight&&this.$container.offsetWidth&&this.$container.style.height==="100%"&&window.console.error(s._commonErrorMessages.collapsedContainer(),this.$container),this.config.wai_aria_attributes&&this.config.wai_aria_application_role&&this.$container.setAttribute("role","application"),this.config.header||f(this.$container)||(this.config.header=function(x){const S=["day","week","month"];if(x.matrix)for(const O in x.matrix)S.push(O);if(x._props)for(const O in x._props)S.push(O);if(x._grid&&x._grid.names)for(const O in x._grid.names)S.push(O);return["map","agenda","week_agenda","year"].forEach(function(O){x[O+"_view"]&&S.push(O)}),S.concat(["date"]).concat(["prev","today","next"])}(this),window.console.log(["Required DOM elements are missing from the scheduler container and **scheduler.config.header** is not specified.","Using a default header configuration: ","scheduler.config.header = "+JSON.stringify(this.config.header,null,2),"Check this article for the details: https://docs.dhtmlx.com/scheduler/initialization.html"].join(`
`))),this.config.header)this.$container.innerHTML="",this.$container.classList.add("dhx_cal_container"),this.config.header.height&&(this.xy.nav_height=this.config.header.height),this.$container.appendChild(d.render(this.config.header)),this.$container.appendChild(c.render()),this.$container.appendChild(u.render());else if(!f(this.$container))throw new Error(["Required DOM elements are missing from the scheduler container.","Be sure to either specify them manually in the markup: https://docs.dhtmlx.com/scheduler/initialization.html#initializingschedulerviamarkup","Or to use **scheduler.config.header** setting so they could be created automatically: https://docs.dhtmlx.com/scheduler/initialization.html#initializingschedulerviaheaderconfig"].join(`
`));this.config.rtl&&(this.$container.className+=" dhx_cal_container_rtl"),this._skin_init&&s._skin_init(),s.date.init(),this._scroll=!0,this._els=[],this.get_elements(),this.init_templates(),this.set_actions(),this._init_once(),this._init_touch_events(),this.set_sizes(),s.callEvent("onSchedulerReady",[]),s.$initialized=!0,this.setCurrentView(p,y)}},s.xy={min_event_height:20,bar_height:24,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22,event_header_height:14},s.keys={edit_save:13,edit_cancel:27},s.bind=function(h,p){return h.bind?h.bind(p):function(){return h.apply(p,arguments)}},s.set_sizes=function(){var h=this._x=this._obj.clientWidth-this.xy.margin_left,p=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,y=this.$container.querySelector(".dhx_cal_scale_placeholder");s._is_material_skin()?(y||((y=document.createElement("div")).className="dhx_cal_scale_placeholder",this.$container.insertBefore(y,this._els.dhx_cal_header[0])),y.style.display="block",this.set_xy(y,h,this.xy.scale_height+1,0,this._els.dhx_cal_header[0].offsetTop)):y&&y.parentNode.removeChild(y),this._lightbox&&(s.$container.offsetWidth<1200||this._setLbPosition(document.querySelector(".dhx_cal_light"))),this._data_width=h-p,this._els.dhx_cal_navline[0].style.width=h+"px";const x=this._els.dhx_cal_header[0];this.set_xy(x,this._data_width,this.xy.scale_height),x.style.left="",x.style.right="",this._table_view?this.config.rtl?x.style.right="-1px":x.style.left="-1px":this.config.rtl?x.style.right=`${this.xy.scale_width}px`:x.style.left=`${this.xy.scale_width}px`},s.set_xy=function(h,p,y,x,S){function O(N){let A=N;return isNaN(Number(A))||(A=Math.max(0,A)+"px"),A}var I="left";p!==void 0&&(h.style.width=O(p)),y!==void 0&&(h.style.height=O(y)),arguments.length>3&&(x!==void 0&&(this.config.rtl&&(I="right"),h.style[I]=x+"px"),S!==void 0&&(h.style.top=S+"px"))},s.get_elements=function(){const h=this._obj.getElementsByTagName("DIV");for(let p=0;p<h.length;p++){let y=s._getClassName(h[p]);const x=h[p].getAttribute("data-tab")||h[p].getAttribute("name")||"";y&&(y=y.split(" ")[0]),this._els[y]||(this._els[y]=[]),this._els[y].push(h[p]);let S=s.locale.labels[x+"_tab"]||s.locale.labels[x||y];typeof S!="string"&&x&&!h[p].innerHTML&&(S=x.split("_")[0]),S&&(this._waiAria.labelAttr(h[p],S),h[p].innerHTML=S)}};const v=s._createDomEventScope();function g(h,p){const y=new Date(h),x=(new Date(p).getTime()-y.getTime())/864e5;return Math.abs(x)}s.unset_actions=function(){v.detachAll()},s.set_actions=function(){for(const h in this._els)if(this._click[h])for(let p=0;p<this._els[h].length;p++){const y=this._els[h][p],x=this._click[h].bind(y);v.attach(y,"click",x)}v.attach(this._obj,"selectstart",function(h){return h.preventDefault(),!1}),v.attach(this._obj,"mousemove",function(h){s._temp_touch_block||s._on_mouse_move(h)}),v.attach(this._obj,"mousedown",function(h){s._ignore_next_click||s._on_mouse_down(h)}),v.attach(this._obj,"mouseup",function(h){s._ignore_next_click||s._on_mouse_up(h)}),v.attach(this._obj,"dblclick",function(h){s._on_dbl_click(h)}),v.attach(this._obj,"contextmenu",function(h){return s.checkEvent("onContextMenu")&&h.preventDefault(),s.callEvent("onContextMenu",[s._locate_event(h.target),h])})},s.select=function(h){this._select_id!=h&&(s._close_not_saved(),this.editStop(!1),this._select_id&&this.unselect(),this._select_id=h,this.updateEvent(h),this.callEvent("onEventSelected",[h]))},s.unselect=function(h){if(h&&h!=this._select_id)return;const p=this._select_id;this._select_id=null,p&&this.getEvent(p)&&this.updateEvent(p),this.callEvent("onEventUnselected",[p])},s.$stateProvider.registerProvider("global",(function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}}).bind(s)),s._click={dhx_cal_data:function(h){if(s._ignore_next_click)return h.preventDefault&&h.preventDefault(),h.cancelBubble=!0,s._ignore_next_click=!1,!1;const p=s._locate_event(h.target);if(p){if(!s.callEvent("onClick",[p,h])||s.config.readonly)return}else s.callEvent("onEmptyClick",[s.getActionData(h).date,h]);if(p&&s.config.select){s.select(p);const y=h.target.closest(".dhx_menu_icon"),x=s._getClassName(y);x.indexOf("_icon")!=-1&&s._click.buttons[x.split(" ")[1].replace("icon_","")](p)}else s._close_not_saved(),s.getState().select_id&&new Date().valueOf()-(s._new_event||0)>500&&s.unselect()},dhx_cal_prev_button:function(){s._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(h,p){let y=1;s.config.rtl&&(p=-p,y=-y),s.setCurrentView(s.date.add(s.date[s._mode+"_start"](new Date(s._date)),p||y,s._mode))},dhx_cal_today_button:function(){s.callEvent("onBeforeTodayDisplayed",[])&&s.setCurrentView(s._currentDate())},dhx_cal_tab:function(){const h=this.getAttribute("data-tab"),p=this.getAttribute("name"),y=h||p.substring(0,p.search("_tab"));s.setCurrentView(s._date,y)},buttons:{delete:function(h){const p=s.locale.labels.confirm_deleting;s._dhtmlx_confirm({message:p,title:s.locale.labels.title_confirm_deleting,callback:function(){s.deleteEvent(h)},config:{ok:s.locale.labels.icon_delete}})},edit:function(h){s.edit(h)},save:function(h){s.editStop(!0)},details:function(h){s.showLightbox(h)},form:function(h){s.showLightbox(h)},cancel:function(h){s.editStop(!1)}}},s._dhtmlx_confirm=function({message:h,title:p,callback:y,config:x}){if(!h)return y();x=x||{};const S={...x,text:h};p&&(S.title=p),y&&(S.callback=function(O){O&&y()}),s.confirm(S)},s.addEventNow=function(h,p,y){let x={};s._isObject(h)&&!s._isDate(h)&&(x=h,h=null);const S=6e4*(this.config.event_duration||this.config.time_step);h||(h=x.start_date||Math.round(s._currentDate().valueOf()/S)*S);let O=new Date(h);if(!p){let A=this.config.first_hour;A>O.getHours()&&(O.setHours(A),h=O.valueOf()),p=h.valueOf()+S}let I=new Date(p);O.valueOf()==I.valueOf()&&I.setTime(I.valueOf()+S),x.start_date=x.start_date||O,x.end_date=x.end_date||I,x.text=x.text||this.locale.labels.new_event,x.id=this._drag_id=x.id||this.uid(),this._drag_mode="new-size",this._loading=!0;const N=this.addEvent(x);return this.callEvent("onEventCreated",[this._drag_id,y]),this._loading=!1,this._drag_event={},this._on_mouse_up(y),N},s._on_dbl_click=function(h,p){if(p=p||h.target,this.config.readonly)return;const y=s._getClassName(p).split(" ")[0];switch(y){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!s.config.dblclick_create)break;this.addEventNow(this.getActionData(h).date,null,h);break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_cal_agenda_event_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":{const x=this._locate_event(p);if(!this.callEvent("onDblClick",[x,h]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(x)._timed||!this.config.select?this.showLightbox(x):this.edit(x);break}case"dhx_time_block":case"dhx_cal_container":return;default:{const x=this["dblclick_"+y];if(x)x.call(this,h);else if(p.parentNode&&p!=this)return s._on_dbl_click(h,p.parentNode);break}}},s._get_column_index=function(h){let p=0;if(this._cols){let y=0,x=0;for(;y+this._cols[x]<h&&x<this._cols.length;)y+=this._cols[x],x++;if(p=x+(this._cols[x]?(h-y)/this._cols[x]:0),this._ignores&&p>=this._cols.length)for(;p>=1&&this._ignores[Math.floor(p)];)p--}return p},s._week_indexes_from_pos=function(h){if(this._cols){const p=this._get_column_index(h.x);return h.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(p)-1)),h.y=Math.max(0,Math.ceil(60*h.y/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),h}return h},s._mouse_coords=function(h){let p;const y=document.body,x=document.documentElement;p=this.$env.isIE||!h.pageX&&!h.pageY?{x:h.clientX+(y.scrollLeft||x.scrollLeft||0)-y.clientLeft,y:h.clientY+(y.scrollTop||x.scrollTop||0)-y.clientTop}:{x:h.pageX,y:h.pageY},this.config.rtl&&this._colsS?(p.x=this.$container.querySelector(".dhx_cal_data").offsetWidth-p.x,p.x+=this.$domHelpers.getAbsoluteLeft(this._obj),this._mode!=="month"&&(p.x-=this.xy.scale_width)):p.x-=this.$domHelpers.getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width);const S=this.$container.querySelector(".dhx_cal_data");p.y-=this.$domHelpers.getAbsoluteTop(S)-this._els.dhx_cal_data[0].scrollTop,p.ev=h;const O=this["mouse_"+this._mode];if(O)p=O.call(this,p);else if(this._table_view){const I=this._get_column_index(p.x);if(!this._cols||!this._colsS)return p;let N=0;for(N=1;N<this._colsS.heights.length&&!(this._colsS.heights[N]>p.y);N++);p.y=Math.ceil(24*(Math.max(0,I)+7*Math.max(0,N-1))*60/this.config.time_step),(s._drag_mode||this._mode=="month")&&(p.y=24*(Math.max(0,Math.ceil(I)-1)+7*Math.max(0,N-1))*60/this.config.time_step),this._drag_mode=="move"&&s._ignores_detected&&s.config.preserve_length&&(p._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{x_step:1,x_unit:"day"}))),p.x=0}else p=this._week_indexes_from_pos(p);return p.timestamp=+new Date,p},s._close_not_saved=function(){if(new Date().valueOf()-(s._new_event||0)>500&&s._edit_id){const h=s.locale.labels.confirm_closing;s._dhtmlx_confirm({message:h,title:s.locale.labels.title_confirm_closing,callback:function(){s.editStop(s.config.positive_closing)}}),h&&(this._drag_id=this._drag_pos=this._drag_mode=null)}},s._correct_shift=function(h,p){return h-6e4*(new Date(s._min_date).getTimezoneOffset()-new Date(h).getTimezoneOffset())*(p?-1:1)},s._is_pos_changed=function(h,p){function y(x,S,O){return Math.abs(x-S)>O}return!h||!this._drag_pos||!!(this._drag_pos.has_moved||!this._drag_pos.timestamp||p.timestamp-this._drag_pos.timestamp>100||y(h.ev.clientX,p.ev.clientX,5)||y(h.ev.clientY,p.ev.clientY,5))},s._correct_drag_start_date=function(h){let p;s.matrix&&(p=s.matrix[s._mode]),p=p||{x_step:1,x_unit:"day"},h=new Date(h);let y=1;return(p._start_correction||p._end_correction)&&(y=60*(p.last_hour||0)-(60*h.getHours()+h.getMinutes())||1),1*h+(s._get_fictional_event_length(h,y,p)-y)},s._correct_drag_end_date=function(h,p){let y;s.matrix&&(y=s.matrix[s._mode]),y=y||{x_step:1,x_unit:"day"};const x=1*h+s._get_fictional_event_length(h,p,y);return new Date(1*x-(s._get_fictional_event_length(x,-1,y,-1)+1))},s._on_mouse_move=function(h){if(this._drag_mode){var p=this._mouse_coords(h);if(this._is_pos_changed(this._drag_pos,p)){var y,x;if(this._edit_id!=this._drag_id&&this._close_not_saved(),!this._drag_mode)return;var S=null;if(this._drag_pos&&!this._drag_pos.has_moved&&((S=this._drag_pos).has_moved=!0),this._drag_pos=p,this._drag_pos.has_moved=!0,this._drag_mode=="create"){if(S&&(p=S),this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,y=this._get_date_from_pos(p).valueOf(),!this._drag_start)return this.callEvent("onBeforeEventCreated",[h,this._drag_id])?(this._loading=!1,void(this._drag_start=y)):void(this._loading=!1);x=y,this._drag_start;var O=new Date(this._drag_start),I=new Date(x);this._mode!="day"&&this._mode!="week"||O.getHours()!=I.getHours()||O.getMinutes()!=I.getMinutes()||(I=new Date(this._drag_start+1e3)),this._drag_id=this.uid(),this.addEvent(O,I,this.locale.labels.new_event,this._drag_id,p.fields),this.callEvent("onEventCreated",[this._drag_id,h]),this._loading=!1,this._drag_mode="new-size"}var N,A=this.config.time_step,m=this.getEvent(this._drag_id);if(s.matrix&&(N=s.matrix[s._mode]),N=N||{x_step:1,x_unit:"day"},this._drag_mode=="move")y=this._min_date.valueOf()+6e4*(p.y*this.config.time_step+24*p.x*60),!p.custom&&this._table_view&&(y+=1e3*this.date.time_part(m.start_date)),!this._table_view&&this._dragEventBody&&this._drag_event._move_event_shift===void 0&&(this._drag_event._move_event_shift=y-m.start_date),this._drag_event._move_event_shift&&(y-=this._drag_event._move_event_shift),y=this._correct_shift(y),p._ignores&&this.config.preserve_length&&this._table_view&&N?(y=s._correct_drag_start_date(y),x=s._correct_drag_end_date(y,this._drag_event._event_length)):x=m.end_date.valueOf()-(m.start_date.valueOf()-y);else{if(y=m.start_date.valueOf(),x=m.end_date.valueOf(),this._table_view){var b=this._min_date.valueOf()+p.y*this.config.time_step*6e4+(p.custom?0:864e5);if(this._mode=="month")if(b=this._correct_shift(b,!1),this._drag_from_start){var E=864e5;b<=s.date.date_part(new Date(x+E-1)).valueOf()&&(y=b-E)}else x=b;else if(this.config.preserve_length){if(p.resize_from_start)y=s._correct_drag_start_date(b),N.round_position&&N.first_hour&&N.last_hour&&N.x_unit=="day"&&(y=new Date(1*y+N._start_correction));else if(x=s._correct_drag_end_date(b,0),N.round_position&&N.first_hour&&N.last_hour&&N.x_unit=="day"&&(x=s.date.date_part(new Date(x)),x=new Date(1*x-N._end_correction)),N.round_position&&s["ignore_"+s._mode]&&N.x_unit=="day"){const ge=this["ignore_"+this._mode];let Ue=s.date.add(new Date(x),-N.x_step,N.x_unit);ge(Ue)&&(x=Ue)}}else p.resize_from_start?y=b:x=b}else{var k=this.date.date_part(new Date(m.end_date.valueOf()-1)).valueOf(),D=new Date(k),C=this.config.first_hour,R=60/A*(this.config.last_hour-C);this.config.time_step=1;var P=this._mouse_coords(h);this.config.time_step=A;var U=p.y*A*6e4,q=Math.min(p.y+1,R)*A*6e4,$=6e4*P.y;x=Math.abs(U-$)>Math.abs(q-$)?k+q:k+U,x+=6e4*(new Date(x).getTimezoneOffset()-D.getTimezoneOffset()),this._els.dhx_cal_data[0].style.cursor="s-resize",this._mode!="week"&&this._mode!="day"||(x=this._correct_shift(x))}if(this._drag_mode=="new-size")if(x<=this._drag_start){var ee=p.shift||(this._table_view&&!p.custom?864e5:0);y=x-(p.shift?0:ee),x=this._drag_start+(ee||6e4*A)}else y=this._drag_start;else x<=y&&(x=N&&N.round_position?N.x_unit=="hour"||N.x_unit=="minute"?s.date.add(y,N.x_step,N.x_unit):s.date.add(s.date.date_part(new Date(y)),1,N.x_unit):y+6e4*A)}var ie=new Date(x-1),Q=new Date(y);if(this._drag_mode=="move"&&s.config.limit_drag_out&&(+Q<+s._min_date||+x>+s._max_date)){if(+m.start_date<+s._min_date||+m.end_date>+s._max_date)Q=new Date(m.start_date),x=new Date(m.end_date);else{var W=x-Q;+Q<+s._min_date?(Q=new Date(s._min_date),p._ignores&&this.config.preserve_length&&this._table_view?(Q=new Date(s._correct_drag_start_date(Q)),N._start_correction&&(Q=new Date(Q.valueOf()+N._start_correction)),x=new Date(1*Q+this._get_fictional_event_length(Q,this._drag_event._event_length,N))):x=new Date(+Q+W)):(x=new Date(s._max_date),p._ignores&&this.config.preserve_length&&this._table_view?(N._end_correction&&(x=new Date(x.valueOf()-N._end_correction)),x=new Date(1*x-this._get_fictional_event_length(x,0,N,!0)),Q=new Date(1*x-this._get_fictional_event_length(x,this._drag_event._event_length,N,!0)),this._ignores_detected&&(Q=s.date.add(Q,N.x_step,N.x_unit),x=new Date(1*x-this._get_fictional_event_length(x,0,N,!0)),x=s.date.add(x,N.x_step,N.x_unit))):Q=new Date(+x-W))}ie=new Date(x-1)}if(!this._table_view&&this._dragEventBody&&!s.config.all_timed&&(!s._get_section_view()&&p.x!=this._get_event_sday({start_date:new Date(y),end_date:new Date(y)})||new Date(y).getHours()<this.config.first_hour)&&(W=x-Q,this._drag_mode=="move"&&(E=this._min_date.valueOf()+24*p.x*60*6e4,(Q=new Date(E)).setHours(this.config.first_hour),+Q<=+m.start_date?x=new Date(+Q+W):Q=new Date(+x-W))),this._table_view||s.config.all_timed||!(!s.getView()&&p.x!=this._get_event_sday({start_date:new Date(x),end_date:new Date(x)})||new Date(x).getHours()>=this.config.last_hour)||(W=x-Q,E=this._min_date.valueOf()+24*p.x*60*6e4,(x=s.date.date_part(new Date(E))).setHours(this.config.last_hour),ie=new Date(x-1),this._drag_mode=="move"&&(+Q<=+m.start_date?x=new Date(+Q+W):Q=new Date(+x-W))),!this._table_view&&s.config.all_timed){let ge=this._min_date.valueOf()+24*p.x*60*6e4;new Date(s._drag_start).getDay()!=new Date(ge)&&(ge=new Date(s._drag_start));let Ue=new Date(ge).setHours(this.config.last_hour);s._drag_start&&this._drag_mode=="new-size"&&Ue<new Date(x)&&((x=s.date.date_part(new Date(ge))).setHours(this.config.last_hour),ie=new Date(x-1))}if(this._table_view&&s["ignore_"+this._mode]&&(this._drag_mode=="resize"||this._drag_mode=="new-size")&&+x>+s._max_date){x=new Date(s._max_date);const ge=this["ignore_"+this._mode];for(;ge(x);)x=s.date.add(x,-N.x_step,N.x_unit);x=s.date.add(x,N.x_step,N.x_unit)}if(this._table_view||ie.getDate()==Q.getDate()&&ie.getHours()<this.config.last_hour||s._allow_dnd)if(m.start_date=Q,m.end_date=new Date(x),this.config.update_render){var J=s._els.dhx_cal_data[0].scrollTop;this.update_view(),s._els.dhx_cal_data[0].scrollTop=J}else this.updateEvent(this._drag_id);this._table_view&&this.for_rendered(this._drag_id,function(ge){ge.className+=" dhx_in_move dhx_cal_event_drag"}),this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,h])}}else if(s.checkEvent("onMouseMove")){var re=this._locate_event(h.target||h.srcElement);this.callEvent("onMouseMove",[re,h])}},s._on_mouse_down=function(h,p){if(h.button!=2&&!this.config.readonly&&!this._drag_mode){p=p||h.target||h.srcElement;var y=s._getClassName(p).split(" ")[0];switch(this.config.drag_event_body&&y=="dhx_body"&&p.parentNode&&p.parentNode.className.indexOf("dhx_cal_select_menu")===-1&&(y="dhx_event_move",this._dragEventBody=!0),y){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize",s._getClassName(p).indexOf("dhx_event_resize_end")<0?s._drag_from_start=!0:s._drag_from_start=!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(p.parentNode)return s._on_mouse_down(h,p.parentNode);break;default:if((!s.checkEvent("onMouseDown")||s.callEvent("onMouseDown",[y,h]))&&p.parentNode&&p!=this&&y!="dhx_body")return s._on_mouse_down(h,p.parentNode);this._drag_mode=null,this._drag_id=null}if(this._drag_mode){var x=this._locate_event(p);if(this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[x,this._drag_mode,h])){if(this._drag_id=x,(this._edit_id!=this._drag_id||this._edit_id&&this._drag_mode=="create")&&this._close_not_saved(),!this._drag_mode)return;this._drag_event=s._lame_clone(this.getEvent(this._drag_id)||{}),this._drag_pos=this._mouse_coords(h)}else this._drag_mode=this._drag_id=0}this._drag_start=null}},s._get_private_properties=function(h){var p={};for(var y in h)y.indexOf("_")===0&&(p[y]=!0);return p},s._clear_temporary_properties=function(h,p){var y=this._get_private_properties(h),x=this._get_private_properties(p);for(var S in x)y[S]||delete p[S]},s._on_mouse_up=function(h){if(!h||h.button!=2||!this._mobile){if(this._drag_mode&&this._drag_id){this._els.dhx_cal_data[0].style.cursor="default";var p=this._drag_id,y=this._drag_mode,x=!this._drag_pos||this._drag_pos.has_moved;delete this._drag_event._move_event_shift;var S=this.getEvent(this._drag_id);if(x&&(this._drag_event._dhx_changed||!this._drag_event.start_date||S.start_date.valueOf()!=this._drag_event.start_date.valueOf()||S.end_date.valueOf()!=this._drag_event.end_date.valueOf())){var O=this._drag_mode=="new-size";if(this.callEvent("onBeforeEventChanged",[S,h,O,this._drag_event]))if(this._drag_id=this._drag_mode=null,O&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select||!this.isOneDayEvent(this.getEvent(p)))return s.callEvent("onDragEnd",[p,y,h]),this.showLightbox(p);this._drag_pos=!0,this._select_id=this._edit_id=p}else this._new_event||this.callEvent(O?"onEventAdded":"onEventChanged",[p,this.getEvent(p)]);else O?this.deleteEvent(S.id,!0):(this._drag_event._dhx_changed=!1,this._clear_temporary_properties(S,this._drag_event),s._lame_copy(S,this._drag_event),this.updateEvent(S.id))}this._drag_pos&&(this._drag_pos.has_moved||this._drag_pos===!0)&&(this._drag_id=this._drag_mode=null,this.render_view_data()),s.callEvent("onDragEnd",[p,y,h])}this._drag_id=null,this._drag_mode=null,this._drag_pos=null,this._drag_event=null,this._drag_from_start=null}},s._trigger_dyn_loading=function(){return!(!this._load_mode||!this._load()||(this._render_wait=!0,0))},s.update_view=function(){this._reset_ignores(),this._update_nav_bar(this.config.header,this.$container.querySelector(".dhx_cal_navline"));var h=this[this._mode+"_view"];if(h?h.call(this,!0):this._reset_scale(),this._trigger_dyn_loading())return!0;this.render_view_data()},s.isViewExists=function(h){return!!(s[h+"_view"]||s.date[h+"_start"]&&s.templates[h+"_date"]&&s.templates[h+"_scale_date"])},s._set_aria_buttons_attrs=function(){for(var h=["dhx_cal_next_button","dhx_cal_prev_button","dhx_cal_tab","dhx_cal_today_button"],p=0;p<h.length;p++)for(var y=this._els[h[p]],x=0;y&&x<y.length;x++){var S=y[x].getAttribute("data-tab")||y[x].getAttribute("name"),O=this.locale.labels[h[p]];S&&(O=this.locale.labels[S+"_tab"]||this.locale.labels[S]||O),h[p]=="dhx_cal_next_button"?O=this.locale.labels.next:h[p]=="dhx_cal_prev_button"&&(O=this.locale.labels.prev),this._waiAria.headerButtonsAttributes(y[x],O||"")}},s.updateView=function(h,p){if(!this.$container)throw new Error(`The scheduler is not initialized. 
 **scheduler.updateView** or **scheduler.setCurrentView** can be called only after **scheduler.init**`);h=h||this._date,p=p||this._mode;var y="dhx_cal_data";this.locale.labels.icon_form||(this.locale.labels.icon_form=this.locale.labels.icon_edit);var x=this._obj,S="dhx_scheduler_"+this._mode,O="dhx_scheduler_"+p;this._mode&&x.className.indexOf(S)!=-1?x.className=x.className.replace(S,O):x.className+=" "+O;var I,N="dhx_multi_day",A=!(this._mode!=p||!this.config.preserve_scroll)&&this._els[y][0].scrollTop;this._els[N]&&this._els[N][0]&&(I=this._els[N][0].scrollTop),this[this._mode+"_view"]&&p&&this._mode!=p&&this[this._mode+"_view"](!1),this._close_not_saved(),this._els[N]&&(this._els[N][0].parentNode.removeChild(this._els[N][0]),this._els[N]=null),this._mode=p,this._date=h,this._table_view=this._mode=="month",this._dy_shift=0,this.update_view(),this._set_aria_buttons_attrs();var m=this._els.dhx_cal_tab;if(m)for(var b=0;b<m.length;b++){var E=m[b];E.getAttribute("data-tab")==this._mode||E.getAttribute("name")==this._mode+"_tab"?(E.classList.add("active"),this._waiAria.headerToggleState(E,!0)):(E.classList.remove("active"),this._waiAria.headerToggleState(E,!1))}typeof A=="number"&&(this._els[y][0].scrollTop=A),typeof I=="number"&&this._els[N]&&this._els[N][0]&&(this._els[N][0].scrollTop=I)},s.setCurrentView=function(h,p){this.callEvent("onBeforeViewChange",[this._mode,this._date,p||this._mode,h||this._date])&&(this.updateView(h,p),this.callEvent("onViewChange",[this._mode,this._date]))},s.render=function(h,p){s.setCurrentView(h,p)},s._render_x_header=function(h,p,y,x,S){S=S||0;var O=document.createElement("div");O.className="dhx_scale_bar",this.templates[this._mode+"_scalex_class"]&&(O.className+=" "+this.templates[this._mode+"_scalex_class"](y));var I=this._cols[h];this._mode=="month"&&h===0&&this.config.left_border&&(O.className+=" dhx_scale_bar_border",p+=1),this.set_xy(O,I,this.xy.scale_height-1,p,S);var N=this.templates[this._mode+"_scale_date"](y,this._mode);O.innerHTML=N,this._waiAria.dayHeaderAttr(O,N),x.appendChild(O)},s._get_columns_num=function(h,p){var y=7;if(!s._table_view){var x=s.date["get_"+s._mode+"_end"];x&&(p=x(h)),y=Math.round((p.valueOf()-h.valueOf())/864e5)}return y},s._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))},s._get_view_end=function(){var h=this._get_timeunit_start(),p=s.date.add(h,1,this._mode);if(!s._table_view){var y=s.date["get_"+s._mode+"_end"];y&&(p=y(h))}return p},s._calc_scale_sizes=function(h,p,y){var x=this.config.rtl,S=h,O=this._get_columns_num(p,y);this._process_ignores(p,O,"day",1);for(var I=O-this._ignores_detected,N=0;N<O;N++)this._ignores[N]?(this._cols[N]=0,I++):this._cols[N]=Math.floor(S/(I-N)),S-=this._cols[N],this._colsS[N]=(this._cols[N-1]||0)+(this._colsS[N-1]||(this._table_view?0:x?this.xy.scroll_width:this.xy.scale_width));this._colsS.col_length=O,this._colsS[O]=this._cols[O-1]+this._colsS[O-1]||0},s._set_scale_col_size=function(h,p,y){var x=this.config;this.set_xy(h,p,x.hour_size_px*(x.last_hour-x.first_hour),y+this.xy.scale_width+1,0)},s._render_scales=function(h,p){var y=new Date(s._min_date),x=new Date(s._max_date),S=this.date.date_part(s._currentDate()),O=parseInt(h.style.width,10)-1,I=new Date(this._min_date),N=this._get_columns_num(y,x);this._calc_scale_sizes(O,y,x);var A=0;h.innerHTML="";for(var m=0;m<N;m++){if(this._ignores[m]||this._render_x_header(m,A,I,h),!this._table_view){var b=document.createElement("div"),E="dhx_scale_holder";I.valueOf()==S.valueOf()&&(E+=" dhx_scale_holder_now"),b.setAttribute("data-column-index",m),this._ignores_detected&&this._ignores[m]&&(E+=" dhx_scale_ignore");for(let k=1*this.config.first_hour;k<this.config.last_hour;k++){const D=document.createElement("div");D.className="dhx_scale_time_slot dhx_scale_time_slot_hour_start",D.style.height=this.config.hour_size_px/2+"px";let C=new Date(I.getFullYear(),I.getMonth(),I.getDate(),k,0);D.setAttribute("data-slot-date",this.templates.format_date(C));let R=this.templates.time_slot_text(C);R&&(D.innerHTML=R);let P=this.templates.time_slot_class(C);P&&D.classList.add(P),b.appendChild(D);const U=document.createElement("div");U.className="dhx_scale_time_slot",C=new Date(I.getFullYear(),I.getMonth(),I.getDate(),k,30),U.setAttribute("data-slot-date",this.templates.format_date(C)),U.style.height=this.config.hour_size_px/2+"px",R=this.templates.time_slot_text(C),R&&(U.innerHTML=R),P=this.templates.time_slot_class(C),P&&U.classList.add(P),b.appendChild(U)}b.className=E+" "+this.templates.week_date_class(I,S),this._waiAria.dayColumnAttr(b,I),this._set_scale_col_size(b,this._cols[m],A),p.appendChild(b),this.callEvent("onScaleAdd",[b,I])}A+=this._cols[m],I=this.date.add(I,1,"day"),I=this.date.day_start(I)}},s._getNavDateElement=function(){return this.$container.querySelector(".dhx_cal_date")},s._reset_scale=function(){if(this.templates[this._mode+"_date"]){var h=this._els.dhx_cal_header[0],p=this._els.dhx_cal_data[0],y=this.config;h.innerHTML="",p.innerHTML="";var x,S,O=(y.readonly||!y.drag_resize?" dhx_resize_denied":"")+(y.readonly||!y.drag_move?" dhx_move_denied":"");p.className="dhx_cal_data"+O,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes();var I=this._get_timeunit_start(),N=s._get_view_end();x=S=this._table_view?s.date.week_start(I):I,this._min_date=x;var A=this.templates[this._mode+"_date"](I,N,this._mode),m=this._getNavDateElement();if(m&&(m.innerHTML=A,this._waiAria.navBarDateAttr(m,A)),this._max_date=N,s._render_scales(h,p),this._table_view)this._reset_month_scale(p,I,S);else if(this._reset_hours_scale(p,I,S),y.multi_day){var b="dhx_multi_day";this._els[b]&&(this._els[b][0].parentNode.removeChild(this._els[b][0]),this._els[b]=null);var E=document.createElement("div");E.className=b,E.style.visibility="hidden",E.style.display="none";var k=this._colsS[this._colsS.col_length],D=y.rtl?this.xy.scale_width:this.xy.scroll_width,C=Math.max(k+D,0);this.set_xy(E,C,0,0),p.parentNode.insertBefore(E,p);var R=E.cloneNode(!0);R.className=b+"_icon",R.style.visibility="hidden",R.style.display="none",this.set_xy(R,this.xy.scale_width+1,0,0),E.appendChild(R),this._els[b]=[E,R],s.event(this._els[b][0],"click",this._click.dhx_cal_data)}}},s._reset_hours_scale=function(h,p,y){var x=document.createElement("div");x.className="dhx_scale_holder";for(var S=new Date(1980,1,1,this.config.first_hour,0,0),O=1*this.config.first_hour;O<this.config.last_hour;O++){var I=document.createElement("div");I.className="dhx_scale_hour",I.style.height=this.config.hour_size_px+"px";var N=this.xy.scale_width;this.config.left_border&&(I.className+=" dhx_scale_hour_border"),I.style.width=N+"px";var A=s.templates.hour_scale(S);I.innerHTML=A,this._waiAria.hourScaleAttr(I,A),x.appendChild(I),S=this.date.add(S,1,"hour")}h.appendChild(x),this.config.scroll_hour&&(h.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))},s._currentDate=function(){return s.config.now_date?new Date(s.config.now_date):new Date},s._reset_ignores=function(){this._ignores={},this._ignores_detected=0},s._process_ignores=function(h,p,y,x,S){this._reset_ignores();var O=s["ignore_"+this._mode];if(O)for(var I=new Date(h),N=0;N<p;N++)O(I)&&(this._ignores_detected+=1,this._ignores[N]=!0,S&&p++),I=s.date.add(I,x,y),s.date[y+"_start"]&&(I=s.date[y+"_start"](I))},s._render_month_scale=function(h,p,y,x){var S=s.date.add(p,1,"month"),O=new Date(y),I=s._currentDate();I=this.date.date_part(I),y=this.date.date_part(y),x=x||Math.ceil(Math.round((S.valueOf()-y.valueOf())/864e5)/7);for(var N=[],A=0;A<=7;A++){var m=this._cols[A]||0;isNaN(Number(m))||(m+="px"),N[A]=m}function b(Q){var W=s._colsS.height;return s._colsS.heights[Q+1]!==void 0&&(W=s._colsS.heights[Q+1]-(s._colsS.heights[Q]||0)),W}var E=0;const k=document.createElement("div");for(k.classList.add("dhx_cal_month_table"),A=0;A<x;A++){var D=document.createElement("div");D.classList.add("dhx_cal_month_row"),D.style.height=b(A)+"px",k.appendChild(D);for(var C=0;C<7;C++){var R=document.createElement("div");D.appendChild(R);var P="dhx_cal_month_cell";y<p?P+=" dhx_before":y>=S?P+=" dhx_after":y.valueOf()==I.valueOf()&&(P+=" dhx_now"),this._ignores_detected&&this._ignores[C]&&(P+=" dhx_scale_ignore"),R.className=P+" "+this.templates.month_date_class(y,I),R.setAttribute("data-cell-date",s.templates.format_date(y));var U="dhx_month_body",q="dhx_month_head";if(C===0&&this.config.left_border&&(U+=" dhx_month_body_border",q+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[C])R.appendChild(document.createElement("div")),R.appendChild(document.createElement("div"));else{R.style.width=N[C],this._waiAria.monthCellAttr(R,y);var $=document.createElement("div");$.style.height=s.xy.month_head_height+"px",$.className=q,$.innerHTML=this.templates.month_day(y),R.appendChild($);var ee=document.createElement("div");ee.className=U,R.appendChild(ee)}var ie=y.getDate();(y=this.date.add(y,1,"day")).getDate()-ie>1&&(y=new Date(y.getFullYear(),y.getMonth(),ie+1,12,0))}s._colsS.heights[A]=E,E+=b(A)}return this._min_date=O,this._max_date=y,h.innerHTML="",h.appendChild(k),this._scales={},h.querySelectorAll("[data-cell-date]").forEach(Q=>{const W=s.templates.parse_date(Q.getAttribute("data-cell-date")),J=Q.querySelector(".dhx_month_body");this._scales[+W]=J,this.callEvent("onScaleAdd",[this._scales[+W],W])}),this._max_date},s._reset_month_scale=function(h,p,y,x){var S=s.date.add(p,1,"month");y=this.date.date_part(y),x=x||Math.ceil(Math.round((S.valueOf()-y.valueOf())/864e5)/7);var O=Math.floor(h.clientHeight/x)-this.xy.month_head_height;return this._colsS.height=O+this.xy.month_head_height,this._colsS.heights=[],s._render_month_scale(h,p,y,x)},s.getView=function(h){return h||(h=s.getState().mode),s.matrix&&s.matrix[h]?s.matrix[h]:s._props&&s._props[h]?s._props[h]:null},s.getLabel=function(h,p){for(var y=this.config.lightbox.sections,x=0;x<y.length;x++)if(y[x].map_to==h){for(var S=y[x].options,O=0;O<S.length;O++)if(S[O].key==p)return S[O].label}return""},s.updateCollection=function(h,p){var y=s.serverList(h);return!!y&&(y.splice(0,y.length),y.push.apply(y,p||[]),s.callEvent("onOptionsLoad",[]),s.resetLightbox(),s.hideCover(),!0)},s._lame_clone=function(h,p){var y,x,S;for(p=p||[],y=0;y<p.length;y+=2)if(h===p[y])return p[y+1];if(h&&typeof h=="object"){for(S=Object.create(h),x=[Array,Date,Number,String,Boolean],y=0;y<x.length;y++)h instanceof x[y]&&(S=y?new x[y](h):new x[y]);for(y in p.push(h,S),h)Object.prototype.hasOwnProperty.apply(h,[y])&&(S[y]=s._lame_clone(h[y],p))}return S||h},s._lame_copy=function(h,p){for(var y in p)p.hasOwnProperty(y)&&(h[y]=p[y]);return h},s._get_date_from_pos=function(h){var p=this._min_date.valueOf()+6e4*(h.y*this.config.time_step+24*(this._table_view?0:h.x)*60);return new Date(this._correct_shift(p))},s.getActionData=function(h){var p=this._mouse_coords(h);return{date:this._get_date_from_pos(p),section:p.section}},s._focus=function(h,p){if(h&&h.focus)if(this._mobile)window.setTimeout(function(){h.focus()},10);else try{p&&h.select&&h.offsetWidth&&h.select(),h.focus()}catch{}},s._get_real_event_length=function(h,p,y){var x,S=p-h,O=this["ignore_"+this._mode],I=0;y.render?(I=this._get_date_index(y,h),x=this._get_date_index(y,p),h.valueOf()<s.getState().min_date.valueOf()&&(I=-g(h,s.getState().min_date)),p.valueOf()>s.getState().max_date.valueOf()&&(x+=g(p,s.getState().max_date))):x=Math.round(S/60/60/1e3/24);for(var N=!0;I<x;){var A=s.date.add(p,-y.x_step,y.x_unit);if(O&&O(p)&&(!N||N&&O(A)))S-=p-A;else{let m=0;const b=new Date(Math.max(A.valueOf(),h.valueOf())),E=p,k=new Date(b.getFullYear(),b.getMonth(),b.getDate(),y.first_hour||0),D=new Date(b.getFullYear(),b.getMonth(),b.getDate(),y.last_hour||24),C=new Date(p.getFullYear(),p.getMonth(),p.getDate(),y.first_hour||0),R=new Date(p.getFullYear(),p.getMonth(),p.getDate(),y.last_hour||24);E.valueOf()>R.valueOf()&&(m+=E-R),E.valueOf()>C.valueOf()?m+=y._start_correction:m+=60*E.getHours()*60*1e3+60*E.getMinutes()*1e3,b.valueOf()<=D.valueOf()&&(m+=y._end_correction),b.valueOf()<k.valueOf()&&(m+=k.valueOf()-b.valueOf()),S-=m,N=!1}p=A,x--}return S},s._get_fictional_event_length=function(h,p,y,x){var S=new Date(h),O=x?-1:1;if(y._start_correction||y._end_correction){var I;I=x?60*S.getHours()+S.getMinutes()-60*(y.first_hour||0):60*(y.last_hour||0)-(60*S.getHours()+S.getMinutes());var N=60*(y.last_hour-y.first_hour),A=Math.ceil((p/6e4-I)/N);A<0&&(A=0),p+=A*(1440-N)*60*1e3}var m,b=new Date(1*h+p*O),E=this["ignore_"+this._mode],k=0;for(y.render?(k=this._get_date_index(y,S),m=this._get_date_index(y,b)):m=Math.round(p/60/60/1e3/24);y.x_unit==="day"?k*O<m*O:k*O<=m*O;){var D=s.date.add(S,y.x_step*O,y.x_unit);E&&E(S)&&(p+=(D-S)*O,m+=O),S=D,k+=O}return p},s._get_section_view=function(){return this.getView()},s._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null},s._is_initialized=function(){var h=this.getState();return this._obj&&h.date&&h.mode},s._is_lightbox_open=function(){var h=this.getState();return h.lightbox_id!==null&&h.lightbox_id!==void 0}}(t),function(s){(function(){var d=new RegExp(`<(?:.|
)*?>`,"gm"),c=new RegExp(" +","gm");function u(h){return(h+"").replace(d," ").replace(c," ")}var f=new RegExp("'","gm");function v(h){return(h+"").replace(f,"&#39;")}for(var g in s._waiAria={getAttributeString:function(h){var p=[" "];for(var y in h)if(typeof h[y]!="function"&&typeof h[y]!="object"){var x=v(u(h[y]));p.push(y+"='"+x+"'")}return p.push(" "),p.join(" ")},setAttributes:function(h,p){for(var y in p)h.setAttribute(y,u(p[y]));return h},labelAttr:function(h,p){return this.setAttributes(h,{"aria-label":p})},label:function(h){return s._waiAria.getAttributeString({"aria-label":h})},hourScaleAttr:function(h,p){this.labelAttr(h,p)},monthCellAttr:function(h,p){this.labelAttr(h,s.templates.day_date(p))},navBarDateAttr:function(h,p){this.labelAttr(h,p)},dayHeaderAttr:function(h,p){this.labelAttr(h,p)},dayColumnAttr:function(h,p){this.dayHeaderAttr(h,s.templates.day_date(p))},headerButtonsAttributes:function(h,p){return this.setAttributes(h,{role:"button","aria-label":p})},headerToggleState:function(h,p){return this.setAttributes(h,{"aria-pressed":p?"true":"false"})},getHeaderCellAttr:function(h){return s._waiAria.getAttributeString({"aria-label":h})},eventAttr:function(h,p){this._eventCommonAttr(h,p)},_eventCommonAttr:function(h,p){p.setAttribute("aria-label",u(s.templates.event_text(h.start_date,h.end_date,h))),s.config.readonly&&p.setAttribute("aria-readonly",!0),h.$dataprocessor_class&&p.setAttribute("aria-busy",!0),p.setAttribute("aria-selected",s.getState().select_id==h.id?"true":"false")},setEventBarAttr:function(h,p){this._eventCommonAttr(h,p)},_getAttributes:function(h,p){var y={setAttribute:function(x,S){this[x]=S}};return h.apply(this,[p,y]),y},eventBarAttrString:function(h){return this.getAttributeString(this._getAttributes(this.setEventBarAttr,h))},agendaHeadAttrString:function(){return this.getAttributeString({role:"row"})},agendaHeadDateString:function(h){return this.getAttributeString({role:"columnheader","aria-label":h})},agendaHeadDescriptionString:function(h){return this.agendaHeadDateString(h)},agendaDataAttrString:function(){return this.getAttributeString({role:"grid"})},agendaEventAttrString:function(h){var p=this._getAttributes(this._eventCommonAttr,h);return p.role="row",this.getAttributeString(p)},agendaDetailsBtnString:function(){return this.getAttributeString({role:"button","aria-label":s.locale.labels.icon_details})},gridAttrString:function(){return this.getAttributeString({role:"grid"})},gridRowAttrString:function(h){return this.agendaEventAttrString(h)},gridCellAttrString:function(h,p,y){return this.getAttributeString({role:"gridcell","aria-label":[p.label===void 0?p.id:p.label,": ",y]})},mapAttrString:function(){return this.gridAttrString()},mapRowAttrString:function(h){return this.gridRowAttrString(h)},mapDetailsBtnString:function(){return this.agendaDetailsBtnString()},minicalHeader:function(h,p){this.setAttributes(h,{id:p+"","aria-live":"assertice","aria-atomic":"true"})},minicalGrid:function(h,p){this.setAttributes(h,{"aria-labelledby":p+"",role:"grid"})},minicalRow:function(h){this.setAttributes(h,{role:"row"})},minicalDayCell:function(h,p){var y=p.valueOf()<s._max_date.valueOf()&&p.valueOf()>=s._min_date.valueOf();this.setAttributes(h,{role:"gridcell","aria-label":s.templates.day_date(p),"aria-selected":y?"true":"false"})},minicalHeadCell:function(h){this.setAttributes(h,{role:"columnheader"})},weekAgendaDayCell:function(h,p){var y=h.querySelector(".dhx_wa_scale_bar"),x=h.querySelector(".dhx_wa_day_data"),S=s.uid()+"";this.setAttributes(y,{id:S}),this.setAttributes(x,{"aria-labelledby":S})},weekAgendaEvent:function(h,p){this.eventAttr(p,h)},lightboxHiddenAttr:function(h){h.setAttribute("aria-hidden","true")},lightboxVisibleAttr:function(h){h.setAttribute("aria-hidden","false")},lightboxSectionButtonAttrString:function(h){return this.getAttributeString({role:"button","aria-label":h,tabindex:"0"})},yearHeader:function(h,p){this.setAttributes(h,{id:p+""})},yearGrid:function(h,p){this.minicalGrid(h,p)},yearHeadCell:function(h){return this.minicalHeadCell(h)},yearRow:function(h){return this.minicalRow(h)},yearDayCell:function(h){this.setAttributes(h,{role:"gridcell"})},lightboxAttr:function(h){h.setAttribute("role","dialog"),h.setAttribute("aria-hidden","true"),h.firstChild.setAttribute("role","heading")},lightboxButtonAttrString:function(h){return this.getAttributeString({role:"button","aria-label":s.locale.labels[h],tabindex:"0"})},eventMenuAttrString:function(h){return this.getAttributeString({role:"button","aria-label":s.locale.labels[h]})},lightboxHeader:function(h,p){h.setAttribute("aria-label",p)},lightboxSelectAttrString:function(h){var p="";switch(h){case"%Y":p=s.locale.labels.year;break;case"%m":p=s.locale.labels.month;break;case"%d":p=s.locale.labels.day;break;case"%H:%i":p=s.locale.labels.hour+" "+s.locale.labels.minute}return s._waiAria.getAttributeString({"aria-label":p})},messageButtonAttrString:function(h){return"tabindex='0' role='button' aria-label='"+h+"'"},messageInfoAttr:function(h){h.setAttribute("role","alert")},messageModalAttr:function(h,p){h.setAttribute("role","dialog"),p&&h.setAttribute("aria-labelledby",p)},quickInfoAttr:function(h){h.setAttribute("role","dialog")},quickInfoHeaderAttrString:function(){return" role='heading' "},quickInfoHeader:function(h,p){h.setAttribute("aria-label",p)},quickInfoButtonAttrString:function(h){return s._waiAria.getAttributeString({role:"button","aria-label":h,tabindex:"0"})},tooltipAttr:function(h){h.setAttribute("role","tooltip")},tooltipVisibleAttr:function(h){h.setAttribute("aria-hidden","false")},tooltipHiddenAttr:function(h){h.setAttribute("aria-hidden","true")}},s._waiAria)s._waiAria[g]=function(h){return function(){return s.config.wai_aria_attributes?h.apply(this,arguments):" "}}(s._waiAria[g])})()}(t),t.utils=tt,t.$domHelpers=kt,t.utils.dom=kt,t.uid=tt.uid,t.mixin=tt.mixin,t.defined=tt.defined,t.assert=function(s){return function(d,c){d||s.config.show_errors&&s.callEvent("onError",[c])!==!1&&(s.message?s.message({type:"error",text:c,expire:-1}):console.log(c))}}(t),t.copy=tt.copy,t._createDatePicker=function(s,d){return new Ou(t,s,d)},t._getFocusableNodes=kt.getFocusableNodes,t._getClassName=kt.getClassName,t._locate_css=kt.locateCss;const n=nu(t);var r,a,i;t.utils.mixin(t,n),t.env=t.$env=G_,t.Promise=window.Promise,function(s){s.destructor=function(){for(var d in s.callEvent("onDestroy",[]),this.clearAll(),this.$container&&(this.$container.innerHTML=""),this._eventRemoveAll&&this._eventRemoveAll(),this.resetLightbox&&this.resetLightbox(),this._dp&&this._dp.destructor&&this._dp.destructor(),this.detachAllEvents(),this)d.indexOf("$")===0&&delete this[d];s.$destroyed=!0}}(t),function(s){function d(c,u){var f={method:c};if(u.length===0)throw new Error("Arguments list of query is wrong.");if(u.length===1)return typeof u[0]=="string"?(f.url=u[0],f.async=!0):(f.url=u[0].url,f.async=u[0].async||!0,f.callback=u[0].callback,f.headers=u[0].headers),u[0].data?typeof u[0].data!="string"?f.data=Ga(u[0].data):f.data=u[0].data:f.data="",f;switch(f.url=u[0],c){case"GET":case"DELETE":f.callback=u[1],f.headers=u[2];break;case"POST":case"PUT":u[1]?typeof u[1]!="string"?f.data=Ga(u[1]):f.data=u[1]:f.data="",f.callback=u[2],f.headers=u[3]}return f}s.Promise=window.Promise,s.ajax={cache:!0,method:"get",serializeRequestParams:Ga,parse:function(c){return typeof c!="string"?c:(c=c.replace(/^[\s]+/,""),typeof DOMParser>"u"||s.$env.isIE?window.ActiveXObject!==void 0&&((u=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",u.loadXML(c)):u=new DOMParser().parseFromString(c,"text/xml"),u);var u},xmltop:function(c,u,f){if(u.status===void 0||u.status<400){var v=u.responseXML?u.responseXML||u:this.parse(u.responseText||u);if(v&&v.documentElement!==null&&!v.getElementsByTagName("parsererror").length)return v.getElementsByTagName(c)[0]}return f!==-1&&s.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],f]),document.createElement("DIV")},xpath:function(c,u){if(u.nodeName||(u=u.responseXML||u),s.$env.isIE)return u.selectNodes(c)||[];for(var f,v=[],g=(u.ownerDocument||u).evaluate(c,u,null,XPathResult.ANY_TYPE,null);f=g.iterateNext();)v.push(f);return v},query:function(c){return this._call(c.method||"GET",c.url,c.data||"",c.async||!0,c.callback,c.headers)},get:function(c,u,f){var v=d("GET",arguments);return this.query(v)},getSync:function(c,u){var f=d("GET",arguments);return f.async=!1,this.query(f)},put:function(c,u,f,v){var g=d("PUT",arguments);return this.query(g)},del:function(c,u,f){var v=d("DELETE",arguments);return this.query(v)},post:function(c,u,f,v){arguments.length==1?u="":arguments.length==2&&typeof u=="function"&&(f=u,u="");var g=d("POST",arguments);return this.query(g)},postSync:function(c,u,f){u=u===null?"":String(u);var v=d("POST",arguments);return v.async=!1,this.query(v)},_call:function(c,u,f,v,g,h){return new s.Promise((function(p,y){var x=typeof XMLHttpRequest===void 0||s.$env.isIE?new window.ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,S=navigator.userAgent.match(/AppleWebKit/)!==null&&navigator.userAgent.match(/Qt/)!==null&&navigator.userAgent.match(/Safari/)!==null;if(v&&x.addEventListener("readystatechange",function(){if(x.readyState==4||S&&x.readyState==3){if((x.status!=200||x.responseText==="")&&!s.callEvent("onAjaxError",[x]))return;setTimeout(function(){typeof g=="function"&&g.apply(window,[{xmlDoc:x,filePath:u}]),p(x),typeof g=="function"&&(g=null,x=null)},0)}}),c!="GET"||this.cache||(u+=(u.indexOf("?")>=0?"&":"?")+"dhxr"+new Date().getTime()+"=1"),x.open(c,u,v),h)for(var O in h)x.setRequestHeader(O,h[O]);else c.toUpperCase()=="POST"||c=="PUT"||c=="DELETE"?x.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):c=="GET"&&(f=null);if(x.setRequestHeader("X-Requested-With","XMLHttpRequest"),x.send(f),!v)return{xmlDoc:x,filePath:u}}).bind(this))},urlSeparator:function(c){return c.indexOf("?")!=-1?"&":"?"}},s.$ajax=s.ajax}(t),J_(t),function(s){s.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D %j",hour_date:"%H:%i",month_day:"%d",date_format:"%Y-%m-%d %H:%i",api_date:"%d-%m-%Y %H:%i",parse_exact_format:!1,preserve_length:!0,time_step:5,displayed_event_color:"#ff4a4a",displayed_event_text_color:"#ffef80",wide_form:0,day_column_padding:8,use_select_menu_space:!0,fix_tab_position:!0,start_on_monday:!0,first_hour:0,last_hour:24,readonly:!1,drag_resize:!0,drag_move:!0,drag_create:!0,drag_event_body:!0,dblclick_create:!0,details_on_dblclick:!0,edit_on_create:!0,details_on_create:!0,header:null,hour_size_px:44,resize_month_events:!1,resize_month_timed:!1,responsive_lightbox:!1,separate_short_events:!0,rtl:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:200,drag_lightbox:!0,preserve_scroll:!0,select:!0,undo_deleted:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,touch_swipe_dates:!1,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_right:["dhx_save_btn","dhx_cancel_btn"],buttons_left:["dhx_delete_btn"],lightbox:{sections:[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1,ajax_error:"alert",delay_render:0,timeline_swap_resize:!0,wai_aria_attributes:!0,wai_aria_application_role:!0,csp:"auto",event_attribute:"data-event-id",show_errors:!0},s.config.buttons_left.$initial=s.config.buttons_left.join(),s.config.buttons_right.$initial=s.config.buttons_right.join(),s._helpers={parseDate:function(d){return(s.templates.xml_date||s.templates.parse_date)(d)},formatDate:function(d){return(s.templates.xml_format||s.templates.format_date)(d)}},s.templates={},s.init_templates=function(){var d=s.date.date_to_str,c=s.config;(function(u,f){for(var v in f)u[v]||(u[v]=f[v])})(s.templates,{day_date:d(c.default_date),month_date:d(c.month_date),week_date:function(u,f){return c.rtl?s.templates.day_date(s.date.add(f,-1,"day"))+" &ndash; "+s.templates.day_date(u):s.templates.day_date(u)+" &ndash; "+s.templates.day_date(s.date.add(f,-1,"day"))},day_scale_date:d(c.default_date),time_slot_text:function(u){return""},time_slot_class:function(u){return""},month_scale_date:d(c.week_date),week_scale_date:d(c.day_date),hour_scale:d(c.hour_date),time_picker:d(c.hour_date),event_date:d(c.hour_date),month_day:d(c.month_day),load_format:d(c.load_date),format_date:d(c.date_format,c.server_utc),parse_date:s.date.str_to_date(c.date_format,c.server_utc),api_date:s.date.str_to_date(c.api_date,!1,!1),event_header:function(u,f,v){return v._mode==="small"||v._mode==="smallest"?s.templates.event_date(u):s.templates.event_date(u)+" - "+s.templates.event_date(f)},event_text:function(u,f,v){return v.text},event_class:function(u,f,v){return""},month_date_class:function(u){return""},week_date_class:function(u){return""},event_bar_date:function(u,f,v){return s.templates.event_date(u)},event_bar_text:function(u,f,v){return v.text},month_events_link:function(u,f){return"<a>View more("+f+" events)</a>"},drag_marker_class:function(u,f,v){return""},drag_marker_content:function(u,f,v){return""},tooltip_date_format:s.date.date_to_str("%Y-%m-%d %H:%i"),tooltip_text:function(u,f,v){return"<b>Event:</b> "+v.text+"<br/><b>Start date:</b> "+s.templates.tooltip_date_format(u)+"<br/><b>End date:</b> "+s.templates.tooltip_date_format(f)},calendar_month:d("%F %Y"),calendar_scale_date:d("%D"),calendar_date:d("%d"),calendar_time:d("%d-%m-%Y")}),this.callEvent("onTemplatesReady",[])}}(t),function(s){s._events={},s.clearAll=function(){this._events={},this._loaded={},this._edit_id=null,this._select_id=null,this._drag_id=null,this._drag_mode=null,this._drag_pos=null,this._new_event=null,this.clear_view(),this.callEvent("onClearAll",[])},s.addEvent=function(d,c,u,f,v){if(!arguments.length)return this.addEventNow();var g=d;arguments.length!=1&&((g=v||{}).start_date=d,g.end_date=c,g.text=u,g.id=f),g.id=g.id||s.uid(),g.text=g.text||"",typeof g.start_date=="string"&&(g.start_date=this.templates.api_date(g.start_date)),typeof g.end_date=="string"&&(g.end_date=this.templates.api_date(g.end_date));var h=6e4*(this.config.event_duration||this.config.time_step);g.start_date.valueOf()==g.end_date.valueOf()&&g.end_date.setTime(g.end_date.valueOf()+h),g.start_date.setMilliseconds(0),g.end_date.setMilliseconds(0),g._timed=this.isOneDayEvent(g);var p=!this._events[g.id];return this._events[g.id]=g,this.event_updated(g),this._loading||this.callEvent(p?"onEventAdded":"onEventChanged",[g.id,g]),g.id},s.deleteEvent=function(d,c){var u=this._events[d];(c||this.callEvent("onBeforeEventDelete",[d,u])&&this.callEvent("onConfirmedBeforeEventDelete",[d,u]))&&(u&&(s.getState().select_id==d&&s.unselect(),delete this._events[d],this.event_updated(u),this._drag_id==u.id&&(this._drag_id=null,this._drag_mode=null,this._drag_pos=null)),this.callEvent("onEventDeleted",[d,u]))},s.getEvent=function(d){return this._events[d]},s.setEvent=function(d,c){c.id||(c.id=d),this._events[d]=c},s.for_rendered=function(d,c){for(var u=this._rendered.length-1;u>=0;u--)this._rendered[u].getAttribute(this.config.event_attribute)==d&&c(this._rendered[u],u)},s.changeEventId=function(d,c){if(d!=c){var u=this._events[d];u&&(u.id=c,this._events[c]=u,delete this._events[d]),this.for_rendered(d,function(f){f.setAttribute("event_id",c),f.setAttribute(s.config.event_attribute,c)}),this._select_id==d&&(this._select_id=c),this._edit_id==d&&(this._edit_id=c),this.callEvent("onEventIdChange",[d,c])}},function(){for(var d=["text","Text","start_date","StartDate","end_date","EndDate"],c=function(v){return function(g){return s.getEvent(g)[v]}},u=function(v){return function(g,h){var p=s.getEvent(g);p[v]=h,p._changed=!0,p._timed=this.isOneDayEvent(p),s.event_updated(p,!0)}},f=0;f<d.length;f+=2)s["getEvent"+d[f+1]]=c(d[f]),s["setEvent"+d[f+1]]=u(d[f])}(),s.event_updated=function(d,c){this.is_visible_events(d)?this.render_view_data():this.clear_event(d.id)},s.is_visible_events=function(d){if(!this._min_date||!this._max_date)return!1;if(d.start_date.valueOf()<this._max_date.valueOf()&&this._min_date.valueOf()<d.end_date.valueOf()){var c=d.start_date.getHours(),u=d.end_date.getHours()+d.end_date.getMinutes()/60,f=this.config.last_hour,v=this.config.first_hour;return!(!this._table_view&&(u>f||u<=v)&&(c>=f||c<v)&&!((d.end_date.valueOf()-d.start_date.valueOf())/36e5>24-(this.config.last_hour-this.config.first_hour)||c<f&&u>v))}return!1},s.isOneDayEvent=function(d){var c=new Date(d.end_date.valueOf()-1);return d.start_date.getFullYear()===c.getFullYear()&&d.start_date.getMonth()===c.getMonth()&&d.start_date.getDate()===c.getDate()&&d.end_date.valueOf()-d.start_date.valueOf()<864e5},s.get_visible_events=function(d){var c=[];for(var u in this._events)this.is_visible_events(this._events[u])&&(d&&!this._events[u]._timed||this.filter_event(u,this._events[u])&&c.push(this._events[u]));return c},s.filter_event=function(d,c){var u=this["filter_"+this._mode];return!u||u(d,c)},s._is_main_area_event=function(d){return!!d._timed},s.render_view_data=function(d,c){var u=!1;if(!d){if(u=!0,this._not_render)return void(this._render_wait=!0);this._render_wait=!1,this.clear_view(),d=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(var f=0,v=d.length;f<v;f++)this._recalculate_timed(d[f]);if(this.config.multi_day&&!this._table_view){var g=[],h=[];for(f=0;f<d.length;f++)this._is_main_area_event(d[f])?g.push(d[f]):h.push(d[f]);if(!this._els.dhx_multi_day){var p=s._commonErrorMessages.unknownView(this._mode);throw new Error(p)}this._rendered_location=this._els.dhx_multi_day[0],this._table_view=!0,this.render_data(h,c),this._table_view=!1,this._rendered_location=this._els.dhx_cal_data[0],this._table_view=!1,this.render_data(g,c)}else{var y=document.createDocumentFragment(),x=this._els.dhx_cal_data[0];this._rendered_location=y,this.render_data(d,c),x.appendChild(y),this._rendered_location=x}u&&this.callEvent("onDataRender",[])},s._view_month_day=function(d){var c=s.getActionData(d).date;s.callEvent("onViewMoreClick",[c])&&s.setCurrentView(c,"day")},s._render_month_link=function(d){for(var c=this._rendered_location,u=this._lame_clone(d),f=d._sday;f<d._eday;f++){u._sday=f,u._eday=f+1;var v=s.date,g=s._min_date;g=v.add(g,u._sweek,"week"),g=v.add(g,u._sday,"day");var h=s.getEvents(g,v.add(g,1,"day")).length,p=this._get_event_bar_pos(u),y=p.x2-p.x,x=document.createElement("div");s.event(x,"click",function(S){s._view_month_day(S)}),x.className="dhx_month_link",x.style.top=p.y+"px",x.style.left=p.x+"px",x.style.width=y+"px",x.innerHTML=s.templates.month_events_link(g,h),this._rendered.push(x),c.appendChild(x)}},s._recalculate_timed=function(d){var c;d&&(c=typeof d!="object"?this._events[d]:d)&&(c._timed=s.isOneDayEvent(c))},s.attachEvent("onEventChanged",s._recalculate_timed),s.attachEvent("onEventAdded",s._recalculate_timed),s.render_data=function(d,c){d=this._pre_render_events(d,c);for(var u={},f=0;f<d.length;f++)if(this._table_view)if(s._mode!="month")this.render_event_bar(d[f]);else{var v=s.config.max_month_events;v!==1*v||d[f]._sorder<v?this.render_event_bar(d[f]):v!==void 0&&d[f]._sorder==v&&s._render_month_link(d[f])}else{var g=d[f],h=s.locate_holder(g._sday);if(!h)continue;u[g._sday]||(u[g._sday]={real:h,buffer:document.createDocumentFragment(),width:h.clientWidth});var p=u[g._sday];this.render_event(g,p.buffer,p.width)}for(var f in u)(p=u[f]).real&&p.buffer&&p.real.appendChild(p.buffer)},s._get_first_visible_cell=function(d){for(var c=0;c<d.length;c++)if((d[c].className||"").indexOf("dhx_scale_ignore")==-1)return d[c];return d[0]},s._pre_render_events=function(d,c){var u=this.xy.bar_height,f=this._colsS.heights,v=this._colsS.heights=[0,0,0,0,0,0,0],g=this._els.dhx_cal_data[0];if(d=this._table_view?this._pre_render_events_table(d,c):this._pre_render_events_line(d,c),this._table_view)if(c)this._colsS.heights=f;else{var h=g.querySelectorAll(".dhx_cal_month_row");if(h.length){for(var p=0;p<h.length;p++){v[p]++;var y=h[p].querySelectorAll(".dhx_cal_month_cell"),x=this._colsS.height-this.xy.month_head_height;if(v[p]*u>x){var S=x;1*this.config.max_month_events!==this.config.max_month_events||v[p]<=this.config.max_month_events?S=v[p]*u:(this.config.max_month_events+1)*u>x&&(S=(this.config.max_month_events+1)*u),h[p].style.height=S+this.xy.month_head_height+"px"}v[p]=(v[p-1]||0)+s._get_first_visible_cell(y).offsetHeight}v.unshift(0);const D=this.$container.querySelector(".dhx_cal_data");if(D.offsetHeight<D.scrollHeight&&!s._colsS.scroll_fix&&s.xy.scroll_width){var O=s._colsS,I=O[O.col_length],N=O.heights.slice();I-=s.xy.scroll_width||0,this._calc_scale_sizes(I,this._min_date,this._max_date),s._colsS.heights=N,this.set_xy(this._els.dhx_cal_header[0],I),s._render_scales(this._els.dhx_cal_header[0]),s._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date),O.scroll_fix=!0}}else if(d.length||this._els.dhx_multi_day[0].style.visibility!="visible"||(v[0]=-1),d.length||v[0]==-1){var A=(v[0]+1)*u+4,m=A,b=A+"px";this.config.multi_day_height_limit&&(b=(m=Math.min(A,this.config.multi_day_height_limit))+"px");var E=this._els.dhx_multi_day[0];E.style.height=b,E.style.visibility=v[0]==-1?"hidden":"visible",E.style.display=v[0]==-1?"none":"";var k=this._els.dhx_multi_day[1];k.style.height=b,k.style.visibility=v[0]==-1?"hidden":"visible",k.style.display=v[0]==-1?"none":"",k.className=v[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small",this._dy_shift=(v[0]+1)*u,this.config.multi_day_height_limit&&(this._dy_shift=Math.min(this.config.multi_day_height_limit,this._dy_shift)),v[0]=0,m!=A&&(E.style.overflowY="auto",k.style.position="fixed",k.style.top="",k.style.left="")}}return d},s._get_event_sday=function(d){var c=this.date.day_start(new Date(d.start_date));return Math.round((c.valueOf()-this._min_date.valueOf())/864e5)},s._get_event_mapped_end_date=function(d){var c=d.end_date;if(this.config.separate_short_events){var u=(d.end_date-d.start_date)/6e4;u<this._min_mapped_duration&&(c=this.date.add(c,this._min_mapped_duration-u,"minute"))}return c},s._pre_render_events_line=function(d,c){d.sort(function(k,D){return k.start_date.valueOf()==D.start_date.valueOf()?k.id>D.id?1:-1:k.start_date>D.start_date?1:-1});var u=[],f=[];this._min_mapped_duration=Math.floor(60*this.xy.min_event_height/this.config.hour_size_px);for(var v=0;v<d.length;v++){var g=d[v],h=g.start_date,p=g.end_date,y=h.getHours(),x=p.getHours();if(g._sday=this._get_event_sday(g),this._ignores[g._sday])d.splice(v,1),v--;else{if(u[g._sday]||(u[g._sday]=[]),!c){g._inner=!1;for(var S=u[g._sday];S.length;){var O=S[S.length-1];if(!(this._get_event_mapped_end_date(O).valueOf()<=g.start_date.valueOf()))break;S.splice(S.length-1,1)}for(var I=S.length,N=!1,A=0;A<S.length;A++)if(O=S[A],this._get_event_mapped_end_date(O).valueOf()<=g.start_date.valueOf()){N=!0,g._sorder=O._sorder,I=A,g._inner=!0;break}if(S.length&&(S[S.length-1]._inner=!0),!N)if(S.length)if(S.length<=S[S.length-1]._sorder){if(S[S.length-1]._sorder)for(A=0;A<S.length;A++){for(var m=!1,b=0;b<S.length;b++)if(S[b]._sorder==A){m=!0;break}if(!m){g._sorder=A;break}}else g._sorder=0;g._inner=!0}else{var E=S[0]._sorder;for(A=1;A<S.length;A++)S[A]._sorder>E&&(E=S[A]._sorder);g._sorder=E+1,g._inner=!1}else g._sorder=0;S.splice(I,I==S.length?0:1,g),S.length>(S.max_count||0)?(S.max_count=S.length,g._count=S.length):g._count=g._count?g._count:1}(y<this.config.first_hour||x>=this.config.last_hour)&&(f.push(g),d[v]=g=this._copy_event(g),y<this.config.first_hour&&(g.start_date.setHours(this.config.first_hour),g.start_date.setMinutes(0)),x>=this.config.last_hour&&(g.end_date.setMinutes(0),g.end_date.setHours(this.config.last_hour)),g.start_date>g.end_date||y==this.config.last_hour)&&(d.splice(v,1),v--)}}if(!c){for(v=0;v<d.length;v++)d[v]._count=u[d[v]._sday].max_count;for(v=0;v<f.length;v++)f[v]._count=u[f[v]._sday].max_count}return d},s._time_order=function(d){d.sort(function(c,u){return c.start_date.valueOf()==u.start_date.valueOf()?c._timed&&!u._timed?1:!c._timed&&u._timed?-1:c.id>u.id?1:-1:c.start_date>u.start_date?1:-1})},s._is_any_multiday_cell_visible=function(d,c,u){var f=this._cols.length,v=!1,g=d,h=!0,p=new Date(c);for(s.date.day_start(new Date(c)).valueOf()!=c.valueOf()&&(p=s.date.day_start(p),p=s.date.add(p,1,"day"));g<p;){h=!1;var y=this.locate_holder_day(g,!1,u)%f;if(!this._ignores[y]){v=!0;break}g=s.date.add(g,1,"day")}return h||v},s._pre_render_events_table=function(d,c){this._time_order(d);for(var u,f=[],v=[[],[],[],[],[],[],[]],g=this._colsS.heights,h=this._cols.length,p={},y=0;y<d.length;y++){var x=d[y],S=x.id;p[S]||(p[S]={first_chunk:!0,last_chunk:!0});var O=p[S],I=u||x.start_date,N=x.end_date;I<this._min_date&&(O.first_chunk=!1,I=this._min_date),N>this._max_date&&(O.last_chunk=!1,N=this._max_date);var A=this.locate_holder_day(I,!1,x);if(x._sday=A%h,!this._ignores[x._sday]||!x._timed){var m=this.locate_holder_day(N,!0,x)||h;if(x._eday=m%h||h,x._length=m-A,x._sweek=Math.floor((this._correct_shift(I.valueOf(),1)-this._min_date.valueOf())/(864e5*h)),s._is_any_multiday_cell_visible(I,N,x)){var b,E=v[x._sweek];for(b=0;b<E.length&&!(E[b]._eday<=x._sday);b++);if(x._sorder&&c||(x._sorder=b),x._sday+x._length<=h)u=null,f.push(x),E[b]=x,g[x._sweek]=E.length-1,x._first_chunk=O.first_chunk,x._last_chunk=O.last_chunk;else{var k=this._copy_event(x);k.id=x.id,k._length=h-x._sday,k._eday=h,k._sday=x._sday,k._sweek=x._sweek,k._sorder=x._sorder,k.end_date=this.date.add(I,k._length,"day"),k._first_chunk=O.first_chunk,O.first_chunk&&(O.first_chunk=!1),f.push(k),E[b]=k,u=k.end_date,g[x._sweek]=E.length-1,y--}}else u=null}}return f},s._copy_dummy=function(){var d=new Date(this.start_date),c=new Date(this.end_date);this.start_date=d,this.end_date=c},s._copy_event=function(d){return this._copy_dummy.prototype=d,new this._copy_dummy},s._rendered=[],s.clear_view=function(){for(var d=0;d<this._rendered.length;d++){var c=this._rendered[d];c.parentNode&&c.parentNode.removeChild(c)}this._rendered=[]},s.updateEvent=function(d){var c=this.getEvent(d);this.clear_event(d),c&&this.is_visible_events(c)&&this.filter_event(d,c)&&(this._table_view||this.config.multi_day||c._timed)&&(this.config.update_render?this.render_view_data():this.getState().mode!="month"||this.getState().drag_id||this.isOneDayEvent(c)?this.render_view_data([c],!0):this.render_view_data())},s.clear_event=function(d){this.for_rendered(d,function(c,u){c.parentNode&&c.parentNode.removeChild(c),s._rendered.splice(u,1)})},s._y_from_date=function(d){var c=60*d.getHours()+d.getMinutes();return Math.round((60*c*1e3-60*this.config.first_hour*60*1e3)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)},s._calc_event_y=function(d,c){c=c||0;var u=60*d.start_date.getHours()+d.start_date.getMinutes(),f=60*d.end_date.getHours()+d.end_date.getMinutes()||60*s.config.last_hour;return{top:this._y_from_date(d.start_date),height:Math.max(c,(f-u)*this.config.hour_size_px/60)}},s.render_event=function(d,c,u){var f=s.xy.menu_width,v=this.config.use_select_menu_space?0:f;if(!(d._sday<0)){var g=s.locate_holder(d._sday);if(g){c=c||g;var h=this._calc_event_y(d,s.xy.min_event_height),p=h.top,y=h.height,x=d._count||1,S=d._sorder||0;u=u||g.clientWidth,this.config.day_column_padding&&(u-=this.config.day_column_padding);var O=Math.floor((u-v)/x),I=S*O+1;if(d._inner||(O*=x-S),this.config.cascade_event_display){const R=this.config.cascade_event_count,P=this.config.cascade_event_margin;let U,q=(x-S-1)%R*P,$=S%R*P;x*P<u-this.config.day_column_padding?U=d._inner?q/2:0:(U=d._inner?q/3:0,I=$/3,x*P/2>u-this.config.day_column_padding&&(U=d._inner?q/R:0,I=$/R)),O=Math.floor(u-v-I-U)}d._mode=y<30?"smallest":y<42?"small":null;var N=this._render_v_bar(d,v+I,p,O,y,d._text_style,s.templates.event_header(d.start_date,d.end_date,d),s.templates.event_text(d.start_date,d.end_date,d));if(d._mode==="smallest"?N.classList.add("dhx_cal_event--xsmall"):d._mode==="small"&&N.classList.add("dhx_cal_event--small"),this._waiAria.eventAttr(d,N),this._rendered.push(N),c.appendChild(N),I=I+parseInt(this.config.rtl?g.style.right:g.style.left,10)+v,this._edit_id==d.id){N.style.zIndex=1,O=Math.max(O,s.xy.editor_width),(N=document.createElement("div")).setAttribute("event_id",d.id),N.setAttribute(this.config.event_attribute,d.id),this._waiAria.eventAttr(d,N),N.className="dhx_cal_event dhx_cal_editor",this.config.rtl&&I++,this.set_xy(N,O,y,I,p),d.color&&N.style.setProperty("--dhx-scheduler-event-background",d.color);var A=s.templates.event_class(d.start_date,d.end_date,d);A&&(N.className+=" "+A);var m=document.createElement("div");m.style.cssText+="overflow:hidden;height:100%",N.appendChild(m),this._els.dhx_cal_data[0].appendChild(N),this._rendered.push(N),m.innerHTML="<textarea class='dhx_cal_editor'>"+d.text+"</textarea>",this._editor=m.querySelector("textarea"),s.event(this._editor,"keydown",function(R){if(R.shiftKey)return!0;var P=R.keyCode;P==s.keys.edit_save&&s.editStop(!0),P==s.keys.edit_cancel&&s.editStop(!1),P!=s.keys.edit_save&&P!=s.keys.edit_cancel||R.preventDefault&&R.preventDefault()}),s.event(this._editor,"selectstart",function(R){return R.cancelBubble=!0,!0}),s._focus(this._editor,!0),this._els.dhx_cal_data[0].scrollLeft=0}if(this.xy.menu_width!==0&&this._select_id==d.id){this.config.cascade_event_display&&this._drag_mode&&(N.style.zIndex=1);for(var b,E=this.config["icons_"+(this._edit_id==d.id?"edit":"select")],k="",D=0;D<E.length;D++){const R=E[D];b=this._waiAria.eventMenuAttrString(R),k+=`<div class='dhx_menu_icon ${R}' title='${this.locale.labels[R]}' ${b}></div>`}var C=this._render_v_bar(d,I-f-1,p,f,null,"","<div class='dhx_menu_head'></div>",k,!0);d.color&&C.style.setProperty("--dhx-scheduler-event-background",d.color),d.textColor&&C.style.setProperty("--dhx-scheduler-event-color",d.textColor),this._els.dhx_cal_data[0].appendChild(C),this._rendered.push(C)}this.config.drag_highlight&&this._drag_id==d.id&&this.highlightEventPosition(d)}}},s._render_v_bar=function(d,c,u,f,v,g,h,p,y){var x=document.createElement("div"),S=d.id,O=y?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",I=s.getState();I.drag_id==d.id&&(O+=" dhx_cal_event_drag"),I.select_id==d.id&&(O+=" dhx_cal_event_selected");var N=s.templates.event_class(d.start_date,d.end_date,d);N&&(O=O+" "+N),this.config.cascade_event_display&&(O+=" dhx_cal_event_cascade");var A=f-1,m=`<div event_id="${S}" ${this.config.event_attribute}="${S}" class="${O}"
				style="position:absolute; top:${u}px; ${this.config.rtl?"right:":"left:"}${c}px; width:${A}px; height:${v}px; ${g||""}" 
				data-bar-start="${d.start_date.valueOf()}" data-bar-end="${d.end_date.valueOf()}">
				</div>`;x.innerHTML=m;var b=x.cloneNode(!0).firstChild;if(!y&&s.renderEvent(b,d,f,v,h,p))return d.color&&b.style.setProperty("--dhx-scheduler-event-background",d.color),d.textColor&&b.style.setProperty("--dhx-scheduler-event-color",d.textColor),b;b=x.firstChild,d.color&&b.style.setProperty("--dhx-scheduler-event-background",d.color),d.textColor&&b.style.setProperty("--dhx-scheduler-event-color",d.textColor);var E='<div class="dhx_event_move dhx_header" >&nbsp;</div>';E+='<div class="dhx_event_move dhx_title">'+h+"</div>",E+='<div class="dhx_body">'+p+"</div>";var k="dhx_event_resize dhx_footer";return(y||d._drag_resize===!1)&&(k="dhx_resize_denied "+k),E+='<div class="'+k+'" style=" width:'+(y?" margin-top:-1px;":"")+'" ></div>',b.innerHTML=E,b},s.renderEvent=function(){return!1},s.locate_holder=function(d){return this._mode=="day"?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[d]},s.locate_holder_day=function(d,c){var u=Math.floor((this._correct_shift(d,1)-this._min_date)/864e5);return c&&this.date.time_part(d)&&u++,u},s._get_dnd_order=function(d,c,u){if(!this._drag_event)return d;this._drag_event._orig_sorder?d=this._drag_event._orig_sorder:this._drag_event._orig_sorder=d;for(var f=c*d;f+c>u;)d--,f-=c;return Math.max(d,0)},s._get_event_bar_pos=function(d){var c=this.config.rtl,u=this._colsS,f=u[d._sday],v=u[d._eday];c&&(f=u[u.col_length]-u[d._eday]+u[0],v=u[u.col_length]-u[d._sday]+u[0]),v==f&&(v=u[d._eday+1]);var g=this.xy.bar_height,h=d._sorder;if(d.id==this._drag_id){var p=u.heights[d._sweek+1]-u.heights[d._sweek]-this.xy.month_head_height;h=s._get_dnd_order(h,g,p)}var y=h*g;return{x:f,x2:v,y:u.heights[d._sweek]+(u.height?this.xy.month_scale_height+2:2)+y}},s.render_event_bar=function(d){var c=this._rendered_location,u=this._get_event_bar_pos(d),f=u.y,v=u.x,g=u.x2,h="";if(g){var p=s.config.resize_month_events&&this._mode=="month"&&(!d._timed||s.config.resize_month_timed),y=document.createElement("div"),x=d.hasOwnProperty("_first_chunk")&&d._first_chunk,S=d.hasOwnProperty("_last_chunk")&&d._last_chunk,O=p&&(d._timed||x),I=p&&(d._timed||S),N=!0,A="dhx_cal_event_clear";d._timed&&!p||(N=!1,A="dhx_cal_event_line"),x&&(A+=" dhx_cal_event_line_start"),S&&(A+=" dhx_cal_event_line_end"),O&&(h+="<div class='dhx_event_resize dhx_event_resize_start'></div>"),I&&(h+="<div class='dhx_event_resize dhx_event_resize_end'></div>");var m=s.templates.event_class(d.start_date,d.end_date,d);m&&(A+=" "+m);var b=d.color?"--dhx-scheduler-event-background:"+d.color+";":"",E=d.textColor?"--dhx-scheduler-event-color:"+d.textColor+";":"",k=["position:absolute","top:"+f+"px","left:"+v+"px","width:"+(g-v-(N?1:0))+"px","height:"+(this.xy.bar_height-2)+"px",E,b,d._text_style||""].join(";"),D="<div event_id='"+d.id+"' "+this.config.event_attribute+"='"+d.id+"' class='"+A+"' style='"+k+"'"+this._waiAria.eventBarAttrString(d)+">";p&&(D+=h),s.getState().mode!="month"||d._beforeEventChangedFlag||(d=s.getEvent(d.id)),d._timed&&(D+=`<span class='dhx_cal_event_clear_date'>${s.templates.event_bar_date(d.start_date,d.end_date,d)}</span>`),D+="<div class='dhx_cal_event_line_content'>",D+=s.templates.event_bar_text(d.start_date,d.end_date,d)+"</div>",D+="</div>",D+="</div>",y.innerHTML=D,this._rendered.push(y.firstChild),c.appendChild(y.firstChild)}},s._locate_event=function(d){for(var c=null;d&&!c&&d.getAttribute;)c=d.getAttribute(this.config.event_attribute),d=d.parentNode;return c},s.edit=function(d){this._edit_id!=d&&(this.editStop(!1,d),this._edit_id=d,this.updateEvent(d))},s.editStop=function(d,c){if(!c||this._edit_id!=c){var u=this.getEvent(this._edit_id);u&&(d&&(u.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(u.id),this._edit_stop_event(u,d))}},s._edit_stop_event=function(d,c){this._new_event?(c?this.callEvent("onEventAdded",[d.id,d]):d&&this.deleteEvent(d.id,!0),this._new_event=null):c&&this.callEvent("onEventChanged",[d.id,d])},s.getEvents=function(d,c){var u=[];for(var f in this._events){var v=this._events[f];v&&(!d&&!c||v.start_date<c&&v.end_date>d)&&u.push(v)}return u},s.getRenderedEvent=function(d){if(d){for(var c=s._rendered,u=0;u<c.length;u++){var f=c[u];if(f.getAttribute(s.config.event_attribute)==d)return f}return null}},s.showEvent=function(d,c){d&&typeof d=="object"&&(c=d.mode,S=d.section,d=d.section);var u=typeof d=="number"||typeof d=="string"?s.getEvent(d):d;if(c=c||s._mode,u&&(!this.checkEvent("onBeforeEventDisplay")||this.callEvent("onBeforeEventDisplay",[u,c]))){var f=s.config.scroll_hour;s.config.scroll_hour=u.start_date.getHours();var v=s.config.preserve_scroll;s.config.preserve_scroll=!1;var g=u.color,h=u.textColor;if(s.config.highlight_displayed_event&&(u.color=s.config.displayed_event_color,u.textColor=s.config.displayed_event_text_color),s.setCurrentView(new Date(u.start_date),c),s.config.scroll_hour=f,s.config.preserve_scroll=v,s.matrix&&s.matrix[c]){var p=s.getView(),y=p.y_property,x=s.getEvent(u.id);if(x){if(!S){var S=x[y];Array.isArray(S)?S=S[0]:typeof S=="string"&&s.config.section_delimiter&&S.indexOf(s.config.section_delimiter)>-1&&(S=S.split(s.config.section_delimiter)[0])}var O=p.getSectionTop(S),I=p.posFromDate(x.start_date),N=s.$container.querySelector(".dhx_timeline_data_wrapper");if(I-=(N.offsetWidth-p.dx)/2,O=O-N.offsetHeight/2+p.dy/2,p._smartRenderingEnabled())var A=p.attachEvent("onScroll",function(){m(),p.detachEvent(A)});p.scrollTo({left:I,top:O}),p._smartRenderingEnabled()||m()}}else m();s.callEvent("onAfterEventDisplay",[u,c])}function m(){u.color=g,u.textColor=h}}}(t),function(s){s._append_drag_marker=function(d){if(!d.parentNode){var c=s._els.dhx_cal_data[0].lastChild,u=s._getClassName(c);u.indexOf("dhx_scale_holder")<0&&c.previousSibling&&(c=c.previousSibling),u=s._getClassName(c),c&&u.indexOf("dhx_scale_holder")===0&&c.appendChild(d)}},s._update_marker_position=function(d,c){var u=s._calc_event_y(c,0);d.style.top=u.top+"px",d.style.height=u.height+"px"},s.highlightEventPosition=function(d){var c=document.createElement("div");c.setAttribute("event_id",d.id),c.setAttribute(this.config.event_attribute,d.id),this._rendered.push(c),this._update_marker_position(c,d);var u=this.templates.drag_marker_class(d.start_date,d.end_date,d),f=this.templates.drag_marker_content(d.start_date,d.end_date,d);c.className="dhx_drag_marker",u&&(c.className+=" "+u),f&&(c.innerHTML=f),this._append_drag_marker(c)}}(t),Q_(t),X_(t),Z_(t),function(s){s.getRootView=function(){return{view:{render:function(){return{tag:"div",type:1,attrs:{style:"width:100%;height:100%;"},hooks:{didInsert:function(){s.setCurrentView()}},body:[{el:this.el,type:1}]}},init:function(){var d=document.createElement("DIV");d.id="scheduler_"+s.uid(),d.style.width="100%",d.style.height="100%",d.classList.add("dhx_cal_container"),d.cmp="grid",d.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button"></div><div class="dhx_cal_next_button"></div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" data-tab="day"></div><div class="dhx_cal_tab" data-tab="week"></div><div class="dhx_cal_tab" data-tab="month"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',s.init(d),this.el=d}},type:4}}}(t),eu(t),window.jQuery&&(r=window.jQuery,a=0,i=[],r.fn.dhx_scheduler=function(s){if(typeof s!="string"){var d=[];return this.each(function(){if(this&&this.getAttribute)if(this.getAttribute("dhxscheduler"))d.push(window[this.getAttribute("dhxscheduler")]);else{var c="scheduler";a&&(c="scheduler"+(a+1),window[c]=Scheduler.getSchedulerInstance());var u=window[c];for(var f in this.setAttribute("dhxscheduler",c),s)f!="data"&&(u.config[f]=s[f]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button"></div><div class="dhx_cal_next_button"></div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab" data-tab="day" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" data-tab="week" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" data-tab="month" style="right:76px;"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',this.className+=" dhx_cal_container"),u.init(this,u.config.date,u.config.mode),s.data&&u.parse(s.data),d.push(u),a++}}),d.length===1?d[0]:d}if(i[s])return i[s].apply(this,[]);r.error("Method "+s+" does not exist on jQuery.dhx_scheduler")}),function(s){(function(){var d=s.setCurrentView,c=s.updateView,u=null,f=null,v=function(p,y){var x=this;ft.clearTimeout(f),ft.clearTimeout(u);var S=x._date,O=x._mode;h(this,p,y),f=setTimeout(function(){s.$destroyed||(x.callEvent("onBeforeViewChange",[O,S,y||x._mode,p||x._date])?(c.call(x,p,y),x.callEvent("onViewChange",[x._mode,x._date]),ft.clearTimeout(u),f=0):h(x,S,O))},s.config.delay_render)},g=function(p,y){var x=this,S=arguments;h(this,p,y),ft.clearTimeout(u),u=setTimeout(function(){s.$destroyed||f||c.apply(x,S)},s.config.delay_render)};function h(p,y,x){y&&(p._date=y),x&&(p._mode=x)}s.attachEvent("onSchedulerReady",function(){s.config.delay_render?(s.setCurrentView=v,s.updateView=g):(s.setCurrentView=d,s.updateView=c)})})()}(t),function(s){s.createDataProcessor=function(d){var c,u;d instanceof Function?c=d:d.hasOwnProperty("router")?c=d.router:d.hasOwnProperty("event")&&(c=d),u=c?"CUSTOM":d.mode||"REST-JSON";var f=new li(d.url);return f.init(s),f.setTransactionMode({mode:u,router:c},d.batchUpdate),f},s.DataProcessor=li}(t),function(s){s.attachEvent("onSchedulerReady",function(){typeof dhtmlxError<"u"&&window.dhtmlxError.catchError("LoadXML",function(d,c,u){var f=u[0].responseText;switch(s.config.ajax_error){case"alert":ft.alert(f);break;case"console":ft.console.log(f)}})})}(t);const o=new bu({en:_u,ar:ru,be:au,ca:iu,cn:ou,cs:su,da:lu,de:du,el:cu,es:uu,fi:hu,fr:fu,he:pu,hu:mu,id:gu,it:vu,jp:yu,nb:wu,nl:xu,no:Eu,pl:ku,pt:Tu,ro:Au,ru:Su,si:Du,sk:Cu,sv:Iu,tr:Nu,ua:Mu});t.i18n={addLocale:o.addLocale,setLocale:function(s){if(typeof s=="string"){var d=o.getLocale(s);d||(d=o.getLocale("en")),t.locale=d}else if(s)if(t.locale)for(var c in s)s[c]&&typeof s[c]=="object"?(t.locale[c]||(t.locale[c]={}),t.mixin(t.locale[c],s[c],!0)):t.locale[c]=s[c];else t.locale=s;var u=t.locale.labels;u.dhx_save_btn=u.icon_save,u.dhx_cancel_btn=u.icon_cancel,u.dhx_delete_btn=u.icon_delete,t.$container&&t.get_elements()},getLocale:o.getLocale},t.i18n.setLocale("en"),t.ext={},$_(t);const l={};return t.plugins=function(s){(function(d,c,u){const f=[];for(const v in d)if(d[v]){const g=v.toLowerCase();c[g]&&c[g].forEach(function(h){const p=h.toLowerCase();d[p]||f.push(p)}),f.push(g)}return f.sort(function(v,g){const h=u[v]||0,p=u[g]||0;return h>p?1:h<p?-1:0}),f})(s,{treetimeline:["timeline"],daytimeline:["timeline"],outerdrag:["legacy"]},{legacy:1,limit:1,timeline:2,daytimeline:3,treetimeline:3,outerdrag:6}).forEach(function(d){if(!l[d]){const c=e.getExtension(d);if(!c)throw new Error("unknown plugin "+d);c(t),l[d]=!0}})},t.plugins({all_timed:"short"}),t}class Pu{constructor(t){this._extensions={};for(const n in t)this._extensions[n]=t[n]}addExtension(t,n){this._extensions[t]=n}getExtension(t){return this._extensions[t]}}typeof dhtmlx<"u"&&dhtmlx.attaches&&(dhtmlx.attaches.attachScheduler=function(e,t,n,r){n=n||'<div class="dhx_cal_tab" name="day_tab" data-tab="day" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" data-tab="week" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" data-tab="month" style="right:76px;"></div>';var a=document.createElement("DIV");return a.id="dhxSchedObj_"+this._genStr(12),a.innerHTML='<div id="'+a.id+'" class="dhx_cal_container" style="width:100%; height:100%;"><div class="dhx_cal_navline"><div class="dhx_cal_prev_button"></div><div class="dhx_cal_next_button"></div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div>'+n+'</div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div></div>',document.body.appendChild(a.firstChild),this.attachObject(a.id,!1,!0),this.vs[this.av].sched=r,this.vs[this.av].schedId=a.id,r.setSizes=r.updateView,r.destructor=function(){},r.init(a.id,e,t),this.vs[this._viewRestore()].sched});const Et=(e,t)=>{t(!1,`The ${e} extension is not included in this version of dhtmlxScheduler.<br>
		You may need a <a href="https://docs.dhtmlx.com/scheduler/editions_comparison.html" target="_blank">Professional version of the component</a>.<br>
		Contact us at <a href="https://dhtmlx.com/docs/contact.shtml" target="_blank">https://dhtmlx.com/docs/contact.shtml</a> if you have any questions.`)};function Lu(e){(function(){var t=[];function n(){return!!t.length}function r(l){setTimeout(function(){if(e.$destroyed)return!0;n()||function(s,d){for(;s&&s!=d;)s=s.parentNode;return s==d}(document.activeElement,e.$container)||e.focus()},1)}function a(l){var s=(l=l||window.event).currentTarget;s==t[t.length-1]&&e.$keyboardNavigation.trapFocus(s,l)}if(e.attachEvent("onLightbox",function(){var l;l=e.getLightbox(),e.eventRemove(l,"keydown",a),e.event(l,"keydown",a),t.push(l)}),e.attachEvent("onAfterLightbox",function(){var l=t.pop();l&&e.eventRemove(l,"keydown",a),r()}),e.attachEvent("onAfterQuickInfo",function(){r()}),!e._keyNavMessagePopup){e._keyNavMessagePopup=!0;var i=null,o=null;const l=[];e.attachEvent("onMessagePopup",function(s){for(i=document.activeElement,o=i;o&&e._getClassName(o).indexOf("dhx_cal_data")<0;)o=o.parentNode;o&&(o=o.parentNode),e.eventRemove(s,"keydown",a),e.event(s,"keydown",a),l.push(s)}),e.attachEvent("onAfterMessagePopup",function(){var s=l.pop();s&&e.eventRemove(s,"keydown",a),setTimeout(function(){if(e.$destroyed)return!0;for(var d=document.activeElement;d&&e._getClassName(d).indexOf("dhx_cal_light")<0;)d=d.parentNode;d||(i&&i.parentNode?i.focus():o&&o.parentNode&&o.focus(),i=null,o=null)},1)})}e.$keyboardNavigation.isModal=n})()}function Vu(e){e._temp_key_scope=function(){e.config.key_nav=!0,e.$keyboardNavigation._pasteDate=null,e.$keyboardNavigation._pasteSection=null;var t=null,n={};function r(o){o=o||window.event,n.x=o.clientX,n.y=o.clientY}function a(){for(var o,l,s=document.elementFromPoint(n.x,n.y);s&&s!=e._obj;)s=s.parentNode;return o=s==e._obj,l=e.$keyboardNavigation.dispatcher.isEnabled(),o||l}function i(o){return e._lame_copy({},o)}document.body?e.event(document.body,"mousemove",r):e.event(window,"load",function(){e.event(document.body,"mousemove",r)}),e.attachEvent("onMouseMove",function(o,l){var s=e.getState();if(s.mode&&s.min_date){var d=e.getActionData(l);e.$keyboardNavigation._pasteDate=d.date,e.$keyboardNavigation._pasteSection=d.section}}),e._make_pasted_event=function(o){var l=e.$keyboardNavigation._pasteDate,s=e.$keyboardNavigation._pasteSection,d=o.end_date-o.start_date,c=i(o);if(function(f){delete f.rec_type,delete f.rec_pattern,delete f.event_pid,delete f.event_length}(c),c.start_date=new Date(l),c.end_date=new Date(c.start_date.valueOf()+d),s){var u=e._get_section_property();e.config.multisection&&o[u]&&e.isMultisectionEvent&&e.isMultisectionEvent(o)?c[u]=o[u]:c[u]=s}return c},e._do_paste=function(o,l,s){e.callEvent("onBeforeEventPasted",[o,l,s])!==!1&&(e.addEvent(l),e.callEvent("onEventPasted",[o,l,s]))},e._is_key_nav_active=function(){return!(!this._is_initialized()||this._is_lightbox_open()||!this.config.key_nav)},e.event(document,"keydown",function(o){(o.ctrlKey||o.metaKey)&&o.keyCode==86&&e._buffer_event&&!e.$keyboardNavigation.dispatcher.isEnabled()&&(e.$keyboardNavigation.dispatcher.isActive=a())}),e._key_nav_copy_paste=function(o){if(!e._is_key_nav_active())return!0;if(o.keyCode==37||o.keyCode==39){o.cancelBubble=!0;var l=e.date.add(e._date,o.keyCode==37?-1:1,e._mode);return e.setCurrentView(l),!0}var s,d=(s=e.$keyboardNavigation.dispatcher.getActiveNode())&&s.eventId?s.eventId:e._select_id;if((o.ctrlKey||o.metaKey)&&o.keyCode==67)return d&&(e._buffer_event=i(e.getEvent(d)),t=!0,e.callEvent("onEventCopied",[e.getEvent(d)])),!0;if((o.ctrlKey||o.metaKey)&&o.keyCode==88&&d){t=!1;var c=e._buffer_event=i(e.getEvent(d));e.updateEvent(c.id),e.callEvent("onEventCut",[c])}if((o.ctrlKey||o.metaKey)&&o.keyCode==86&&a()){if(c=(c=e._buffer_event?e.getEvent(e._buffer_event.id):e._buffer_event)||e._buffer_event){var u=e._make_pasted_event(c);t?(u.id=e.uid(),e._do_paste(t,u,c)):e.callEvent("onBeforeEventChanged",[u,o,!1,c])&&(e._do_paste(t,u,c),t=!0)}return!0}}},e._temp_key_scope()}function $u(e){e.$keyboardNavigation.attachSchedulerHandlers=function(){var t,n=e.$keyboardNavigation.dispatcher,r=function(s){if(e.config.key_nav)return n.keyDownHandler(s)},a=function(){n.keepScrollPosition(function(){n.focusGlobalNode()})};e.attachEvent("onDataRender",function(){e.config.key_nav&&n.isEnabled()&&!e.getState().editor_id&&(clearTimeout(t),t=setTimeout(function(){if(e.$destroyed)return!0;n.isEnabled()||n.enable(),i()}))});var i=function(){if(n.isEnabled()){var s=n.getActiveNode();s&&(s.isValid()||(s=s.fallback()),!s||s instanceof e.$keyboardNavigation.MinicalButton||s instanceof e.$keyboardNavigation.MinicalCell||n.keepScrollPosition(function(){s.focus(!0)}))}};function o(s){if(!e.config.key_nav)return!0;const d=e.getView();let c=!1;if(e.getState().mode==="month")c=e.$keyboardNavigation.isChildOf(s.target||s.srcElement,e.$container.querySelector(".dhx_cal_month_table"));else if(d&&d.layout==="timeline")c=e.$keyboardNavigation.isChildOf(s.target||s.srcElement,e.$container.querySelector(".dhx_timeline_data_col"));else{const v=e.$container.querySelectorAll(".dhx_scale_holder");c=Array.from(v).some(g=>g===s.target.parentNode)}var u,f=e.getActionData(s);e._locate_event(s.target||s.srcElement)?u=new e.$keyboardNavigation.Event(e._locate_event(s.target||s.srcElement)):c&&(u=new e.$keyboardNavigation.TimeSlot,f.date&&c&&(u=u.nextSlot(new e.$keyboardNavigation.TimeSlot(f.date,null,f.section)))),u&&(n.isEnabled()?f.date&&c&&n.delay(function(){n.setActiveNode(u)}):n.activeNode=u)}e.attachEvent("onSchedulerReady",function(){var s=e.$container;e.eventRemove(document,"keydown",r),e.eventRemove(s,"mousedown",o),e.eventRemove(s,"focus",a),e.config.key_nav?(e.event(document,"keydown",r),e.event(s,"mousedown",o),e.event(s,"focus",a),s.setAttribute("tabindex","0")):s.removeAttribute("tabindex")});var l=e.updateEvent;e.updateEvent=function(s){var d=l.apply(this,arguments);if(e.config.key_nav&&n.isEnabled()&&e.getState().select_id==s){var c=new e.$keyboardNavigation.Event(s);e.getState().lightbox_id||function(u){if(e.config.key_nav&&n.isEnabled()){var f=u,v=new e.$keyboardNavigation.Event(f.eventId);if(!v.isValid()){var g=v.start||f.start,h=v.end||f.end,p=v.section||f.section;(v=new e.$keyboardNavigation.TimeSlot(g,h,p)).isValid()||(v=new e.$keyboardNavigation.TimeSlot)}n.setActiveNode(v);var y=n.getActiveNode();y&&y.getNode&&document.activeElement!=y.getNode()&&n.focusNode(n.getActiveNode())}}(c)}return d},e.attachEvent("onEventDeleted",function(s){return e.config.key_nav&&n.isEnabled()&&n.getActiveNode().eventId==s&&n.setActiveNode(new e.$keyboardNavigation.TimeSlot),!0}),e.attachEvent("onClearAll",function(){if(!e.config.key_nav)return!0;n.isEnabled()&&n.getActiveNode()instanceof e.$keyboardNavigation.Event&&n.setActiveNode(new e.$keyboardNavigation.TimeSlot)})}}class Hu{constructor(t){this.map=null,this._markers=[],this.scheduler=t}onEventClick(t){if(this._markers&&this._markers.length>0){for(let n=0;n<this._markers.length;n++)if(t.id==this._markers[n].event.id){let r=this.settings.zoom_after_resolve||this.settings.initial_zoom;t.lat&&t.lng?(this.map.setCenter({lat:t.lat,lng:t.lng}),this.map.setZoom(r)):(this.map.setCenter({lat:this.settings.error_position.lat,lng:this.settings.error_position.lng}),this.map.setZoom(r)),google.maps.event.trigger(this._markers[n].marker,"click")}}}initialize(t,n){this.settings=n;let r=this.scheduler,a={center:{lat:n.initial_position.lat,lng:n.initial_position.lng},zoom:n.initial_zoom,mapId:t.id,scrollwheel:!0,mapTypeId:n.type};if(this.map===null)this.map=new google.maps.Map(t,a);else{let i=this.map;t.appendChild(this.map.__gm.messageOverlay),t.appendChild(this.map.__gm.outerContainer),setTimeout(function(){i.setOptions({container:t.id})},500)}google.maps.event.addListener(this.map,"dblclick",function(i){const o=new google.maps.Geocoder;if(!r.config.readonly&&r.config.dblclick_create){let l=i.latLng;o.geocode({latLng:l},function(s,d){d==google.maps.GeocoderStatus.OK?(l=s[0].geometry.location,r.addEventNow({lat:l.lat(),lng:l.lng(),event_location:s[0].formatted_address,start_date:r.getState().date,end_date:r.date.add(r.getState().date,r.config.time_step,"minute")})):console.error("Geocode was not successful for the following reason: "+d)})}})}destroy(t){for(google.maps.event.clearInstanceListeners(window),google.maps.event.clearInstanceListeners(document),google.maps.event.clearInstanceListeners(t);t.firstChild;)t.firstChild.remove();t.innerHTML=""}async addEventMarker(t){let n={title:t.text,position:{},map:{}};t.lat&&t.lng?n.position={lat:t.lat,lng:t.lng}:n.position={lat:this.settings.error_position.lat,lng:this.settings.error_position.lng};const{AdvancedMarkerElement:r}=await google.maps.importLibrary("marker");let a;this.scheduler.ext.mapView.createMarker?(n.map=this.map,a=this.scheduler.ext.mapView.createMarker(n)):(a=new r(n),a.map=this.map),a.setMap(this.map),t["!nativeeditor_status"]=="true_deleted"&&a.setMap(null),google.maps.event.addListener(a,"click",()=>{this.infoWindow&&this.infoWindow.close(),this.infoWindow=new google.maps.InfoWindow({maxWidth:this.settings.info_window_max_width}),this.infoWindow.setContent(this.scheduler.templates.map_info_content(t)),this.infoWindow.open({anchor:a,map:this.map})});let i={event:t,...n,marker:a};this._markers.push(i)}removeEventMarker(t){for(let n=0;n<this._markers.length;n++)t==this._markers[n].event.id&&(this._markers[n].marker.setVisible(!1),this._markers[n].marker.setMap(null),this._markers[n].marker.setPosition(null),this._markers[n].marker=null,this._markers.splice(n,1),n--)}updateEventMarker(t){for(let n=0;n<this._markers.length;n++)if(this._markers[n].event.id==t.id){this._markers[n].event=t,this._markers[n].position.lat=t.lat,this._markers[n].position.lng=t.lng,this._markers[n].text=t.text;let r=new google.maps.LatLng(t.lat,t.lng);this._markers[n].marker.setPosition(r)}}clearEventMarkers(){if(this._markers.length>0){for(let t=0;t<this._markers.length;t++)this._markers[t].marker.setMap(null);this._markers=[]}}setView(t,n,r){this.map.setCenter({lat:t,lng:n}),this.map.setZoom(r)}async resolveAddress(t){const n=new google.maps.Geocoder;return await new Promise(r=>{n.geocode({address:t},function(a,i){i==google.maps.GeocoderStatus.OK?r({lat:a[0].geometry.location.lat(),lng:a[0].geometry.location.lng()}):(console.error("Geocode was not successful for the following reason: "+i),r({}))})})}}class Fu{constructor(t){this.map=null,this._markers=[],this.scheduler=t}onEventClick(t){if(this._markers&&this._markers.length>0)for(let n=0;n<this._markers.length;n++)t.id==this._markers[n].event.id&&(this._markers[n].marker.openPopup(),this._markers[n].marker.closeTooltip(),t.lat&&t.lng?this.setView(t.lat,t.lng,this.settings.zoom_after_resolve||this.settings.initial_zoom):this.setView(this.settings.error_position.lat,this.settings.error_position.lng,this.settings.zoom_after_resolve||this.settings.initial_zoom))}initialize(t,n){let r=this.scheduler,a=document.createElement("div");a.className="mapWrapper",a.id="mapWrapper",a.style.width=t.style.width,a.style.height=t.style.height,t.appendChild(a);let i=L.map(a,{center:L.latLng(n.initial_position.lat,n.initial_position.lng),zoom:n.initial_zoom,keyboard:!1});L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(i),i.on("dblclick",async function(o){let l=await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${o.latlng.lat}&lon=${o.latlng.lng}&format=json`,{method:"GET",headers:{"Accept-Language":"en"}}).then(s=>s.json());if(l.address){let s=l.address.country;r.addEventNow({lat:o.latlng.lat,lng:o.latlng.lng,event_location:s,start_date:r.getState().date,end_date:r.date.add(r.getState().date,r.config.time_step,"minute")})}else console.error("unable recieve a position of the event",l.error)}),this.map=i,this.settings=n}destroy(t){for(this.map.remove();t.firstChild;)t.firstChild.remove();t.innerHTML=""}addEventMarker(t){const n=L.icon({iconUrl:"https://unpkg.com/leaflet@1.0.3/dist/images/marker-icon.png",iconSize:[25,41],shadowSize:[30,65],iconAnchor:[12,41],shadowAnchor:[7,65]});let r={minWidth:180,maxWidth:this.settings.info_window_max_width};const a=L.popup(r).setContent(this.scheduler.templates.map_info_content(t)),i=L.tooltip().setContent(t.text);let o=[t.lat,t.lng];t.lat&&t.lng||(o=[this.settings.error_position.lat,this.settings.error_position.lng]);const l={event:t,marker:L.marker(o,{icon:n}).bindPopup(a).bindTooltip(i).addTo(this.map)};this._markers.push(l)}removeEventMarker(t){for(let n=0;n<this._markers.length;n++)t==this._markers[n].event.id&&(this.map.removeLayer(this._markers[n].marker),this._markers.splice(n,1),n--)}updateEventMarker(t){for(let n=0;n<this._markers.length;n++)this._markers[n].event.id==t.id&&(this._markers[n].event=t,t.lat&&t.lng?this._markers[n].marker.setLatLng([t.lat,t.lng]):this._markers[n].marker.setLatLng([this.settings.error_position.lat,this.settings.error_position.lng]))}clearEventMarkers(){if(this._markers){for(let t=0;t<this._markers.length;t++)this.map.removeLayer(this._markers[t].marker);this._markers=[]}}setView(t,n,r){this.map.setView([t,n],r)}async resolveAddress(t){let n={},r=await fetch(`https://nominatim.openstreetmap.org/search?q=${t}&format=json`,{method:"GET",headers:{"Accept-Language":"en"}}).then(a=>a.json());return r&&r.length?(n.lat=+r[0].lat,n.lng=+r[0].lon):console.error(`Unable recieve a position of the event's location: ${t}`),n}}class Uu{constructor(t){this.map=null,this._markers=[],this.scheduler=t}onEventClick(t){if(this._markers&&this._markers.length>0)for(let n=0;n<this._markers.length;n++){const r=this._markers[n].marker.getPopup();r.isOpen()&&r.remove(),t.id==this._markers[n].event.id&&(this._markers[n].marker.togglePopup(),t.lat&&t.lng?this.setView(t.lat,t.lng,this.settings.zoom_after_resolve||this.settings.initial_zoom):this.setView(this.settings.error_position.lat,this.settings.error_position.lng,this.settings.zoom_after_resolve||this.settings.initial_zoom))}}initialize(t,n){let r=this.scheduler;mapboxgl.accessToken=n.accessToken;const a=new mapboxgl.Map({container:t,center:[n.initial_position.lng,n.initial_position.lat],zoom:n.initial_zoom+1});a.on("dblclick",async function(i){let o=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${i.lngLat.lng},${i.lngLat.lat}.json?access_token=${n.accessToken}`).then(l=>l.json());if(o.features){let l=o.features[0].place_name;r.addEventNow({lat:i.lngLat.lat,lng:i.lngLat.lng,event_location:l,start_date:r.getState().date,end_date:r.date.add(r.getState().date,r.config.time_step,"minute")})}else console.error("unable recieve a position of the event")}),this.map=a,this.settings=n}destroy(t){for(this.map.remove();t.firstChild;)t.firstChild.remove();t.innerHTML=""}addEventMarker(t){let n=[t.lng,t.lat];t.lat&&t.lng||(n=[this.settings.error_position.lng,this.settings.error_position.lat]);const r=new mapboxgl.Popup({offset:25,focusAfterOpen:!1}).setMaxWidth(`${this.settings.info_window_max_width}px`).setHTML(this.scheduler.templates.map_info_content(t)),a={event:t,marker:new mapboxgl.Marker().setLngLat(n).setPopup(r).addTo(this.map)};this._markers.push(a)}removeEventMarker(t){for(let n=0;n<this._markers.length;n++)t==this._markers[n].event.id&&(this._markers[n].marker.remove(),this._markers.splice(n,1),n--)}updateEventMarker(t){for(let n=0;n<this._markers.length;n++)this._markers[n].event.id==t.id&&(this._markers[n].event=t,t.lat&&t.lng?this._markers[n].marker.setLngLat([t.lng,t.lat]):this._markers[n].marker.setLngLat([this.settings.error_position.lng,this.settings.error_position.lat]))}clearEventMarkers(){for(let t=0;t<this._markers.length;t++)this._markers[t].marker.remove();this._markers=[]}setView(t,n,r){this.map.setCenter([n,t]),this.map.setZoom(r)}async resolveAddress(t){let n=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${t}.json?access_token=${this.settings.accessToken}`).then(a=>a.json()),r={};return n&&n.features.length?(r.lng=n.features[0].center[0],r.lat=n.features[0].center[1]):console.error(`Unable recieve a position of the event's location: ${t}`),r}}var di=["MO","TU","WE","TH","FR","SA","SU"],Be=function(){function e(t,n){if(n===0)throw new Error("Can't create weekday with n == 0");this.weekday=t,this.n=n}return e.fromStr=function(t){return new e(di.indexOf(t))},e.prototype.nth=function(t){return this.n===t?this:new e(this.weekday,t)},e.prototype.equals=function(t){return this.weekday===t.weekday&&this.n===t.n},e.prototype.toString=function(){var t=di[this.weekday];return this.n&&(t=(this.n>0?"+":"")+String(this.n)+t),t},e.prototype.getJsWeekday=function(){return this.weekday===6?0:this.weekday+1},e}(),Ee=function(e){return e!=null},rt=function(e){return typeof e=="number"},Cs=function(e){return typeof e=="string"&&di.includes(e)},Ke=Array.isArray,ct=function(e,t){t===void 0&&(t=e),arguments.length===1&&(t=e,e=0);for(var n=[],r=e;r<t;r++)n.push(r);return n},ce=function(e,t){var n=0,r=[];if(Ke(e))for(;n<t;n++)r[n]=[].concat(e);else for(;n<t;n++)r[n]=e;return r};function rn(e,t,n){n===void 0&&(n=" ");var r=String(e);return t|=0,r.length>t?String(r):((t-=r.length)>n.length&&(n+=ce(n,t/n.length)),n.slice(0,t)+String(r))}var Xe=function(e,t){var n=e%t;return n*t<0?n+t:n},Ja=function(e,t){return{div:Math.floor(e/t),mod:Xe(e,t)}},it=function(e){return!Ee(e)||e.length===0},Se=function(e){return!it(e)},fe=function(e,t){return Se(e)&&e.indexOf(t)!==-1},Wt=function(e,t,n,r,a,i){return r===void 0&&(r=0),a===void 0&&(a=0),i===void 0&&(i=0),new Date(Date.UTC(e,t-1,n,r,a,i))},zu=[31,28,31,30,31,30,31,31,30,31,30,31],od=864e5,sd=Wt(1970,1,1),qu=[6,0,1,2,3,4,5],Un=function(e){return e%4==0&&e%100!=0||e%400==0},ld=function(e){return e instanceof Date},zn=function(e){return ld(e)&&!isNaN(e.getTime())},ci=function(e){return t=sd,n=e.getTime()-t.getTime(),Math.round(n/od);var t,n},dd=function(e){return new Date(sd.getTime()+e*od)},Bu=function(e){var t=e.getUTCMonth();return t===1&&Un(e.getUTCFullYear())?29:zu[t]},_n=function(e){return qu[e.getUTCDay()]},Is=function(e,t){var n=Wt(e,t+1,1);return[_n(n),Bu(n)]},cd=function(e,t){return t=t||e,new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))},_i=function(e){return new Date(e.getTime())},Ns=function(e){for(var t=[],n=0;n<e.length;n++)t.push(_i(e[n]));return t},Zn=function(e){e.sort(function(t,n){return t.getTime()-n.getTime()})},Hi=function(e,t){t===void 0&&(t=!0);var n=new Date(e);return[rn(n.getUTCFullYear().toString(),4,"0"),rn(n.getUTCMonth()+1,2,"0"),rn(n.getUTCDate(),2,"0"),"T",rn(n.getUTCHours(),2,"0"),rn(n.getUTCMinutes(),2,"0"),rn(n.getUTCSeconds(),2,"0"),t?"Z":""].join("")},Fi=function(e){var t=/^(\d{4})(\d{2})(\d{2})(T(\d{2})(\d{2})(\d{2})Z?)?$/.exec(e);if(!t)throw new Error("Invalid UNTIL value: ".concat(e));return new Date(Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[5],10)||0,parseInt(t[6],10)||0,parseInt(t[7],10)||0))},Ms=function(e,t){return e.toLocaleString("sv-SE",{timeZone:t}).replace(" ","T")+"Z"},cn=function(){function e(t,n){this.minDate=null,this.maxDate=null,this._result=[],this.total=0,this.method=t,this.args=n,t==="between"?(this.maxDate=n.inc?n.before:new Date(n.before.getTime()-1),this.minDate=n.inc?n.after:new Date(n.after.getTime()+1)):t==="before"?this.maxDate=n.inc?n.dt:new Date(n.dt.getTime()-1):t==="after"&&(this.minDate=n.inc?n.dt:new Date(n.dt.getTime()+1))}return e.prototype.accept=function(t){++this.total;var n=this.minDate&&t<this.minDate,r=this.maxDate&&t>this.maxDate;if(this.method==="between"){if(n)return!0;if(r)return!1}else if(this.method==="before"){if(r)return!1}else if(this.method==="after")return!!n||(this.add(t),!1);return this.add(t)},e.prototype.add=function(t){return this._result.push(t),!0},e.prototype.getValue=function(){var t=this._result;switch(this.method){case"all":case"between":return t;default:return t.length?t[t.length-1]:null}},e.prototype.clone=function(){return new e(this.method,this.args)},e}(),ui=function(e,t){return ui=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])},ui(e,t)};function Ui(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ui(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Qe=function(){return Qe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Qe.apply(this,arguments)};function Y(e,t,n){for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var _e,Os=function(e){function t(n,r,a){var i=e.call(this,n,r)||this;return i.iterator=a,i}return Ui(t,e),t.prototype.add=function(n){return!!this.iterator(n,this._result.length)&&(this._result.push(n),!0)},t}(cn),zr={dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],tokens:{SKIP:/^[ \r\n\t]+|^\.$/,number:/^[1-9][0-9]*/,numberAsText:/^(one|two|three)/i,every:/^every/i,"day(s)":/^days?/i,"weekday(s)":/^weekdays?/i,"week(s)":/^weeks?/i,"hour(s)":/^hours?/i,"minute(s)":/^minutes?/i,"month(s)":/^months?/i,"year(s)":/^years?/i,on:/^(on|in)/i,at:/^(at)/i,the:/^the/i,first:/^first/i,second:/^second/i,third:/^third/i,nth:/^([1-9][0-9]*)(\.|th|nd|rd|st)/i,last:/^last/i,for:/^for/i,"time(s)":/^times?/i,until:/^(un)?til/i,monday:/^mo(n(day)?)?/i,tuesday:/^tu(e(s(day)?)?)?/i,wednesday:/^we(d(n(esday)?)?)?/i,thursday:/^th(u(r(sday)?)?)?/i,friday:/^fr(i(day)?)?/i,saturday:/^sa(t(urday)?)?/i,sunday:/^su(n(day)?)?/i,january:/^jan(uary)?/i,february:/^feb(ruary)?/i,march:/^mar(ch)?/i,april:/^apr(il)?/i,may:/^may/i,june:/^june?/i,july:/^july?/i,august:/^aug(ust)?/i,september:/^sep(t(ember)?)?/i,october:/^oct(ober)?/i,november:/^nov(ember)?/i,december:/^dec(ember)?/i,comma:/^(,\s*|(and|or)\s*)+/i}},Rs=function(e,t){return e.indexOf(t)!==-1},ju=function(e){return e.toString()},Yu=function(e,t,n){return"".concat(t," ").concat(n,", ").concat(e)},ht=function(){function e(t,n,r,a){if(n===void 0&&(n=ju),r===void 0&&(r=zr),a===void 0&&(a=Yu),this.text=[],this.language=r||zr,this.gettext=n,this.dateFormatter=a,this.rrule=t,this.options=t.options,this.origOptions=t.origOptions,this.origOptions.bymonthday){var i=[].concat(this.options.bymonthday),o=[].concat(this.options.bynmonthday);i.sort(function(c,u){return c-u}),o.sort(function(c,u){return u-c}),this.bymonthday=i.concat(o),this.bymonthday.length||(this.bymonthday=null)}if(Ee(this.origOptions.byweekday)){var l=Ke(this.origOptions.byweekday)?this.origOptions.byweekday:[this.origOptions.byweekday],s=String(l);this.byweekday={allWeeks:l.filter(function(c){return!c.n}),someWeeks:l.filter(function(c){return!!c.n}),isWeekdays:s.indexOf("MO")!==-1&&s.indexOf("TU")!==-1&&s.indexOf("WE")!==-1&&s.indexOf("TH")!==-1&&s.indexOf("FR")!==-1&&s.indexOf("SA")===-1&&s.indexOf("SU")===-1,isEveryDay:s.indexOf("MO")!==-1&&s.indexOf("TU")!==-1&&s.indexOf("WE")!==-1&&s.indexOf("TH")!==-1&&s.indexOf("FR")!==-1&&s.indexOf("SA")!==-1&&s.indexOf("SU")!==-1};var d=function(c,u){return c.weekday-u.weekday};this.byweekday.allWeeks.sort(d),this.byweekday.someWeeks.sort(d),this.byweekday.allWeeks.length||(this.byweekday.allWeeks=null),this.byweekday.someWeeks.length||(this.byweekday.someWeeks=null)}else this.byweekday=null}return e.isFullyConvertible=function(t){if(!(t.options.freq in e.IMPLEMENTED)||t.origOptions.until&&t.origOptions.count)return!1;for(var n in t.origOptions){if(Rs(["dtstart","tzid","wkst","freq"],n))return!0;if(!Rs(e.IMPLEMENTED[t.options.freq],n))return!1}return!0},e.prototype.isFullyConvertible=function(){return e.isFullyConvertible(this.rrule)},e.prototype.toString=function(){var t=this.gettext;if(!(this.options.freq in e.IMPLEMENTED))return t("RRule error: Unable to fully convert this rrule to text");if(this.text=[t("every")],this[B.FREQUENCIES[this.options.freq]](),this.options.until){this.add(t("until"));var n=this.options.until;this.add(this.dateFormatter(n.getUTCFullYear(),this.language.monthNames[n.getUTCMonth()],n.getUTCDate()))}else this.options.count&&this.add(t("for")).add(this.options.count.toString()).add(this.plural(this.options.count)?t("times"):t("time"));return this.isFullyConvertible()||this.add(t("(~ approximate)")),this.text.join("")},e.prototype.HOURLY=function(){var t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("hours"):t("hour"))},e.prototype.MINUTELY=function(){var t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("minutes"):t("minute"))},e.prototype.DAILY=function(){var t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.byweekday&&this.byweekday.isWeekdays?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(this.plural(this.options.interval)?t("days"):t("day")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday?this._byweekday():this.origOptions.byhour&&this._byhour()},e.prototype.WEEKLY=function(){var t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()).add(this.plural(this.options.interval)?t("weeks"):t("week")),this.byweekday&&this.byweekday.isWeekdays?this.options.interval===1?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(t("on")).add(t("weekdays")):this.byweekday&&this.byweekday.isEveryDay?this.add(this.plural(this.options.interval)?t("days"):t("day")):(this.options.interval===1&&this.add(t("week")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.origOptions.byhour&&this._byhour())},e.prototype.MONTHLY=function(){var t=this.gettext;this.origOptions.bymonth?(this.options.interval!==1&&(this.add(this.options.interval.toString()).add(t("months")),this.plural(this.options.interval)&&this.add(t("in"))),this._bymonth()):(this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("months"):t("month"))),this.bymonthday?this._bymonthday():this.byweekday&&this.byweekday.isWeekdays?this.add(t("on")).add(t("weekdays")):this.byweekday&&this._byweekday()},e.prototype.YEARLY=function(){var t=this.gettext;this.origOptions.bymonth?(this.options.interval!==1&&(this.add(this.options.interval.toString()),this.add(t("years"))),this._bymonth()):(this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("years"):t("year"))),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.options.byyearday&&this.add(t("on the")).add(this.list(this.options.byyearday,this.nth,t("and"))).add(t("day")),this.options.byweekno&&this.add(t("in")).add(this.plural(this.options.byweekno.length)?t("weeks"):t("week")).add(this.list(this.options.byweekno,void 0,t("and")))},e.prototype._bymonthday=function(){var t=this.gettext;this.byweekday&&this.byweekday.allWeeks?this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext,t("or"))).add(t("the")).add(this.list(this.bymonthday,this.nth,t("or"))):this.add(t("on the")).add(this.list(this.bymonthday,this.nth,t("and")))},e.prototype._byweekday=function(){var t=this.gettext;this.byweekday.allWeeks&&!this.byweekday.isWeekdays&&this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext)),this.byweekday.someWeeks&&(this.byweekday.allWeeks&&this.add(t("and")),this.add(t("on the")).add(this.list(this.byweekday.someWeeks,this.weekdaytext,t("and"))))},e.prototype._byhour=function(){var t=this.gettext;this.add(t("at")).add(this.list(this.origOptions.byhour,void 0,t("and")))},e.prototype._bymonth=function(){this.add(this.list(this.options.bymonth,this.monthtext,this.gettext("and")))},e.prototype.nth=function(t){var n;t=parseInt(t.toString(),10);var r=this.gettext;if(t===-1)return r("last");var a=Math.abs(t);switch(a){case 1:case 21:case 31:n=a+r("st");break;case 2:case 22:n=a+r("nd");break;case 3:case 23:n=a+r("rd");break;default:n=a+r("th")}return t<0?n+" "+r("last"):n},e.prototype.monthtext=function(t){return this.language.monthNames[t-1]},e.prototype.weekdaytext=function(t){var n=rt(t)?(t+1)%7:t.getJsWeekday();return(t.n?this.nth(t.n)+" ":"")+this.language.dayNames[n]},e.prototype.plural=function(t){return t%100!=1},e.prototype.add=function(t){return this.text.push(" "),this.text.push(t),this},e.prototype.list=function(t,n,r,a){var i=this;a===void 0&&(a=","),Ke(t)||(t=[t]),n=n||function(l){return l.toString()};var o=function(l){return n&&n.call(i,l)};return r?function(l,s,d){for(var c="",u=0;u<l.length;u++)u!==0&&(u===l.length-1?c+=" "+d+" ":c+=s+" "),c+=l[u];return c}(t.map(o),a,r):t.map(o).join(a+" ")},e}(),Wu=function(){function e(t){this.done=!0,this.rules=t}return e.prototype.start=function(t){return this.text=t,this.done=!1,this.nextSymbol()},e.prototype.isDone=function(){return this.done&&this.symbol===null},e.prototype.nextSymbol=function(){var t,n;this.symbol=null,this.value=null;do{if(this.done)return!1;for(var r in t=null,this.rules){var a=this.rules[r].exec(this.text);a&&(t===null||a[0].length>t[0].length)&&(t=a,n=r)}if(t!=null&&(this.text=this.text.substr(t[0].length),this.text===""&&(this.done=!0)),t==null)return this.done=!0,this.symbol=null,void(this.value=null)}while(n==="SKIP");return this.symbol=n,this.value=t,!0},e.prototype.accept=function(t){if(this.symbol===t){if(this.value){var n=this.value;return this.nextSymbol(),n}return this.nextSymbol(),!0}return!1},e.prototype.acceptNumber=function(){return this.accept("number")},e.prototype.expect=function(t){if(this.accept(t))return!0;throw new Error("expected "+t+" but found "+this.symbol)},e}();function _d(e,t){t===void 0&&(t=zr);var n={},r=new Wu(t.tokens);return r.start(e)?(function(){r.expect("every");var c=r.acceptNumber();if(c&&(n.interval=parseInt(c[0],10)),r.isDone())throw new Error("Unexpected end");switch(r.symbol){case"day(s)":n.freq=B.DAILY,r.nextSymbol()&&(i(),d());break;case"weekday(s)":n.freq=B.WEEKLY,n.byweekday=[B.MO,B.TU,B.WE,B.TH,B.FR],r.nextSymbol(),i(),d();break;case"week(s)":n.freq=B.WEEKLY,r.nextSymbol()&&(a(),i(),d());break;case"hour(s)":n.freq=B.HOURLY,r.nextSymbol()&&(a(),d());break;case"minute(s)":n.freq=B.MINUTELY,r.nextSymbol()&&(a(),d());break;case"month(s)":n.freq=B.MONTHLY,r.nextSymbol()&&(a(),d());break;case"year(s)":n.freq=B.YEARLY,r.nextSymbol()&&(a(),d());break;case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":n.freq=B.WEEKLY;var u=r.symbol.substr(0,2).toUpperCase();if(n.byweekday=[B[u]],!r.nextSymbol())return;for(;r.accept("comma");){if(r.isDone())throw new Error("Unexpected end");var f=l();if(!f)throw new Error("Unexpected symbol "+r.symbol+", expected weekday");n.byweekday.push(B[f]),r.nextSymbol()}i(),function(){r.accept("on"),r.accept("the");var g=s();if(g)for(n.bymonthday=[g],r.nextSymbol();r.accept("comma");){if(!(g=s()))throw new Error("Unexpected symbol "+r.symbol+"; expected monthday");n.bymonthday.push(g),r.nextSymbol()}}(),d();break;case"january":case"february":case"march":case"april":case"may":case"june":case"july":case"august":case"september":case"october":case"november":case"december":if(n.freq=B.YEARLY,n.bymonth=[o()],!r.nextSymbol())return;for(;r.accept("comma");){if(r.isDone())throw new Error("Unexpected end");var v=o();if(!v)throw new Error("Unexpected symbol "+r.symbol+", expected month");n.bymonth.push(v),r.nextSymbol()}a(),d();break;default:throw new Error("Unknown symbol")}}(),n):null;function a(){var c=r.accept("on"),u=r.accept("the");if(c||u)do{var f=s(),v=l(),g=o();if(f)v?(r.nextSymbol(),n.byweekday||(n.byweekday=[]),n.byweekday.push(B[v].nth(f))):(n.bymonthday||(n.bymonthday=[]),n.bymonthday.push(f),r.accept("day(s)"));else if(v)r.nextSymbol(),n.byweekday||(n.byweekday=[]),n.byweekday.push(B[v]);else if(r.symbol==="weekday(s)")r.nextSymbol(),n.byweekday||(n.byweekday=[B.MO,B.TU,B.WE,B.TH,B.FR]);else if(r.symbol==="week(s)"){r.nextSymbol();var h=r.acceptNumber();if(!h)throw new Error("Unexpected symbol "+r.symbol+", expected week number");for(n.byweekno=[parseInt(h[0],10)];r.accept("comma");){if(!(h=r.acceptNumber()))throw new Error("Unexpected symbol "+r.symbol+"; expected monthday");n.byweekno.push(parseInt(h[0],10))}}else{if(!g)return;r.nextSymbol(),n.bymonth||(n.bymonth=[]),n.bymonth.push(g)}}while(r.accept("comma")||r.accept("the")||r.accept("on"))}function i(){if(r.accept("at"))do{var c=r.acceptNumber();if(!c)throw new Error("Unexpected symbol "+r.symbol+", expected hour");for(n.byhour=[parseInt(c[0],10)];r.accept("comma");){if(!(c=r.acceptNumber()))throw new Error("Unexpected symbol "+r.symbol+"; expected hour");n.byhour.push(parseInt(c[0],10))}}while(r.accept("comma")||r.accept("at"))}function o(){switch(r.symbol){case"january":return 1;case"february":return 2;case"march":return 3;case"april":return 4;case"may":return 5;case"june":return 6;case"july":return 7;case"august":return 8;case"september":return 9;case"october":return 10;case"november":return 11;case"december":return 12;default:return!1}}function l(){switch(r.symbol){case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":return r.symbol.substr(0,2).toUpperCase();default:return!1}}function s(){switch(r.symbol){case"last":return r.nextSymbol(),-1;case"first":return r.nextSymbol(),1;case"second":return r.nextSymbol(),r.accept("last")?-2:2;case"third":return r.nextSymbol(),r.accept("last")?-3:3;case"nth":var c=parseInt(r.value[1],10);if(c<-366||c>366)throw new Error("Nth out of range: "+c);return r.nextSymbol(),r.accept("last")?-c:c;default:return!1}}function d(){if(r.symbol==="until"){var c=Date.parse(r.text);if(!c)throw new Error("Cannot parse until date:"+r.text);n.until=new Date(c)}else r.accept("for")&&(n.count=parseInt(r.value[0],10),r.expect("number"))}}function Qa(e){return e<_e.HOURLY}(function(e){e[e.YEARLY=0]="YEARLY",e[e.MONTHLY=1]="MONTHLY",e[e.WEEKLY=2]="WEEKLY",e[e.DAILY=3]="DAILY",e[e.HOURLY=4]="HOURLY",e[e.MINUTELY=5]="MINUTELY",e[e.SECONDLY=6]="SECONDLY"})(_e||(_e={}));var Ku=function(e,t){return t===void 0&&(t=zr),new B(_d(e,t)||void 0)},an=["count","until","interval","byweekday","bymonthday","bymonth"];ht.IMPLEMENTED=[],ht.IMPLEMENTED[_e.HOURLY]=an,ht.IMPLEMENTED[_e.MINUTELY]=an,ht.IMPLEMENTED[_e.DAILY]=["byhour"].concat(an),ht.IMPLEMENTED[_e.WEEKLY]=an,ht.IMPLEMENTED[_e.MONTHLY]=an,ht.IMPLEMENTED[_e.YEARLY]=["byweekno","byyearday"].concat(an);var Gu=ht.isFullyConvertible,qr=function(){function e(t,n,r,a){this.hour=t,this.minute=n,this.second=r,this.millisecond=a||0}return e.prototype.getHours=function(){return this.hour},e.prototype.getMinutes=function(){return this.minute},e.prototype.getSeconds=function(){return this.second},e.prototype.getMilliseconds=function(){return this.millisecond},e.prototype.getTime=function(){return 1e3*(60*this.hour*60+60*this.minute+this.second)+this.millisecond},e}(),Ju=function(e){function t(n,r,a,i,o,l,s){var d=e.call(this,i,o,l,s)||this;return d.year=n,d.month=r,d.day=a,d}return Ui(t,e),t.fromDate=function(n){return new this(n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.valueOf()%1e3)},t.prototype.getWeekday=function(){return _n(new Date(this.getTime()))},t.prototype.getTime=function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond)).getTime()},t.prototype.getDay=function(){return this.day},t.prototype.getMonth=function(){return this.month},t.prototype.getYear=function(){return this.year},t.prototype.addYears=function(n){this.year+=n},t.prototype.addMonths=function(n){if(this.month+=n,this.month>12){var r=Math.floor(this.month/12),a=Xe(this.month,12);this.month=a,this.year+=r,this.month===0&&(this.month=12,--this.year)}},t.prototype.addWeekly=function(n,r){r>this.getWeekday()?this.day+=-(this.getWeekday()+1+(6-r))+7*n:this.day+=-(this.getWeekday()-r)+7*n,this.fixDay()},t.prototype.addDaily=function(n){this.day+=n,this.fixDay()},t.prototype.addHours=function(n,r,a){for(r&&(this.hour+=Math.floor((23-this.hour)/n)*n);;){this.hour+=n;var i=Ja(this.hour,24),o=i.div,l=i.mod;if(o&&(this.hour=l,this.addDaily(o)),it(a)||fe(a,this.hour))break}},t.prototype.addMinutes=function(n,r,a,i){for(r&&(this.minute+=Math.floor((1439-(60*this.hour+this.minute))/n)*n);;){this.minute+=n;var o=Ja(this.minute,60),l=o.div,s=o.mod;if(l&&(this.minute=s,this.addHours(l,!1,a)),(it(a)||fe(a,this.hour))&&(it(i)||fe(i,this.minute)))break}},t.prototype.addSeconds=function(n,r,a,i,o){for(r&&(this.second+=Math.floor((86399-(3600*this.hour+60*this.minute+this.second))/n)*n);;){this.second+=n;var l=Ja(this.second,60),s=l.div,d=l.mod;if(s&&(this.second=d,this.addMinutes(s,!1,a,i)),(it(a)||fe(a,this.hour))&&(it(i)||fe(i,this.minute))&&(it(o)||fe(o,this.second)))break}},t.prototype.fixDay=function(){if(!(this.day<=28)){var n=Is(this.year,this.month-1)[1];if(!(this.day<=n))for(;this.day>n;){if(this.day-=n,++this.month,this.month===13&&(this.month=1,++this.year,this.year>9999))return;n=Is(this.year,this.month-1)[1]}}},t.prototype.add=function(n,r){var a=n.freq,i=n.interval,o=n.wkst,l=n.byhour,s=n.byminute,d=n.bysecond;switch(a){case _e.YEARLY:return this.addYears(i);case _e.MONTHLY:return this.addMonths(i);case _e.WEEKLY:return this.addWeekly(i,o);case _e.DAILY:return this.addDaily(i);case _e.HOURLY:return this.addHours(i,r,l);case _e.MINUTELY:return this.addMinutes(i,r,l,s);case _e.SECONDLY:return this.addSeconds(i,r,l,s,d)}},t}(qr);function ud(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var a=r[n];fe(yh,a)||t.push(a),ld(e[a])&&!zn(e[a])&&t.push(a)}if(t.length)throw new Error("Invalid options: "+t.join(", "));return Qe({},e)}function Qu(e){var t=Qe(Qe({},zi),ud(e));if(Ee(t.byeaster)&&(t.freq=B.YEARLY),!Ee(t.freq)||!B.FREQUENCIES[t.freq])throw new Error("Invalid frequency: ".concat(t.freq," ").concat(e.freq));if(t.dtstart||(t.dtstart=new Date(new Date().setMilliseconds(0))),Ee(t.wkst)?rt(t.wkst)||(t.wkst=t.wkst.weekday):t.wkst=B.MO.weekday,Ee(t.bysetpos)){rt(t.bysetpos)&&(t.bysetpos=[t.bysetpos]);for(var n=0;n<t.bysetpos.length;n++)if((i=t.bysetpos[n])===0||!(i>=-366&&i<=366))throw new Error("bysetpos must be between 1 and 366, or between -366 and -1")}if(!(t.byweekno||Se(t.byweekno)||Se(t.byyearday)||t.bymonthday||Se(t.bymonthday)||Ee(t.byweekday)||Ee(t.byeaster)))switch(t.freq){case B.YEARLY:t.bymonth||(t.bymonth=t.dtstart.getUTCMonth()+1),t.bymonthday=t.dtstart.getUTCDate();break;case B.MONTHLY:t.bymonthday=t.dtstart.getUTCDate();break;case B.WEEKLY:t.byweekday=[_n(t.dtstart)]}if(Ee(t.bymonth)&&!Ke(t.bymonth)&&(t.bymonth=[t.bymonth]),Ee(t.byyearday)&&!Ke(t.byyearday)&&rt(t.byyearday)&&(t.byyearday=[t.byyearday]),Ee(t.bymonthday))if(Ke(t.bymonthday)){var r=[],a=[];for(n=0;n<t.bymonthday.length;n++){var i;(i=t.bymonthday[n])>0?r.push(i):i<0&&a.push(i)}t.bymonthday=r,t.bynmonthday=a}else t.bymonthday<0?(t.bynmonthday=[t.bymonthday],t.bymonthday=[]):(t.bynmonthday=[],t.bymonthday=[t.bymonthday]);else t.bymonthday=[],t.bynmonthday=[];if(Ee(t.byweekno)&&!Ke(t.byweekno)&&(t.byweekno=[t.byweekno]),Ee(t.byweekday))if(rt(t.byweekday))t.byweekday=[t.byweekday],t.bynweekday=null;else if(Cs(t.byweekday))t.byweekday=[Be.fromStr(t.byweekday).weekday],t.bynweekday=null;else if(t.byweekday instanceof Be)!t.byweekday.n||t.freq>B.MONTHLY?(t.byweekday=[t.byweekday.weekday],t.bynweekday=null):(t.bynweekday=[[t.byweekday.weekday,t.byweekday.n]],t.byweekday=null);else{var o=[],l=[];for(n=0;n<t.byweekday.length;n++){var s=t.byweekday[n];rt(s)?o.push(s):Cs(s)?o.push(Be.fromStr(s).weekday):!s.n||t.freq>B.MONTHLY?o.push(s.weekday):l.push([s.weekday,s.n])}t.byweekday=Se(o)?o:null,t.bynweekday=Se(l)?l:null}else t.bynweekday=null;return Ee(t.byhour)?rt(t.byhour)&&(t.byhour=[t.byhour]):t.byhour=t.freq<B.HOURLY?[t.dtstart.getUTCHours()]:null,Ee(t.byminute)?rt(t.byminute)&&(t.byminute=[t.byminute]):t.byminute=t.freq<B.MINUTELY?[t.dtstart.getUTCMinutes()]:null,Ee(t.bysecond)?rt(t.bysecond)&&(t.bysecond=[t.bysecond]):t.bysecond=t.freq<B.SECONDLY?[t.dtstart.getUTCSeconds()]:null,{parsedOptions:t}}function hi(e){var t=e.split(`
`).map(Xu).filter(function(n){return n!==null});return Qe(Qe({},t[0]),t[1])}function Br(e){var t={},n=/DTSTART(?:;TZID=([^:=]+?))?(?::|=)([^;\s]+)/i.exec(e);if(!n)return t;var r=n[1],a=n[2];return r&&(t.tzid=r),t.dtstart=Fi(a),t}function Xu(e){if(!(e=e.replace(/^\s+|\s+$/,"")).length)return null;var t=/^([A-Z]+?)[:;]/.exec(e.toUpperCase());if(!t)return Ps(e);var n=t[1];switch(n.toUpperCase()){case"RRULE":case"EXRULE":return Ps(e);case"DTSTART":return Br(e);default:throw new Error("Unsupported RFC prop ".concat(n," in ").concat(e))}}function Ps(e){var t=Br(e.replace(/^RRULE:/i,""));return e.replace(/^(?:RRULE|EXRULE):/i,"").split(";").forEach(function(n){var r=n.split("="),a=r[0],i=r[1];switch(a.toUpperCase()){case"FREQ":t.freq=_e[i.toUpperCase()];break;case"WKST":t.wkst=et[i.toUpperCase()];break;case"COUNT":case"INTERVAL":case"BYSETPOS":case"BYMONTH":case"BYMONTHDAY":case"BYYEARDAY":case"BYWEEKNO":case"BYHOUR":case"BYMINUTE":case"BYSECOND":var o=function(d){return d.indexOf(",")!==-1?d.split(",").map(Ls):Ls(d)}(i),l=a.toLowerCase();t[l]=o;break;case"BYWEEKDAY":case"BYDAY":t.byweekday=function(d){var c=d.split(",");return c.map(function(u){if(u.length===2)return et[u];var f=u.match(/^([+-]?\d{1,2})([A-Z]{2})$/);if(!f||f.length<3)throw new SyntaxError("Invalid weekday string: ".concat(u));var v=Number(f[1]),g=f[2],h=et[g].weekday;return new Be(h,v)})}(i);break;case"DTSTART":case"TZID":var s=Br(e);t.tzid=s.tzid,t.dtstart=s.dtstart;break;case"UNTIL":t.until=Fi(i);break;case"BYEASTER":t.byeaster=Number(i);break;default:throw new Error("Unknown RRULE property '"+a+"'")}}),t}function Ls(e){return/^[+-]?\d+$/.test(e)?Number(e):e}var jr=function(){function e(t,n){if(isNaN(t.getTime()))throw new RangeError("Invalid date passed to DateWithZone");this.date=t,this.tzid=n}return Object.defineProperty(e.prototype,"isUTC",{get:function(){return!this.tzid||this.tzid.toUpperCase()==="UTC"},enumerable:!1,configurable:!0}),e.prototype.toString=function(){var t=Hi(this.date.getTime(),this.isUTC);return this.isUTC?":".concat(t):";TZID=".concat(this.tzid,":").concat(t)},e.prototype.getTime=function(){return this.date.getTime()},e.prototype.rezonedDate=function(){return this.isUTC?this.date:(t=this.date,n=this.tzid,r=Intl.DateTimeFormat().resolvedOptions().timeZone,a=new Date(Ms(t,r)),i=new Date(Ms(t,n??"UTC")).getTime()-a.getTime(),new Date(t.getTime()-i));var t,n,r,a,i},e}();function fi(e){for(var t,n=[],r="",a=Object.keys(e),i=Object.keys(zi),o=0;o<a.length;o++)if(a[o]!=="tzid"&&fe(i,a[o])){var l=a[o].toUpperCase(),s=e[a[o]],d="";if(Ee(s)&&(!Ke(s)||s.length)){switch(l){case"FREQ":d=B.FREQUENCIES[e.freq];break;case"WKST":d=rt(s)?new Be(s).toString():s.toString();break;case"BYWEEKDAY":l="BYDAY",d=(t=s,Ke(t)?t:[t]).map(function(g){return g instanceof Be?g:Ke(g)?new Be(g[0],g[1]):new Be(g)}).toString();break;case"DTSTART":r=Zu(s,e.tzid);break;case"UNTIL":d=Hi(s,!e.tzid);break;default:if(Ke(s)){for(var c=[],u=0;u<s.length;u++)c[u]=String(s[u]);d=c.toString()}else d=String(s)}d&&n.push([l,d])}}var f=n.map(function(g){var h=g[0],p=g[1];return"".concat(h,"=").concat(p.toString())}).join(";"),v="";return f!==""&&(v="RRULE:".concat(f)),[r,v].filter(function(g){return!!g}).join(`
`)}function Zu(e,t){return e?"DTSTART"+new jr(new Date(e),t).toString():""}function eh(e,t){return Array.isArray(e)?!!Array.isArray(t)&&e.length===t.length&&e.every(function(n,r){return n.getTime()===t[r].getTime()}):e instanceof Date?t instanceof Date&&e.getTime()===t.getTime():e===t}var th=function(){function e(){this.all=!1,this.before=[],this.after=[],this.between=[]}return e.prototype._cacheAdd=function(t,n,r){n&&(n=n instanceof Date?_i(n):Ns(n)),t==="all"?this.all=n:(r._value=n,this[t].push(r))},e.prototype._cacheGet=function(t,n){var r=!1,a=n?Object.keys(n):[],i=function(c){for(var u=0;u<a.length;u++){var f=a[u];if(!eh(n[f],c[f]))return!0}return!1},o=this[t];if(t==="all")r=this.all;else if(Ke(o))for(var l=0;l<o.length;l++){var s=o[l];if(!a.length||!i(s)){r=s._value;break}}if(!r&&this.all){var d=new cn(t,n);for(l=0;l<this.all.length&&d.accept(this.all[l]);l++);r=d.getValue(),this._cacheAdd(t,r,n)}return Ke(r)?Ns(r):r instanceof Date?_i(r):r},e}(),nh=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],ce(1,31),!0),ce(2,28),!0),ce(3,31),!0),ce(4,30),!0),ce(5,31),!0),ce(6,30),!0),ce(7,31),!0),ce(8,31),!0),ce(9,30),!0),ce(10,31),!0),ce(11,30),!0),ce(12,31),!0),ce(1,7)),rh=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],ce(1,31),!0),ce(2,29),!0),ce(3,31),!0),ce(4,30),!0),ce(5,31),!0),ce(6,30),!0),ce(7,31),!0),ce(8,31),!0),ce(9,30),!0),ce(10,31),!0),ce(11,30),!0),ce(12,31),!0),ce(1,7)),ah=ct(1,29),ih=ct(1,30),Tt=ct(1,31),Le=ct(1,32),oh=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],Le,!0),ih,!0),Le,!0),Tt,!0),Le,!0),Tt,!0),Le,!0),Le,!0),Tt,!0),Le,!0),Tt,!0),Le,!0),Le.slice(0,7)),sh=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],Le,!0),ah,!0),Le,!0),Tt,!0),Le,!0),Tt,!0),Le,!0),Le,!0),Tt,!0),Le,!0),Tt,!0),Le,!0),Le.slice(0,7)),lh=ct(-28,0),dh=ct(-29,0),At=ct(-30,0),Ve=ct(-31,0),ch=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],Ve,!0),dh,!0),Ve,!0),At,!0),Ve,!0),At,!0),Ve,!0),Ve,!0),At,!0),Ve,!0),At,!0),Ve,!0),Ve.slice(0,7)),_h=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],Ve,!0),lh,!0),Ve,!0),At,!0),Ve,!0),At,!0),Ve,!0),Ve,!0),At,!0),Ve,!0),At,!0),Ve,!0),Ve.slice(0,7)),uh=[0,31,60,91,121,152,182,213,244,274,305,335,366],hh=[0,31,59,90,120,151,181,212,243,273,304,334,365],Vs=function(){for(var e=[],t=0;t<55;t++)e=e.concat(ct(7));return e}();function fh(e,t){var n,r,a=Wt(e,1,1),i=Un(e)?366:365,o=Un(e+1)?366:365,l=ci(a),s=_n(a),d=Qe(Qe({yearlen:i,nextyearlen:o,yearordinal:l,yearweekday:s},function(A){var m=Un(A)?366:365,b=Wt(A,1,1),E=_n(b);return m===365?{mmask:nh,mdaymask:sh,nmdaymask:_h,wdaymask:Vs.slice(E),mrange:hh}:{mmask:rh,mdaymask:oh,nmdaymask:ch,wdaymask:Vs.slice(E),mrange:uh}}(e)),{wnomask:null});if(it(t.byweekno))return d;d.wnomask=ce(0,i+7);var c=n=Xe(7-s+t.wkst,7);c>=4?(c=0,r=d.yearlen+Xe(s-t.wkst,7)):r=i-c;for(var u=Math.floor(r/7),f=Xe(r,7),v=Math.floor(u+f/4),g=0;g<t.byweekno.length;g++){var h=t.byweekno[g];if(h<0&&(h+=v+1),h>0&&h<=v){var p=void 0;h>1?(p=c+7*(h-1),c!==n&&(p-=7-n)):p=c;for(var y=0;y<7&&(d.wnomask[p]=1,p++,d.wdaymask[p]!==t.wkst);y++);}}if(fe(t.byweekno,1)&&(p=c+7*v,c!==n&&(p-=7-n),p<i))for(g=0;g<7&&(d.wnomask[p]=1,p+=1,d.wdaymask[p]!==t.wkst);g++);if(c){var x=void 0;if(fe(t.byweekno,-1))x=-1;else{var S=_n(Wt(e-1,1,1)),O=Xe(7-S.valueOf()+t.wkst,7),I=Un(e-1)?366:365,N=void 0;O>=4?(O=0,N=I+Xe(S-t.wkst,7)):N=i-c,x=Math.floor(52+Xe(N,7)/4)}if(fe(t.byweekno,x))for(p=0;p<c;p++)d.wnomask[p]=1}return d}var ph=function(){function e(t){this.options=t}return e.prototype.rebuild=function(t,n){var r=this.options;if(t!==this.lastyear&&(this.yearinfo=fh(t,r)),Se(r.bynweekday)&&(n!==this.lastmonth||t!==this.lastyear)){var a=this.yearinfo,i=a.yearlen,o=a.mrange,l=a.wdaymask;this.monthinfo=function(s,d,c,u,f,v){var g={lastyear:s,lastmonth:d,nwdaymask:[]},h=[];if(v.freq===B.YEARLY)if(it(v.bymonth))h=[[0,c]];else for(var p=0;p<v.bymonth.length;p++)d=v.bymonth[p],h.push(u.slice(d-1,d+1));else v.freq===B.MONTHLY&&(h=[u.slice(d-1,d+1)]);if(it(h))return g;for(g.nwdaymask=ce(0,c),p=0;p<h.length;p++)for(var y=h[p],x=y[0],S=y[1]-1,O=0;O<v.bynweekday.length;O++){var I=void 0,N=v.bynweekday[O],A=N[0],m=N[1];m<0?(I=S+7*(m+1),I-=Xe(f[I]-A,7)):(I=x+7*(m-1),I+=Xe(7-f[I]+A,7)),x<=I&&I<=S&&(g.nwdaymask[I]=1)}return g}(t,n,i,o,l,r)}Ee(r.byeaster)&&(this.eastermask=function(s,d){d===void 0&&(d=0);var c=s%19,u=Math.floor(s/100),f=s%100,v=Math.floor(u/4),g=u%4,h=Math.floor((u+8)/25),p=Math.floor((u-h+1)/3),y=Math.floor(19*c+u-v-p+15)%30,x=Math.floor(f/4),S=f%4,O=Math.floor(32+2*g+2*x-y-S)%7,I=Math.floor((c+11*y+22*O)/451),N=Math.floor((y+O-7*I+114)/31),A=(y+O-7*I+114)%31+1,m=Date.UTC(s,N-1,A+d),b=Date.UTC(s,0,1);return[Math.ceil((m-b)/864e5)]}(t,r.byeaster))},Object.defineProperty(e.prototype,"lastyear",{get:function(){return this.monthinfo?this.monthinfo.lastyear:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastmonth",{get:function(){return this.monthinfo?this.monthinfo.lastmonth:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yearlen",{get:function(){return this.yearinfo.yearlen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yearordinal",{get:function(){return this.yearinfo.yearordinal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mrange",{get:function(){return this.yearinfo.mrange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wdaymask",{get:function(){return this.yearinfo.wdaymask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mmask",{get:function(){return this.yearinfo.mmask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wnomask",{get:function(){return this.yearinfo.wnomask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nwdaymask",{get:function(){return this.monthinfo?this.monthinfo.nwdaymask:[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextyearlen",{get:function(){return this.yearinfo.nextyearlen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mdaymask",{get:function(){return this.yearinfo.mdaymask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nmdaymask",{get:function(){return this.yearinfo.nmdaymask},enumerable:!1,configurable:!0}),e.prototype.ydayset=function(){return[ct(this.yearlen),0,this.yearlen]},e.prototype.mdayset=function(t,n){for(var r=this.mrange[n-1],a=this.mrange[n],i=ce(null,this.yearlen),o=r;o<a;o++)i[o]=o;return[i,r,a]},e.prototype.wdayset=function(t,n,r){for(var a=ce(null,this.yearlen+7),i=ci(Wt(t,n,r))-this.yearordinal,o=i,l=0;l<7&&(a[i]=i,++i,this.wdaymask[i]!==this.options.wkst);l++);return[a,o,i]},e.prototype.ddayset=function(t,n,r){var a=ce(null,this.yearlen),i=ci(Wt(t,n,r))-this.yearordinal;return a[i]=i,[a,i,i+1]},e.prototype.htimeset=function(t,n,r,a){var i=this,o=[];return this.options.byminute.forEach(function(l){o=o.concat(i.mtimeset(t,l,r,a))}),Zn(o),o},e.prototype.mtimeset=function(t,n,r,a){var i=this.options.bysecond.map(function(o){return new qr(t,n,o,a)});return Zn(i),i},e.prototype.stimeset=function(t,n,r,a){return[new qr(t,n,r,a)]},e.prototype.getdayset=function(t){switch(t){case _e.YEARLY:return this.ydayset.bind(this);case _e.MONTHLY:return this.mdayset.bind(this);case _e.WEEKLY:return this.wdayset.bind(this);case _e.DAILY:default:return this.ddayset.bind(this)}},e.prototype.gettimeset=function(t){switch(t){case _e.HOURLY:return this.htimeset.bind(this);case _e.MINUTELY:return this.mtimeset.bind(this);case _e.SECONDLY:return this.stimeset.bind(this)}},e}();function mh(e,t,n,r,a,i){for(var o=[],l=0;l<e.length;l++){var s=void 0,d=void 0,c=e[l];c<0?(s=Math.floor(c/t.length),d=Xe(c,t.length)):(s=Math.floor((c-1)/t.length),d=Xe(c-1,t.length));for(var u=[],f=n;f<r;f++){var v=i[f];Ee(v)&&u.push(v)}var g=void 0;g=s<0?u.slice(s)[0]:u[s];var h=t[d],p=dd(a.yearordinal+g),y=cd(p,h);fe(o,y)||o.push(y)}return Zn(o),o}function hd(e,t){var n=t.dtstart,r=t.freq,a=t.interval,i=t.until,o=t.bysetpos,l=t.count;if(l===0||a===0)return Fn(e);var s=Ju.fromDate(n),d=new ph(t);d.rebuild(s.year,s.month);for(var c=function(m,b,E){var k=E.freq,D=E.byhour,C=E.byminute,R=E.bysecond;return Qa(k)?function(P){var U=P.dtstart.getTime()%1e3;if(!Qa(P.freq))return[];var q=[];return P.byhour.forEach(function($){P.byminute.forEach(function(ee){P.bysecond.forEach(function(ie){q.push(new qr($,ee,ie,U))})})}),q}(E):k>=B.HOURLY&&Se(D)&&!fe(D,b.hour)||k>=B.MINUTELY&&Se(C)&&!fe(C,b.minute)||k>=B.SECONDLY&&Se(R)&&!fe(R,b.second)?[]:m.gettimeset(k)(b.hour,b.minute,b.second,b.millisecond)}(d,s,t);;){var u=d.getdayset(r)(s.year,s.month,s.day),f=u[0],v=u[1],g=u[2],h=vh(f,v,g,d,t);if(Se(o))for(var p=mh(o,c,v,g,d,f),y=0;y<p.length;y++){var x=p[y];if(i&&x>i)return Fn(e);if(x>=n){var S=$s(x,t);if(!e.accept(S)||l&&!--l)return Fn(e)}}else for(y=v;y<g;y++){var O=f[y];if(Ee(O))for(var I=dd(d.yearordinal+O),N=0;N<c.length;N++){var A=c[N];if(x=cd(I,A),i&&x>i||x>=n&&(S=$s(x,t),!e.accept(S)||l&&!--l))return Fn(e)}}if(t.interval===0||(s.add(t,h),s.year>9999))return Fn(e);Qa(r)||(c=d.gettimeset(r)(s.hour,s.minute,s.second,0)),d.rebuild(s.year,s.month)}}function gh(e,t,n){var r=n.bymonth,a=n.byweekno,i=n.byweekday,o=n.byeaster,l=n.bymonthday,s=n.bynmonthday,d=n.byyearday;return Se(r)&&!fe(r,e.mmask[t])||Se(a)&&!e.wnomask[t]||Se(i)&&!fe(i,e.wdaymask[t])||Se(e.nwdaymask)&&!e.nwdaymask[t]||o!==null&&!fe(e.eastermask,t)||(Se(l)||Se(s))&&!fe(l,e.mdaymask[t])&&!fe(s,e.nmdaymask[t])||Se(d)&&(t<e.yearlen&&!fe(d,t+1)&&!fe(d,-e.yearlen+t)||t>=e.yearlen&&!fe(d,t+1-e.yearlen)&&!fe(d,-e.nextyearlen+t-e.yearlen))}function $s(e,t){return new jr(e,t.tzid).rezonedDate()}function Fn(e){return e.getValue()}function vh(e,t,n,r,a){for(var i=!1,o=t;o<n;o++){var l=e[o];(i=gh(r,l,a))&&(e[l]=null)}return i}var et={MO:new Be(0),TU:new Be(1),WE:new Be(2),TH:new Be(3),FR:new Be(4),SA:new Be(5),SU:new Be(6)},zi={freq:_e.YEARLY,dtstart:null,interval:1,wkst:et.MO,count:null,until:null,tzid:null,bysetpos:null,bymonth:null,bymonthday:null,bynmonthday:null,byyearday:null,byweekno:null,byweekday:null,bynweekday:null,byhour:null,byminute:null,bysecond:null,byeaster:null},yh=Object.keys(zi),B=function(){function e(t,n){t===void 0&&(t={}),n===void 0&&(n=!1),this._cache=n?null:new th,this.origOptions=ud(t);var r=Qu(t).parsedOptions;this.options=r}return e.parseText=function(t,n){return _d(t,n)},e.fromText=function(t,n){return Ku(t,n)},e.fromString=function(t){return new e(e.parseString(t)||void 0)},e.prototype._iter=function(t){return hd(t,this.options)},e.prototype._cacheGet=function(t,n){return!!this._cache&&this._cache._cacheGet(t,n)},e.prototype._cacheAdd=function(t,n,r){if(this._cache)return this._cache._cacheAdd(t,n,r)},e.prototype.all=function(t){if(t)return this._iter(new Os("all",{},t));var n=this._cacheGet("all");return n===!1&&(n=this._iter(new cn("all",{})),this._cacheAdd("all",n)),n},e.prototype.between=function(t,n,r,a){if(r===void 0&&(r=!1),!zn(t)||!zn(n))throw new Error("Invalid date passed in to RRule.between");var i={before:n,after:t,inc:r};if(a)return this._iter(new Os("between",i,a));var o=this._cacheGet("between",i);return o===!1&&(o=this._iter(new cn("between",i)),this._cacheAdd("between",o,i)),o},e.prototype.before=function(t,n){if(n===void 0&&(n=!1),!zn(t))throw new Error("Invalid date passed in to RRule.before");var r={dt:t,inc:n},a=this._cacheGet("before",r);return a===!1&&(a=this._iter(new cn("before",r)),this._cacheAdd("before",a,r)),a},e.prototype.after=function(t,n){if(n===void 0&&(n=!1),!zn(t))throw new Error("Invalid date passed in to RRule.after");var r={dt:t,inc:n},a=this._cacheGet("after",r);return a===!1&&(a=this._iter(new cn("after",r)),this._cacheAdd("after",a,r)),a},e.prototype.count=function(){return this.all().length},e.prototype.toString=function(){return fi(this.origOptions)},e.prototype.toText=function(t,n,r){return function(a,i,o,l){return new ht(a,i,o,l).toString()}(this,t,n,r)},e.prototype.isFullyConvertibleToText=function(){return Gu(this)},e.prototype.clone=function(){return new e(this.origOptions)},e.FREQUENCIES=["YEARLY","MONTHLY","WEEKLY","DAILY","HOURLY","MINUTELY","SECONDLY"],e.YEARLY=_e.YEARLY,e.MONTHLY=_e.MONTHLY,e.WEEKLY=_e.WEEKLY,e.DAILY=_e.DAILY,e.HOURLY=_e.HOURLY,e.MINUTELY=_e.MINUTELY,e.SECONDLY=_e.SECONDLY,e.MO=et.MO,e.TU=et.TU,e.WE=et.WE,e.TH=et.TH,e.FR=et.FR,e.SA=et.SA,e.SU=et.SU,e.parseString=hi,e.optionsToString=fi,e}(),Hs={dtstart:null,cache:!1,unfold:!1,forceset:!1,compatible:!1,tzid:null};function bh(e,t){var n=[],r=[],a=[],i=[],o=Br(e),l=o.dtstart,s=o.tzid,d=function(c,u){if(u===void 0&&(u=!1),c=c&&c.trim(),!c)throw new Error("Invalid empty string");if(!u)return c.split(/\s/);for(var f=c.split(`
`),v=0;v<f.length;){var g=f[v]=f[v].replace(/\s+$/g,"");g?v>0&&g[0]===" "?(f[v-1]+=g.slice(1),f.splice(v,1)):v+=1:f.splice(v,1)}return f}(e,t.unfold);return d.forEach(function(c){var u;if(c){var f=function(y){var x=function(N){if(N.indexOf(":")===-1)return{name:"RRULE",value:N};var A=(E=N,k=":",D=1,C=E.split(k),D?C.slice(0,D).concat([C.slice(D).join(k)]):C),m=A[0],b=A[1],E,k,D,C;return{name:m,value:b}}(y),S=x.name,O=x.value,I=S.split(";");if(!I)throw new Error("empty property name");return{name:I[0].toUpperCase(),parms:I.slice(1),value:O}}(c),v=f.name,g=f.parms,h=f.value;switch(v.toUpperCase()){case"RRULE":if(g.length)throw new Error("unsupported RRULE parm: ".concat(g.join(",")));n.push(hi(c));break;case"RDATE":var p=((u=/RDATE(?:;TZID=([^:=]+))?/i.exec(c))!==null&&u!==void 0?u:[])[1];p&&!s&&(s=p),r=r.concat(Fs(h,g));break;case"EXRULE":if(g.length)throw new Error("unsupported EXRULE parm: ".concat(g.join(",")));a.push(hi(h));break;case"EXDATE":i=i.concat(Fs(h,g));break;case"DTSTART":break;default:throw new Error("unsupported property: "+v)}}}),{dtstart:l,tzid:s,rrulevals:n,rdatevals:r,exrulevals:a,exdatevals:i}}function Wn(e,t){return t===void 0&&(t={}),function(n,r){var a=bh(n,r),i=a.rrulevals,o=a.rdatevals,l=a.exrulevals,s=a.exdatevals,d=a.dtstart,c=a.tzid,u=r.cache===!1;if(r.compatible&&(r.forceset=!0,r.unfold=!0),r.forceset||i.length>1||o.length||l.length||s.length){var f=new wh(u);return f.dtstart(d),f.tzid(c||void 0),i.forEach(function(g){f.rrule(new B(Xa(g,d,c),u))}),o.forEach(function(g){f.rdate(g)}),l.forEach(function(g){f.exrule(new B(Xa(g,d,c),u))}),s.forEach(function(g){f.exdate(g)}),r.compatible&&r.dtstart&&f.rdate(d),f}var v=i[0]||{};return new B(Xa(v,v.dtstart||r.dtstart||d,v.tzid||r.tzid||c),u)}(e,function(n){var r=[],a=Object.keys(n),i=Object.keys(Hs);if(a.forEach(function(o){fe(i,o)||r.push(o)}),r.length)throw new Error("Invalid options: "+r.join(", "));return Qe(Qe({},Hs),n)}(t))}function Xa(e,t,n){return Qe(Qe({},e),{dtstart:t,tzid:n})}function Fs(e,t){return function(n){n.forEach(function(r){if(!/(VALUE=DATE(-TIME)?)|(TZID=)/.test(r))throw new Error("unsupported RDATE/EXDATE parm: "+r)})}(t),e.split(",").map(function(n){return Fi(n)})}function Us(e){var t=this;return function(n){if(n!==void 0&&(t["_".concat(e)]=n),t["_".concat(e)]!==void 0)return t["_".concat(e)];for(var r=0;r<t._rrule.length;r++){var a=t._rrule[r].origOptions[e];if(a)return a}}}var wh=function(e){function t(n){n===void 0&&(n=!1);var r=e.call(this,{},n)||this;return r.dtstart=Us.apply(r,["dtstart"]),r.tzid=Us.apply(r,["tzid"]),r._rrule=[],r._rdate=[],r._exrule=[],r._exdate=[],r}return Ui(t,e),t.prototype._iter=function(n){return function(r,a,i,o,l,s){var d={},c=r.accept;function u(h,p){i.forEach(function(y){y.between(h,p,!0).forEach(function(x){d[Number(x)]=!0})})}l.forEach(function(h){var p=new jr(h,s).rezonedDate();d[Number(p)]=!0}),r.accept=function(h){var p=Number(h);return isNaN(p)?c.call(this,h):!(!d[p]&&(u(new Date(p-1),new Date(p+1)),!d[p]))||(d[p]=!0,c.call(this,h))},r.method==="between"&&(u(r.args.after,r.args.before),r.accept=function(h){var p=Number(h);return!!d[p]||(d[p]=!0,c.call(this,h))});for(var f=0;f<o.length;f++){var v=new jr(o[f],s).rezonedDate();if(!r.accept(new Date(v.getTime())))break}a.forEach(function(h){hd(r,h.options)});var g=r._result;switch(Zn(g),r.method){case"all":case"between":return g;case"before":return g.length&&g[g.length-1]||null;default:return g.length&&g[0]||null}}(n,this._rrule,this._exrule,this._rdate,this._exdate,this.tzid())},t.prototype.rrule=function(n){zs(n,this._rrule)},t.prototype.exrule=function(n){zs(n,this._exrule)},t.prototype.rdate=function(n){qs(n,this._rdate)},t.prototype.exdate=function(n){qs(n,this._exdate)},t.prototype.rrules=function(){return this._rrule.map(function(n){return Wn(n.toString())})},t.prototype.exrules=function(){return this._exrule.map(function(n){return Wn(n.toString())})},t.prototype.rdates=function(){return this._rdate.map(function(n){return new Date(n.getTime())})},t.prototype.exdates=function(){return this._exdate.map(function(n){return new Date(n.getTime())})},t.prototype.valueOf=function(){var n=[];return!this._rrule.length&&this._dtstart&&(n=n.concat(fi({dtstart:this._dtstart}))),this._rrule.forEach(function(r){n=n.concat(r.toString().split(`
`))}),this._exrule.forEach(function(r){n=n.concat(r.toString().split(`
`).map(function(a){return a.replace(/^RRULE:/,"EXRULE:")}).filter(function(a){return!/^DTSTART/.test(a)}))}),this._rdate.length&&n.push(Bs("RDATE",this._rdate,this.tzid())),this._exdate.length&&n.push(Bs("EXDATE",this._exdate,this.tzid())),n},t.prototype.toString=function(){return this.valueOf().join(`
`)},t.prototype.clone=function(){var n=new t(!!this._cache);return this._rrule.forEach(function(r){return n.rrule(r.clone())}),this._exrule.forEach(function(r){return n.exrule(r.clone())}),this._rdate.forEach(function(r){return n.rdate(new Date(r.getTime()))}),this._exdate.forEach(function(r){return n.exdate(new Date(r.getTime()))}),n},t}(B);function zs(e,t){if(!(e instanceof B))throw new TypeError(String(e)+" is not RRule instance");fe(t.map(String),String(e))||t.push(e)}function qs(e,t){if(!(e instanceof Date))throw new TypeError(String(e)+" is not Date instance");fe(t.map(Number),Number(e))||(t.push(e),Zn(t))}function Bs(e,t,n){var r=!n||n.toUpperCase()==="UTC",a=r?"".concat(e,":"):"".concat(e,";TZID=").concat(n,":"),i=t.map(function(o){return Hi(o.valueOf(),r)}).join(",");return"".concat(a).concat(i)}class xh{constructor(t){this._scheduler=t}getNode(){const t=this._scheduler;return this._tooltipNode||(this._tooltipNode=document.createElement("div"),this._tooltipNode.className="dhtmlXTooltip scheduler_tooltip tooltip",t._waiAria.tooltipAttr(this._tooltipNode)),t.config.rtl?this._tooltipNode.classList.add("dhtmlXTooltip_rtl"):this._tooltipNode.classList.remove("dhtmlXTooltip_rtl"),this._tooltipNode}setViewport(t){return this._root=t,this}show(t,n){const r=this._scheduler,a=r.$domHelpers,i=document.body,o=this.getNode();if(a.isChildOf(o,i)||(this.hide(),i.appendChild(o)),this._isLikeMouseEvent(t)){const l=this._calculateTooltipPosition(t);n=l.top,t=l.left}return o.style.top=n+"px",o.style.left=t+"px",r._waiAria.tooltipVisibleAttr(o),this}hide(){const t=this._scheduler,n=this.getNode();return n&&n.parentNode&&n.parentNode.removeChild(n),t._waiAria.tooltipHiddenAttr(n),this}setContent(t){return this.getNode().innerHTML=t,this}_isLikeMouseEvent(t){return!(!t||typeof t!="object")&&"clientX"in t&&"clientY"in t}_getViewPort(){return this._root||document.body}_calculateTooltipPosition(t){const n=this._scheduler,r=n.$domHelpers,a=this._getViewPortSize(),i=this.getNode(),o={top:0,left:0,width:i.offsetWidth,height:i.offsetHeight,bottom:0,right:0},l=n.config.tooltip_offset_x,s=n.config.tooltip_offset_y,d=document.body,c=r.getRelativeEventPosition(t,d),u=r.getNodePosition(d);c.y+=u.y,o.top=c.y,o.left=c.x,o.top+=s,o.left+=l,o.bottom=o.top+o.height,o.right=o.left+o.width;const f=window.scrollY+d.scrollTop;return o.top<a.top-f?(o.top=a.top,o.bottom=o.top+o.height):o.bottom>a.bottom&&(o.bottom=a.bottom,o.top=o.bottom-o.height),o.left<a.left?(o.left=a.left,o.right=a.left+o.width):o.right>a.right&&(o.right=a.right,o.left=o.right-o.width),c.x>=o.left&&c.x<=o.right&&(o.left=c.x-o.width-l,o.right=o.left+o.width),c.y>=o.top&&c.y<=o.bottom&&(o.top=c.y-o.height-s,o.bottom=o.top+o.height),o.left<0&&(o.left=0),o.right<0&&(o.right=0),o}_getViewPortSize(){const t=this._scheduler,n=t.$domHelpers,r=this._getViewPort();let a,i=r,o=window.scrollY+document.body.scrollTop,l=window.scrollX+document.body.scrollLeft;return r===t.$event_data?(i=t.$event,o=0,l=0,a=n.getNodePosition(t.$event)):a=n.getNodePosition(i),{left:a.x+l,top:a.y+o,width:a.width,height:a.height,bottom:a.y+a.height+o,right:a.x+a.width+l}}}class Eh{constructor(t){this._listeners={},this.tooltip=new xh(t),this._scheduler=t,this._domEvents=t._createDomEventScope(),this._initDelayedFunctions()}destructor(){this.tooltip.hide(),this._domEvents.detachAll()}hideTooltip(){this.delayHide()}attach(t){let n=document.body;const r=this._scheduler,a=r.$domHelpers;t.global||(n=r.$root);let i=null;const o=l=>{const s=a.getTargetNode(l),d=a.closest(s,t.selector);if(a.isChildOf(s,this.tooltip.getNode()))return;const c=()=>{i=d,t.onmouseenter(l,d)};r._mobile&&r.config.touch_tooltip&&(d?c():t.onmouseleave(l,d)),i?d&&d===i?t.onmousemove(l,d):(t.onmouseleave(l,i),i=null,d&&d!==i&&c()):d&&c()};this.detach(t.selector),this._domEvents.attach(n,"mousemove",o),this._listeners[t.selector]={node:n,handler:o}}detach(t){const n=this._listeners[t];n&&this._domEvents.detach(n.node,"mousemove",n.handler)}tooltipFor(t){const n=r=>{let a=r;return document.createEventObject&&!document.createEvent&&(a=document.createEventObject(r)),a};this._initDelayedFunctions(),this.attach({selector:t.selector,global:t.global,onmouseenter:(r,a)=>{const i=t.html(r,a);i&&this.delayShow(n(r),i)},onmousemove:(r,a)=>{const i=t.html(r,a);i?this.delayShow(n(r),i):(this.delayShow.$cancelTimeout(),this.delayHide())},onmouseleave:()=>{this.delayShow.$cancelTimeout(),this.delayHide()}})}_initDelayedFunctions(){const t=this._scheduler;this.delayShow&&this.delayShow.$cancelTimeout(),this.delayHide&&this.delayHide.$cancelTimeout(),this.tooltip.hide(),this.delayShow=tt.delay((n,r)=>{t.callEvent("onBeforeTooltip",[n])===!1?this.tooltip.hide():(this.tooltip.setContent(r),this.tooltip.show(n))},t.config.tooltip_timeout||1),this.delayHide=tt.delay(()=>{this.delayShow.$cancelTimeout(),this.tooltip.hide()},t.config.tooltip_hide_timeout||1)}}const kh={active_links:function(e){e.config.active_link_view="day",e._active_link_click=function(t){var n=t.target.getAttribute("data-link-date"),r=e.date.str_to_date(e.config.api_date,!1,!0);if(n)return e.setCurrentView(r(n),e.config.active_link_view),t&&t.preventDefault&&t.preventDefault(),!1},e.attachEvent("onTemplatesReady",function(){var t=function(r,a){a=a||r+"_scale_date",e.templates["_active_links_old_"+a]||(e.templates["_active_links_old_"+a]=e.templates[a]);var i=e.templates["_active_links_old_"+a],o=e.date.date_to_str(e.config.api_date);e.templates[a]=function(l){return"<a data-link-date='"+o(l)+"' href='#'>"+i(l)+"</a>"}};if(t("week"),t("","month_day"),this.matrix)for(var n in this.matrix)t(n);this._detachDomEvent(this._obj,"click",e._active_link_click),e.event(this._obj,"click",e._active_link_click)})},agenda_legacy:function(e){e.date.add_agenda_legacy=function(t){return e.date.add(t,1,"year")},e.templates.agenda_legacy_time=function(t,n,r){return r._timed?this.day_date(r.start_date,r.end_date,r)+" "+this.event_date(t):e.templates.day_date(t)+" &ndash; "+e.templates.day_date(n)},e.templates.agenda_legacy_text=function(t,n,r){return r.text},e.templates.agenda_legacy_date=function(){return""},e.date.agenda_legacy_start=function(){return e.date.date_part(e._currentDate())},e.attachEvent("onTemplatesReady",function(){var t=e.dblclick_dhx_cal_data;e.dblclick_dhx_cal_data=function(){if(this._mode=="agenda_legacy")!this.config.readonly&&this.config.dblclick_create&&this.addEventNow();else if(t)return t.apply(this,arguments)};var n=e.render_data;e.render_data=function(i){if(this._mode!="agenda_legacy")return n.apply(this,arguments);a()};var r=e.render_view_data;function a(){var i=e.get_visible_events();i.sort(function(y,x){return y.start_date>x.start_date?1:-1});for(var o,l="<div class='dhx_agenda_area' "+e._waiAria.agendaDataAttrString()+">",s=0;s<i.length;s++){var d=i[s],c=d.color?"--dhx-scheduler-event-background:"+d.color+";":"",u=d.textColor?"--dhx-scheduler-event-color:"+d.textColor+";":"",f=e.templates.event_class(d.start_date,d.end_date,d);o=e._waiAria.agendaEventAttrString(d);var v=e._waiAria.agendaDetailsBtnString();l+="<div "+o+" class='dhx_agenda_line"+(f?" "+f:"")+"' event_id='"+d.id+"' "+e.config.event_attribute+"='"+d.id+"' style='"+u+c+(d._text_style||"")+"'><div class='dhx_agenda_event_time'>"+(e.config.rtl?e.templates.agenda_time(d.end_date,d.start_date,d):e.templates.agenda_time(d.start_date,d.end_date,d))+"</div>",l+=`<div ${v} class='dhx_event_icon icon_details'><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path d="M15.4444 16.4H4.55556V7.6H15.4444V16.4ZM13.1111 2V3.6H6.88889V2H5.33333V3.6H4.55556C3.69222 3.6 3 4.312 3 5.2V16.4C3 16.8243 3.16389 17.2313 3.45561 17.5314C3.74733 17.8314 4.143 18 4.55556 18H15.4444C15.857 18 16.2527 17.8314 16.5444 17.5314C16.8361 17.2313 17 16.8243 17 16.4V5.2C17 4.312 16.3 3.6 15.4444 3.6H14.6667V2H13.1111ZM13.8889 10.8H10V14.8H13.8889V10.8Z" fill="#A1A4A6"/>
			</svg></div>`,l+="<span>"+e.templates.agenda_text(d.start_date,d.end_date,d)+"</span></div>"}l+="<div class='dhx_v_border'></div></div>",e._els.dhx_cal_data[0].innerHTML=l,e._els.dhx_cal_data[0].childNodes[0].scrollTop=e._agendaScrollTop||0;var g=e._els.dhx_cal_data[0].childNodes[0];g.childNodes[g.childNodes.length-1].style.height=g.offsetHeight<e._els.dhx_cal_data[0].offsetHeight?"100%":g.offsetHeight+"px";var h=e._els.dhx_cal_data[0].firstChild.childNodes,p=e._getNavDateElement();for(p&&(p.innerHTML=e.templates.agenda_date(e._min_date,e._max_date,e._mode)),e._rendered=[],s=0;s<h.length-1;s++)e._rendered[s]=h[s]}e.render_view_data=function(){return this._mode=="agenda_legacy"&&(e._agendaScrollTop=e._els.dhx_cal_data[0].childNodes[0].scrollTop,e._els.dhx_cal_data[0].childNodes[0].scrollTop=0),r.apply(this,arguments)},e.agenda_legacy_view=function(i){e._min_date=e.config.agenda_start||e.date.agenda_legacy_start(e._date),e._max_date=e.config.agenda_end||e.date.add_agenda_legacy(e._min_date,1),function(o){if(o){var l=e.locale.labels,s=e._waiAria.agendaHeadAttrString(),d=e._waiAria.agendaHeadDateString(l.date),c=e._waiAria.agendaHeadDescriptionString(l.description);e._els.dhx_cal_header[0].innerHTML="<div "+s+" class='dhx_agenda_line dhx_agenda_line_header'><div "+d+">"+l.date+"</div><span class = 'description_header' style='padding-left:25px' "+c+">"+l.description+"</span></div>",e._table_view=!0,e.set_sizes()}}(i),i?(e._cols=null,e._colsS=null,e._table_view=!0,a()):e._table_view=!1}})},agenda_view:function(e){e.date.add_agenda=function(a,i){return e.date.add(a,1*i,"month")},e.templates.agenda_time=function(a,i,o){return o._timed?`${this.event_date(a)} - ${this.event_date(i)}`:e.locale.labels.full_day},e.templates.agenda_text=function(a,i,o){return o.text};const t=e.date.date_to_str("%F %j"),n=e.date.date_to_str("%l");e.templates.agenda_day=function(a){return`<div class="dhx_agenda_day_date">${t(a)}</div>
		<div class="dhx_agenda_day_dow">${n(a)}</div>`},e.templates.agenda_date=function(a,i){return e.templates.month_date(e.getState().date)},e.date.agenda_start=function(a){return e.date.month_start(new Date(a))};let r=0;e.attachEvent("onTemplatesReady",function(){var a=e.dblclick_dhx_cal_data;e.dblclick_dhx_cal_data=function(){if(this._mode=="agenda")!this.config.readonly&&this.config.dblclick_create&&this.addEventNow();else if(a)return a.apply(this,arguments)};var i=e.render_data;e.render_data=function(d){if(this._mode!="agenda")return i.apply(this,arguments);l()};var o=e.render_view_data;function l(){const d=e.get_visible_events();d.sort(function(p,y){return p.start_date>y.start_date?1:-1});const c={};let u=e.getState().min_date;const f=e.getState().max_date;for(;u.valueOf()<f.valueOf();)c[u.valueOf()]=[],u=e.date.add(u,1,"day");let v=!1;if(d.forEach(p=>{let y=e.date.day_start(new Date(p.start_date));for(;y.valueOf()<p.end_date.valueOf();)c[y.valueOf()]&&(c[y.valueOf()].push(p),v=!0),y=e.date.day_start(e.date.add(y,1,"day"))}),v){let p="";for(let y in c)e.ignore_agenda&&e.ignore_agenda(new Date(1*y))||(p+=s(new Date(1*y),c[y]));e._els.dhx_cal_data[0].innerHTML=p}else e._els.dhx_cal_data[0].innerHTML=`<div class="dhx_cal_agenda_no_events">${e.locale.labels.agenda_tab}</div>`;e._els.dhx_cal_data[0].scrollTop=r;let g=e._els.dhx_cal_data[0].querySelectorAll(".dhx_cal_agenda_event_line");e._rendered=[];for(var h=0;h<g.length-1;h++)e._rendered[h]=g[h]}function s(d,c){if(!c.length)return"";let u=`
<div class="dhx_cal_agenda_day" data-date="${e.templates.format_date(d)}" data-day="${d.getDay()}">
	<div class="dhx_cal_agenda_day_header">${e.templates.agenda_day(d)}</div>
	<div class="dhx_cal_agenda_day_events">
`;return c.forEach(f=>{u+=function(v,g){const h=e.templates.agenda_time(g.start_date,g.end_date,g),p=e.getState().select_id,y=e.templates.event_class(g.start_date,g.end_date,g),x=e.templates.agenda_text(g.start_date,g.end_date,g);let S="";return(g.color||g.textColor)&&(S=` style="${g.color?"--dhx-scheduler-event-background:"+g.color+";":""}${g.textColor?"--dhx-scheduler-event-color:"+g.textColor+";":""}" `),`<div class="dhx_cal_agenda_event_line ${y||""} ${g.id==p?"dhx_cal_agenda_event_line_selected":""}" ${S} ${e.config.event_attribute}="${g.id}">
	<div class="dhx_cal_agenda_event_line_marker"></div>
	<div class="dhx_cal_agenda_event_line_time">${h}</div>
	<div class="dhx_cal_agenda_event_line_text">${x}</div>
</div>`}(0,f)}),u+="</div></div>",u}e.render_view_data=function(){return this._mode=="agenda"&&(r=e._els.dhx_cal_data[0].scrollTop,e._els.dhx_cal_data[0].scrollTop=0),o.apply(this,arguments)},e.agenda_view=function(d){d?(e._min_date=e.config.agenda_start||e.date.agenda_start(e._date),e._max_date=e.config.agenda_end||e.date.add_agenda(e._min_date,1),e._cols=null,e._colsS=null,e._table_view=!0,e._getNavDateElement().innerHTML=e.templates.agenda_date(e._date),l()):e._table_view=!1}})},all_timed:function(e){e.config.all_timed="short",e.config.all_timed_month=!1,e.ext.allTimed={isMainAreaEvent:function(l){return!!(l._timed||e.config.all_timed===!0||e.config.all_timed=="short"&&t(l))}};var t=function(l){return!((l.end_date-l.start_date)/36e5>=24)||e._drag_mode=="resize"&&e._drag_id==l.id};e._safe_copy=function(l){var s=null,d=e._copy_event(l);return l.event_pid&&(s=e.getEvent(l.event_pid)),s&&s.isPrototypeOf(l)&&(delete d.event_length,delete d.event_pid,delete d.rec_pattern,delete d.rec_type),d};var n=e._pre_render_events_line,r=e._pre_render_events_table,a=function(l,s){return this._table_view?r.call(this,l,s):n.call(this,l,s)};e._pre_render_events_line=e._pre_render_events_table=function(l,s){if(!this.config.all_timed||this._table_view&&this._mode!="month"||this._mode=="month"&&!this.config.all_timed_month)return a.call(this,l,s);for(var d=0;d<l.length;d++){var c=l[d];if(!c._timed)if(this.config.all_timed!="short"||t(c)){var u=this._safe_copy(c);c._virtual?u._first_chunk=!1:u._first_chunk=!0,u._drag_resize=!1,u._virtual=!0,u.start_date=new Date(u.start_date),h(c)?(u.end_date=p(u.start_date),this.config.last_hour!=24&&(u.end_date=y(u.start_date,this.config.last_hour))):u.end_date=new Date(c.end_date);var f=!1;u.start_date<this._max_date&&u.end_date>this._min_date&&u.start_date<u.end_date&&(l[d]=u,f=!0);var v=this._safe_copy(c);if(v._virtual=!0,v.end_date=new Date(v.end_date),v.start_date<this._min_date?v.start_date=y(this._min_date,this.config.first_hour):v.start_date=y(p(c.start_date),this.config.first_hour),v.start_date<this._max_date&&v.start_date<v.end_date){if(!f){l[d--]=v;continue}l.splice(d+1,0,v),v._last_chunk=!1}else u._last_chunk=!0,u._drag_resize=!0}else this._mode!="month"&&l.splice(d--,1)}var g=this._drag_mode!="move"&&s;return a.call(this,l,g);function h(x){var S=p(x.start_date);return+x.end_date>+S}function p(x){var S=e.date.add(x,1,"day");return S=e.date.date_part(S)}function y(x,S){var O=e.date.date_part(new Date(x));return O.setHours(S),O}};var i=e.get_visible_events;e.get_visible_events=function(l){return this.config.all_timed&&this.config.multi_day?i.call(this,!1):i.call(this,l)},e.attachEvent("onBeforeViewChange",function(l,s,d,c){return e._allow_dnd=d=="day"||d=="week"||e.getView(d),!0}),e._is_main_area_event=function(l){return e.ext.allTimed.isMainAreaEvent(l)};var o=e.updateEvent;e.updateEvent=function(l){var s,d,c=e.getEvent(l);c&&(s=e.config.all_timed&&!(e.isOneDayEvent(e._events[l])||e.getState().drag_id))&&(d=e.config.update_render,e.config.update_render=!0),o.apply(e,arguments),c&&s&&(e.config.update_render=d)}},collision:function(e){let t,n;function r(a){e._get_section_view()&&a&&(t=e.getEvent(a)[e._get_section_property()])}e.config.collision_limit=1,e.attachEvent("onBeforeDrag",function(a){return r(a),!0}),e.attachEvent("onBeforeLightbox",function(a){const i=e.getEvent(a);return n=[i.start_date,i.end_date],r(a),!0}),e.attachEvent("onEventChanged",function(a){if(!a||!e.getEvent(a))return!0;const i=e.getEvent(a);if(!e.checkCollision(i)){if(!n)return!1;i.start_date=n[0],i.end_date=n[1],i._timed=this.isOneDayEvent(i)}return!0}),e.attachEvent("onBeforeEventChanged",function(a,i,o){return e.checkCollision(a)}),e.attachEvent("onEventAdded",function(a,i){e.checkCollision(i)||e.deleteEvent(a)}),e.attachEvent("onEventSave",function(a,i,o){if((i=e._lame_clone(i)).id=a,!i.start_date||!i.end_date){const l=e.getEvent(a);i.start_date=new Date(l.start_date),i.end_date=new Date(l.end_date)}return(i.rrule&&!i.recurring_event_id||i.rec_type)&&e._roll_back_dates(i),e.checkCollision(i)}),e._check_sections_collision=function(a,i){const o=e._get_section_property();return a[o]==i[o]&&a.id!=i.id},e.checkCollision=function(a){let i=[];const o=e.config.collision_limit;if(a.rec_type){let c=e.getRecDates(a);for(let u=0;u<c.length;u++){let f=e.getEvents(c[u].start_date,c[u].end_date);for(let v=0;v<f.length;v++)(f[v].event_pid||f[v].id)!=a.id&&i.push(f[v])}}else if(a.rrule){let c=e.getRecDates(a);for(let u=0;u<c.length;u++){let f=e.getEvents(c[u].start_date,c[u].end_date);for(let v=0;v<f.length;v++)(String(f[v].id).split("#")[0]||f[v].id)!=a.id&&i.push(f[v])}}else{i=e.getEvents(a.start_date,a.end_date);for(let c=0;c<i.length;c++){let u=i[c];if(u.id==a.id||u.event_length&&[u.event_pid,u.event_length].join("#")==a.id){i.splice(c,1);break}if(u.recurring_event_id&&[u.recurring_event_id,u._pid_time].join("#")==a.id){i.splice(c,1);break}}}const l=e._get_section_view(),s=e._get_section_property();let d=!0;if(l){let c=0;for(let u=0;u<i.length;u++)i[u].id!=a.id&&this._check_sections_collision(i[u],a)&&c++;c>=o&&(d=!1)}else i.length>=o&&(d=!1);if(!d){let c=!e.callEvent("onEventCollision",[a,i]);return c||(a[s]=t||a[s]),c}return d}},container_autoresize:function(e){e.config.container_autoresize=!0,e.config.month_day_min_height=90,e.config.min_grid_size=25,e.config.min_map_size=400;var t=e._pre_render_events,n=!0,r=0,a=0;e._pre_render_events=function(c,u){if(!e.config.container_autoresize||!n)return t.apply(this,arguments);var f=this.xy.bar_height,v=this._colsS.heights,g=this._colsS.heights=[0,0,0,0,0,0,0],h=this._els.dhx_cal_data[0];if(c=this._table_view?this._pre_render_events_table(c,u):this._pre_render_events_line(c,u),this._table_view)if(u)this._colsS.heights=v;else{var p=h.firstChild;const A=p.querySelectorAll(".dhx_cal_month_row");if(A&&A.length){for(var y=0;y<A.length;y++){if(g[y]++,g[y]*f>this._colsS.height-this.xy.month_head_height){var x=A[y].querySelectorAll(".dhx_cal_month_cell"),S=this._colsS.height-this.xy.month_head_height;1*this.config.max_month_events!==this.config.max_month_events||g[y]<=this.config.max_month_events?S=g[y]*f:(this.config.max_month_events+1)*f>this._colsS.height-this.xy.month_head_height&&(S=(this.config.max_month_events+1)*f),A[y].style.height=S+this.xy.month_head_height+"px";for(var O=0;O<x.length;O++)x[O].childNodes[1].style.height=S+"px";g[y]=(g[y-1]||0)+x[0].offsetHeight}g[y]=(g[y-1]||0)+A[y].querySelectorAll(".dhx_cal_month_cell")[0].offsetHeight}g.unshift(0),p.parentNode.offsetHeight<p.parentNode.scrollHeight&&p._h_fix}else if(c.length||this._els.dhx_multi_day[0].style.visibility!="visible"||(g[0]=-1),c.length||g[0]==-1){var I=(g[0]+1)*f+1;a!=I+1&&(this._obj.style.height=r-a+I-1+"px"),I+="px";const m=this._els.dhx_cal_navline[0].offsetHeight,b=this._els.dhx_cal_header[0].offsetHeight;h.style.height=this._obj.offsetHeight-m-b-(this.xy.margin_top||0)+"px";var N=this._els.dhx_multi_day[0];N.style.height=I,N.style.visibility=g[0]==-1?"hidden":"visible",N.style.display=g[0]==-1?"none":"",(N=this._els.dhx_multi_day[1]).style.height=I,N.style.visibility=g[0]==-1?"hidden":"visible",N.style.display=g[0]==-1?"none":"",N.className=g[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small",this._dy_shift=(g[0]+1)*f,g[0]=0}}return c};var i=["dhx_cal_navline","dhx_cal_header","dhx_multi_day","dhx_cal_data"],o=function(c){r=0;for(var u=0;u<i.length;u++){var f=i[u],v=e._els[f]?e._els[f][0]:null,g=0;switch(f){case"dhx_cal_navline":case"dhx_cal_header":g=v.offsetHeight;break;case"dhx_multi_day":g=v?v.offsetHeight-1:0,a=g;break;case"dhx_cal_data":var h=e.getState().mode;if(v.childNodes[1]&&h!="month"){let D=0;for(let C=0;C<v.childNodes.length;C++)v.childNodes[C].offsetHeight>D&&(D=v.childNodes[C].offsetHeight);g=D}else g=Math.max(v.offsetHeight-1,v.scrollHeight);if(h=="month")e.config.month_day_min_height&&!c&&(g=v.querySelectorAll(".dhx_cal_month_row").length*e.config.month_day_min_height),c&&(v.style.height=g+"px");else if(h=="year")g=190*e.config.year_y;else if(h=="agenda"){if(g=0,v.children&&v.children.length)if(v.children.length===1&&v.children[0].classList.contains("dhx_cal_agenda_no_events"))g=300;else for(var p=0;p<v.children.length;p++)g+=v.children[p].offsetHeight;g+2<e.config.min_grid_size?g=e.config.min_grid_size:g+=2}else if(h=="week_agenda"){for(var y,x,S=e.xy.week_agenda_scale_height+e.config.min_grid_size,O=0;O<v.childNodes.length;O++)for(x=v.childNodes[O],p=0;p<x.childNodes.length;p++){for(var I=0,N=x.childNodes[p].childNodes[1],A=0;A<N.childNodes.length;A++)I+=N.childNodes[A].offsetHeight;y=I+e.xy.week_agenda_scale_height,(y=O!=1||p!=2&&p!=3?y:2*y)>S&&(S=y)}g=3*S}else if(h=="map"){g=0;var m=v.querySelectorAll(".dhx_map_line");for(p=0;p<m.length;p++)g+=m[p].offsetHeight;g+2<e.config.min_map_size?g=e.config.min_map_size:g+=2}else if(e._gridView)if(g=0,v.childNodes[1].childNodes[0].childNodes&&v.childNodes[1].childNodes[0].childNodes.length){for(m=v.childNodes[1].childNodes[0].childNodes[0].childNodes,p=0;p<m.length;p++)g+=m[p].offsetHeight;(g+=2)<e.config.min_grid_size&&(g=e.config.min_grid_size)}else g=e.config.min_grid_size;if(e.matrix&&e.matrix[h]){if(c)g+=0,v.style.height=g+"px";else{g=0;for(var b=e.matrix[h],E=b.y_unit,k=0;k<E.length;k++)g+=b.getSectionHeight(E[k].key);e.$container.clientWidth!=e.$container.scrollWidth&&(g+=d())}g-=1}(h=="day"||h=="week"||e._props&&e._props[h])&&(g+=2)}r+=g+=1}e._obj.style.height=r+"px",c||e.updateView()};function l(){n=!1,e.callEvent("onAfterSchedulerResize",[]),n=!0}var s=function(){if(!e.config.container_autoresize||!n)return!0;var c=e.getState().mode;if(!c)return!0;var u=window.requestAnimationFrame||window.setTimeout,f=document.documentElement.scrollTop;u(function(){!e.$destroyed&&e.$initialized&&o()}),e.matrix&&e.matrix[c]||c=="month"?u(function(){!e.$destroyed&&e.$initialized&&(o(!0),document.documentElement.scrollTop=f,l())},1):l()};function d(){var c=document.createElement("div");c.style.cssText="visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;",document.body.appendChild(c);var u=c.offsetWidth-c.clientWidth;return document.body.removeChild(c),u}e.attachEvent("onBeforeViewChange",function(){var c=e.config.container_autoresize;if(e.xy.$original_scroll_width||(e.xy.$original_scroll_width=e.xy.scroll_width),e.xy.scroll_width=c?0:e.xy.$original_scroll_width,e.matrix)for(var u in e.matrix){var f=e.matrix[u];f.$original_section_autoheight||(f.$original_section_autoheight=f.section_autoheight),f.section_autoheight=!c&&f.$original_section_autoheight}return!0}),e.attachEvent("onViewChange",s),e.attachEvent("onXLE",s),e.attachEvent("onEventChanged",s),e.attachEvent("onEventCreated",s),e.attachEvent("onEventAdded",s),e.attachEvent("onEventDeleted",s),e.attachEvent("onAfterSchedulerResize",s),e.attachEvent("onClearAll",s),e.attachEvent("onBeforeExpand",function(){return n=!1,!0}),e.attachEvent("onBeforeCollapse",function(){return n=!0,!0})},cookie:function(e){function t(a){return(a._obj.id||"scheduler")+"_settings"}var n=!0;e.attachEvent("onBeforeViewChange",function(a,i,o,l){if(n&&e._get_url_nav){var s=e._get_url_nav();(s.date||s.mode||s.event)&&(n=!1)}var d=t(e);if(n){n=!1;var c=function(f){var v=f+"=";if(document.cookie.length>0){var g=document.cookie.indexOf(v);if(g!=-1){g+=v.length;var h=document.cookie.indexOf(";",g);return h==-1&&(h=document.cookie.length),document.cookie.substring(g,h)}}return""}(d);if(c){e._min_date||(e._min_date=l),(c=unescape(c).split("@"))[0]=this._helpers.parseDate(c[0]);var u=this.isViewExists(c[1])?c[1]:o;return l=isNaN(+c[0])?l:c[0],window.setTimeout(function(){e.$destroyed||e.setCurrentView(l,u)},1),!1}}return!0}),e.attachEvent("onViewChange",function(a,i){var o,l,s=t(e),d=escape(this._helpers.formatDate(i)+"@"+a);l=s+"="+d+((o="expires=Sun, 31 Jan 9999 22:00:00 GMT")?"; "+o:""),document.cookie=l});var r=e._load;e._load=function(){var a=arguments;if(e._date)r.apply(this,a);else{var i=this;window.setTimeout(function(){r.apply(i,a)},1)}}},daytimeline:function(e){Et("Day Timeline",e.assert)},drag_between:function(e){Et("Drag Between",e.assert)},editors:function(e){e.form_blocks.combo={render:function(t){t.cached_options||(t.cached_options={});const n=t.height?`style='height:${t.height}px;'`:"";var r="";return r+=`<div class='${t.type}' ${n}></div>`},set_value:function(t,n,r,a){(function(){v();var f=e.attachEvent("onAfterLightbox",function(){v(),e.detachEvent(f)});function v(){if(t._combo&&t._combo.DOMParent){var g=t._combo;g.unload?g.unload():g.destructor&&g.destructor(),g.DOMParent=g.DOMelem=null}}})(),window.dhx_globalImgPath=a.image_path||"/",t._combo=new dhtmlXCombo(t,a.name,t.offsetWidth-8),a.onchange&&t._combo.attachEvent("onChange",a.onchange),a.options_height&&t._combo.setOptionHeight(a.options_height);var i=t._combo;if(i.enableFilteringMode(a.filtering,a.script_path||null,!!a.cache),a.script_path){var o=r[a.map_to];o?a.cached_options[o]?(i.addOption(o,a.cached_options[o]),i.disable(1),i.selectOption(0),i.disable(0)):e.ajax.get(a.script_path+"?id="+o+"&uid="+e.uid(),function(f){var v,g=f.xmlDoc.responseText;try{v=JSON.parse(g).options[0].text}catch{v=e.ajax.xpath("//option",f.xmlDoc)[0].childNodes[0].nodeValue}a.cached_options[o]=v,i.addOption(o,v),i.disable(1),i.selectOption(0),i.disable(0)}):i.setComboValue("")}else{for(var l=[],s=0;s<a.options.length;s++){var d=a.options[s],c=[d.key,d.label,d.css];l.push(c)}if(i.addOption(l),r[a.map_to]){var u=i.getIndexByValue(r[a.map_to]);i.selectOption(u)}}},get_value:function(t,n,r){var a=t._combo.getSelectedValue();return r.script_path&&(r.cached_options[a]=t._combo.getSelectedText()),a},focus:function(t){}},e.form_blocks.radio={render:function(t){var n="";n+=`<div class='dhx_cal_ltext dhx_cal_radio ${t.vertical?"dhx_cal_radio_vertical":""}' style='height:${t.height}px;'>`;for(var r=0;r<t.options.length;r++){var a=e.uid();n+="<label class='dhx_cal_radio_item' for='"+a+"'><input id='"+a+"' type='radio' name='"+t.name+"' value='"+t.options[r].key+"'><span> "+t.options[r].label+"</span></label>"}return n+="</div>"},set_value:function(t,n,r,a){for(var i=t.getElementsByTagName("input"),o=0;o<i.length;o++){i[o].checked=!1;var l=r[a.map_to]||n;i[o].value==l&&(i[o].checked=!0)}},get_value:function(t,n,r){for(var a=t.getElementsByTagName("input"),i=0;i<a.length;i++)if(a[i].checked)return a[i].value},focus:function(t){}},e.form_blocks.checkbox={render:function(t){return e.config.wide_form?'<div class="dhx_cal_wide_checkbox"></div>':""},set_value:function(t,n,r,a){t=e._lightbox.querySelector(`#${a.id}`),a.height&&(t.style.height=`${a.height}px`);var i=e.uid(),o=a.checked_value!==void 0?n==a.checked_value:!!n;t.className+=" dhx_cal_checkbox";var l="<input id='"+i+"' type='checkbox' value='true' name='"+a.name+"'"+(o?"checked='true'":"")+"'>",s="<label for='"+i+"'>"+(e.locale.labels["section_"+a.name]||a.name)+"</label>";if(e.config.wide_form?(t.innerHTML=s,t.nextSibling.innerHTML=l):t.innerHTML=l+s,a.handler){var d=t.getElementsByTagName("input")[0];if(d.$_eventAttached)return;d.$_eventAttached=!0,e.event(d,"click",a.handler)}},get_value:function(t,n,r){var a=(t=e._lightbox.querySelector(`#${r.id}`)).getElementsByTagName("input")[0];return a||(a=t.nextSibling.getElementsByTagName("input")[0]),a.checked?r.checked_value||!0:r.unchecked_value||!1},focus:function(t){}}},expand:function(e){e.ext.fullscreen={toggleIcon:null},e.expand=function(){if(e.callEvent("onBeforeExpand",[])){var t=e._obj;do t._position=t.style.position||"",t.style.position="static";while((t=t.parentNode)&&t.style);(t=e._obj).style.position="absolute",t._width=t.style.width,t._height=t.style.height,t.style.width=t.style.height="100%",t.style.top=t.style.left="0px";var n=document.body;n.scrollTop=0,(n=n.parentNode)&&(n.scrollTop=0),document.body._overflow=document.body.style.overflow||"",document.body.style.overflow="hidden",e._maximize(),e.callEvent("onExpand",[])}},e.collapse=function(){if(e.callEvent("onBeforeCollapse",[])){var t=e._obj;do t.style.position=t._position;while((t=t.parentNode)&&t.style);(t=e._obj).style.width=t._width,t.style.height=t._height,document.body.style.overflow=document.body._overflow,e._maximize(),e.callEvent("onCollapse",[])}},e.attachEvent("onTemplatesReady",function(){var t=document.createElement("div");t.className="dhx_expand_icon",e.ext.fullscreen.toggleIcon=t,t.innerHTML=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
	<g>
	<line x1="0.5" y1="5" x2="0.5" y2="3.0598e-08" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line y1="0.5" x2="5" y2="0.5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="0.5" y1="11" x2="0.5" y2="16" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line y1="15.5" x2="5" y2="15.5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="11" y1="0.5" x2="16" y2="0.5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="15.5" y1="2.18557e-08" x2="15.5" y2="5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="11" y1="15.5" x2="16" y2="15.5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="15.5" y1="16" x2="15.5" y2="11" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	</g>
	</svg>
	`,e._obj.appendChild(t),e.event(t,"click",function(){e.expanded?e.collapse():e.expand()})}),e._maximize=function(){this.expanded=!this.expanded,this.expanded?this.ext.fullscreen.toggleIcon.classList.add("dhx_expand_icon--expanded"):this.ext.fullscreen.toggleIcon.classList.remove("dhx_expand_icon--expanded");for(var t=["left","top"],n=0;n<t.length;n++){var r=e["_prev_margin_"+t[n]];e.xy["margin_"+t[n]]?(e["_prev_margin_"+t[n]]=e.xy["margin_"+t[n]],e.xy["margin_"+t[n]]=0):r&&(e.xy["margin_"+t[n]]=e["_prev_margin_"+t[n]],delete e["_prev_margin_"+t[n]])}e.setCurrentView()}},export_api:function(e){(function(){function t(r,a){for(var i in a)r[i]||(r[i]=a[i]);return r}function n(r,a){var i={};return(r=a._els[r])&&r[0]?(i.x=r[0].scrollWidth,i.y=r[0].scrollHeight):(i.x=0,i.y=0),i}window.dhtmlxAjax||(window.dhtmlxAjax={post:function(r,a,i){return window.dhx4.ajax.post(r,a,i)},get:function(r,a){return window.ajax.get(r,a)}}),function(r){function a(){var i=r.getState().mode;return r.matrix&&r.matrix[i]?r.matrix[i]:null}r.exportToPDF=function(i){(i=t(i||{},{name:"calendar.pdf",format:"A4",orientation:"landscape",dpi:96,zoom:1,rtl:r.config.rtl})).html=this._export_html(i),i.mode=this.getState().mode,this._send_to_export(i,"pdf")},r.exportToPNG=function(i){(i=t(i||{},{name:"calendar.png",format:"A4",orientation:"landscape",dpi:96,zoom:1,rtl:r.config.rtl})).html=this._export_html(i),i.mode=this.getState().mode,this._send_to_export(i,"png")},r.exportToICal=function(i){i=t(i||{},{name:"calendar.ical",data:this._serialize_plain(null,i)}),this._send_to_export(i,"ical")},r.exportToExcel=function(i){i=t(i||{},{name:"calendar.xlsx",title:"Events",data:this._serialize_plain(this.templates.xml_format,i),columns:this._serialize_columns()}),this._send_to_export(i,"excel")},r._ajax_to_export=function(i,o,l){delete i.callback;var s=i.server||"https://export.dhtmlx.com/scheduler";window.dhtmlxAjax.post(s,"type="+o+"&store=1&data="+encodeURIComponent(JSON.stringify(i)),function(d){var c=null;if(!(d.xmlDoc.status>400))try{c=JSON.parse(d.xmlDoc.responseText)}catch{}l(c)})},r._plain_export_copy=function(i,o){var l={};for(var s in i)l[s]=i[s];return l.start_date=o(l.start_date),l.end_date=o(l.end_date),l.$text=this.templates.event_text(i.start_date,i.end_date,i),l},r._serialize_plain=function(i,o){var l;i=i||r.date.date_to_str("%Y%m%dT%H%i%s",!0),l=o&&o.start&&o.end?r.getEvents(o.start,o.end):r.getEvents();for(var s=[],d=0;d<l.length;d++)s[d]=this._plain_export_copy(l[d],i);return s},r._serialize_columns=function(){return[{id:"start_date",header:"Start Date",width:30},{id:"end_date",header:"End Date",width:30},{id:"$text",header:"Text",width:100}]},r._send_to_export=function(i,o){if(i.version||(i.version=r.version),i.skin||(i.skin=r.skin),i.callback)return r._ajax_to_export(i,o,i.callback);var l=this._create_hidden_form();l.firstChild.action=i.server||"https://export.dhtmlx.com/scheduler",l.firstChild.childNodes[0].value=JSON.stringify(i),l.firstChild.childNodes[1].value=o,l.firstChild.submit()},r._create_hidden_form=function(){if(!this._hidden_export_form){var i=this._hidden_export_form=document.createElement("div");i.style.display="none",i.innerHTML="<form method='POST' target='_blank'><input type='text' name='data'><input type='hidden' name='type' value=''></form>",document.body.appendChild(i)}return this._hidden_export_form},r._get_export_size=function(i,o,l,s,d,c,u){s=parseInt(s)/25.4||4;var f={A5:{x:148,y:210},A4:{x:210,y:297},A3:{x:297,y:420},A2:{x:420,y:594},A1:{x:594,y:841},A0:{x:841,y:1189}},v=n("dhx_cal_data",this).x,g={y:n("dhx_cal_data",this).y+n("dhx_cal_header",this).y+n("dhx_multi_day",this).y};return g.x=i==="full"?v:Math.floor((o==="landscape"?f[i].y:f[i].x)*s),u&&(g.x*=parseFloat(u.x)||1,g.y*=parseFloat(u.y)||1),g},r._export_html=function(i){var o,l,s,d=(o=void 0,l=void 0,(s=a())&&(l=s.scrollable,o=s.smart_rendering),{nav_height:r.xy.nav_height,scroll_width:r.xy.scroll_width,style_width:r._obj.style.width,style_height:r._obj.style.height,timeline_scrollable:l,timeline_smart_rendering:o}),c=r._get_export_size(i.format,i.orientation,i.zoom,i.dpi,i.header,i.footer,i.scales),u="";try{(function(f,v){r._obj.style.width=f.x+"px",r._obj.style.height=f.y+"px",r.xy.nav_height=0,r.xy.scroll_width=0;var g=a();(v.timeline_scrollable||v.timeline_smart_rendering)&&(g.scrollable=!1,g.smart_rendering=!1)})(c,d),r.setCurrentView(),u=r._obj.innerHTML}catch(f){console.error(f)}finally{(function(f){r.xy.scroll_width=f.scroll_width,r.xy.nav_height=f.nav_height,r._obj.style.width=f.style_width,r._obj.style.height=f.style_height;var v=a();(f.timeline_scrollable||f.timeline_smart_rendering)&&(v.scrollable=f.timeline_scrollable,v.smart_rendering=f.timeline_smart_rendering)})(d),r.setCurrentView()}return u}}(e)})()},grid_view:function(e){Et("Grid",e.assert)},html_templates:function(e){e.attachEvent("onTemplatesReady",function(){for(var t=document.body.getElementsByTagName("DIV"),n=0;n<t.length;n++){var r=t[n].className||"";if((r=r.split(":")).length==2&&r[0]=="template"){var a='return "'+(t[n].innerHTML||"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/[\n\r]+/g,"")+'";';a=unescape(a).replace(/\{event\.([a-z]+)\}/g,function(i,o){return'"+ev.'+o+'+"'}),e.templates[r[1]]=Function("start","end","ev",a),t[n].style.display="none"}}})},key_nav:function(e){function t(n){var r={minicalButton:e.$keyboardNavigation.MinicalButton,minicalDate:e.$keyboardNavigation.MinicalCell,scheduler:e.$keyboardNavigation.SchedulerNode,dataArea:e.$keyboardNavigation.DataArea,timeSlot:e.$keyboardNavigation.TimeSlot,event:e.$keyboardNavigation.Event},a={};for(var i in r)a[i.toLowerCase()]=r[i];return a[n=(n+"").toLowerCase()]||r.scheduler}e.config.key_nav=!0,e.config.key_nav_step=30,e.addShortcut=function(n,r,a){var i=t(a);i&&i.prototype.bind(n,r)},e.getShortcutHandler=function(n,r){var a=t(r);if(a){var i=e.$keyboardNavigation.shortcuts.parse(n);if(i.length)return a.prototype.findHandler(i[0])}},e.removeShortcut=function(n,r){var a=t(r);a&&a.prototype.unbind(n)},e.focus=function(){if(e.config.key_nav){var n=e.$keyboardNavigation.dispatcher;n.enable();var r=n.getActiveNode();!r||r instanceof e.$keyboardNavigation.MinicalButton||r instanceof e.$keyboardNavigation.MinicalCell?n.setDefaultNode():n.focusNode(n.getActiveNode())}},e.$keyboardNavigation={},e._compose=function(){for(var n=Array.prototype.slice.call(arguments,0),r={},a=0;a<n.length;a++){var i=n[a];for(var o in typeof i=="function"&&(i=new i),i)r[o]=i[o]}return r},function(n){n.$keyboardNavigation.shortcuts={createCommand:function(){return{modifiers:{shift:!1,alt:!1,ctrl:!1,meta:!1},keyCode:null}},parse:function(r){for(var a=[],i=this.getExpressions(this.trim(r)),o=0;o<i.length;o++){for(var l=this.getWords(i[o]),s=this.createCommand(),d=0;d<l.length;d++)this.commandKeys[l[d]]?s.modifiers[l[d]]=!0:this.specialKeys[l[d]]?s.keyCode=this.specialKeys[l[d]]:s.keyCode=l[d].charCodeAt(0);a.push(s)}return a},getCommandFromEvent:function(r){var a=this.createCommand();a.modifiers.shift=!!r.shiftKey,a.modifiers.alt=!!r.altKey,a.modifiers.ctrl=!!r.ctrlKey,a.modifiers.meta=!!r.metaKey,a.keyCode=r.which||r.keyCode,a.keyCode>=96&&a.keyCode<=105&&(a.keyCode-=48);var i=String.fromCharCode(a.keyCode);return i&&(a.keyCode=i.toLowerCase().charCodeAt(0)),a},getHashFromEvent:function(r){return this.getHash(this.getCommandFromEvent(r))},getHash:function(r){var a=[];for(var i in r.modifiers)r.modifiers[i]&&a.push(i);return a.push(r.keyCode),a.join(this.junctionChar)},getExpressions:function(r){return r.split(this.junctionChar)},getWords:function(r){return r.split(this.combinationChar)},trim:function(r){return r.replace(/\s/g,"")},junctionChar:",",combinationChar:"+",commandKeys:{shift:16,alt:18,ctrl:17,meta:!0},specialKeys:{backspace:8,tab:9,enter:13,esc:27,space:32,up:38,down:40,left:37,right:39,home:36,end:35,pageup:33,pagedown:34,delete:46,insert:45,plus:107,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123}}}(e),function(n){n.$keyboardNavigation.EventHandler={_handlers:null,findHandler:function(r){this._handlers||(this._handlers={});var a=n.$keyboardNavigation.shortcuts.getHash(r);return this._handlers[a]},doAction:function(r,a){var i=this.findHandler(r);i&&(i.call(this,a),a.preventDefault?a.preventDefault():a.returnValue=!1)},bind:function(r,a){this._handlers||(this._handlers={});for(var i=n.$keyboardNavigation.shortcuts,o=i.parse(r),l=0;l<o.length;l++)this._handlers[i.getHash(o[l])]=a},unbind:function(r){for(var a=n.$keyboardNavigation.shortcuts,i=a.parse(r),o=0;o<i.length;o++)this._handlers[a.getHash(i[o])]&&delete this._handlers[a.getHash(i[o])]},bindAll:function(r){for(var a in r)this.bind(a,r[a])},initKeys:function(){this._handlers||(this._handlers={}),this.keys&&this.bindAll(this.keys)}}}(e),function(n){n.$keyboardNavigation.getFocusableNodes=n._getFocusableNodes,n.$keyboardNavigation.trapFocus=function(r,a){if(a.keyCode!=9)return!1;for(var i,o=n.$keyboardNavigation.getFocusableNodes(r),l=document.activeElement,s=-1,d=0;d<o.length;d++)if(o[d]==l){s=d;break}if(a.shiftKey){if(i=o[s<=0?o.length-1:s-1])return i.focus(),a.preventDefault(),!0}else if(i=o[s>=o.length-1?0:s+1])return i.focus(),a.preventDefault(),!0;return!1}}(e),function(n){n.$keyboardNavigation.marker={clear:function(){for(var r=n.$container.querySelectorAll(".dhx_focus_slot"),a=0;a<r.length;a++)r[a].parentNode.removeChild(r[a])},createElement:function(){var r=document.createElement("div");return r.setAttribute("tabindex",-1),r.className="dhx_focus_slot",r},renderMultiple:function(r,a,i){for(var o=[],l=new Date(r),s=new Date(Math.min(a.valueOf(),n.date.add(n.date.day_start(new Date(r)),1,"day").valueOf()));l.valueOf()<a.valueOf();)o=o.concat(i.call(this,l,new Date(Math.min(s.valueOf(),a.valueOf())))),l=n.date.day_start(n.date.add(l,1,"day")),s=n.date.day_start(n.date.add(l,1,"day")),s=new Date(Math.min(s.valueOf(),a.valueOf()));return o},render:function(r,a,i){this.clear();var o=[],l=n.$keyboardNavigation.TimeSlot.prototype._modes;switch(n.$keyboardNavigation.TimeSlot.prototype._getMode()){case l.units:o=this.renderVerticalMarker(r,a,i);break;case l.timeline:o=this.renderTimelineMarker(r,a,i);break;case l.year:o=o.concat(this.renderMultiple(r,a,this.renderYearMarker));break;case l.month:o=this.renderMonthMarker(r,a);break;case l.weekAgenda:o=o.concat(this.renderMultiple(r,a,this.renderWeekAgendaMarker));break;case l.list:o=this.renderAgendaMarker(r,a);break;case l.dayColumns:o=o.concat(this.renderMultiple(r,a,this.renderVerticalMarker))}this.addWaiAriaLabel(o,r,a,i),this.addDataAttributes(o,r,a,i);for(var s=o.length-1;s>=0;s--)if(o[s].offsetWidth)return o[s];return null},addDataAttributes:function(r,a,i,o){for(var l=n.date.date_to_str(n.config.api_date),s=l(a),d=l(i),c=0;c<r.length;c++)r[c].setAttribute("data-start-date",s),r[c].setAttribute("data-end-date",d),o&&r[c].setAttribute("data-section",o)},addWaiAriaLabel:function(r,a,i,o){var l="",s=n.getState().mode,d=!1;if(l+=n.templates.day_date(a),n.date.day_start(new Date(a)).valueOf()!=a.valueOf()&&(l+=" "+n.templates.hour_scale(a),d=!0),n.date.day_start(new Date(a)).valueOf()!=n.date.day_start(new Date(i)).valueOf()&&(l+=" - "+n.templates.day_date(i),(d||n.date.day_start(new Date(i)).valueOf()!=i.valueOf())&&(l+=" "+n.templates.hour_scale(i))),o){if(n.matrix&&n.matrix[s]){const u=n.matrix[s],f=u.y_unit[u.order[o]];l+=", "+n.templates[s+"_scale_label"](f.key,f.label,f)}else if(n._props&&n._props[s]){const u=n._props[s],f=u.options[u.order[o]];l+=", "+n.templates[s+"_scale_text"](f.key,f.label,f)}}for(var c=0;c<r.length;c++)n._waiAria.setAttributes(r[c],{"aria-label":l,"aria-live":"polite"})},renderWeekAgendaMarker:function(r,a){for(var i=n.$container.querySelectorAll(".dhx_wa_day_cont .dhx_wa_scale_bar"),o=n.date.week_start(new Date(n.getState().min_date)),l=-1,s=n.date.day_start(new Date(r)),d=0;d<i.length&&(l++,n.date.day_start(new Date(o)).valueOf()!=s.valueOf());d++)o=n.date.add(o,1,"day");return l!=-1?this._wrapDiv(i[l]):[]},_wrapDiv:function(r){var a=this.createElement();return a.style.top=r.offsetTop+"px",a.style.left=r.offsetLeft+"px",a.style.width=r.offsetWidth+"px",a.style.height=r.offsetHeight+"px",r.appendChild(a),[a]},renderYearMarker:function(r,a){var i=n._get_year_cell(r);i.style.position="relative";var o=this.createElement();return o.style.top="0px",o.style.left="0px",o.style.width="100%",o.style.height="100%",i.appendChild(o),[o]},renderAgendaMarker:function(r,a){var i=this.createElement();return i.style.height="1px",i.style.width="100%",i.style.opacity=1,i.style.top="0px",i.style.left="0px",n.$container.querySelector(".dhx_cal_data").appendChild(i),[i]},renderTimelineMarker:function(r,a,i){var o=n._lame_copy({},n.matrix[n._mode]),l=o._scales;o.round_position=!1;var s=[],d=r?new Date(r):n._min_date,c=a?new Date(a):n._max_date;if(d.valueOf()<n._min_date.valueOf()&&(d=new Date(n._min_date)),c.valueOf()>n._max_date.valueOf()&&(c=new Date(n._max_date)),!o._trace_x)return s;for(var u=0;u<o._trace_x.length&&!n._is_column_visible(o._trace_x[u]);u++);if(u==o._trace_x.length)return s;var f=l[i];if(!(d<a&&c>r))return s;var v=this.createElement();let g,h;function p(I,N){N.setDate(1),N.setFullYear(I.getFullYear()),N.setMonth(I.getMonth()),N.setDate(I.getDate())}if(n.getView().days){const I=new Date(r);p(n._min_date,I);const N=new Date(a);p(n._min_date,N),g=n._timeline_getX({start_date:I},!1,o),h=n._timeline_getX({start_date:N},!1,o)}else g=n._timeline_getX({start_date:r},!1,o),h=n._timeline_getX({start_date:a},!1,o);var y=o._section_height[i]-1||o.dy-1,x=0;n._isRender("cell")&&(x=f.offsetTop,g+=o.dx,h+=o.dx,f=n.$container.querySelector(".dhx_cal_data"));var S=Math.max(1,h-g-1);let O="left";return n.config.rtl&&(O="right"),v.style.cssText=`height:${y}px; ${O}:${g}px; width:${S}px; top:${x}px;`,f&&(f.appendChild(v),s.push(v)),s},renderMonthCell:function(r){for(var a=n.$container.querySelectorAll(".dhx_month_head"),i=[],o=0;o<a.length;o++)i.push(a[o].parentNode);var l=-1,s=0,d=-1,c=n.date.week_start(new Date(n.getState().min_date)),u=n.date.day_start(new Date(r));for(o=0;o<i.length&&(l++,d==6?(s++,d=0):d++,n.date.day_start(new Date(c)).valueOf()!=u.valueOf());o++)c=n.date.add(c,1,"day");if(l==-1)return[];var f=n._colsS[d],v=n._colsS.heights[s],g=this.createElement();g.style.top=v+"px",g.style.left=f+"px",g.style.width=n._cols[d]+"px",g.style.height=(n._colsS.heights[s+1]-v||n._colsS.height)+"px";var h=n.$container.querySelector(".dhx_cal_data"),p=h.querySelector(".dhx_cal_month_table");return p.nextSibling?h.insertBefore(g,p.nextSibling):h.appendChild(g),g},renderMonthMarker:function(r,a){for(var i=[],o=r;o.valueOf()<a.valueOf();)i.push(this.renderMonthCell(o)),o=n.date.add(o,1,"day");return i},renderVerticalMarker:function(r,a,i){var o=n.locate_holder_day(r),l=[],s=null,d=n.config;if(n._ignores[o])return l;if(n._props&&n._props[n._mode]&&i){var c=n._props[n._mode];o=c.order[i];var u=c.order[i];c.days>1?o=n.locate_holder_day(r)+u:(o=u,c.size&&o>c.position+c.size&&(o=0))}if(!(s=n.locate_holder(o))||s.querySelector(".dhx_scale_hour"))return document.createElement("div");var f=Math.max(60*r.getHours()+r.getMinutes(),60*d.first_hour),v=Math.min(60*a.getHours()+a.getMinutes(),60*d.last_hour);if(!v&&n.date.day_start(new Date(a)).valueOf()>n.date.day_start(new Date(r)).valueOf()&&(v=60*d.last_hour),v<=f)return[];var g=this.createElement(),h=n.config.hour_size_px*d.last_hour+1,p=36e5;return g.style.top=Math.round((60*f*1e3-n.config.first_hour*p)*n.config.hour_size_px/p)%h+"px",g.style.lineHeight=g.style.height=Math.max(Math.round(60*(v-f)*1e3*n.config.hour_size_px/p)%h,1)+"px",g.style.width="100%",s.appendChild(g),l.push(g),l[0]}}}(e),function(n){n.$keyboardNavigation.SchedulerNode=function(){},n.$keyboardNavigation.SchedulerNode.prototype=n._compose(n.$keyboardNavigation.EventHandler,{getDefaultNode:function(){var r=new n.$keyboardNavigation.TimeSlot;return r.isValid()||(r=r.fallback()),r},_modes:{month:"month",year:"year",dayColumns:"dayColumns",timeline:"timeline",units:"units",weekAgenda:"weekAgenda",list:"list"},getMode:function(){var r=n.getState().mode;return n.matrix&&n.matrix[r]?this._modes.timeline:n._props&&n._props[r]?this._modes.units:r=="month"?this._modes.month:r=="year"?this._modes.year:r=="week_agenda"?this._modes.weekAgenda:r=="map"||r=="agenda"||n._grid&&n["grid_"+r]?this._modes.list:this._modes.dayColumns},focus:function(){n.focus()},blur:function(){},disable:function(){n.$container.setAttribute("tabindex","0")},enable:function(){n.$container&&n.$container.removeAttribute("tabindex")},isEnabled:function(){return n.$container.hasAttribute("tabindex")},_compareEvents:function(r,a){return r.start_date.valueOf()==a.start_date.valueOf()?r.id>a.id?1:-1:r.start_date.valueOf()>a.start_date.valueOf()?1:-1},_pickEvent:function(r,a,i,o){var l=n.getState();r=new Date(Math.max(l.min_date.valueOf(),r.valueOf())),a=new Date(Math.min(l.max_date.valueOf(),a.valueOf()));var s=n.getEvents(r,a);s.sort(this._compareEvents),o&&(s=s.reverse());for(var d=!!i,c=0;c<s.length&&d;c++)s[c].id==i&&(d=!1),s.splice(c,1),c--;for(c=0;c<s.length;c++)if(new n.$keyboardNavigation.Event(s[c].id).getNode())return s[c];return null},nextEventHandler:function(r){var a=n.$keyboardNavigation.dispatcher.activeNode,i=r||a&&a.eventId,o=null;if(i&&n.getEvent(i)){var l=n.getEvent(i);o=n.$keyboardNavigation.SchedulerNode.prototype._pickEvent(l.start_date,n.date.add(l.start_date,1,"year"),l.id,!1)}if(!o&&!r){var s=n.getState();o=n.$keyboardNavigation.SchedulerNode.prototype._pickEvent(s.min_date,n.date.add(s.min_date,1,"year"),null,!1)}if(o){var d=new n.$keyboardNavigation.Event(o.id);d.isValid()?(a&&a.blur(),n.$keyboardNavigation.dispatcher.setActiveNode(d)):this.nextEventHandler(o.id)}},prevEventHandler:function(r){var a=n.$keyboardNavigation.dispatcher.activeNode,i=r||a&&a.eventId,o=null;if(i&&n.getEvent(i)){var l=n.getEvent(i);o=n.$keyboardNavigation.SchedulerNode.prototype._pickEvent(n.date.add(l.end_date,-1,"year"),l.end_date,l.id,!0)}if(!o&&!r){var s=n.getState();o=n.$keyboardNavigation.SchedulerNode.prototype._pickEvent(n.date.add(s.max_date,-1,"year"),s.max_date,null,!0)}if(o){var d=new n.$keyboardNavigation.Event(o.id);d.isValid()?(a&&a.blur(),n.$keyboardNavigation.dispatcher.setActiveNode(d)):this.prevEventHandler(o.id)}},keys:{"alt+1, alt+2, alt+3, alt+4, alt+5, alt+6, alt+7, alt+8, alt+9":function(r){var a=n.$keyboardNavigation.HeaderCell.prototype.getNodes(".dhx_cal_navline .dhx_cal_tab"),i=r.key;i===void 0&&(i=r.keyCode-48),a[1*i-1]&&a[1*i-1].click()},"ctrl+left,meta+left":function(r){n._click.dhx_cal_prev_button()},"ctrl+right,meta+right":function(r){n._click.dhx_cal_next_button()},"ctrl+up,meta+up":function(r){n.$container.querySelector(".dhx_cal_data").scrollTop-=20},"ctrl+down,meta+down":function(r){n.$container.querySelector(".dhx_cal_data").scrollTop+=20},e:function(){this.nextEventHandler()},home:function(){n.setCurrentView(new Date)},"shift+e":function(){this.prevEventHandler()},"ctrl+enter,meta+enter":function(){n.addEventNow({start_date:new Date(n.getState().date)})},"ctrl+c,meta+c":function(r){n._key_nav_copy_paste(r)},"ctrl+v,meta+v":function(r){n._key_nav_copy_paste(r)},"ctrl+x,meta+x":function(r){n._key_nav_copy_paste(r)}}}),n.$keyboardNavigation.SchedulerNode.prototype.bindAll(n.$keyboardNavigation.SchedulerNode.prototype.keys)}(e),function(n){n.$keyboardNavigation.KeyNavNode=function(){},n.$keyboardNavigation.KeyNavNode.prototype=n._compose(n.$keyboardNavigation.EventHandler,{isValid:function(){return!0},fallback:function(){return null},moveTo:function(r){n.$keyboardNavigation.dispatcher.setActiveNode(r)},compareTo:function(r){if(!r)return!1;for(var a in this){if(!!this[a]!=!!r[a])return!1;var i=!(!this[a]||!this[a].toString),o=!(!r[a]||!r[a].toString);if(o!=i)return!1;if(o&&i){if(r[a].toString()!=this[a].toString())return!1}else if(r[a]!=this[a])return!1}return!0},getNode:function(){},focus:function(){var r=this.getNode();r&&(r.setAttribute("tabindex","-1"),r.focus&&r.focus())},blur:function(){var r=this.getNode();r&&r.setAttribute("tabindex","-1")}})}(e),function(n){n.$keyboardNavigation.HeaderCell=function(r){this.index=r||0},n.$keyboardNavigation.HeaderCell.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{getNode:function(r){r=r||this.index||0;var a=this.getNodes();if(a[r])return a[r]},getNodes:function(r){r=r||[".dhx_cal_navline .dhx_cal_prev_button",".dhx_cal_navline .dhx_cal_next_button",".dhx_cal_navline .dhx_cal_today_button",".dhx_cal_navline .dhx_cal_tab"].join(", ");var a=Array.prototype.slice.call(n.$container.querySelectorAll(r));return a.sort(function(i,o){return i.offsetLeft-o.offsetLeft}),a},_handlers:null,isValid:function(){return!!this.getNode(this.index)},fallback:function(){var r=this.getNode(0);return r||(r=new n.$keyboardNavigation.TimeSlot),r},keys:{left:function(){var r=this.index-1;r<0&&(r=this.getNodes().length-1),this.moveTo(new n.$keyboardNavigation.HeaderCell(r))},right:function(){var r=this.index+1;r>=this.getNodes().length&&(r=0),this.moveTo(new n.$keyboardNavigation.HeaderCell(r))},down:function(){this.moveTo(new n.$keyboardNavigation.TimeSlot)},enter:function(){var r=this.getNode();r&&r.click()}}}),n.$keyboardNavigation.HeaderCell.prototype.bindAll(n.$keyboardNavigation.HeaderCell.prototype.keys)}(e),function(n){n.$keyboardNavigation.Event=function(r){if(this.eventId=null,n.getEvent(r)){var a=n.getEvent(r);this.start=new Date(a.start_date),this.end=new Date(a.end_date),this.section=this._getSection(a),this.eventId=r}},n.$keyboardNavigation.Event.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{_getNodes:function(){return Array.prototype.slice.call(n.$container.querySelectorAll("["+n.config.event_attribute+"]"))},_modes:n.$keyboardNavigation.SchedulerNode.prototype._modes,getMode:n.$keyboardNavigation.SchedulerNode.prototype.getMode,_handlers:null,isValid:function(){return!(!n.getEvent(this.eventId)||!this.getNode())},fallback:function(){var r=this._getNodes()[0],a=null;if(r&&n._locate_event(r)){var i=n._locate_event(r);a=new n.$keyboardNavigation.Event(i)}else a=new n.$keyboardNavigation.TimeSlot;return a},isScrolledIntoView:function(r){var a=r.getBoundingClientRect(),i=n.$container.querySelector(".dhx_cal_data").getBoundingClientRect();return!(a.bottom<i.top||a.top>i.bottom)},getNode:function(){var r="["+n.config.event_attribute+"='"+this.eventId+"']",a=n.$keyboardNavigation.dispatcher.getInlineEditor(this.eventId);if(a)return a;if(n.isMultisectionEvent&&n.isMultisectionEvent(n.getEvent(this.eventId))){for(var i=n.$container.querySelectorAll(r),o=0;o<i.length;o++)if(this.isScrolledIntoView(i[o]))return i[o];return i[0]}return n.$container.querySelector(r)},focus:function(){var r=n.getEvent(this.eventId),a=n.getState();(r.start_date.valueOf()>a.max_date.valueOf()||r.end_date.valueOf()<=a.min_date.valueOf())&&n.setCurrentView(r.start_date);var i=this.getNode();this.isScrolledIntoView(i)?n.$keyboardNavigation.dispatcher.keepScrollPosition((function(){n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this)}).bind(this)):n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this)},blur:function(){n.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this)},_getSection:function(r){var a=null,i=n.getState().mode;return n.matrix&&n.matrix[i]?a=r[n.matrix[n.getState().mode].y_property]:n._props&&n._props[i]&&(a=r[n._props[i].map_to]),a},_moveToSlot:function(r){var a=n.getEvent(this.eventId);if(a){var i=this._getSection(a),o=new n.$keyboardNavigation.TimeSlot(a.start_date,null,i);this.moveTo(o.nextSlot(o,r))}else this.moveTo(new n.$keyboardNavigation.TimeSlot)},keys:{left:function(){this._moveToSlot("left")},right:function(){this._moveToSlot("right")},down:function(){this.getMode()==this._modes.list?n.$keyboardNavigation.SchedulerNode.prototype.nextEventHandler():this._moveToSlot("down")},space:function(){var r=this.getNode();r&&r.click?r.click():this.moveTo(new n.$keyboardNavigation.TimeSlot)},up:function(){this.getMode()==this._modes.list?n.$keyboardNavigation.SchedulerNode.prototype.prevEventHandler():this._moveToSlot("up")},delete:function(){n.getEvent(this.eventId)?n._click.buttons.delete(this.eventId):this.moveTo(new n.$keyboardNavigation.TimeSlot)},enter:function(){n.getEvent(this.eventId)?n.showLightbox(this.eventId):this.moveTo(new n.$keyboardNavigation.TimeSlot)}}}),n.$keyboardNavigation.Event.prototype.bindAll(n.$keyboardNavigation.Event.prototype.keys)}(e),function(n){n.$keyboardNavigation.TimeSlot=function(r,a,i,o){var l=n.getState(),s=n.matrix&&n.matrix[l.mode];r||(r=this.getDefaultDate()),a||(a=s?n.date.add(r,s.x_step,s.x_unit):n.date.add(r,n.config.key_nav_step,"minute")),this.section=i||this._getDefaultSection(),this.start_date=new Date(r),this.end_date=new Date(a),this.movingDate=o||null},n.$keyboardNavigation.TimeSlot.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{_handlers:null,getDefaultDate:function(){var r,a=n.getState(),i=new Date(a.date);i.setSeconds(0),i.setMilliseconds(0);var o=new Date;o.setSeconds(0),o.setMilliseconds(0);var l=n.matrix&&n.matrix[a.mode],s=!1;if(i.valueOf()===o.valueOf()&&(s=!0),l)s?(l.x_unit==="day"?(o.setHours(0),o.setMinutes(0)):l.x_unit==="hour"&&o.setMinutes(0),r=o):r=n.date[l.name+"_start"](new Date(a.date)),r=this.findVisibleColumn(r);else if(r=new Date(n.getState().min_date),s&&(r=o),r=this.findVisibleColumn(r),s||r.setHours(n.config.first_hour),!n._table_view){var d=n.$container.querySelector(".dhx_cal_data");d.scrollTop&&r.setHours(n.config.first_hour+Math.ceil(d.scrollTop/n.config.hour_size_px))}return r},clone:function(r){return new n.$keyboardNavigation.TimeSlot(r.start_date,r.end_date,r.section,r.movingDate)},_getMultisectionView:function(){var r,a=n.getState();return n._props&&n._props[a.mode]?r=n._props[a.mode]:n.matrix&&n.matrix[a.mode]&&(r=n.matrix[a.mode]),r},_getDefaultSection:function(){var r=null;return this._getMultisectionView()&&!r&&(r=this._getNextSection()),r},_getNextSection:function(r,a){var i=this._getMultisectionView(),o=i.order[r],l=o;(l=o!==void 0?o+a:i.size&&i.position?i.position:0)<0&&(l=0);var s=i.options||i.y_unit;return l>=s.length&&(l=s.length-1),s[l]?s[l].key:null},isValid:function(){var r=n.getState();if(this.start_date.valueOf()<r.min_date.valueOf()||this.start_date.valueOf()>=r.max_date.valueOf()||!this.isVisible(this.start_date,this.end_date))return!1;var a=this._getMultisectionView();return!a||a.order[this.section]!==void 0},fallback:function(){var r=new n.$keyboardNavigation.TimeSlot;return r.isValid()?r:new n.$keyboardNavigation.DataArea},getNodes:function(){return Array.prototype.slice.call(n.$container.querySelectorAll(".dhx_focus_slot"))},getNode:function(){return this.getNodes()[0]},focus:function(){this.section&&n.getView()&&n.getView().smart_rendering&&n.getView().scrollTo&&!n.$container.querySelector(`[data-section-id="${this.section}"]`)&&n.getView().scrollTo({section:this.section}),n.$keyboardNavigation.marker.render(this.start_date,this.end_date,this.section),n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this),n.$keyboardNavigation._pasteDate=this.start_date,n.$keyboardNavigation._pasteSection=this.section},blur:function(){n.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this),n.$keyboardNavigation.marker.clear()},_modes:n.$keyboardNavigation.SchedulerNode.prototype._modes,_getMode:n.$keyboardNavigation.SchedulerNode.prototype.getMode,addMonthDate:function(r,a,i){var o;switch(a){case"up":o=n.date.add(r,-1,"week");break;case"down":o=n.date.add(r,1,"week");break;case"left":o=n.date.day_start(n.date.add(r,-1,"day")),o=this.findVisibleColumn(o,-1);break;case"right":o=n.date.day_start(n.date.add(r,1,"day")),o=this.findVisibleColumn(o,1);break;default:o=n.date.day_start(new Date(r))}var l=n.getState();return(r.valueOf()<l.min_date.valueOf()||!i&&r.valueOf()>=l.max_date.valueOf())&&(o=new Date(l.min_date)),o},nextMonthSlot:function(r,a,i){var o,l;return(o=this.addMonthDate(r.start_date,a,i)).setHours(n.config.first_hour),(l=new Date(o)).setHours(n.config.last_hour),{start_date:o,end_date:l}},_alignTimeSlot:function(r,a,i,o){for(var l=new Date(a);l.valueOf()<r.valueOf();)l=n.date.add(l,o,i);return l.valueOf()>r.valueOf()&&(l=n.date.add(l,-o,i)),l},nextTimelineSlot:function(r,a,i){var o=n.getState(),l=n.matrix[o.mode],s=this._alignTimeSlot(r.start_date,n.date[l.name+"_start"](new Date(r.start_date)),l.x_unit,l.x_step),d=this._alignTimeSlot(r.end_date,n.date[l.name+"_start"](new Date(r.end_date)),l.x_unit,l.x_step);d.valueOf()<=s.valueOf()&&(d=n.date.add(s,l.x_step,l.x_unit));var c=this.clone(r);switch(c.start_date=s,c.end_date=d,c.section=r.section||this._getNextSection(),a){case"up":c.section=this._getNextSection(r.section,-1);break;case"down":c.section=this._getNextSection(r.section,1);break;case"left":c.start_date=this.findVisibleColumn(n.date.add(c.start_date,-l.x_step,l.x_unit),-1),c.end_date=n.date.add(c.start_date,l.x_step,l.x_unit);break;case"right":c.start_date=this.findVisibleColumn(n.date.add(c.start_date,l.x_step,l.x_unit),1),c.end_date=n.date.add(c.start_date,l.x_step,l.x_unit)}return(c.start_date.valueOf()<o.min_date.valueOf()||c.start_date.valueOf()>=o.max_date.valueOf())&&(i&&c.start_date.valueOf()>=o.max_date.valueOf()?c.start_date=new Date(o.max_date):(c.start_date=n.date[o.mode+"_start"](n.date.add(o.date,a=="left"?-1:1,o.mode)),c.end_date=n.date.add(c.start_date,l.x_step,l.x_unit))),c},nextUnitsSlot:function(r,a,i){var o=this.clone(r);o.section=r.section||this._getNextSection();var l=r.section||this._getNextSection(),s=n.getState(),d=n._props[s.mode];switch(a){case"left":l=this._getNextSection(r.section,-1);var c=d.size?d.size-1:d.options.length;d.days>1&&d.order[l]==c-1&&n.date.add(r.start_date,-1,"day").valueOf()>=s.min_date.valueOf()&&(o=this.nextDaySlot(r,a,i));break;case"right":l=this._getNextSection(r.section,1),d.days>1&&!d.order[l]&&n.date.add(r.start_date,1,"day").valueOf()<s.max_date.valueOf()&&(o=this.nextDaySlot(r,a,i));break;default:o=this.nextDaySlot(r,a,i),l=r.section}return o.section=l,o},_moveDate:function(r,a){var i=this.findVisibleColumn(n.date.add(r,a,"day"),a);return i.setHours(r.getHours()),i.setMinutes(r.getMinutes()),i},isBeforeLastHour:function(r,a){var i=r.getMinutes(),o=r.getHours(),l=n.config.last_hour;return o<l||!a&&(l==24||o==l)&&!i},isAfterFirstHour:function(r,a){var i=r.getMinutes(),o=r.getHours(),l=n.config.first_hour,s=n.config.last_hour;return o>=l||!a&&!i&&(!o&&s==24||o==s)},isInVisibleDayTime:function(r,a){return this.isBeforeLastHour(r,a)&&this.isAfterFirstHour(r,a)},nextDaySlot:function(r,a,i){var o,l,s=n.config.key_nav_step,d=this._alignTimeSlot(r.start_date,n.date.day_start(new Date(r.start_date)),"minute",s),c=r.start_date;switch(a){case"up":if(o=n.date.add(d,-s,"minute"),!this.isInVisibleDayTime(o,!0)&&(!i||this.isInVisibleDayTime(c,!0))){var u=!0;i&&n.date.date_part(new Date(o)).valueOf()!=n.date.date_part(new Date(c)).valueOf()&&(u=!1),u&&(o=this.findVisibleColumn(n.date.add(r.start_date,-1,"day"),-1)),o.setHours(n.config.last_hour),o.setMinutes(0),o=n.date.add(o,-s,"minute")}l=n.date.add(o,s,"minute");break;case"down":o=n.date.add(d,s,"minute");var f=i?o:n.date.add(o,s,"minute");this.isInVisibleDayTime(f,!1)||i&&!this.isInVisibleDayTime(c,!1)||(i?(u=!0,n.date.date_part(new Date(c)).valueOf()==c.valueOf()&&(u=!1),u&&(o=this.findVisibleColumn(n.date.add(r.start_date,1,"day"),1)),o.setHours(n.config.first_hour),o.setMinutes(0),o=n.date.add(o,s,"minute")):((o=this.findVisibleColumn(n.date.add(r.start_date,1,"day"),1)).setHours(n.config.first_hour),o.setMinutes(0))),l=n.date.add(o,s,"minute");break;case"left":o=this._moveDate(r.start_date,-1),l=this._moveDate(r.end_date,-1);break;case"right":o=this._moveDate(r.start_date,1),l=this._moveDate(r.end_date,1);break;default:o=d,l=n.date.add(o,s,"minute")}return{start_date:o,end_date:l}},nextWeekAgendaSlot:function(r,a){var i,o,l=n.getState();switch(a){case"down":case"left":i=n.date.day_start(n.date.add(r.start_date,-1,"day")),i=this.findVisibleColumn(i,-1);break;case"up":case"right":i=n.date.day_start(n.date.add(r.start_date,1,"day")),i=this.findVisibleColumn(i,1);break;default:i=n.date.day_start(r.start_date)}return(r.start_date.valueOf()<l.min_date.valueOf()||r.start_date.valueOf()>=l.max_date.valueOf())&&(i=new Date(l.min_date)),(o=new Date(i)).setHours(n.config.last_hour),{start_date:i,end_date:o}},nextAgendaSlot:function(r,a){return{start_date:r.start_date,end_date:r.end_date}},isDateVisible:function(r){if(!n._ignores_detected)return!0;var a,i=n.matrix&&n.matrix[n.getState().mode];return a=i?n._get_date_index(i,r):n.locate_holder_day(r),!n._ignores[a]},findVisibleColumn:function(r,a){var i=r;a=a||1;for(var o=n.getState();!this.isDateVisible(i)&&(a>0&&i.valueOf()<=o.max_date.valueOf()||a<0&&i.valueOf()>=o.min_date.valueOf());)i=this.nextDateColumn(i,a);return i},nextDateColumn:function(r,a){a=a||1;var i=n.matrix&&n.matrix[n.getState().mode];return i?n.date.add(r,a*i.x_step,i.x_unit):n.date.day_start(n.date.add(r,a,"day"))},isVisible:function(r,a){if(!n._ignores_detected)return!0;for(var i=new Date(r);i.valueOf()<a.valueOf();){if(this.isDateVisible(i))return!0;i=this.nextDateColumn(i)}return!1},nextSlot:function(r,a,i,o){var l;i=i||this._getMode();var s=n.$keyboardNavigation.TimeSlot.prototype.clone(r);switch(i){case this._modes.units:l=this.nextUnitsSlot(s,a,o);break;case this._modes.timeline:l=this.nextTimelineSlot(s,a,o);break;case this._modes.year:case this._modes.month:l=this.nextMonthSlot(s,a,o);break;case this._modes.weekAgenda:l=this.nextWeekAgendaSlot(s,a,o);break;case this._modes.list:l=this.nextAgendaSlot(s,a,o);break;case this._modes.dayColumns:l=this.nextDaySlot(s,a,o)}return l.start_date.valueOf()>=l.end_date.valueOf()&&(l=this.nextSlot(l,a,i)),n.$keyboardNavigation.TimeSlot.prototype.clone(l)},extendSlot:function(r,a){var i;switch(this._getMode()){case this._modes.units:i=a=="left"||a=="right"?this.nextUnitsSlot(r,a):this.extendUnitsSlot(r,a);break;case this._modes.timeline:i=a=="down"||a=="up"?this.nextTimelineSlot(r,a):this.extendTimelineSlot(r,a);break;case this._modes.year:case this._modes.month:i=this.extendMonthSlot(r,a);break;case this._modes.dayColumns:i=this.extendDaySlot(r,a);break;case this._modes.weekAgenda:i=this.extendWeekAgendaSlot(r,a);break;default:i=r}var o=n.getState();return i.start_date.valueOf()<o.min_date.valueOf()&&(i.start_date=this.findVisibleColumn(o.min_date),i.start_date.setHours(n.config.first_hour)),i.end_date.valueOf()>o.max_date.valueOf()&&(i.end_date=this.findVisibleColumn(o.max_date,-1)),n.$keyboardNavigation.TimeSlot.prototype.clone(i)},extendTimelineSlot:function(r,a){return this.extendGenericSlot({left:"start_date",right:"end_date"},r,a,"timeline")},extendWeekAgendaSlot:function(r,a){return this.extendGenericSlot({left:"start_date",right:"end_date"},r,a,"weekAgenda")},extendGenericSlot:function(r,a,i,o){var l,s=a.movingDate;if(s||(s=r[i]),!s||!r[i])return a;if(!i)return n.$keyboardNavigation.TimeSlot.prototype.clone(a);(l=this.nextSlot({start_date:a[s],section:a.section},i,o,!0)).start_date.valueOf()==a.start_date.valueOf()&&(l=this.nextSlot({start_date:l.start_date,section:l.section},i,o,!0)),l.movingDate=s;var d=this.extendSlotDates(a,l,l.movingDate);return d.end_date.valueOf()<=d.start_date.valueOf()&&(l.movingDate=l.movingDate=="end_date"?"start_date":"end_date"),d=this.extendSlotDates(a,l,l.movingDate),l.start_date=d.start_date,l.end_date=d.end_date,l},extendSlotDates:function(r,a,i){var o={start_date:null,end_date:null};return i=="start_date"?(o.start_date=a.start_date,o.end_date=r.end_date):(o.start_date=r.start_date,o.end_date=a.start_date),o},extendMonthSlot:function(r,a){return(r=this.extendGenericSlot({up:"start_date",down:"end_date",left:"start_date",right:"end_date"},r,a,"month")).start_date.setHours(n.config.first_hour),r.end_date=n.date.add(r.end_date,-1,"day"),r.end_date.setHours(n.config.last_hour),r},extendUnitsSlot:function(r,a){var i;switch(a){case"down":case"up":i=this.extendDaySlot(r,a);break;default:i=r}return i.section=r.section,i},extendDaySlot:function(r,a){return this.extendGenericSlot({up:"start_date",down:"end_date",left:"start_date",right:"end_date"},r,a,"dayColumns")},scrollSlot:function(r){var a=n.getState(),i=this.nextSlot(this,r);(i.start_date.valueOf()<a.min_date.valueOf()||i.start_date.valueOf()>=a.max_date.valueOf())&&n.setCurrentView(new Date(i.start_date)),this.moveTo(i)},keys:{left:function(){this.scrollSlot("left")},right:function(){this.scrollSlot("right")},down:function(){this._getMode()==this._modes.list?n.$keyboardNavigation.SchedulerNode.prototype.nextEventHandler():this.scrollSlot("down")},up:function(){this._getMode()==this._modes.list?n.$keyboardNavigation.SchedulerNode.prototype.prevEventHandler():this.scrollSlot("up")},"shift+down":function(){this.moveTo(this.extendSlot(this,"down"))},"shift+up":function(){this.moveTo(this.extendSlot(this,"up"))},"shift+right":function(){this.moveTo(this.extendSlot(this,"right"))},"shift+left":function(){this.moveTo(this.extendSlot(this,"left"))},enter:function(){var r={start_date:new Date(this.start_date),end_date:new Date(this.end_date)},a=n.getState().mode;n.matrix&&n.matrix[a]?r[n.matrix[n.getState().mode].y_property]=this.section:n._props&&n._props[a]&&(r[n._props[a].map_to]=this.section),n.addEventNow(r)}}}),n.$keyboardNavigation.TimeSlot.prototype.bindAll(n.$keyboardNavigation.TimeSlot.prototype.keys)}(e),function(n){n.$keyboardNavigation.MinicalButton=function(r,a){this.container=r,this.index=a||0},n.$keyboardNavigation.MinicalButton.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{isValid:function(){return!!this.container.offsetWidth},fallback:function(){var r=new n.$keyboardNavigation.TimeSlot;return r.isValid()?r:new n.$keyboardNavigation.DataArea},focus:function(){n.$keyboardNavigation.dispatcher.globalNode.disable(),this.container.removeAttribute("tabindex"),n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this)},blur:function(){this.container.setAttribute("tabindex","0"),n.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this)},getNode:function(){return this.index?this.container.querySelector(".dhx_cal_next_button"):this.container.querySelector(".dhx_cal_prev_button")},keys:{right:function(r){this.moveTo(new n.$keyboardNavigation.MinicalButton(this.container,this.index?0:1))},left:function(r){this.moveTo(new n.$keyboardNavigation.MinicalButton(this.container,this.index?0:1))},down:function(){var r=new n.$keyboardNavigation.MinicalCell(this.container,0,0);r&&!r.isValid()&&(r=r.fallback()),this.moveTo(r)},enter:function(r){this.getNode().click()}}}),n.$keyboardNavigation.MinicalButton.prototype.bindAll(n.$keyboardNavigation.MinicalButton.prototype.keys)}(e),function(n){n.$keyboardNavigation.MinicalCell=function(r,a,i){this.container=r,this.row=a||0,this.col=i||0},n.$keyboardNavigation.MinicalCell.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{isValid:function(){var r=this._getGrid();return!(!r[this.row]||!r[this.row][this.col])},fallback:function(){var r=this.row,a=this.col,i=this._getGrid();i[r]||(r=0);var o=!0;if(r>i.length/2&&(o=!1),!i[r]){var l=new n.$keyboardNavigation.TimeSlot;return l.isValid()?l:new n.$keyboardNavigation.DataArea}if(o){for(var s=a;i[r]&&s<i[r].length;s++)if(i[r][s]||s!=i[r].length-1||(r++,a=0),i[r][s])return new n.$keyboardNavigation.MinicalCell(this.container,r,s)}else for(s=a;i[r]&&s<i[r].length;s--)if(i[r][s]||s||(a=i[--r].length-1),i[r][s])return new n.$keyboardNavigation.MinicalCell(this.container,r,s);return new n.$keyboardNavigation.MinicalButton(this.container,0)},focus:function(){n.$keyboardNavigation.dispatcher.globalNode.disable(),this.container.removeAttribute("tabindex"),n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this)},blur:function(){this.container.setAttribute("tabindex","0"),n.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this)},_getNode:function(r,a){return this.container.querySelector(".dhx_year_body tr:nth-child("+(r+1)+") td:nth-child("+(a+1)+")")},getNode:function(){return this._getNode(this.row,this.col)},_getGrid:function(){for(var r=this.container.querySelectorAll(".dhx_year_body tr"),a=[],i=0;i<r.length;i++){a[i]=[];for(var o=r[i].querySelectorAll("td"),l=0;l<o.length;l++){var s=o[l],d=!0,c=n._getClassName(s);(c.indexOf("dhx_after")>-1||c.indexOf("dhx_before")>-1||c.indexOf("dhx_scale_ignore")>-1)&&(d=!1),a[i][l]=d}}return a},keys:{right:function(r){var a=this._getGrid(),i=this.row,o=this.col+1;a[i]&&a[i][o]||(a[i+1]?(i+=1,o=0):o=this.col);var l=new n.$keyboardNavigation.MinicalCell(this.container,i,o);l.isValid()||(l=l.fallback()),this.moveTo(l)},left:function(r){var a=this._getGrid(),i=this.row,o=this.col-1;a[i]&&a[i][o]||(o=a[i-1]?a[i-=1].length-1:this.col);var l=new n.$keyboardNavigation.MinicalCell(this.container,i,o);l.isValid()||(l=l.fallback()),this.moveTo(l)},down:function(){var r=this._getGrid(),a=this.row+1,i=this.col;r[a]&&r[a][i]||(a=this.row);var o=new n.$keyboardNavigation.MinicalCell(this.container,a,i);o.isValid()||(o=o.fallback()),this.moveTo(o)},up:function(){var r=this._getGrid(),a=this.row-1,i=this.col;if(r[a]&&r[a][i]){var o=new n.$keyboardNavigation.MinicalCell(this.container,a,i);o.isValid()||(o=o.fallback()),this.moveTo(o)}else{var l=0;this.col>r[this.row].length/2&&(l=1),this.moveTo(new n.$keyboardNavigation.MinicalButton(this.container,l))}},enter:function(r){this.getNode().querySelector(".dhx_month_head").click()}}}),n.$keyboardNavigation.MinicalCell.prototype.bindAll(n.$keyboardNavigation.MinicalCell.prototype.keys)}(e),function(n){n.$keyboardNavigation.DataArea=function(r){this.index=r||0},n.$keyboardNavigation.DataArea.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{getNode:function(r){return n.$container.querySelector(".dhx_cal_data")},_handlers:null,isValid:function(){return!0},fallback:function(){return this},keys:{"up,down,right,left":function(){this.moveTo(new n.$keyboardNavigation.TimeSlot)}}}),n.$keyboardNavigation.DataArea.prototype.bindAll(n.$keyboardNavigation.DataArea.prototype.keys)}(e),Lu(e),function(n){n.$keyboardNavigation.dispatcher={isActive:!1,activeNode:null,globalNode:new n.$keyboardNavigation.SchedulerNode,keepScrollPosition:function(r){var a,i,o=n.$container.querySelector(".dhx_timeline_scrollable_data");o||(o=n.$container.querySelector(".dhx_cal_data")),o&&(a=o.scrollTop,i=o.scrollLeft),r(),o&&(o.scrollTop=a,o.scrollLeft=i)},enable:function(){if(n.$container){this.isActive=!0;var r=this;this.keepScrollPosition(function(){r.globalNode.enable(),r.setActiveNode(r.getActiveNode())})}},disable:function(){this.isActive=!1,this.globalNode.disable()},isEnabled:function(){return!!this.isActive},getDefaultNode:function(){return this.globalNode.getDefaultNode()},setDefaultNode:function(){this.setActiveNode(this.getDefaultNode())},getActiveNode:function(){var r=this.activeNode;return r&&!r.isValid()&&(r=r.fallback()),r},focusGlobalNode:function(){this.blurNode(this.globalNode),this.focusNode(this.globalNode)},setActiveNode:function(r){r&&r.isValid()&&(this.activeNode&&this.activeNode.compareTo(r)||this.isEnabled()&&(this.blurNode(this.activeNode),this.activeNode=r,this.focusNode(this.activeNode)))},focusNode:function(r){r&&r.focus&&(r.focus(),r.getNode&&document.activeElement!=r.getNode()&&this.setActiveNode(new n.$keyboardNavigation.DataArea))},blurNode:function(r){r&&r.blur&&r.blur()},getInlineEditor:function(r){var a=n.$container.querySelector(".dhx_cal_editor["+n.config.event_attribute+"='"+r+"'] textarea");return a&&a.offsetWidth?a:null},keyDownHandler:function(r){if(!r.defaultPrevented){var a=this.getActiveNode();if((!n.$keyboardNavigation.isModal()||a&&a.container&&n.utils.dom.locateCss({target:a.container},"dhx_minical_popup",!1))&&(!n.getState().editor_id||!this.getInlineEditor(n.getState().editor_id))&&this.isEnabled()){r=r||window.event;var i=this.globalNode,o=n.$keyboardNavigation.shortcuts.getCommandFromEvent(r);a?a.findHandler(o)?a.doAction(o,r):i.findHandler(o)&&i.doAction(o,r):this.setDefaultNode()}}},_timeout:null,delay:function(r,a){clearTimeout(this._timeout),this._timeout=setTimeout(r,a||1)}}}(e),Vu(e),function(){$u(e),function(l){l.$keyboardNavigation._minicalendars=[],l.$keyboardNavigation.isMinical=function(s){for(var d=l.$keyboardNavigation._minicalendars,c=0;c<d.length;c++)if(this.isChildOf(s,d[c]))return!0;return!1},l.$keyboardNavigation.isChildOf=function(s,d){for(;s&&s!==d;)s=s.parentNode;return s===d},l.$keyboardNavigation.patchMinicalendar=function(){var s=l.$keyboardNavigation.dispatcher;function d(v){var g=v.target;s.enable(),s.setActiveNode(new l.$keyboardNavigation.MinicalButton(g,0))}function c(v){var g=v.target||v.srcElement,h=l.utils.dom.locateCss(v,"dhx_cal_prev_button",!1),p=l.utils.dom.locateCss(v,"dhx_cal_next_button",!1),y=l.utils.dom.locateCss(v,"dhx_year_body",!1),x=0,S=0;if(y){for(var O,I,N=g;N&&N.tagName.toLowerCase()!="td";)N=N.parentNode;if(N&&(O=(I=N).parentNode),O&&I){for(var A=O.parentNode.querySelectorAll("tr"),m=0;m<A.length;m++)if(A[m]==O){x=m;break}var b=O.querySelectorAll("td");for(m=0;m<b.length;m++)if(b[m]==I){S=m;break}}}var E=v.currentTarget;s.delay(function(){var k;(h||p||y)&&(h?(k=new l.$keyboardNavigation.MinicalButton(E,0),s.setActiveNode(new l.$keyboardNavigation.MinicalButton(E,0))):p?k=new l.$keyboardNavigation.MinicalButton(E,1):y&&(k=new l.$keyboardNavigation.MinicalCell(E,x,S)),k&&(s.enable(),k.isValid()&&(s.activeNode=null,s.setActiveNode(k))))})}if(l.renderCalendar){var u=l.renderCalendar;l.renderCalendar=function(){var v=u.apply(this,arguments),g=l.$keyboardNavigation._minicalendars;l.eventRemove(v,"click",c),l.event(v,"click",c),l.eventRemove(v,"focus",d),l.event(v,"focus",d);for(var h=!1,p=0;p<g.length;p++)if(g[p]==v){h=!0;break}if(h||g.push(v),s.isEnabled()){var y=s.getActiveNode();y&&y.container==v?s.focusNode(y):v.setAttribute("tabindex","0")}else v.setAttribute("tabindex","0");return v}}if(l.destroyCalendar){var f=l.destroyCalendar;l.destroyCalendar=function(v,g){v=v||(l._def_count?l._def_count.firstChild:null);var h=f.apply(this,arguments);if(!v||!v.parentNode)for(var p=l.$keyboardNavigation._minicalendars,y=0;y<p.length;y++)p[y]==v&&(l.eventRemove(p[y],"focus",d),p.splice(y,1),y--);return h}}}}(e);var n=e.$keyboardNavigation.dispatcher;if(e.$keyboardNavigation.attachSchedulerHandlers(),e.renderCalendar)e.$keyboardNavigation.patchMinicalendar();else var r=e.attachEvent("onSchedulerReady",function(){e.detachEvent(r),e.$keyboardNavigation.patchMinicalendar()});function a(){if(e.config.key_nav){var l=document.activeElement;return!(!l||e.utils.dom.locateCss(l,"dhx_cal_quick_info",!1))&&(e.$keyboardNavigation.isChildOf(l,e.$container)||e.$keyboardNavigation.isMinical(l))}}function i(l){l&&!n.isEnabled()?n.enable():!l&&n.isEnabled()&&n.disable()}const o=setInterval(function(){if(e.$container&&e.$keyboardNavigation.isChildOf(e.$container,document.body)){var l=a();l?i(l):!l&&n.isEnabled()&&setTimeout(function(){e.$destroyed||(e.config.key_nav?i(a()):e.$container.removeAttribute("tabindex"))},100)}},500);e.attachEvent("onDestroy",function(){clearInterval(o)})}()},layer:function(e){e.attachEvent("onTemplatesReady",function(){this.layers.sort(function(n,r){return n.zIndex-r.zIndex}),e._dp_init=function(n){n._methods=["_set_event_text_style","","changeEventId","deleteEvent"],this.attachEvent("onEventAdded",function(r){!this._loading&&this.validId(r)&&this.getEvent(r)&&this.getEvent(r).layer==n.layer&&n.setUpdated(r,!0,"inserted")}),this.attachEvent("onBeforeEventDelete",function(r){if(this.getEvent(r)&&this.getEvent(r).layer==n.layer){if(!this.validId(r))return;var a=n.getState(r);return a=="inserted"||this._new_event?(n.setUpdated(r,!1),!0):a!="deleted"&&(a=="true_deleted"||(n.setUpdated(r,!0,"deleted"),!1))}return!0}),this.attachEvent("onEventChanged",function(r){!this._loading&&this.validId(r)&&this.getEvent(r)&&this.getEvent(r).layer==n.layer&&n.setUpdated(r,!0,"updated")}),n._getRowData=function(r,a){var i=this.obj.getEvent(r),o={};for(var l in i)l.indexOf("_")!==0&&(i[l]&&i[l].getUTCFullYear?o[l]=this.obj._helpers.formatDate(i[l]):o[l]=i[l]);return o},n._clearUpdateFlag=function(){},n.attachEvent("insertCallback",e._update_callback),n.attachEvent("updateCallback",e._update_callback),n.attachEvent("deleteCallback",function(r,a){this.obj.setUserData(a,this.action_param,"true_deleted"),this.obj.deleteEvent(a)})},function(){var n=function(i){if(i===null||typeof i!="object")return i;var o=new i.constructor;for(var l in i)o[l]=n(i[l]);return o};e._dataprocessors=[],e._layers_zindex={};for(var r=0;r<e.layers.length;r++){if(e.config["lightbox_"+e.layers[r].name]={},e.config["lightbox_"+e.layers[r].name].sections=n(e.config.lightbox.sections),e._layers_zindex[e.layers[r].name]=e.config.initial_layer_zindex||5+3*r,e.layers[r].url){var a=e.createDataProcessor({url:e.layers[r].url});a.layer=e.layers[r].name,e._dataprocessors.push(a),e._dataprocessors[r].init(e)}e.layers[r].isDefault&&(e.defaultLayer=e.layers[r].name)}}(),e.showLayer=function(n){this.toggleLayer(n,!0)},e.hideLayer=function(n){this.toggleLayer(n,!1)},e.toggleLayer=function(n,r){var a=this.getLayer(n);a.visible=r!==void 0?!!r:!a.visible,this.setCurrentView(this._date,this._mode)},e.getLayer=function(n){var r,a;typeof n=="string"&&(a=n),typeof n=="object"&&(a=n.layer);for(var i=0;i<e.layers.length;i++)e.layers[i].name==a&&(r=e.layers[i]);return r},e.attachEvent("onBeforeLightbox",function(n){var r=this.getEvent(n);return this.config.lightbox.sections=this.config["lightbox_"+r.layer].sections,e.resetLightbox(),!0}),e.attachEvent("onClick",function(n,r){var a=e.getEvent(n);return!e.getLayer(a.layer).noMenu}),e.attachEvent("onEventCollision",function(n,r){var a=this.getLayer(n);if(!a.checkCollision)return!1;for(var i=0,o=0;o<r.length;o++)r[o].layer==a.name&&r[o].id!=n.id&&i++;return i>=e.config.collision_limit}),e.addEvent=function(n,r,a,i,o){var l=n;arguments.length!=1&&((l=o||{}).start_date=n,l.end_date=r,l.text=a,l.id=i,l.layer=this.defaultLayer),l.id=l.id||e.uid(),l.text=l.text||"",typeof l.start_date=="string"&&(l.start_date=this.templates.api_date(l.start_date)),typeof l.end_date=="string"&&(l.end_date=this.templates.api_date(l.end_date)),l._timed=this.isOneDayEvent(l);var s=!this._events[l.id];this._events[l.id]=l,this.event_updated(l),this._loading||this.callEvent(s?"onEventAdded":"onEventChanged",[l.id,l])},this._evs_layer={};for(var t=0;t<this.layers.length;t++)this._evs_layer[this.layers[t].name]=[];e.addEventNow=function(n,r,a){var i={};typeof n=="object"&&(i=n,n=null);var o=6e4*(this.config.event_duration||this.config.time_step);n||(n=Math.round(e._currentDate().valueOf()/o)*o);var l=new Date(n);if(!r){var s=this.config.first_hour;s>l.getHours()&&(l.setHours(s),n=l.valueOf()),r=n+o}i.start_date=i.start_date||l,i.end_date=i.end_date||new Date(r),i.text=i.text||this.locale.labels.new_event,i.id=this._drag_id=this.uid(),i.layer=this.defaultLayer,this._drag_mode="new-size",this._loading=!0,this.addEvent(i),this.callEvent("onEventCreated",[this._drag_id,a]),this._loading=!1,this._drag_event={},this._on_mouse_up(a)},e._t_render_view_data=function(n){if(this.config.multi_day&&!this._table_view){for(var r=[],a=[],i=0;i<n.length;i++)n[i]._timed?r.push(n[i]):a.push(n[i]);this._table_view=!0,this.render_data(a),this._table_view=!1,this.render_data(r)}else this.render_data(n)},e.render_view_data=function(){if(this._not_render)this._render_wait=!0;else{this._render_wait=!1,this.clear_view(),this._evs_layer={};for(var n=0;n<this.layers.length;n++)this._evs_layer[this.layers[n].name]=[];var r=this.get_visible_events();for(n=0;n<r.length;n++)this._evs_layer[r[n].layer]&&this._evs_layer[r[n].layer].push(r[n]);if(this._mode=="month"){var a=[];for(n=0;n<this.layers.length;n++)this.layers[n].visible&&(a=a.concat(this._evs_layer[this.layers[n].name]));this._t_render_view_data(a)}else for(n=0;n<this.layers.length;n++)if(this.layers[n].visible){var i=this._evs_layer[this.layers[n].name];this._t_render_view_data(i)}}},e._render_v_bar=function(n,r,a,i,o,l,s,d,c){var u=n.id;s.indexOf("<div class=")==-1&&(s=e.templates["event_header_"+n.layer]?e.templates["event_header_"+n.layer](n.start_date,n.end_date,n):s),d.indexOf("<div class=")==-1&&(d=e.templates["event_text_"+n.layer]?e.templates["event_text_"+n.layer](n.start_date,n.end_date,n):d);var f=document.createElement("div"),v="dhx_cal_event",g=e.templates["event_class_"+n.layer]?e.templates["event_class_"+n.layer](n.start_date,n.end_date,n):e.templates.event_class(n.start_date,n.end_date,n);g&&(v=v+" "+g);var h=e._border_box_events(),p=i-2,y=h?p:i-4,x=h?p:i-6,S=h?p:i-14,O=h?p-2:i-8,I=h?o-this.xy.event_header_height:o-30+1,N='<div event_id="'+u+'" '+e.config.event_attribute+'="'+u+'" class="'+v+'" style="position:absolute; top:'+a+"px; left:"+r+"px; width:"+y+"px; height:"+o+"px;"+(l||"")+'">';return N+='<div class="dhx_header" style=" width:'+x+'px;" >&nbsp;</div>',N+='<div class="dhx_title">'+s+"</div>",N+='<div class="dhx_body" style=" width:'+S+"px; height:"+I+'px;">'+d+"</div>",N+='<div class="dhx_footer" style=" width:'+O+"px;"+(c?" margin-top:-1px;":"")+'" ></div></div>',f.innerHTML=N,f.style.zIndex=100,f.firstChild},e.render_event_bar=function(n){var r=this._els.dhx_cal_data[0],a=this._colsS[n._sday],i=this._colsS[n._eday];i==a&&(i=this._colsS[n._eday+1]);var o=this.xy.bar_height,l=this._colsS.heights[n._sweek]+(this._colsS.height?this.xy.month_scale_height+2:2)+n._sorder*o,s=document.createElement("div"),d=n._timed?"dhx_cal_event_clear":"dhx_cal_event_line",c=e.templates["event_class_"+n.layer]?e.templates["event_class_"+n.layer](n.start_date,n.end_date,n):e.templates.event_class(n.start_date,n.end_date,n);c&&(d=d+" "+c);var u='<div event_id="'+n.id+'" '+this.config.event_attribute+'="'+n.id+'" class="'+d+'" style="position:absolute; top:'+l+"px; left:"+a+"px; width:"+(i-a-15)+"px;"+(n._text_style||"")+'">';n._timed&&(u+=e.templates["event_bar_date_"+n.layer]?e.templates["event_bar_date_"+n.layer](n.start_date,n.end_date,n):e.templates.event_bar_date(n.start_date,n.end_date,n)),u+=e.templates["event_bar_text_"+n.layer]?e.templates["event_bar_text_"+n.layer](n.start_date,n.end_date,n):e.templates.event_bar_text(n.start_date,n.end_date,n)+"</div>)",u+="</div>",s.innerHTML=u,this._rendered.push(s.firstChild),r.appendChild(s.firstChild)},e.render_event=function(n){var r=e.xy.menu_width;if(e.getLayer(n.layer).noMenu&&(r=0),!(n._sday<0)){var a=e.locate_holder(n._sday);if(a){var i=60*n.start_date.getHours()+n.start_date.getMinutes(),o=60*n.end_date.getHours()+n.end_date.getMinutes()||60*e.config.last_hour,l=Math.round((60*i*1e3-60*this.config.first_hour*60*1e3)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)+1,s=Math.max(e.xy.min_event_height,(o-i)*this.config.hour_size_px/60)+1,d=Math.floor((a.clientWidth-r)/n._count),c=n._sorder*d+1;n._inner||(d*=n._count-n._sorder);var u=this._render_v_bar(n.id,r+c,l,d,s,n._text_style,e.templates.event_header(n.start_date,n.end_date,n),e.templates.event_text(n.start_date,n.end_date,n));if(this._rendered.push(u),a.appendChild(u),c=c+parseInt(a.style.left,10)+r,l+=this._dy_shift,u.style.zIndex=this._layers_zindex[n.layer],this._edit_id==n.id){u.style.zIndex=parseInt(u.style.zIndex)+1;var f=u.style.zIndex;d=Math.max(d-4,e.xy.editor_width),(u=document.createElement("div")).setAttribute("event_id",n.id),u.setAttribute(this.config.event_attribute,n.id),this.set_xy(u,d,s-20,c,l+14),u.className="dhx_cal_editor",u.style.zIndex=f;var v=document.createElement("div");this.set_xy(v,d-6,s-26),v.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",v.style.zIndex=f,u.appendChild(v),this._els.dhx_cal_data[0].appendChild(u),this._rendered.push(u),v.innerHTML="<textarea class='dhx_cal_editor'>"+n.text+"</textarea>",this._editor=v.firstChild,this._editor.addEventListener("keypress",function(x){if(x.shiftKey)return!0;var S=x.keyCode;S==e.keys.edit_save&&e.editStop(!0),S==e.keys.edit_cancel&&e.editStop(!1)}),this._editor.addEventListener("selectstart",function(x){return x.cancelBubble=!0,!0}),v.firstChild.focus(),this._els.dhx_cal_data[0].scrollLeft=0,v.firstChild.select()}if(this._select_id==n.id){u.style.zIndex=parseInt(u.style.zIndex)+1;for(var g=this.config["icons_"+(this._edit_id==n.id?"edit":"select")],h="",p=0;p<g.length;p++)h+="<div class='dhx_menu_icon "+g[p]+"' title='"+this.locale.labels[g[p]]+"'></div>";var y=this._render_v_bar(n.id,c-r+1,l,r,20*g.length+26,"","<div class='dhx_menu_head'></div>",h,!0);y.style.left=c-r+1,y.style.zIndex=u.style.zIndex,this._els.dhx_cal_data[0].appendChild(y),this._rendered.push(y)}}}},e.filter_agenda=function(n,r){var a=e.getLayer(r.layer);return a&&a.visible}})},limit:function(e){e.config.limit_start=null,e.config.limit_end=null,e.config.limit_view=!1,e.config.check_limits=!0,e._temp_limit_scope=function(){var t=null;e.attachEvent("onBeforeViewChange",function(n,r,a,i){function o(l,s){var d=e.config.limit_start,c=e.config.limit_end,u=e.date.add(l,1,s);return l.valueOf()>c.valueOf()||u<=d.valueOf()}return!e.config.limit_view||!o(i=i||r,a=a||n)||r.valueOf()==i.valueOf()||(setTimeout(function(){if(e.$destroyed)return!0;var l=o(r,a)?e.config.limit_start:r;e.setCurrentView(o(l,a)?null:l,a)},1),!1)}),e.attachEvent("onMouseDown",function(n){return n!="dhx_time_block"}),e.attachEvent("onBeforeDrag",function(n){return!n||e.checkLimitViolation(e.getEvent(n))}),e.attachEvent("onClick",function(n,r){return e.checkLimitViolation(e.getEvent(n))}),e.attachEvent("onBeforeLightbox",function(n){var r=e.getEvent(n);return t=[r.start_date,r.end_date],e.checkLimitViolation(r)}),e.attachEvent("onEventSave",function(n,r,a){if(!r.start_date||!r.end_date){var i=e.getEvent(n);r.start_date=new Date(i.start_date),r.end_date=new Date(i.end_date)}if(r.rec_type){var o=e._lame_clone(r);return e._roll_back_dates(o),e.checkLimitViolation(o)}return e.checkLimitViolation(r)}),e.attachEvent("onEventAdded",function(n){if(!n)return!0;var r=e.getEvent(n);return!e.checkLimitViolation(r)&&e.config.limit_start&&e.config.limit_end&&(r.start_date<e.config.limit_start&&(r.start_date=new Date(e.config.limit_start)),r.start_date.valueOf()>=e.config.limit_end.valueOf()&&(r.start_date=this.date.add(e.config.limit_end,-1,"day")),r.end_date<e.config.limit_start&&(r.end_date=new Date(e.config.limit_start)),r.end_date.valueOf()>=e.config.limit_end.valueOf()&&(r.end_date=this.date.add(e.config.limit_end,-1,"day")),r.start_date.valueOf()>=r.end_date.valueOf()&&(r.end_date=this.date.add(r.start_date,this.config.event_duration||this.config.time_step,"minute")),r._timed=this.isOneDayEvent(r)),!0}),e.attachEvent("onEventChanged",function(n){if(!n)return!0;var r=e.getEvent(n);if(!e.checkLimitViolation(r)){if(!t)return!1;r.start_date=t[0],r.end_date=t[1],r._timed=this.isOneDayEvent(r)}return!0}),e.attachEvent("onBeforeEventChanged",function(n,r,a){return e.checkLimitViolation(n)}),e.attachEvent("onBeforeEventCreated",function(n){var r=e.getActionData(n).date,a={_timed:!0,start_date:r,end_date:e.date.add(r,e.config.time_step,"minute")};return e.checkLimitViolation(a)}),e.attachEvent("onViewChange",function(){e._mark_now()}),e.attachEvent("onAfterSchedulerResize",function(){return window.setTimeout(function(){if(e.$destroyed)return!0;e._mark_now()},1),!0}),e.attachEvent("onTemplatesReady",function(){e._mark_now_timer=window.setInterval(function(){e._is_initialized()&&e._mark_now()},6e4)}),e.attachEvent("onDestroy",function(){clearInterval(e._mark_now_timer)})},e._temp_limit_scope()},map_view:function(e){let t=null,n=[];const r={googleMap:new Hu(e),openStreetMaps:new Fu(e),mapbox:new Uu(e)};function a(o){t=o.ext.mapView.createAdapter(),n.push(e.attachEvent("onEventSave",function(l,s,d){let c=e.getEvent(l);return c&&c.event_location!=s.event_location&&(e._eventLocationChanged=!0),!0}),e.attachEvent("onEventChanged",(l,s)=>{const{start_date:d,end_date:c}=s,{min_date:u,max_date:f}=e.getState();return d.valueOf()<f.valueOf()&&c.valueOf()>u.valueOf()&&t&&(e.config.map_settings.resolve_event_location&&s.event_location&&!e._latLngUpdate?i(s,t):t.updateEventMarker(s)),e._latLngUpdate=!1,!0}),e.attachEvent("onEventIdChange",function(l,s){let d=e.getEvent(s);t==null||t.removeEventMarker(l),t==null||t.addEventMarker(d)}),e.attachEvent("onEventAdded",(l,s)=>{const{start_date:d,end_date:c}=s,{min_date:u,max_date:f}=e.getState();d.valueOf()<f.valueOf()&&c.valueOf()>u.valueOf()&&t&&(e.config.map_settings.resolve_event_location&&s.event_location&&e._eventLocationChanged?(i(s,t),e._eventLocationChanged=!1):(t.addEventMarker(s),t.onEventClick(s)))}),e.attachEvent("onClick",function(l,s){const d=e.getEvent(l);return t&&d&&t.onEventClick(d),!1}),e.attachEvent("onBeforeEventDelete",(l,s)=>(t&&t.removeEventMarker(l),!0)))}async function i(o,l){let s=await l.resolveAddress(o.event_location);return o.lat=s.lat,o.lng=s.lng,l.removeEventMarker(String(o.id)),l.addEventMarker(o),o}e.ext||(e.ext={}),e.ext.mapView={createAdapter:function(){return r[e.config.map_view_provider]},createMarker:function(o){return new google.maps.Marker(o)},currentAdapter:null,adapters:r},e._latLngUpdate=!1,e._eventLocationChanged=!1,e.config.map_view_provider="googleMap",e.config.map_settings={initial_position:{lat:48.724,lng:8.215},error_position:{lat:15,lng:15},initial_zoom:1,zoom_after_resolve:15,info_window_max_width:300,resolve_user_location:!0,resolve_event_location:!0,view_provider:"googleMap"},e.config.map_initial_position&&(e.config.map_settings.initial_position={lat:e.config.map_initial_position.lat(),lng:e.config.map_initial_position.lng()}),e.config.map_error_position&&(e.config.map_settings.error_position={lat:e.config.map_error_position.lat(),lng:e.config.map_error_position.lng()}),e.xy.map_date_width=188,e.xy.map_icon_width=25,e.xy.map_description_width=400,e.date.add_map=function(o,l,s){return new Date(o.valueOf())},e.templates.map_date=function(o,l,s){return""},e.templates.map_time=function(o,l,s){return e.config.rtl&&!s._timed?e.templates.day_date(l)+" &ndash; "+e.templates.day_date(o):s._timed?this.day_date(s.start_date,s.end_date,s)+" "+this.event_date(o):e.templates.day_date(o)+" &ndash; "+e.templates.day_date(l)},e.templates.map_text=function(o,l,s){return s.text},e.templates.map_info_content=function(o){return`<div><b>Event's text:</b> ${o.text}
				<div><b>Location:</b> ${o.event_location}</div>
				<div><b>Starts:</b> ${e.templates.tooltip_date_format(o.start_date)}</div>
				<div><b>Ends:</b> ${e.templates.tooltip_date_format(o.end_date)}</div>
			</div>`},e.date.map_start=function(o){return o},e.dblclick_dhx_map_area=function(o){let l=o.target.closest(`[${e.config.event_attribute}]`);if(l){let s=l.getAttribute(`${e.config.event_attribute}`);e.showLightbox(s)}this.config.readonly||!this.config.dblclick_create||l||this.addEventNow({start_date:e.config.map_start,end_date:e.date.add(e.config.map_start,e.config.time_step,"minute")})},e.attachEvent("onSchedulerReady",function(){e.config.map_initial_zoom!==void 0&&(e.config.map_settings.initial_zoom=e.config.map_initial_zoom),e.config.map_zoom_after_resolve!==void 0&&(e.config.map_settings.zoom_after_resolve=e.config.map_zoom_after_resolve),e.config.map_infowindow_max_width!==void 0&&(e.config.map_settings.info_window_max_width=e.config.map_infowindow_max_width),e.config.map_resolve_user_location!==void 0&&(e.config.map_settings.resolve_user_location=e.config.map_resolve_user_location),e.config.map_view_provider!==void 0&&(e.config.map_settings.view_provider=e.config.map_view_provider),e.config.map_type!==void 0&&(e.config.map_settings.type=e.config.map_type),e.config.map_resolve_event_location!==void 0&&(e.config.map_settings.resolve_event_location=e.config.map_resolve_event_location),e.ext.mapView.currentAdapter=e.config.map_view_provider;let o=document.createElement("div");o.className="mapContainer",o.id="mapContainer",o.style.display="none",o.style.zIndex="1",e._obj.appendChild(o);const l=e.render_data;function s(){let c=e.get_visible_events();c.sort(function(g,h){return g.start_date.valueOf()==h.start_date.valueOf()?g.id>h.id?1:-1:g.start_date>h.start_date?1:-1});let u="<div "+e._waiAria.mapAttrString()+" class='dhx_map_area'>";for(let g=0;g<c.length;g++){let h=c[g],p=h.id==e._selected_event_id?"dhx_map_line highlight":"dhx_map_line",y=h.color?"--dhx-scheduler-event-background:"+h.color+";":"",x=h.textColor?"--dhx-scheduler-event-color:"+h.textColor+";":"",S=e._waiAria.mapRowAttrString(h),O=e._waiAria.mapDetailsBtnString();u+="<div "+S+" class='"+p+"' event_id='"+h.id+"' "+e.config.event_attribute+"='"+h.id+"' style='"+y+x+(h._text_style||"")+" width: "+(e.xy.map_date_width+e.xy.map_description_width+2)+"px;'><div class='dhx_map_event_time' style='width: "+e.xy.map_date_width+"px;' >"+e.templates.map_time(h.start_date,h.end_date,h)+"</div>",u+=`<div ${O} class='dhx_event_icon icon_details'><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path d="M15.4444 16.4H4.55556V7.6H15.4444V16.4ZM13.1111 2V3.6H6.88889V2H5.33333V3.6H4.55556C3.69222 3.6 3 4.312 3 5.2V16.4C3 16.8243 3.16389 17.2313 3.45561 17.5314C3.74733 17.8314 4.143 18 4.55556 18H15.4444C15.857 18 16.2527 17.8314 16.5444 17.5314C16.8361 17.2313 17 16.8243 17 16.4V5.2C17 4.312 16.3 3.6 15.4444 3.6H14.6667V2H13.1111ZM13.8889 10.8H10V14.8H13.8889V10.8Z" fill="#A1A4A6"/>
			</svg></div>`,u+="<div class='line_description' style='width:"+(e.xy.map_description_width-e.xy.map_icon_width)+"px;'>"+e.templates.map_text(h.start_date,h.end_date,h)+"</div></div>"}u+="<div class='dhx_v_border' style="+(e.config.rtl?"'right: ":"'left: ")+(e.xy.map_date_width-1)+"px;'></div><div class='dhx_v_border_description'></div></div>",e._els.dhx_cal_data[0].scrollTop=0,e._els.dhx_cal_data[0].innerHTML=u;let f=e._els.dhx_cal_data[0].firstChild.childNodes,v=e._getNavDateElement();v&&(v.innerHTML=e.templates[e._mode+"_date"](e._min_date,e._max_date,e._mode)),e._rendered=[];for(let g=0;g<f.length-2;g++)e._rendered[g]=f[g]}e.render_data=function(c,u){if(this._mode!="map")return l.apply(this,arguments);{s();let f=e.get_visible_events();t&&(t.clearEventMarkers(),f.forEach(v=>t==null?void 0:t.addEventMarker(v)))}},e.map_view=function(c){e._els.dhx_cal_data[0].style.width=e.xy.map_date_width+e.xy.map_description_width+1+"px",e._min_date=e.config.map_start||e._currentDate(),e._max_date=e.config.map_end||e.date.add(e._currentDate(),1,"year"),e._table_view=!0,function(g){if(g){const h=e.locale.labels;e._els.dhx_cal_header[0].innerHTML="<div class='dhx_map_head' style='width: "+(e.xy.map_date_width+e.xy.map_description_width+2)+"px;' ><div class='headline_date' style='width: "+e.xy.map_date_width+"px;'>"+h.date+"</div><div class='headline_description' style='width: "+e.xy.map_description_width+"px;'>"+h.description+"</div></div>",e._table_view=!0,e.set_sizes()}}(c);let u=document.getElementById("mapContainer");var f,v;(function(g){let h=document.getElementById(g);if(h){const p=e.$container.querySelector(".dhx_cal_navline").offsetHeight;let y=e.$container.querySelector(".dhx_cal_data").offsetHeight+e.$container.querySelector(".dhx_cal_header").offsetHeight;y<0&&(y=0);let x=e._x-e.xy.map_date_width-e.xy.map_description_width-1;x<0&&(x=0),h.style.height=y+"px",h.style.width=x+"px",h.style.position="absolute",h.style.top=p+"px",e.config.rtl?h.style.marginRight=e.xy.map_date_width+e.xy.map_description_width+1+"px":h.style.marginLeft=e.xy.map_date_width+e.xy.map_description_width+1+"px",h.style.marginTop=e.xy.nav_height+2+"px"}})("mapContainer"),c&&u?(o.style.display="block",s(),e.config.map_view_provider==e.ext.mapView.currentAdapter?(t==null||t.destroy(u),a(e),t==null||t.initialize(u,e.config.map_settings)):(t==null||t.destroy(u),a(e),t==null||t.initialize(u,e.config.map_settings),e.ext.mapView.currentAdapter=e.config.map_view_provider),t&&(f=e.config.map_settings,v=t,f.resolve_user_location?navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(g){v.setView(g.coords.latitude,g.coords.longitude,f.zoom_after_resolve||f.initial_zoom)}):v.setView(f.initial_position.lat,f.initial_position.lng,f.initial_zoom))):(o.style.display="none",e._els.dhx_cal_data[0].style.width="100%",t&&u&&(t.destroy(u),t=null,e.ext.mapView.currentAdapter=e.config.map_view_provider),n.forEach(g=>e.detachEvent(g)),n=[])},e.attachEvent("onLocationError",function(c){return alert("Location can't be found"),google.maps.LatLng(51.47784,-.001492)});let d=async function(c){if(t){const u=await t.resolveAddress(c.event_location);u.lat&&u.lng?(c.lat=+u.lat,c.lng=+u.lng):(e.callEvent("onLocationError",[c.id]),c.lng=e.config.map_settings.error_position.lng,c.lat=e.config.map_settings.error_position.lat),e._latLngUpdate=!0,e.callEvent("onEventChanged",[c.id,c])}};e._event_resolve_delay=1500,e.attachEvent("onEventLoading",function(c){return c.lat&&c.lng&&(c.lat=+c.lat,c.lng=+c.lng),e.config.map_settings.resolve_event_location&&c.event_location&&!c.lat&&!c.lng&&(e._event_resolve_delay+=1500,function(u,f,v,g){setTimeout(function(){if(e.$destroyed)return!0;let h=u.apply(f,v);return u=f=v=null,h},g||1)}(d,this,[c],e._event_resolve_delay)),!0})})},minical:function(e){const t=e._createDomEventScope();e.config.minicalendar={mark_events:!0},e._synced_minicalendars=[],e.renderCalendar=function(n,r,a){var i=null,o=n.date||e._currentDate();if(typeof o=="string"&&(o=this.templates.api_date(o)),r)i=this._render_calendar(r.parentNode,o,n,r),e.unmarkCalendar(i);else{var l=n.container,s=n.position;if(typeof l=="string"&&(l=document.getElementById(l)),typeof s=="string"&&(s=document.getElementById(s)),s&&s.left===void 0&&s.right===void 0){var d=e.$domHelpers.getOffset(s);s={top:d.top+s.offsetHeight,left:d.left}}l||(l=e._get_def_cont(s)),(i=this._render_calendar(l,o,n)).$_eventAttached||(i.$_eventAttached=!0,t.attach(i,"click",(function(x){var S=x.target||x.srcElement,O=e.$domHelpers;if(O.closest(S,".dhx_month_head")&&!O.closest(S,".dhx_after")&&!O.closest(S,".dhx_before")){var I=O.closest(S,"[data-cell-date]").getAttribute("data-cell-date"),N=e.templates.parse_date(I);e.unmarkCalendar(this),e.markCalendar(this,N,"dhx_calendar_click"),this._last_date=N,this.conf.events&&this.conf.events.onDateClick&&this.conf.events.onDateClick.call(this,N,x),this.conf.handler&&this.conf.handler.call(e,N,this)}}).bind(i)),t.attach(i,"mouseover",(function(x){const S=x.target;if(S.classList.contains("dhx_cal_month_cell")){var O=S.getAttribute("data-cell-date"),I=e.templates.parse_date(O);this.conf.events&&this.conf.events.onDateMouseOver&&this.conf.events.onDateMouseOver.call(this,I,x)}}).bind(i)))}if(e.config.minicalendar.mark_events)for(var c=e.date.month_start(o),u=e.date.add(c,1,"month"),f=this.getEvents(c,u),v=this["filter_"+this._mode],g={},h=0;h<f.length;h++){var p=f[h];if(!v||v(p.id,p)){var y=p.start_date;for(y.valueOf()<c.valueOf()&&(y=c),y=e.date.date_part(new Date(y.valueOf()));y<p.end_date&&(g[+y]||(g[+y]=!0,this.markCalendar(i,y,"dhx_year_event")),!((y=this.date.add(y,1,"day")).valueOf()>=u.valueOf())););}}return this._markCalendarCurrentDate(i),i.conf=n,n.sync&&!a&&this._synced_minicalendars.push(i),i.conf._on_xle_handler||(i.conf._on_xle_handler=e.attachEvent("onXLE",function(){e.updateCalendar(i,i.conf.date)})),this.config.wai_aria_attributes&&this.config.wai_aria_application_role&&i.setAttribute("role","application"),i},e._get_def_cont=function(n){return this._def_count||(this._def_count=document.createElement("div"),this._def_count.className="dhx_minical_popup",e.event(this._def_count,"click",function(r){r.cancelBubble=!0}),document.body.appendChild(this._def_count)),n.left&&(this._def_count.style.left=n.left+"px"),n.right&&(this._def_count.style.right=n.right+"px"),n.top&&(this._def_count.style.top=n.top+"px"),n.bottom&&(this._def_count.style.bottom=n.bottom+"px"),this._def_count._created=new Date,this._def_count},e._locateCalendar=function(n,r){if(typeof r=="string"&&(r=e.templates.api_date(r)),+r>+n._max_date||+r<+n._min_date)return null;for(var a=n.querySelector(".dhx_year_body").childNodes[0],i=0,o=new Date(n._min_date);+this.date.add(o,1,"week")<=+r;)o=this.date.add(o,1,"week"),i++;var l=e.config.start_on_monday,s=(r.getDay()||(l?7:0))-(l?1:0);const d=a.querySelector(`.dhx_cal_month_row:nth-child(${i+1}) .dhx_cal_month_cell:nth-child(${s+1})`);return d?d.firstChild:null},e.markCalendar=function(n,r,a){var i=this._locateCalendar(n,r);i&&(i.className+=" "+a)},e.unmarkCalendar=function(n,r,a){if(a=a||"dhx_calendar_click",r=r||n._last_date){var i=this._locateCalendar(n,r);i&&(i.className=(i.className||"").replace(RegExp(a,"g")))}},e._week_template=function(n){for(var r=n||250,a=0,i=document.createElement("div"),o=this.date.week_start(e._currentDate()),l=0;l<7;l++)this._cols[l]=Math.floor(r/(7-l)),this._render_x_header(l,a,o,i),o=this.date.add(o,1,"day"),r-=this._cols[l],a+=this._cols[l];return i.lastChild.className+=" dhx_scale_bar_last",i},e.updateCalendar=function(n,r){if(n.conf.date&&n.conf.events&&n.conf.events.onBeforeMonthChange&&n.conf.events.onBeforeMonthChange.call(n,n.conf.date,r,n)===!1)return;const a=n.conf.date;n.conf.date=r,this.renderCalendar(n.conf,n,!0),n.conf.events&&n.conf.events.onMonthChange&&n.conf.events.onMonthChange.call(n,a,r)},e._mini_cal_arrows=["&nbsp;","&nbsp;"],e._render_calendar=function(n,r,a,i){var o=e.templates,l=this._cols;this._cols=[];var s=this._mode;this._mode="calendar";var d=this._colsS;this._colsS={height:0};var c=new Date(this._min_date),u=new Date(this._max_date),f=new Date(e._date),v=o.month_day,g=this._ignores_detected;this._ignores_detected=0,o.month_day=o.calendar_date,r=this.date.month_start(r);var h,p=this._week_template(n.offsetWidth-1-this.config.minicalendar.padding);i?h=i:((h=document.createElement("div")).className="dhx_cal_container dhx_mini_calendar",this.config.rtl&&(h.className+=" dhx_cal_container_rtl")),h.setAttribute("date",this._helpers.formatDate(r)),h.innerHTML="<div class='dhx_year_month'></div><div class='dhx_year_grid"+(e.config.rtl?" dhx_grid_rtl'>":"'>")+"<div class='dhx_year_week'>"+(p?p.innerHTML:"")+"</div><div class='dhx_year_body'></div></div>";var y=h.querySelector(".dhx_year_month"),x=h.querySelector(".dhx_year_week"),S=h.querySelector(".dhx_year_body");if(y.innerHTML=this.templates.calendar_month(r),a.navigation)for(var O=function($,ee){var ie=e.date.add($._date,ee,"month");e.updateCalendar($,ie),e._date.getMonth()==$._date.getMonth()&&e._date.getFullYear()==$._date.getFullYear()&&e._markCalendarCurrentDate($)},I=["dhx_cal_prev_button","dhx_cal_next_button"],N=["left:1px;top:4px;position:absolute;","left:auto; right:1px;top:4px;position:absolute;"],A=[-1,1],m=function($){return function(){if(a.sync)for(var ee=e._synced_minicalendars,ie=0;ie<ee.length;ie++)O(ee[ie],$);else e.config.rtl&&($=-$),O(h,$)}},b=[e.locale.labels.prev,e.locale.labels.next],E=0;E<2;E++){var k=document.createElement("div");k.className=I[E],e._waiAria.headerButtonsAttributes(k,b[E]),k.style.cssText=N[E],k.innerHTML=this._mini_cal_arrows[E],y.appendChild(k),t.attach(k,"click",m(A[E]))}h._date=new Date(r),h.week_start=(r.getDay()-(this.config.start_on_monday?1:0)+7)%7;var D=h._min_date=this.date.week_start(r);h._max_date=this.date.add(h._min_date,6,"week"),this._reset_month_scale(S,r,D,6),i||n.appendChild(h),x.style.height=x.childNodes[0].offsetHeight-1+"px";var C=e.uid();e._waiAria.minicalHeader(y,C),e._waiAria.minicalGrid(h.querySelector(".dhx_year_grid"),C),e._waiAria.minicalRow(x);for(var R=x.querySelectorAll(".dhx_scale_bar"),P=0;P<R.length;P++)e._waiAria.minicalHeadCell(R[P]);var U=S.querySelectorAll(".dhx_cal_month_cell"),q=new Date(D);for(P=0;P<U.length;P++)e._waiAria.minicalDayCell(U[P],new Date(q)),q=e.date.add(q,1,"day");return e._waiAria.minicalHeader(y,C),this._cols=l,this._mode=s,this._colsS=d,this._min_date=c,this._max_date=u,e._date=f,o.month_day=v,this._ignores_detected=g,h},e.destroyCalendar=function(n,r){!n&&this._def_count&&this._def_count.firstChild&&(r||new Date().valueOf()-this._def_count._created.valueOf()>500)&&(n=this._def_count.firstChild),n&&(t.detachAll(),n.innerHTML="",n.parentNode&&n.parentNode.removeChild(n),this._def_count&&(this._def_count.style.top="-1000px"),n.conf&&n.conf._on_xle_handler&&e.detachEvent(n.conf._on_xle_handler))},e.isCalendarVisible=function(){return!!(this._def_count&&parseInt(this._def_count.style.top,10)>0)&&this._def_count},e.attachEvent("onTemplatesReady",function(){e.event(document.body,"click",function(){e.destroyCalendar()})},{once:!0}),e.form_blocks.calendar_time={render:function(n){var r="<span class='dhx_minical_input_wrapper'><input class='dhx_readonly dhx_minical_input' type='text' readonly='true'></span>",a=e.config,i=this.date.date_part(e._currentDate()),o=1440,l=0;a.limit_time_select&&(l=60*a.first_hour,o=60*a.last_hour+1),i.setHours(l/60),n._time_values=[],r+=" <select class='dhx_lightbox_time_select'>";for(var s=l;s<o;s+=1*this.config.time_step)r+="<option value='"+s+"'>"+this.templates.time_picker(i)+"</option>",n._time_values.push(s),i=this.date.add(i,this.config.time_step,"minute");return"<div class='dhx_section_time dhx_lightbox_minical'>"+(r+="</select>")+"<span class='dhx_lightbox_minical_spacer'> &nbsp;&ndash;&nbsp; </span>"+r+"</div>"},set_value:function(n,r,a,i){var o,l,s=n.getElementsByTagName("input"),d=n.getElementsByTagName("select"),c=function(y,x,S){e.event(y,"click",function(){e.destroyCalendar(null,!0),e.renderCalendar({position:y,date:new Date(this._date),navigation:!0,handler:function(O){y.value=e.templates.calendar_time(O),y._date=new Date(O),e.destroyCalendar(),e.config.event_duration&&e.config.auto_end_date&&S===0&&g()}})})};if(e.config.full_day){if(!n._full_day){var u="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+e.locale.labels.full_day+"&nbsp;</label></input>";e.config.wide_form||(u=n.previousSibling.innerHTML+u),n.previousSibling.innerHTML=u,n._full_day=!0}var f=n.previousSibling.getElementsByTagName("input")[0],v=e.date.time_part(a.start_date)===0&&e.date.time_part(a.end_date)===0;f.checked=v,d[0].disabled=f.checked,d[1].disabled=f.checked,f.$_eventAttached||(f.$_eventAttached=!0,e.event(f,"click",function(){if(f.checked===!0){var y={};e.form_blocks.calendar_time.get_value(n,y),o=e.date.date_part(y.start_date),(+(l=e.date.date_part(y.end_date))==+o||+l>=+o&&(a.end_date.getHours()!==0||a.end_date.getMinutes()!==0))&&(l=e.date.add(l,1,"day"))}else o=null,l=null;var x=o||a.start_date,S=l||a.end_date;h(s[0],x),h(s[1],S),d[0].value=60*x.getHours()+x.getMinutes(),d[1].value=60*S.getHours()+S.getMinutes(),d[0].disabled=f.checked,d[1].disabled=f.checked}))}if(e.config.event_duration&&e.config.auto_end_date){var g=function(){e.config.auto_end_date&&e.config.event_duration&&(o=e.date.add(s[0]._date,d[0].value,"minute"),l=new Date(o.getTime()+60*e.config.event_duration*1e3),s[1].value=e.templates.calendar_time(l),s[1]._date=e.date.date_part(new Date(l)),d[1].value=60*l.getHours()+l.getMinutes())};d[0].$_eventAttached||d[0].addEventListener("change",g)}function h(y,x,S){c(y,x,S),y.value=e.templates.calendar_time(x),y._date=e.date.date_part(new Date(x))}function p(y){for(var x=i._time_values,S=60*y.getHours()+y.getMinutes(),O=S,I=!1,N=0;N<x.length;N++){var A=x[N];if(A===S){I=!0;break}A<S&&(O=A)}return I||O?I?S:O:-1}h(s[0],a.start_date,0),h(s[1],a.end_date,1),c=function(){},d[0].value=p(a.start_date),d[1].value=p(a.end_date)},get_value:function(n,r){var a=n.getElementsByTagName("input"),i=n.getElementsByTagName("select");return r.start_date=e.date.add(a[0]._date,i[0].value,"minute"),r.end_date=e.date.add(a[1]._date,i[1].value,"minute"),r.end_date<=r.start_date&&(r.end_date=e.date.add(r.start_date,e.config.time_step,"minute")),{start_date:new Date(r.start_date),end_date:new Date(r.end_date)}},focus:function(n){}},e.linkCalendar=function(n,r){var a=function(){var i=e._date,o=new Date(i.valueOf());return r&&(o=r(o)),o.setDate(1),e.updateCalendar(n,o),!0};e.attachEvent("onViewChange",a),e.attachEvent("onXLE",a),e.attachEvent("onEventAdded",a),e.attachEvent("onEventChanged",a),e.attachEvent("onEventDeleted",a),a()},e._markCalendarCurrentDate=function(n){var r=e.getState(),a=r.min_date,i=r.max_date,o=r.mode,l=e.date.month_start(new Date(n._date)),s=e.date.add(l,1,"month");if(!({month:!0,year:!0,agenda:!0,grid:!0}[o]||a.valueOf()<=l.valueOf()&&i.valueOf()>=s.valueOf()))for(var d=a;d.valueOf()<i.valueOf();)l.valueOf()<=d.valueOf()&&s>d&&e.markCalendar(n,d,"dhx_calendar_click"),d=e.date.add(d,1,"day")},e.attachEvent("onEventCancel",function(){e.destroyCalendar(null,!0)}),e.attachEvent("onDestroy",function(){e.destroyCalendar()})},monthheight:function(e){e.attachEvent("onTemplatesReady",function(){e.xy.scroll_width=0;var t=e.render_view_data;e.render_view_data=function(){var r=this._els.dhx_cal_data[0];r.firstChild._h_fix=!0,t.apply(e,arguments);var a=parseInt(r.style.height);r.style.height="1px",r.style.height=r.scrollHeight+"px",this._obj.style.height=this._obj.clientHeight+r.scrollHeight-a+"px"};var n=e._reset_month_scale;e._reset_month_scale=function(r,a,i,o){var l={clientHeight:100};n.apply(e,[l,a,i,o]),r.innerHTML=l.innerHTML}})},multisection:function(e){Et("Multisection",e.assert)},multiselect:function(e){e.form_blocks.multiselect={render:function(t){var n="dhx_multi_select_control dhx_multi_select_"+t.name;t.vertical&&(n+=" dhx_multi_select_control_vertical");for(var r="<div class='"+n+"' style='overflow: auto; height: "+t.height+"px; position: relative;' >",a=0;a<t.options.length;a++)r+="<label><input type='checkbox' value='"+t.options[a].key+"'/>"+t.options[a].label+"</label>";return r+="</div>"},set_value:function(t,n,r,a){for(var i=t.getElementsByTagName("input"),o=0;o<i.length;o++)i[o].checked=!1;function l(f){for(var v=t.getElementsByTagName("input"),g=0;g<v.length;g++)v[g].checked=!!f[v[g].value]}var s={};if(r[a.map_to]){var d=(r[a.map_to]+"").split(a.delimiter||e.config.section_delimiter||",");for(o=0;o<d.length;o++)s[d[o]]=!0;l(s)}else{if(e._new_event||!a.script_url)return;var c=document.createElement("div");c.className="dhx_loading",c.style.cssText="position: absolute; top: 40%; left: 40%;",t.appendChild(c);var u=[a.script_url,a.script_url.indexOf("?")==-1?"?":"&","dhx_crosslink_"+a.map_to+"="+r.id+"&uid="+e.uid()].join("");e.ajax.get(u,function(f){var v=function(g){try{for(var h=JSON.parse(g.xmlDoc.responseText),p={},y=0;y<h.length;y++){var x=h[y];p[x.value||x.key||x.id]=!0}return p}catch{return null}}(f);v||(v=function(g,h){for(var p=e.ajax.xpath("//data/item",g.xmlDoc),y={},x=0;x<p.length;x++)y[p[x].getAttribute(h.map_to)]=!0;return y}(f,a)),l(v),t.removeChild(c)})}},get_value:function(t,n,r){for(var a=[],i=t.getElementsByTagName("input"),o=0;o<i.length;o++)i[o].checked&&a.push(i[o].value);return a.join(r.delimiter||e.config.section_delimiter||",")},focus:function(t){}}},multisource:function(e){var t=e._load;e._load=function(n,r){if(typeof(n=n||this._load_url)=="object")for(var a=function(o){var l=function(){};return l.prototype=o,l}(this._loaded),i=0;i<n.length;i++)this._loaded=new a,t.call(this,n[i],r);else t.apply(this,arguments)}},mvc:function(e){var t,n={use_id:!1};function r(o){var l={};for(var s in o)s.indexOf("_")!==0&&(l[s]=o[s]);return n.use_id||delete l.id,l}function a(o){o._not_render=!1,o._render_wait&&o.render_view_data(),o._loading=!1,o.callEvent("onXLE",[])}function i(o){return n.use_id?o.id:o.cid}e.backbone=function(o,l){l&&(n=l),o.bind("change",function(c,u){var f=i(c),v=e._events[f]=c.toJSON();v.id=f,e._init_event(v),clearTimeout(t),t=setTimeout(function(){if(e.$destroyed)return!0;e.updateView()},1)}),o.bind("remove",function(c,u){var f=i(c);e._events[f]&&e.deleteEvent(f)});var s=[];function d(){if(e.$destroyed)return!0;s.length&&(e.parse(s,"json"),s=[])}o.bind("add",function(c,u){var f=i(c);if(!e._events[f]){var v=c.toJSON();v.id=f,e._init_event(v),s.push(v),s.length==1&&setTimeout(d,1)}}),o.bind("request",function(c){var u;c instanceof Backbone.Collection&&((u=e)._loading=!0,u._not_render=!0,u.callEvent("onXLS",[]))}),o.bind("sync",function(c){c instanceof Backbone.Collection&&a(e)}),o.bind("error",function(c){c instanceof Backbone.Collection&&a(e)}),e.attachEvent("onEventCreated",function(c){var u=new o.model(e.getEvent(c));return e._events[c]=u.toJSON(),e._events[c].id=c,!0}),e.attachEvent("onEventAdded",function(c){if(!o.get(c)){var u=r(e.getEvent(c)),f=new o.model(u),v=i(f);v!=c&&this.changeEventId(c,v),o.add(f),o.trigger("scheduler:add",f)}return!0}),e.attachEvent("onEventChanged",function(c){var u=o.get(c),f=r(e.getEvent(c));return u.set(f),o.trigger("scheduler:change",u),!0}),e.attachEvent("onEventDeleted",function(c){var u=o.get(c);return u&&(o.trigger("scheduler:remove",u),o.remove(c)),!0})}},outerdrag:function(e){e.attachEvent("onTemplatesReady",function(){var t,n=new dhtmlDragAndDropObject,r=n.stopDrag;function a(i,o,l,s){if(!e.checkEvent("onBeforeExternalDragIn")||e.callEvent("onBeforeExternalDragIn",[i,o,l,s,t])){var d=e.attachEvent("onEventCreated",function(g){e.callEvent("onExternalDragIn",[g,i,t])||(this._drag_mode=this._drag_id=null,this.deleteEvent(g))}),c=e.getActionData(t),u={start_date:new Date(c.date)};if(e.matrix&&e.matrix[e._mode]){var f=e.matrix[e._mode];u[f.y_property]=c.section;var v=e._locate_cell_timeline(t);u.start_date=f._trace_x[v.x],u.end_date=e.date.add(u.start_date,f.x_step,f.x_unit)}e._props&&e._props[e._mode]&&(u[e._props[e._mode].map_to]=c.section),e.addEventNow(u),e.detachEvent(d)}}n.stopDrag=function(i){return t=i,r.apply(this,arguments)},n.addDragLanding(e._els.dhx_cal_data[0],{_drag:function(i,o,l,s){a(i,o,l,s)},_dragIn:function(i,o){return i},_dragOut:function(i){return this}}),dhtmlx.DragControl&&dhtmlx.DragControl.addDrop(e._els.dhx_cal_data[0],{onDrop:function(i,o,l,s){var d=dhtmlx.DragControl.getMaster(i);t=s,a(i,d,o,s.target||s.srcElement)},onDragIn:function(i,o,l){return o}},!0)})},pdf:function(e){var t,n,r=new RegExp("<[^>]*>","g"),a=new RegExp("<br[^>]*>","g");function i(I){return I.replace(a,`
`).replace(r,"")}function o(I,N){I=parseFloat(I),N=parseFloat(N),isNaN(N)||(I-=N);var A=s(I);return I=I-A.width+A.cols*t,isNaN(I)?"auto":100*I/t}function l(I,N,A){I=parseFloat(I),N=parseFloat(N),!isNaN(N)&&A&&(I-=N);var m=s(I);return I=I-m.width+m.cols*t,isNaN(I)?"auto":100*I/(t-(isNaN(N)?0:N))}function s(I){for(var N=0,A=e._els.dhx_cal_header[0].childNodes,m=A[1]?A[1].childNodes:A[0].childNodes,b=0;b<m.length;b++){var E=m[b].style?m[b]:m[b].parentNode,k=parseFloat(E.style.width);if(!(I>k))break;I-=k+1,N+=k+1}return{width:N,cols:b}}function d(I){return I=parseFloat(I),isNaN(I)?"auto":100*I/n}function c(I,N){return(window.getComputedStyle?window.getComputedStyle(I,null)[N]:I.currentStyle?I.currentStyle[N]:null)||""}function u(I,N){for(var A=parseInt(I.style.left,10),m=0;m<e._cols.length;m++)if((A-=e._cols[m])<0)return m;return N}function f(I,N){for(var A=parseInt(I.style.top,10),m=0;m<e._colsS.heights.length;m++)if(e._colsS.heights[m]>A)return m;return N}function v(I){return I?"</"+I+">":""}function g(I,N,A,m){var b="<"+I+" profile='"+N+"'";return A&&(b+=" header='"+A+"'"),m&&(b+=" footer='"+m+"'"),b+=">"}function h(){var I="",N=e._mode;if(e.matrix&&e.matrix[e._mode]&&(N=e.matrix[e._mode].render=="cell"?"matrix":"timeline"),I+="<scale mode='"+N+"' today='"+e._els.dhx_cal_date[0].innerHTML+"'>",e._mode=="week_agenda")for(var A=e._els.dhx_cal_data[0].getElementsByTagName("DIV"),m=0;m<A.length;m++)A[m].className=="dhx_wa_scale_bar"&&(I+="<column>"+i(A[m].innerHTML)+"</column>");else if(e._mode=="agenda"||e._mode=="map")I+="<column>"+i((A=e._els.dhx_cal_header[0].childNodes[0].childNodes)[0].innerHTML)+"</column><column>"+i(A[1].innerHTML)+"</column>";else if(e._mode=="year")for(A=e._els.dhx_cal_data[0].childNodes,m=0;m<A.length;m++)I+="<month label='"+i(A[m].querySelector(".dhx_year_month").innerHTML)+"'>",I+=y(A[m].querySelector(".dhx_year_week").childNodes),I+=p(A[m].querySelector(".dhx_year_body")),I+="</month>";else{I+="<x>",I+=y(A=e._els.dhx_cal_header[0].childNodes),I+="</x>";var b=e._els.dhx_cal_data[0];if(e.matrix&&e.matrix[e._mode]){for(I+="<y>",m=0;m<b.firstChild.rows.length;m++)I+="<row><![CDATA["+i(b.firstChild.rows[m].cells[0].innerHTML)+"]]></row>";I+="</y>",n=b.firstChild.rows[0].cells[0].offsetHeight}else if(b.firstChild.tagName=="TABLE")I+=p(b);else{for(b=b.childNodes[b.childNodes.length-1];b.className.indexOf("dhx_scale_holder")==-1;)b=b.previousSibling;for(b=b.childNodes,I+="<y>",m=0;m<b.length;m++)I+=`
<row><![CDATA[`+i(b[m].innerHTML)+"]]></row>";I+="</y>",n=b[0].offsetHeight}}return I+="</scale>"}function p(I){for(var N="",A=I.querySelectorAll("tr"),m=0;m<A.length;m++){for(var b=[],E=A[m].querySelectorAll("td"),k=0;k<E.length;k++)b.push(E[k].querySelector(".dhx_month_head").innerHTML);N+=`
<row height='`+E[0].offsetHeight+"'><![CDATA["+i(b.join("|"))+"]]></row>",n=E[0].offsetHeight}return N}function y(I){var N,A="";e.matrix&&e.matrix[e._mode]&&(e.matrix[e._mode].second_scale&&(N=I[1].childNodes),I=I[0].childNodes);for(var m=0;m<I.length;m++)A+=`
<column><![CDATA[`+i(I[m].innerHTML)+"]]></column>";if(t=I[0].offsetWidth,N){var b=0,E=I[0].offsetWidth,k=1;for(m=0;m<N.length;m++)A+=`
<column second_scale='`+k+"'><![CDATA["+i(N[m].innerHTML)+"]]></column>",(b+=N[m].offsetWidth)>=E&&(E+=I[k]?I[k].offsetWidth:0,k++),t=N[0].offsetWidth}return A}function x(I){var N="",A=e._rendered,m=e.matrix&&e.matrix[e._mode];if(e._mode=="agenda"||e._mode=="map")for(var b=0;b<A.length;b++)N+="<event><head><![CDATA["+i(A[b].childNodes[0].innerHTML)+"]]></head><body><![CDATA["+i(A[b].childNodes[2].innerHTML)+"]]></body></event>";else if(e._mode=="week_agenda")for(b=0;b<A.length;b++)N+="<event day='"+A[b].parentNode.getAttribute("day")+"'><body>"+i(A[b].innerHTML)+"</body></event>";else if(e._mode=="year")for(A=e.get_visible_events(),b=0;b<A.length;b++){var E=A[b].start_date;for(E.valueOf()<e._min_date.valueOf()&&(E=e._min_date);E<A[b].end_date;){var k=E.getMonth()+12*(E.getFullYear()-e._min_date.getFullYear())-e.week_starts._month,D=e.week_starts[k]+E.getDate()-1,C=I?c(e._get_year_cell(E),"color"):"",R=I?c(e._get_year_cell(E),"backgroundColor"):"";if(N+="<event day='"+D%7+"' week='"+Math.floor(D/7)+"' month='"+k+"' backgroundColor='"+R+"' color='"+C+"'></event>",(E=e.date.add(E,1,"day")).valueOf()>=e._max_date.valueOf())break}}else if(m&&m.render=="cell")for(A=e._els.dhx_cal_data[0].getElementsByTagName("TD"),b=0;b<A.length;b++)C=I?c(A[b],"color"):"",N+=`
<event><body backgroundColor='`+(R=I?c(A[b],"backgroundColor"):"")+"' color='"+C+"'><![CDATA["+i(A[b].innerHTML)+"]]></body></event>";else for(b=0;b<A.length;b++){var P,U;if(e.matrix&&e.matrix[e._mode])P=o(A[b].style.left),U=o(A[b].offsetWidth)-1;else{var q=e.config.use_select_menu_space?0:26;P=l(A[b].style.left,q,!0),U=l(A[b].style.width,q)-1}if(!isNaN(1*U)){var $=d(A[b].style.top),ee=d(A[b].style.height),ie=A[b].className.split(" ")[0].replace("dhx_cal_","");if(ie!=="dhx_tooltip_line"){var Q=e.getEvent(A[b].getAttribute(e.config.event_attribute));if(Q){D=Q._sday;var W=Q._sweek,J=Q._length||0;if(e._mode=="month")ee=parseInt(A[b].offsetHeight,10),$=parseInt(A[b].style.top,10)-e.xy.month_head_height,D=u(A[b],D),W=f(A[b],W);else if(e.matrix&&e.matrix[e._mode]){D=0,W=A[b].parentNode.parentNode.parentNode.rowIndex;var re=n;n=A[b].parentNode.offsetHeight,$=d(A[b].style.top),$-=.2*$,n=re}else{if(A[b].parentNode==e._els.dhx_cal_data[0])continue;var ge=e._els.dhx_cal_data[0].childNodes[0],Ue=parseFloat(ge.className.indexOf("dhx_scale_holder")!=-1?ge.style.left:0);P+=o(A[b].parentNode.style.left,Ue)}N+=`
<event week='`+W+"' day='"+D+"' type='"+ie+"' x='"+P+"' y='"+$+"' width='"+U+"' height='"+ee+"' len='"+J+"'>",ie=="event"?(N+="<header><![CDATA["+i(A[b].childNodes[1].innerHTML)+"]]></header>",C=I?c(A[b].childNodes[2],"color"):"",N+="<body backgroundColor='"+(R=I?c(A[b].childNodes[2],"backgroundColor"):"")+"' color='"+C+"'><![CDATA["+i(A[b].childNodes[2].innerHTML)+"]]></body>"):(C=I?c(A[b],"color"):"",N+="<body backgroundColor='"+(R=I?c(A[b],"backgroundColor"):"")+"' color='"+C+"'><![CDATA["+i(A[b].innerHTML)+"]]></body>"),N+="</event>"}}}}return N}function S(I,N,A,m,b,E){var k=!1;m=="fullcolor"&&(k=!0,m="color"),m=m||"color";var D,C="";if(I){var R=e._date,P=e._mode;N=e.date[A+"_start"](N),N=e.date["get_"+A+"_end"]?e.date["get_"+A+"_end"](N):e.date.add(N,1,A),C=g("pages",m,b,E);for(var U=new Date(I);+U<+N;U=this.date.add(U,1,A))this.setCurrentView(U,A),C+=((D="page")?"<"+D+">":"")+h().replace("","-")+x(k)+v("page");C+=v("pages"),this.setCurrentView(R,P)}else C=g("data",m,b,E)+h().replace("","-")+x(k)+v("data");return C}function O(I,N,A,m,b,E,k){(function(D,C){var R=e.uid(),P=document.createElement("div");P.style.display="none",document.body.appendChild(P),P.innerHTML='<form id="'+R+'" method="post" target="_blank" action="'+C+'" accept-charset="utf-8" enctype="application/x-www-form-urlencoded"><input type="hidden" name="mycoolxmlbody"/> </form>',document.getElementById(R).firstChild.value=encodeURIComponent(D),document.getElementById(R).submit(),P.parentNode.removeChild(P)})(typeof b=="object"?function(D){for(var C="<data>",R=0;R<D.length;R++)C+=D[R].source.getPDFData(D[R].start,D[R].end,D[R].view,D[R].mode,D[R].header,D[R].footer);return C+="</data>",C}(b):S.apply(this,[I,N,A,b,E,k]),m)}e.getPDFData=S,e.toPDF=function(I,N,A,m){return O.apply(this,[null,null,null,I,N,A,m])},e.toPDFRange=function(I,N,A,m,b,E,k){return typeof I=="string"&&(I=e.templates.api_date(I),N=e.templates.api_date(N)),O.apply(this,arguments)}},quick_info:function(e){e.config.icons_select=["icon_form","icon_delete"],e.config.details_on_create=!0,e.config.show_quick_info=!0,e.xy.menu_width=0;let t=null;function n(a){const i=a.getBoundingClientRect(),o=e.$container.getBoundingClientRect().bottom-i.bottom;o<0&&(a.style.top=`${parseFloat(a.style.top)+o}px`)}function r(a){let i=0,o=0,l=a;for(;l&&l!=e._obj;)i+=l.offsetLeft,o+=l.offsetTop-l.scrollTop,l=l.offsetParent;return l?{left:i,top:o,dx:i+a.offsetWidth/2>e._x/2?1:0,dy:o+a.offsetHeight/2>e._y/2?1:0,width:a.offsetWidth,height:a.offsetHeight}:0}e.attachEvent("onSchedulerReady",function(){const a=e.$container;a._$quickInfoHandler||(a._$quickInfoHandler=!0,e.event(a,"mousedown",function(i){const o=i.target.closest(`[${e.config.event_attribute}]`);o&&(t={id:o.getAttribute(e.config.event_attribute),position:r(o)})}),e.attachEvent("onDestroy",()=>{delete a._$quickInfoHandler}))}),e.attachEvent("onClick",function(a){if(e.config.show_quick_info)return e.showQuickInfo(a),!0}),function(){for(var a=["onEmptyClick","onViewChange","onLightbox","onBeforeEventDelete","onBeforeDrag"],i=function(){return e.hideQuickInfo(!0),!0},o=0;o<a.length;o++)e.attachEvent(a[o],i)}(),e.templates.quick_info_title=function(a,i,o){return o.text.substr(0,50)},e.templates.quick_info_content=function(a,i,o){return o.details||""},e.templates.quick_info_date=function(a,i,o){return e.isOneDayEvent(o)&&e.config.rtl?e.templates.day_date(a,i,o)+" "+e.templates.event_header(i,a,o):e.isOneDayEvent(o)?e.templates.day_date(a,i,o)+" "+e.templates.event_header(a,i,o):e.config.rtl?e.templates.week_date(i,a,o):e.templates.week_date(a,i,o)},e.showQuickInfo=function(a){if(a==this._quick_info_box_id||(this.hideQuickInfo(!0),this.callEvent("onBeforeQuickInfo",[a])===!1))return;let i;i=t&&t.id==a?t.position:this._get_event_counter_part(a),i&&(this._quick_info_box=this._init_quick_info(i),this._fill_quick_data(a),this._show_quick_info(i),this.callEvent("onQuickInfo",[a]))},function(){function a(i){i=i||"";var o,l=parseFloat(i),s=i.match(/m?s/);switch(s&&(s=s[0]),s){case"s":o=1e3*l;break;case"ms":o=l;break;default:o=0}return o}e.hideQuickInfo=function(i){var o=this._quick_info_box,l=this._quick_info_box_id;if(this._quick_info_box_id=0,o&&o.parentNode){var s=o.offsetWidth;if(e.config.quick_info_detached)return this.callEvent("onAfterQuickInfo",[l]),o.parentNode.removeChild(o);if(o.style.right=="auto"?o.style.left=-s+"px":o.style.right=-s+"px",i)o.parentNode.removeChild(o);else{var d;window.getComputedStyle?d=window.getComputedStyle(o,null):o.currentStyle&&(d=o.currentStyle);var c=a(d["transition-delay"])+a(d["transition-duration"]);setTimeout(function(){o.parentNode&&o.parentNode.removeChild(o)},c)}this.callEvent("onAfterQuickInfo",[l])}}}(),e.event(window,"keydown",function(a){a.keyCode==27&&e.hideQuickInfo()}),e._show_quick_info=function(a){var i=e._quick_info_box;e._obj.appendChild(i);var o=i.offsetWidth,l=i.offsetHeight;if(e.config.quick_info_detached){var s=a.left-a.dx*(o-a.width);e.getView()&&e.getView()._x_scroll&&(e.config.rtl?s+=e.getView()._x_scroll:s-=e.getView()._x_scroll),s+o>window.innerWidth&&(s=window.innerWidth-o),s=Math.max(0,s),i.style.left=s+"px",i.style.top=a.top-(a.dy?l:-a.height)+"px"}else{const d=e.$container.querySelector(".dhx_cal_data").offsetTop;i.style.top=d+20+"px",a.dx==1?(i.style.right="auto",i.style.left=-o+"px",setTimeout(function(){i.style.left="-10px"},1)):(i.style.left="auto",i.style.right=-o+"px",setTimeout(function(){i.style.right="-10px"},1)),i.className=i.className.replace(" dhx_qi_left","").replace(" dhx_qi_right","")+" dhx_qi_"+(a.dx==1?"left":"right")}i.ontransitionend=()=>{n(i),i.ontransitionend=null},setTimeout(()=>{n(i)},1)},e.attachEvent("onTemplatesReady",function(){if(e.hideQuickInfo(),this._quick_info_box){var a=this._quick_info_box;a.parentNode&&a.parentNode.removeChild(a),this._quick_info_box=null}}),e._quick_info_onscroll_handler=function(a){e.hideQuickInfo()},e._init_quick_info=function(){if(!this._quick_info_box){var a=this._quick_info_box=document.createElement("div");this._waiAria.quickInfoAttr(a),a.className="dhx_cal_quick_info",e.$testmode&&(a.className+=" dhx_no_animate"),e.config.rtl&&(a.className+=" dhx_quick_info_rtl");var i=`
		<div class="dhx_cal_qi_tcontrols">
			<a class="dhx_cal_qi_close_btn scheduler_icon close"></a>
		</div>
		<div class="dhx_cal_qi_title" ${this._waiAria.quickInfoHeaderAttrString()}>
				
				<div class="dhx_cal_qi_tcontent"></div>
				<div class="dhx_cal_qi_tdate"></div>
			</div>
			<div class="dhx_cal_qi_content"></div>`;i+='<div class="dhx_cal_qi_controls">';for(var o=e.config.icons_select,l=0;l<o.length;l++)i+=`<div ${this._waiAria.quickInfoButtonAttrString(this.locale.labels[o[l]])} class="dhx_qi_big_icon ${o[l]}" title="${e.locale.labels[o[l]]}">
				<div class='dhx_menu_icon ${o[l]}'></div><div>${e.locale.labels[o[l]]}</div></div>`;i+="</div>",a.innerHTML=i,e.event(a,"click",function(s){e._qi_button_click(s.target||s.srcElement)}),e.config.quick_info_detached&&(e._detachDomEvent(e._els.dhx_cal_data[0],"scroll",e._quick_info_onscroll_handler),e.event(e._els.dhx_cal_data[0],"scroll",e._quick_info_onscroll_handler))}return this._quick_info_box},e._qi_button_click=function(a){var i=e._quick_info_box;if(a&&a!=i)if(a.closest(".dhx_cal_qi_close_btn"))e.hideQuickInfo();else{var o=e._getClassName(a);if(o.indexOf("_icon")!=-1){var l=e._quick_info_box_id;e._click.buttons[o.split(" ")[1].replace("icon_","")](l)}else e._qi_button_click(a.parentNode)}},e._get_event_counter_part=function(a){return r(e.getRenderedEvent(a))},e._fill_quick_data=function(a){var i=e.getEvent(a),o=e._quick_info_box;e._quick_info_box_id=a;var l={content:e.templates.quick_info_title(i.start_date,i.end_date,i),date:e.templates.quick_info_date(i.start_date,i.end_date,i)};o.querySelector(".dhx_cal_qi_tcontent").innerHTML=`<span>${l.content}</span>`,o.querySelector(".dhx_cal_qi_tdate").innerHTML=l.date,e._waiAria.quickInfoHeader(o,[l.content,l.date].join(" "));var s=o.querySelector(".dhx_cal_qi_content");const d=e.templates.quick_info_content(i.start_date,i.end_date,i);d?(s.classList.remove("dhx_hidden"),s.innerHTML=d):s.classList.add("dhx_hidden")}},readonly:function(e){e.attachEvent("onTemplatesReady",function(){var t;e.form_blocks.recurring&&(t=e.form_blocks.recurring.set_value);var n=e.config.buttons_left.slice(),r=e.config.buttons_right.slice();function a(l,s,d,c){for(var u=s.getElementsByTagName(l),f=d.getElementsByTagName(l),v=f.length-1;v>=0;v--)if(d=f[v],c){var g=document.createElement("span");g.className="dhx_text_disabled",g.innerHTML=c(u[v]),d.parentNode.insertBefore(g,d),d.parentNode.removeChild(d)}else d.disabled=!0,s.checked&&(d.checked=!0)}e.attachEvent("onBeforeLightbox",function(l){if(this.config.readonly_form||this.getEvent(l).readonly?this.config.readonly_active=!0:(this.config.readonly_active=!1,e.config.buttons_left=n.slice(),e.config.buttons_right=r.slice(),e.form_blocks.recurring&&(e.form_blocks.recurring.set_value=t)),this.config.readonly_active)for(var s=["dhx_delete_btn","dhx_save_btn"],d=[e.config.buttons_left,e.config.buttons_right],c=0;c<s.length;c++)for(var u=s[c],f=0;f<d.length;f++){for(var v=d[f],g=-1,h=0;h<v.length;h++)if(v[h]==u){g=h;break}g!=-1&&v.splice(g,1)}return this.resetLightbox(),!0});var i=e._fill_lightbox;e._fill_lightbox=function(){var l=this.getLightbox();this.config.readonly_active&&(l.style.visibility="hidden",l.style.display="block");var s=i.apply(this,arguments);if(this.config.readonly_active&&(l.style.visibility="",l.style.display="none"),this.config.readonly_active){var d=this.getLightbox(),c=this._lightbox_r=d.cloneNode(!0);c.id=e.uid(),c.className+=" dhx_cal_light_readonly",a("textarea",d,c,function(u){return u.value}),a("input",d,c,!1),a("select",d,c,function(u){return u.options.length?u.options[Math.max(u.selectedIndex||0,0)].text:""}),d.parentNode.insertBefore(c,d),this.showCover(c),e._lightbox&&e._lightbox.parentNode.removeChild(e._lightbox),this._lightbox=c,e.config.drag_lightbox&&e.event(c.firstChild,"mousedown",e._ready_to_dnd),e._init_lightbox_events(),this.setLightboxSize()}return s};var o=e.hide_lightbox;e.hide_lightbox=function(){return this._lightbox_r&&(this._lightbox_r.parentNode.removeChild(this._lightbox_r),this._lightbox_r=this._lightbox=null),o.apply(this,arguments)}})},recurring:function(e){function t(m){return new Date(m.getFullYear(),m.getMonth(),m.getDate(),m.getHours(),m.getMinutes(),m.getSeconds(),0)}function n(m){return!!m.rrule&&!m.recurring_event_id}function r(m){return new Date(Date.UTC(m.getFullYear(),m.getMonth(),m.getDate(),m.getHours(),m.getMinutes(),m.getSeconds()))}function a(m){m.rrule.includes(";UNTIL=")&&(m.rrule=m.rrule.split(";UNTIL=")[0]);let b=Wn(`RRULE:${m.rrule};UNTIL=${h(m._end_date||m.end_date)}`,{dtstart:m.start_date}),E=new B(b.origOptions).toString().replace("RRULE:","");E=E.split(`
`)[1],m.rrule=E}function i(m,b){b||(b=e.getEvent(m));let E=b.rrule.split(";"),k=[];for(let D=0;D<E.length;D++){let C=E[D].split("="),R=C[0],P=C[1];(R!=="BYDAY"||b.rrule.includes("WEEKLY")&&P.length>3)&&(k.push(R),k.push("="),k.push(P),k.push(";"))}k.pop(),b.rrule=k.join("")}var o;function l(m,b){m._end_date=m.end_date,e._isExceptionFirstOccurrence(b)?(m.start_date=b.start_date,m.end_date=new Date(b.start_date.valueOf()+1e3*m.duration),m._start_date=b.original_start,m._modified=!0):(m.end_date=new Date(b.start_date.valueOf()+1e3*m.duration),m.start_date=b.start_date,m._firstOccurrence=!0),m._thisAndFollowing=b.id}function s(m,b,E,k){const D=E._modified?k.id:m;e._events[D]={...k,text:b.text,duration:b.duration,start_date:b.start_date,rrule:b.rrule,end_date:k._end_date,_start_date:k.start_date,_thisAndFollowing:null,_end_date:null},E._modified&&delete e._events[m],e.callEvent("onEventChanged",[e._events[D].id,e._events[D]])}function d(m){for(const b in e._events)e._events[b].id==m.id&&delete e._events[b]}function c(m,b){for(let E in e._events){let k=e._events[E];(k.recurring_event_id==m||e._is_virtual_event(k.id)&&k.id.split("#")[0]==m)&&(k.text=b.text,e.updateEvent(k.id))}}function u(m,b){let E=m,k=new Date(b.original_start).valueOf();m=String(E).split("#")||b._pid_time||k;let D=e.uid(),C=m[1]?m[1]:b._pid_time||k,R=e._copy_event(b);R.id=D,R.recurring_event_id=b.recurring_event_id||m[0],R.original_start=new Date(Number(C)),R.deleted=!0,e.addEvent(R)}function f(){for(const m in e._events)m==="$dnd_recurring_placeholder"&&delete e._events[m];e.render()}function v(m,b){const E=e.locale;m.find(D=>D.checked)||(m[0].checked=!0);const k=m.reduce((D,C)=>(D[C.value]=C.callback,D),{});e.modalbox({text:`<div class="dhx_edit_recurrence_options">
				${m.map(D=>`<label class="dhx_styled_radio">
					<input type="radio" value="${D.value}" name="option" ${D.checked?"checked":""}>
					${D.label}
				</label>`).join("")}
			</div>`,type:"recurring_mode",title:E.labels.confirm_recurring,width:"auto",position:"middle",buttons:[{label:E.labels.message_ok,value:"ok",css:"rec_ok"},{label:E.labels.message_cancel,value:"cancel"}],callback:function(D,C){if(b&&b(D,C),D==="cancel")return;const R=C.target.closest(".scheduler_modal_box").querySelector("input[type='radio']:checked");let P;R&&(P=R.value),P&&k[P]()}})}function g(){const m={};for(const b in e._events){const E=e._events[b];E.recurring_event_id&&E.original_start&&(m[E.recurring_event_id]||(m[E.recurring_event_id]={}),m[E.recurring_event_id][E.original_start.valueOf()]=E)}return m}e._isFollowing=function(m){let b=e.getEvent(m);return!(!b||!b._thisAndFollowing)},e._isFirstOccurrence=function(m){if(e._is_virtual_event(m.id)){let b=m.id.split("#")[0];return e.getEvent(b).start_date.valueOf()===m.start_date.valueOf()}},e._isExceptionFirstOccurrence=function(m){if(e._is_modified_occurrence(m)){let b=m.recurring_event_id,E=e.getEvent(b);return!(!m.original_start||!m.original_start.valueOf()||m.original_start.valueOf()!==E.start_date.valueOf())}},e._rec_temp=[],e._rec_markers_pull={},e._rec_markers={},e._add_rec_marker=function(m,b){m._pid_time=b,this._rec_markers[m.id]=m,this._rec_markers_pull[m.event_pid]||(this._rec_markers_pull[m.event_pid]={}),this._rec_markers_pull[m.event_pid][b]=m},e._get_rec_marker=function(m,b){let E=this._rec_markers_pull[b];return E?E[m]:null},e._get_rec_markers=function(m){return this._rec_markers_pull[m]||[]},o=e.addEvent,e.addEvent=function(m,b,E,k,D){var C=o.apply(this,arguments);if(C&&e.getEvent(C)){var R=e.getEvent(C);R.start_date&&(R.start_date=t(R.start_date)),R.end_date&&(R.end_date=t(R.end_date))}return C},e.attachEvent("onEventLoading",function(m){return m.original_start&&!m.original_start.getFullYear&&(m.original_start=e.templates.parse_date(m.original_start)),!0}),e.attachEvent("onEventIdChange",function(m,b){if(!this._ignore_call){this._ignore_call=!0,e._rec_markers[m]&&(e._rec_markers[b]=e._rec_markers[m],delete e._rec_markers[m]),e._rec_markers_pull[m]&&(e._rec_markers_pull[b]=e._rec_markers_pull[m],delete e._rec_markers_pull[m]);for(var E=0;E<this._rec_temp.length;E++){var k=this._rec_temp[E];this._is_virtual_event(k.id)&&k.id.split("#")[0]==m&&(k.recurring_event_id=b,this.changeEventId(k.id,b+"#"+k.id.split("#")[1]))}for(var E in this._rec_markers)(k=this._rec_markers[E]).recurring_event_id==m&&(k.recurring_event_id=b,k._pid_changed=!0);var D=e._rec_markers[b];D&&D._pid_changed&&(delete D._pid_changed,setTimeout(function(){if(e.$destroyed)return!0;e.callEvent("onEventChanged",[b,e.getEvent(b)])},1)),delete this._ignore_call}}),e.attachEvent("onConfirmedBeforeEventDelete",function(m){var b=this.getEvent(m);if(this._is_virtual_event(m)||this._is_modified_occurrence(b)&&!function(D){return!!D.deleted}(b))u(m,b);else{n(b)&&this._lightbox_id&&this._roll_back_dates(b);var E=this._get_rec_markers(m);for(var k in E)E.hasOwnProperty(k)&&(m=E[k].id,this.getEvent(m)&&this.deleteEvent(m,!0))}return!0}),e.attachEvent("onEventDeleted",function(m,b){!this._is_virtual_event(m)&&this._is_modified_occurrence(b)&&(e._events[m]||(b.deleted=!0,this.setEvent(m,b),e.render()))}),e.attachEvent("onBeforeEventChanged",function(m,b,E,k){return!(!E&&m&&(e._is_virtual_event(m.id)||e._is_modified_occurrence(m))&&(k.start_date.getDate()!==m.start_date.getDate()?m._beforeEventChangedFlag="edit":m._beforeEventChangedFlag="ask",!e.config.collision_limit||e.checkCollision(m)))||(e._events.$dnd_recurring_placeholder=e._lame_clone(m),e._showRequiredModalBox(m.id,m._beforeEventChangedFlag),!1)}),e.attachEvent("onEventChanged",function(m,b){if(this._loading)return!0;let E=this.getEvent(m);if(this._is_virtual_event(m))(function(P){let U=P.id.split("#"),q=e.uid();e._not_render=!0;let $=e._copy_event(P);$.id=q,$.recurring_event_id=U[0];let ee=U[1];$.original_start=new Date(Number(ee)),e._add_rec_marker($,ee),e.addEvent($),e._not_render=!1})(E);else{E.start_date&&(E.start_date=t(E.start_date)),E.end_date&&(E.end_date=t(E.end_date)),n(E)&&this._lightbox_id&&(E._removeFollowing||this._isFollowing(m)?E._removeFollowing=null:this._roll_back_dates(E));var k=this._get_rec_markers(m);for(var D in k)k.hasOwnProperty(D)&&(delete this._rec_markers[k[D].id],this.deleteEvent(k[D].id,!0));delete this._rec_markers_pull[m];for(var C=!1,R=0;R<this._rendered.length;R++)this._rendered[R].getAttribute(this.config.event_attribute)==m&&(C=!0);C||(this._select_id=null)}return f(),!0}),e.attachEvent("onEventAdded",function(m){if(!this._loading){var b=this.getEvent(m);n(b)&&this._roll_back_dates(b)}return!0}),e.attachEvent("onEventSave",function(m,b,E){let k=this.getEvent(m),D=e._lame_clone(k),C=b.rrule;if(k&&n(k)&&!E&&this._isFollowing(m)){if(k._removeFollowing){if(e.getEvent(k._thisAndFollowing)&&(k._firstOccurrence||k._modified))return e.hideLightbox(),e.deleteEvent(k.id),!1;if(k.end_date=new Date(k.start_date.valueOf()-1e3),k._end_date=k._shorten_end_date,k.start_date=k._start_date,k._shorten=!0,a(k),e.callEvent("onEventChanged",[k.id,k]),e.getEvent(k._thisAndFollowing))for(const R in e._events){let P=e._events[R];P.recurring_event_id===m&&P.start_date.valueOf()>D.start_date.valueOf()&&u(P.id,P)}return e.hideLightbox(),!1}{let R=e.getEvent(k._thisAndFollowing);if(R&&k._firstOccurrence)for(const P in e._events)e._events[P].id==k.id&&s(P,b,k,D);else if(R&&k._modified)for(const P in e._events){let U=e._events[P];U.recurring_event_id==m&&U.id==D._thisAndFollowing&&s(P,b,k,D)}else{e._is_modified_occurrence(R)&&d(R),k.end_date=k._shorten_end_date,k._end_date=k._shorten_end_date,k.start_date=k._start_date,k._shorten=!0,a(k),e.callEvent("onEventChanged",[k.id,k]);let P={...D};P.text=b.text,P.duration=b.duration,P.rrule=C,P._start_date=null,P.id=e.uid(),e.addEvent(P.start_date,P.end_date,P.text,P.id,P)}return E||c(m,b),e.hideLightbox(),!1}}return E||c(m,b),D._ocr&&D._beforeEventChangedFlag?(k.start_date=D.start_date,k.end_date=D.end_date,k._start_date=D._start_date,k._end_date=D._end_date,e.updateEvent(k.id),!0):(this._select_id=null,f(),!0)}),e.attachEvent("onEventCreated",function(m){var b=this.getEvent(m);return n(b)||function(E){E.rrule="",E.original_start=null,E.recurring_event_id=null,E.duration=null,E.deleted=null}(b),!0}),e.attachEvent("onEventCancel",function(m){var b=this.getEvent(m);n(b)&&(this._roll_back_dates(b),this.render_view_data()),f()}),e._roll_back_dates=function(m){m.start_date&&(m.start_date=t(m.start_date)),m.end_date&&(m.end_date=t(m.end_date)),m._end_date&&(m._shorten||(m.duration=Math.round((m.end_date.valueOf()-m.start_date.valueOf())/1e3)),m.end_date=m._end_date),m._start_date&&(m.start_date.setMonth(0),m.start_date.setDate(m._start_date.getDate()),m.start_date.setMonth(m._start_date.getMonth()),m.start_date.setFullYear(m._start_date.getFullYear()),this._isFollowing(m.id)&&(m.start_date.setHours(m._start_date.getHours()),m.start_date.setMinutes(m._start_date.getMinutes()),m.start_date.setSeconds(m._start_date.getSeconds()))),m._thisAndFollowing=null,m._shorten_end_date&&(m._shorten_end_date=null),m._removeFollowing&&(m._removeFollowing=null),m._firstOccurrence&&(m._firstOccurrence=null),m._modified&&(m._modified=null)},e._is_virtual_event=function(m){return m.toString().indexOf("#")!=-1},e._is_modified_occurrence=function(m){return m.recurring_event_id&&m.recurring_event_id!="0"},e.showLightbox_rec=e.showLightbox,e.showLightbox=function(m){const b=this.locale;let E=e.config.lightbox_recurring,k=this.getEvent(m),D=k.recurring_event_id,C=this._is_virtual_event(m);C&&(D=m.split("#")[0]);const R=function(P,U){const q=e.getEvent(P),$=e.getEvent(D),ee=e.getView();if(ee&&q[ee.y_property]&&($[ee.y_property]=q[ee.y_property]),ee&&q[ee.property]&&($[ee.property]=q[ee.property]),U==="Occurrence")return e.showLightbox_rec(P);if(U==="Following"){if(e._isExceptionFirstOccurrence(q)||e._isFirstOccurrence(q))return l($,q),e.showLightbox_rec(D);{$._end_date=$.end_date;const ie=q.original_start||q.start_date;return $._shorten_end_date=new Date(ie.valueOf()-1e3),$.end_date=new Date(q.start_date.valueOf()+1e3*$.duration),$._start_date=$.start_date,$.start_date=q.start_date,$._thisAndFollowing=q.id,k._beforeEventChangedFlag&&($._beforeEventChangedFlag=k._beforeEventChangedFlag,$._shorten_end_date=new Date(ie.valueOf()-1e3)),e.showLightbox_rec(D)}}if(U==="AllEvents"){if(e._isExceptionFirstOccurrence(q)||e._isFirstOccurrence(q))return l($,q),e.showLightbox_rec(D);const ie=new Date($.start_date);return $._end_date=$.end_date,$._start_date=ie,$.start_date.setHours(q.start_date.getHours()),$.start_date.setMinutes(q.start_date.getMinutes()),$.start_date.setSeconds(q.start_date.getSeconds()),$.end_date=new Date($.start_date.valueOf()+1e3*$.duration),$._thisAndFollowing=null,e.showLightbox_rec(D)}};if((D||1*D==0)&&n(k))return R(m,"AllEvents");if(!D||D==="0"||!b.labels.confirm_recurring||E=="instance"||E=="series"&&!C)return this.showLightbox_rec(m);if(E==="ask"){const P=e.locale;v([{value:"Occurrence",label:P.labels.button_edit_occurrence,checked:!0,callback:()=>R(m,"Occurrence")},{value:"Following",label:P.labels.button_edit_occurrence_and_following,callback:()=>R(m,"Following")},{value:"AllEvents",label:P.labels.button_edit_series,callback:()=>R(m,"AllEvents")}])}},e._showRequiredModalBox=function(m,b){let E;const k=e.locale;let D=e.getEvent(m),C=D.recurring_event_id;e._is_virtual_event(D.id)&&(C=D.id.split("#")[0]);let R=e.getEvent(C);const P=e.getView();let U,q,$=e._lame_clone(R);P&&D[P.y_property]&&($[P.y_property]=D[P.y_property]),P&&D[P.property]&&($[P.property]=D[P.property]),D&&D._beforeEventChangedFlag&&(U=D.start_date,q=D.end_date);const ee={value:"AllEvents",label:k.labels.button_edit_series,callback:()=>function(W){let J=e._lame_clone(W);if(e._isExceptionFirstOccurrence(J)&&d(J),q&&U&&($.start_date.setHours(U.getHours()),$.start_date.setMinutes(U.getMinutes()),$.start_date.setSeconds(U.getSeconds()),$.duration=(+q-+U)/1e3),$._beforeEventChangedFlag=W._beforeEventChangedFlag,$._thisAndFollowing=null,!e.config.collision_limit||e.checkCollision($))for(const re in e._events)e._events[re].id==$.id&&(e._events[re]={...$},e.callEvent("onEventChanged",[e._events[re].id,e._events[re]]))}(D)},ie={value:"Following",label:k.labels.button_edit_occurrence_and_following,callback:()=>function(W){let J=e._lame_clone(W);if(q&&U&&(W._start_date=W.start_date,W.start_date=U,W.end_date=q),e._isFirstOccurrence(J)||e._isExceptionFirstOccurrence(J)){if(e._isExceptionFirstOccurrence(J)&&d(J),$._start_date=R.start_date,$.start_date=W.start_date,$.duration=(+W.end_date-+W.start_date)/1e3,$._beforeEventChangedFlag=W._beforeEventChangedFlag,$.rrule&&i($.id,$),!e.config.collision_limit||e.checkCollision($))for(const re in e._events)e._events[re].id==$.id&&(e._events[re]={...$},e.callEvent("onEventChanged",[e._events[re].id,e._events[re]]))}else{$._end_date=R.end_date;const re=W.original_start||e.date.date_part(new Date(W._start_date));$._shorten_end_date=new Date(re.valueOf()-1e3),$.end_date=W.end_date,$._start_date=R.start_date,$.start_date=W.start_date,$._thisAndFollowing=W.id,$.rrule&&i($.id,$);let ge=$.end_date;if($.end_date=$._end_date,!e.config.collision_limit||e.checkCollision($)){$.end_date=ge;for(const Ue in e._events)e._events[Ue].id==$.id&&(e._events[Ue]={...$},e.callEvent("onEventSave",[e._events[Ue].id,e._events[Ue],e._new_event]),e.callEvent("onEventChanged",[e._events[Ue].id,e._events[Ue]]))}}}(D)},Q={value:"Occurrence",label:k.labels.button_edit_occurrence,callback:()=>function(W){let J={...R,...e.getEvent("$dnd_recurring_placeholder")};if(q&&U&&(J.start_date=U,J.end_date=q,J._beforeEventChangedFlag=W._beforeEventChangedFlag,J._ocr=!0),!e.config.collision_limit||e.checkCollision(J))for(const re in e._events){let ge=e._events[re];re!=="$dnd_recurring_placeholder"&&ge.id==J.id&&(e._events[re]={...J},e.callEvent("onEventChanged",[e._events[re].id,e._events[re]]))}}(D),checked:!0};E=b==="ask"?[Q,ie,ee]:[Q,ie],v(E,W=>{W==="cancel"&&f()})},e.get_visible_events_rec=e.get_visible_events,e.get_visible_events=function(m){for(var b=0;b<this._rec_temp.length;b++)delete this._events[this._rec_temp[b].id];this._rec_temp=[];const E=g();var k=this.get_visible_events_rec(m),D=[];for(b=0;b<k.length;b++)k[b].deleted||k[b].recurring_event_id||(n(k[b])?this.repeat_date(k[b],D,void 0,void 0,void 0,void 0,E):D.push(k[b]));return function(C){const R={};return C.forEach(P=>{const U=R[P.id];(!U||U._beforeEventChangedFlag||P._beforeEventChangedFlag)&&(R[P.id]=P)}),Object.values(R)}(D)},function(){var m=e.isOneDayEvent;e.isOneDayEvent=function(E){return!!n(E)||m.call(this,E)};var b=e.updateEvent;e.updateEvent=function(E){var k=e.getEvent(E);k&&n(k)&&!this._is_virtual_event(E)?e.update_view():b.call(this,E)}}();const h=e.date.date_to_str("%Y%m%dT%H%i%s");function p(m){const b=m.getDay(),E=m.getDate();return{dayOfWeek:b,dayNumber:Math.ceil(E/7)}}e.repeat_date=function(m,b,E,k,D,C,R){if(!m.rrule)return;let P=R?R[m.id]:g()[m.id];P||(P={}),k=r(k||new Date(e._min_date.valueOf()-6048e5)),D=r(D||new Date(e._max_date.valueOf()-1e3));const U=r(m.start_date);let q;q=Wn(C?`RRULE:${m.rrule};UNTIL=${h(m.end_date)};COUNT=${C}`:`RRULE:${m.rrule};UNTIL=${h(m.end_date)}`,{dtstart:U});const $=q.between(k,D,!0).map(Q=>{const W=(J=Q,new Date(J.getUTCFullYear(),J.getUTCMonth(),J.getUTCDate(),J.getUTCHours(),J.getUTCMinutes(),J.getUTCSeconds()));var J;return W.setHours(m.start_date.getHours()),W.setMinutes(m.start_date.getMinutes()),W.setSeconds(m.start_date.getSeconds()),W});let ee=0;const ie=m.duration;for(let Q=0;Q<$.length&&!(C&&ee>=C);Q++){const W=$[Q];let J=P[W.valueOf()];if(J){if(J.deleted||J.end_date.valueOf()<e._min_date.valueOf()||!e.filter_event(J.id,J))continue;ee++,b.push(J)}else{const re=e._copy_event(m);if(re.text=m.text,re.start_date=W,re.id=m.id+"#"+Math.ceil(W.valueOf()),re.end_date=new Date(W.valueOf()+1e3*ie),re.end_date.valueOf()<e._min_date.valueOf()||(re.end_date=e._fix_daylight_saving_date(re.start_date,re.end_date,m,W,re.end_date),re._timed=e.isOneDayEvent(re),!re._timed&&!e._table_view&&!e.config.multi_day))continue;b.push(re),E||(e._events[re.id]=re,e._rec_temp.push(re)),ee++}}if(P&&$.length==0)for(let Q in P){let W=P[Q];if(W){if(W.deleted||W.end_date.valueOf()<e._min_date.valueOf()||!e.filter_event(W.id,W))continue;k&&D&&W.start_date<D&&W.end_date>k&&b.push(W)}}},e._fix_daylight_saving_date=function(m,b,E,k,D){var C=m.getTimezoneOffset()-b.getTimezoneOffset();return C?C>0?new Date(k.valueOf()+1e3*E.duration-60*C*1e3):new Date(b.valueOf()-60*C*1e3):new Date(D.valueOf())},e.getRecDates=function(m,b){var E=typeof m=="object"?m:e.getEvent(m),k=[];if(b=b||100,!n(E))return[{start_date:E.start_date,end_date:E.end_date}];if(E.deleted)return[];e.repeat_date(E,k,!0,E.start_date,E.end_date,b);for(var D=[],C=0;C<k.length;C++)k[C].deleted||D.push({start_date:k[C].start_date,end_date:k[C].end_date});return D},e.getEvents=function(m,b){var E=[];const k=g();for(var D in this._events){var C=this._events[D];if(!C.recurring_event_id)if(m&&b&&C.start_date<b&&C.end_date>m)if(n(C)){var R=[];this.repeat_date(C,R,!0,m,b,void 0,k),R.forEach(function(P){P.start_date<b&&P.end_date>m&&E.push(P)})}else this._is_virtual_event(C.id)||E.push(C);else m||b||this._is_virtual_event(C.id)||E.push(C)}return E},e._copy_dummy=function(m){var b=new Date(this.start_date),E=new Date(this.end_date);this.start_date=b,this.end_date=E,this.duration=this.rrule=null},e.config.include_end_by=!1,e.config.lightbox_recurring="ask",e.config.recurring_workdays=[B.MO.weekday,B.TU.weekday,B.WE.weekday,B.TH.weekday,B.FR.weekday],e.config.repeat_date="%m.%d.%Y",e.config.lightbox.sections=[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"recurring",type:"recurring",map_to:"rrule"},{name:"time",height:72,type:"time",map_to:"auto"}],e.attachEvent("onClearAll",function(){e._rec_markers={},e._rec_markers_pull={},e._rec_temp=[]});const y={0:"SU",1:"MO",2:"TU",3:"WE",4:"TH",5:"FR",6:"SA"},x={0:1,1:2,2:3,3:4,4:5,5:6,6:0};function S(m,b){const E=m.querySelector("[name='repeat_interval_value']");E&&(E.value=(b?b.interval:1)||1)}function O(m){switch(m){case 1:case 31:return`${m}st`;case 2:return`${m}nd`;case 3:return`${m}rd`;default:return`${m}th`}}e.templates.repeat_monthly_date=function(m,b){return`Every ${O(m.getDate())}`},e.templates.repeat_monthly_weekday=function(m,b){const E=p(m);return`Every ${O(E.dayNumber)} ${e.locale.date.day_full[E.dayOfWeek]}`},e.templates.repeat_yearly_month_date=function(m,b){const E=m.getDate(),k=e.locale.date.month_full[m.getMonth()];return`Every ${O(E)} day of ${k}`},e.templates.repeat_yearly_month_weekday=function(m,b){const E=p(m),k=e.locale.date.month_full[m.getMonth()];return`Every ${O(E.dayNumber)} ${e.locale.date.day_full[E.dayOfWeek]} of ${k}`};const I={MONTHLY:function(m){return{rrule:{freq:B.MONTHLY,interval:1,bymonthday:m.start.getDate()},until:new Date(9999,1,1)}},WEEKLY:function(m){let b=m.start.getDay()-1;return b==-1&&(b=6),{rrule:{freq:B.WEEKLY,interval:1,byweekday:[b]},until:new Date(9999,1,1)}},DAILY:function(m){return{rrule:{freq:B.DAILY,interval:1},until:new Date(9999,1,1)}},YEARLY:function(m){return{rrule:{freq:B.YEARLY,bymonth:m.start.getMonth()+1,interval:1,bymonthday:m.start.getDate()},until:new Date(9999,1,1)}},WORKDAYS:function(m){return{rrule:{freq:B.WEEKLY,interval:1,byweekday:e.config.recurring_workdays},until:new Date(9999,1,1)}},CUSTOM:function(m,b){const E={},k=b.querySelector('[name="repeat_interval_unit"]').value,D=Math.max(1,b.querySelector('[name="repeat_interval_value"]').value),C=b.querySelector('[name="dhx_custom_month_option"]')?b.querySelector('[name="dhx_custom_month_option"]').value:null,R=b.querySelector('[name="dhx_custom_year_option"]')?b.querySelector('[name="dhx_custom_year_option"]').value:null;let P,U;switch(E.interval=D,k){case"DAILY":E.freq=B.DAILY;break;case"WEEKLY":E.freq=B.WEEKLY,P=[],b.querySelectorAll('.dhx_form_repeat_custom_week [name="week_day"]').forEach(ie=>{ie.checked&&P.push(ie.value)}),E.byweekday=P.map(ie=>{switch(ie){case"MO":return B.MO.weekday;case"TU":return B.TU.weekday;case"WE":return B.WE.weekday;case"TH":return B.TH.weekday;case"FR":return B.FR.weekday;case"SA":return B.SA.weekday;case"SU":return B.SU.weekday}});break;case"MONTHLY":E.freq=B.MONTHLY,C==="month_date"?E.bymonthday=m.start.getDate():(U=m.start.getDay()-1,U==-1&&(U=6),E.byweekday=[U],E.bysetpos=p(m.start).dayNumber);break;case"YEARLY":E.freq=B.YEARLY,E.bymonth=m.start.getMonth()+1,R=="month_date"?E.bymonthday=m.start.getDate():(U=m.start.getDay()-1,U==-1&&(U=6),E.byweekday=[U],E.bysetpos=p(m.start).dayNumber)}const q=e.date.str_to_date("%Y-%m-%d");let $=new Date(9999,1,1);const ee=b.querySelector('[name="dhx_custom_repeat_ends"]');return ee&&ee.value==="ON"?($=q(b.querySelector('[name="dhx_form_repeat_ends_ondate"]').value),E.until=new Date($)):ee&&ee.value==="AFTER"&&(E.count=Math.max(1,b.querySelector('[name="dhx_form_repeat_ends_after"]').value)),{rrule:E,until:$}},NEVER:function(){}};function N(m,b,E){(function(k,D){S(k,D)})(m,b),function(k,D,C){if(S(k,D),k.querySelectorAll(".dhx_form_repeat_custom_week input").forEach(R=>R.checked=!1),D&&D.byweekday)D.byweekday.forEach(R=>{const P=x[R.weekday],U=y[P],q=k.querySelector(`.dhx_form_repeat_custom_week input[value="${U}"]`);q&&(q.checked=!0)});else{const R=y[C.start_date.getDay()],P=k.querySelector(`.dhx_form_repeat_custom_week input[value="${R}"]`);P&&(P.checked=!0)}}(m,b,E),function(k,D,C){S(k,D);const R=k.querySelector('.dhx_form_repeat_custom_month [value="month_date"]'),P=k.querySelector('.dhx_form_repeat_custom_month [value="month_nth_weekday"]');if(R&&P){R.innerText=e.templates.repeat_monthly_date(C.start_date,C),P.innerText=e.templates.repeat_monthly_weekday(C.start_date,C);const U=k.querySelector('[name="dhx_custom_month_option"]');U&&(U.value=!D||!D.bysetpos||D.byweekday&&D.byweekday.length?"month_nth_weekday":"month_date")}}(m,b,E),function(k,D,C){const R=k.querySelector('.dhx_form_repeat_custom_year [value="month_date"]'),P=k.querySelector('.dhx_form_repeat_custom_year [value="month_nth_weekday"]');R&&P&&(R.innerText=e.templates.repeat_yearly_month_date(C.start_date,C),P.innerText=e.templates.repeat_yearly_month_weekday(C.start_date,C),D&&(!D.bysetpos||D.byweekday&&D.byweekday.length)?k.querySelector('[name="dhx_custom_year_option"]').value="month_nth_weekday":k.querySelector('[name="dhx_custom_year_option"]').value="month_date")}(m,b,E),function(k,D,C){const R=k.querySelector('.dhx_form_repeat_ends_extra [name="dhx_form_repeat_ends_after"]'),P=k.querySelector('.dhx_form_repeat_ends_extra [name="dhx_form_repeat_ends_ondate"]'),U=k.querySelector("[name='dhx_custom_repeat_ends']");if(R&&P&&U){R.value=1;let q=e.date.date_to_str("%Y-%m-%d");e.config.repeat_date_of_end||(e.config.repeat_date_of_end=q(e.date.add(e._currentDate(),30,"day"))),P.value=e.config.repeat_date_of_end,D&&D.count?(U.value="AFTER",R.value=D.count):C._end_date&&C._end_date.getFullYear()!==9999?(U.value="ON",P.value=q(C._end_date)):U.value="NEVER",U.dispatchEvent(new Event("change"))}}(m,b,E)}function A(m){for(let b=0;b<e.config.lightbox.sections.length;b++){let E=e.config.lightbox.sections[b];if(E.type===m)return e.formSection(E.name)}return null}e.form_blocks.recurring={_get_node:function(m){if(typeof m=="string"){let b=e._lightbox.querySelector(`#${m}`);b||(b=document.getElementById(m)),m=b}return m.style.display=="none"&&(m.style.display=""),m},_outer_html:function(m){return m.outerHTML||(b=m,(k=document.createElement("div")).appendChild(b.cloneNode(!0)),E=k.innerHTML,k=null,E);var b,E,k},render:function(m){if(m.form){let E=e.form_blocks.recurring,k=E._get_node(m.form),D=E._outer_html(k);return k.style.display="none",D}let b=e.locale.labels;return`<div class="dhx_form_rrule">
		<div class="dhx_form_repeat_pattern">
			<select>
				<option value="NEVER">${b.repeat_never}</option>
				<option value="DAILY">${b.repeat_daily}</option>
				<option value="WEEKLY">${b.repeat_weekly}</option>
				<option value="MONTHLY">${b.repeat_monthly}</option>
				<option value="YEARLY">${b.repeat_yearly}</option>
				<option value="WORKDAYS">${b.repeat_workdays}</option>
				<option value="CUSTOM">${b.repeat_custom}</option>
			</select>
		</div>
		<div class="dhx_form_repeat_custom dhx_hidden">
			<div class="dhx_form_repeat_custom_interval">
				<input name="repeat_interval_value" type="number" min="1">
				<select name="repeat_interval_unit">
					<option value="DAILY">${b.repeat_freq_day}</option>
					<option value="WEEKLY">${b.repeat_freq_week}</option>
					<option value="MONTHLY">${b.repeat_freq_month}</option>
					<option value="YEARLY">${b.repeat_freq_year}</option>
				</select>
			</div>

			<div class="dhx_form_repeat_custom_additional">
				<div class="dhx_form_repeat_custom_week dhx_hidden">
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="MO" />${b.day_for_recurring[1]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="TU" />${b.day_for_recurring[2]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="WE" />${b.day_for_recurring[3]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="TH" />${b.day_for_recurring[4]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="FR" />${b.day_for_recurring[5]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="SA" />${b.day_for_recurring[6]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="SU" />${b.day_for_recurring[0]}</label>
				</div>

				<div class="dhx_form_repeat_custom_month dhx_hidden">
					<select name="dhx_custom_month_option">
						<option value="month_date"></option>
						<option value="month_nth_weekday"></option>
					</select>
				</div>

				<div class="dhx_form_repeat_custom_year dhx_hidden">
					<select name="dhx_custom_year_option">
						<option value="month_date"></option>
						<option value="month_nth_weekday"></option>
					</select>
				</div>
			</div>

			<div class="dhx_form_repeat_ends">
				<div>${b.repeat_ends}</div>
				<div class="dhx_form_repeat_ends_options">
					<select name="dhx_custom_repeat_ends">
						<option value="NEVER">${b.repeat_never}</option>
						<option value="AFTER">${b.repeat_radio_end2}</option>
						<option value="ON">${b.repeat_on_date}</option>
					</select>
					<div class="dhx_form_repeat_ends_extra">
						<div class="dhx_form_repeat_ends_after dhx_hidden">
							<label><input type="number" min="1" name="dhx_form_repeat_ends_after">${b.repeat_text_occurrences_count}</label>
						</div>
						<div class="dhx_form_repeat_ends_on dhx_hidden">
							<input type="date" name="dhx_form_repeat_ends_ondate">
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>`},_init_set_value:function(m,b,E){function k(U){U&&U.classList.add("dhx_hidden")}function D(U){U&&U.classList.remove("dhx_hidden")}e.form_blocks.recurring._ds={start:E.start_date,end:E.end_date};const C=m.querySelector(".dhx_form_repeat_pattern select");C&&C.addEventListener("change",function(){(function(U){const q=m.querySelector(".dhx_form_repeat_custom");U==="CUSTOM"?D(q):k(q)})(this.value)});const R=m.querySelector(".dhx_form_repeat_custom_interval [name='repeat_interval_unit']");R&&R.addEventListener("change",function(){(function(U){const q={weekly:m.querySelector(".dhx_form_repeat_custom_week"),monthly:m.querySelector(".dhx_form_repeat_custom_month"),yearly:m.querySelector(".dhx_form_repeat_custom_year")};switch(U){case"DAILY":k(q.weekly),k(q.monthly),k(q.yearly);break;case"WEEKLY":D(q.weekly),k(q.monthly),k(q.yearly);break;case"MONTHLY":k(q.weekly),D(q.monthly),k(q.yearly);break;case"YEARLY":k(q.weekly),k(q.monthly),D(q.yearly)}})(this.value)});const P=m.querySelector(".dhx_form_repeat_ends [name='dhx_custom_repeat_ends']");P&&P.addEventListener("change",function(){(function(U){const q={after:m.querySelector(".dhx_form_repeat_ends_extra .dhx_form_repeat_ends_after"),on:m.querySelector(".dhx_form_repeat_ends_extra .dhx_form_repeat_ends_on")};switch(U){case"NEVER":k(q.after),k(q.on);break;case"AFTER":D(q.after),k(q.on);break;case"ON":k(q.after),D(q.on)}})(this.value)}),e._lightbox._rec_init_done=!0},button_click:function(){},set_value:function(m,b,E){let k=e.form_blocks.recurring;e._lightbox._rec_init_done||k._init_set_value(m,b,E),m.open=!E.rrule,m.blocked=this._is_modified_occurrence(E);let D=k._ds;if(D.start=E.start_date,D.end=E._end_date,E.rrule){const R=Wn(E.rrule);N(m,R.origOptions,E);const P=function(U,q){const $=U.options,ee=$.until||q;return $.count||ee&&ee.getFullYear()!==9999?"CUSTOM":$.freq!==B.DAILY||$.interval!==1||$.byweekday?$.freq!==B.WEEKLY||$.interval!==1||$.byweekday?$.freq!==B.MONTHLY||$.interval!==1||$.bysetpos?$.freq!==B.YEARLY||$.interval!==1||$.bysetpos?$.freq===B.DAILY&&$.byweekday&&$.byweekday.length===e.config.recurring_workdays.length&&$.byweekday.includes(B.MO)&&$.byweekday.includes(B.TU)&&$.byweekday.includes(B.WE)&&$.byweekday.includes(B.TH)&&$.byweekday.includes(B.FR)?"WORKDAYS":"CUSTOM":"YEARLY":"MONTHLY":"WEEKLY":"DAILY"}(R,E._end_date);if(m.querySelector(".dhx_form_repeat_pattern select").value=P,P==="CUSTOM"){let U;switch(R.origOptions.freq){case B.DAILY:U="DAILY";break;case B.WEEKLY:U="WEEKLY";break;case B.MONTHLY:U="MONTHLY";break;case B.YEARLY:U="YEARLY"}U&&(m.querySelector('[name="repeat_interval_unit"]').value=U,m.querySelector('[name="repeat_interval_unit"]').dispatchEvent(new Event("change")))}}else{N(m,null,E);const R=m.querySelector(".dhx_form_repeat_pattern select");R&&(R.value="NEVER")}const C=m.querySelector(".dhx_form_repeat_pattern select");C&&C.dispatchEvent(new Event("change"))},get_value:function(m,b){const E=m.querySelector(".dhx_form_repeat_pattern select");if(m.blocked||E&&E.value==="NEVER")b.rrule=b.rrule="",b._end_date=b.end_date;else{let k=e.form_blocks.recurring._ds,D={};(function(){let P=e.formSection("time");if(P||(P=A("time")),P||(P=A("calendar_time")),!P)throw new Error(["Can't calculate the recurring rule, the Recurring form block can't find the Time control. Make sure you have the time control in 'scheduler.config.lightbox.sections' config.","You can use either the default time control https://docs.dhtmlx.com/scheduler/time.html, or the datepicker https://docs.dhtmlx.com/scheduler/minicalendar.html, or a custom control. ",'In the latter case, make sure the control is named "time":',"","scheduler.config.lightbox.sections = [",'{name:"time", height:72, type:"YOU CONTROL", map_to:"auto" }];'].join(`
`));return P})().getValue(D),k.start=D.start_date;const C=E?E.value:"CUSTOM",R=I[C](k,m);b.rrule=new B(R.rrule).toString().replace("RRULE:",""),k.end=R.until,b.duration=Math.floor((D.end_date-D.start_date)/1e3),k._start?(b.start_date=new Date(k.start),b._start_date=new Date(k.start),k._start=!1):b._start_date=null,b._end_date=k.end}return b.rrule},focus:function(m){}}},recurring_legacy:function(e){function t(){var i=e.formSection("recurring");if(i||(i=n("recurring")),!i)throw new Error(["Can't locate the Recurring form section.","Make sure that you have the recurring control on the lightbox configuration https://docs.dhtmlx.com/scheduler/recurring_events.html#recurringlightbox ",'and that the recurring control has name "recurring":',"","scheduler.config.lightbox.sections = [",'	{name:"recurring", ... }',"];"].join(`
`));return i}function n(i){for(var o=0;o<e.config.lightbox.sections.length;o++){var l=e.config.lightbox.sections[o];if(l.type===i)return e.formSection(l.name)}return null}function r(i){return new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),0)}var a;e.config.occurrence_timestamp_in_utc=!1,e.config.recurring_workdays=[1,2,3,4,5],e.form_blocks.recurring={_get_node:function(i){if(typeof i=="string"){let o=e._lightbox.querySelector(`#${i}`);o||(o=document.getElementById(i)),i=o}return i.style.display=="none"&&(i.style.display=""),i},_outer_html:function(i){return i.outerHTML||(o=i,(s=document.createElement("div")).appendChild(o.cloneNode(!0)),l=s.innerHTML,s=null,l);var o,l,s},render:function(i){if(i.form){var o=e.form_blocks.recurring,l=o._get_node(i.form),s=o._outer_html(l);return l.style.display="none",s}var d=e.locale.labels;return'<div class="dhx_form_repeat"> <form> <div class="dhx_repeat_left"> <div><label><input class="dhx_repeat_radio" type="radio" name="repeat" value="day" />'+d.repeat_radio_day+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="repeat" value="week"/>'+d.repeat_radio_week+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="repeat" value="month" checked />'+d.repeat_radio_month+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="repeat" value="year" />'+d.repeat_radio_year+'</label></div> </div> <div class="dhx_repeat_divider"></div> <div class="dhx_repeat_center"> <div style="display:none;" id="dhx_repeat_day"> <div><label><input class="dhx_repeat_radio" type="radio" name="day_type" value="d"/>'+d.repeat_radio_day_type+'</label><label><input class="dhx_repeat_text" type="text" name="day_count" value="1" />'+d.repeat_text_day_count+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="day_type" checked value="w"/>'+d.repeat_radio_day_type2+'</label></div> </div> <div style="display:none;" id="dhx_repeat_week"><div><label>'+d.repeat_week+'<input class="dhx_repeat_text" type="text" name="week_count" value="1" /></label><span>'+d.repeat_text_week_count+'</span></div>  <table class="dhx_repeat_days"> <tr> <td><div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="1" />'+d.day_for_recurring[1]+'</label></div> <div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="4" />'+d.day_for_recurring[4]+'</label></div></td> <td><div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="2" />'+d.day_for_recurring[2]+'</label></div> <div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="5" />'+d.day_for_recurring[5]+'</label></div></td> <td><div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="3" />'+d.day_for_recurring[3]+'</label></div> <div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="6" />'+d.day_for_recurring[6]+'</label></div></td> <td><div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="0" />'+d.day_for_recurring[0]+'</label></div> </td> </tr> </table> </div> <div id="dhx_repeat_month"> <div><label class = "dhx_repeat_month_label"><input class="dhx_repeat_radio" type="radio" name="month_type" value="d"/>'+d.repeat_radio_month_type+'</label><label><input class="dhx_repeat_text" type="text" name="month_day" value="1" />'+d.repeat_text_month_day+'</label><label><input class="dhx_repeat_text" type="text" name="month_count" value="1" />'+d.repeat_text_month_count+'</label></div> <div><label class = "dhx_repeat_month_label"><input class="dhx_repeat_radio" type="radio" name="month_type" checked value="w"/>'+d.repeat_radio_month_start+'</label><input class="dhx_repeat_text" type="text" name="month_week2" value="1" /><label><select name="month_day2">	<option value="1" selected >'+e.locale.date.day_full[1]+'<option value="2">'+e.locale.date.day_full[2]+'<option value="3">'+e.locale.date.day_full[3]+'<option value="4">'+e.locale.date.day_full[4]+'<option value="5">'+e.locale.date.day_full[5]+'<option value="6">'+e.locale.date.day_full[6]+'<option value="0">'+e.locale.date.day_full[0]+"</select>"+d.repeat_text_month_count2_before+'</label><label><input class="dhx_repeat_text" type="text" name="month_count2" value="1" />'+d.repeat_text_month_count2_after+'</label></div> </div> <div style="display:none;" id="dhx_repeat_year"> <div><label class = "dhx_repeat_year_label"><input class="dhx_repeat_radio" type="radio" name="year_type" value="d"/>'+d.repeat_radio_day_type+'</label><label><input class="dhx_repeat_text" type="text" name="year_day" value="1" />'+d.repeat_text_year_day+'</label><label><select name="year_month"><option value="0" selected >'+d.month_for_recurring[0]+'<option value="1">'+d.month_for_recurring[1]+'<option value="2">'+d.month_for_recurring[2]+'<option value="3">'+d.month_for_recurring[3]+'<option value="4">'+d.month_for_recurring[4]+'<option value="5">'+d.month_for_recurring[5]+'<option value="6">'+d.month_for_recurring[6]+'<option value="7">'+d.month_for_recurring[7]+'<option value="8">'+d.month_for_recurring[8]+'<option value="9">'+d.month_for_recurring[9]+'<option value="10">'+d.month_for_recurring[10]+'<option value="11">'+d.month_for_recurring[11]+"</select>"+d.select_year_month+'</label></div> <div><label class = "dhx_repeat_year_label"><input class="dhx_repeat_radio" type="radio" name="year_type" checked value="w"/>'+d.repeat_year_label+'</label><input class="dhx_repeat_text" type="text" name="year_week2" value="1" /><select name="year_day2"><option value="1" selected >'+e.locale.date.day_full[1]+'<option value="2">'+e.locale.date.day_full[2]+'<option value="3">'+e.locale.date.day_full[3]+'<option value="4">'+e.locale.date.day_full[4]+'<option value="5">'+e.locale.date.day_full[5]+'<option value="6">'+e.locale.date.day_full[6]+'<option value="7">'+e.locale.date.day_full[0]+"</select>"+d.select_year_day2+'<select name="year_month2"><option value="0" selected >'+d.month_for_recurring[0]+'<option value="1">'+d.month_for_recurring[1]+'<option value="2">'+d.month_for_recurring[2]+'<option value="3">'+d.month_for_recurring[3]+'<option value="4">'+d.month_for_recurring[4]+'<option value="5">'+d.month_for_recurring[5]+'<option value="6">'+d.month_for_recurring[6]+'<option value="7">'+d.month_for_recurring[7]+'<option value="8">'+d.month_for_recurring[8]+'<option value="9">'+d.month_for_recurring[9]+'<option value="10">'+d.month_for_recurring[10]+'<option value="11">'+d.month_for_recurring[11]+'</select></div> </div> </div> <div class="dhx_repeat_divider"></div> <div class="dhx_repeat_right"> <div><label><input class="dhx_repeat_radio" type="radio" name="end" checked/>'+d.repeat_radio_end+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="end" />'+d.repeat_radio_end2+'</label><input class="dhx_repeat_text" type="text" name="occurences_count" value="1" />'+d.repeat_text_occurences_count+'</div> <div><label><input class="dhx_repeat_radio" type="radio" name="end" />'+d.repeat_radio_end3+'</label><input class="dhx_repeat_date" type="text" name="date_of_end" value="'+e.config.repeat_date_of_end+'" /></div> </div> </form> </div> </div>'},_ds:{},_get_form_node:function(i,o,l){var s=i[o];if(!s)return null;if(s.nodeName)return s;if(s.length){for(var d=0;d<s.length;d++)if(s[d].value==l)return s[d]}},_get_node_value:function(i,o,l){var s=i[o];if(!s)return"";if(s.length){if(l){for(var d=[],c=0;c<s.length;c++)s[c].checked&&d.push(s[c].value);return d}for(c=0;c<s.length;c++)if(s[c].checked)return s[c].value}return s.value?l?[s.value]:s.value:void 0},_get_node_numeric_value:function(i,o){return 1*e.form_blocks.recurring._get_node_value(i,o)||0},_set_node_value:function(i,o,l){var s=i[o];if(s){if(s.name==o)s.value=l;else if(s.length)for(var d=typeof l=="object",c=0;c<s.length;c++)(d||s[c].value==l)&&(s[c].checked=d?!!l[s[c].value]:!!l)}},_init_set_value:function(i,o,l){var s=e.form_blocks.recurring,d=s._get_node_value,c=s._set_node_value;e.form_blocks.recurring._ds={start:l.start_date,end:l._end_date};var u=e.date.str_to_date(e.config.repeat_date,!1,!0),f=e.date.date_to_str(e.config.repeat_date),v=i.getElementsByTagName("FORM")[0],g={};function h(m){for(var b=0;b<m.length;b++){var E=m[b];if(E.name)if(g[E.name])if(g[E.name].nodeType){var k=g[E.name];g[E.name]=[k,E]}else g[E.name].push(E);else g[E.name]=E}}if(h(v.getElementsByTagName("INPUT")),h(v.getElementsByTagName("SELECT")),!e.config.repeat_date_of_end){var p=e.date.date_to_str(e.config.repeat_date);e.config.repeat_date_of_end=p(e.date.add(e._currentDate(),30,"day"))}c(g,"date_of_end",e.config.repeat_date_of_end);var y=function(m){return e._lightbox.querySelector(`#${m}`)||{style:{}}};function x(){y("dhx_repeat_day").style.display="none",y("dhx_repeat_week").style.display="none",y("dhx_repeat_month").style.display="none",y("dhx_repeat_year").style.display="none",y("dhx_repeat_"+this.value).style.display="",e.setLightboxSize()}function S(m,b){var E=m.end;if(E.length)if(E[0].value&&E[0].value!="on")for(var k=0;k<E.length;k++)E[k].value==b&&(E[k].checked=!0);else{var D=0;switch(b){case"no":D=0;break;case"date_of_end":D=2;break;default:D=1}E[D].checked=!0}else E.value=b}e.form_blocks.recurring._get_repeat_code=function(m){var b=[d(g,"repeat")];for(O[b[0]](b,m);b.length<5;)b.push("");var E="",k=function(D){var C=D.end;if(C.length){for(var R=0;R<C.length;R++)if(C[R].checked)return C[R].value&&C[R].value!="on"?C[R].value:R?R==2?"date_of_end":"occurences_count":"no"}else if(C.value)return C.value;return"no"}(g);return k=="no"?(m.end=new Date(9999,1,1),E="no"):k=="date_of_end"?m.end=function(D){var C=u(D);return e.config.include_end_by&&(C=e.date.add(C,1,"day")),C}(d(g,"date_of_end")):(e.transpose_type(b.join("_")),E=Math.max(1,d(g,"occurences_count")),m.end=e.date["add_"+b.join("_")](new Date(m.start),E+0,{start_date:m.start})||m.start),b.join("_")+"#"+E};var O={month:function(m,b){var E=e.form_blocks.recurring._get_node_value,k=e.form_blocks.recurring._get_node_numeric_value;E(g,"month_type")=="d"?(m.push(Math.max(1,k(g,"month_count"))),b.start.setDate(E(g,"month_day"))):(m.push(Math.max(1,k(g,"month_count2"))),m.push(E(g,"month_day2")),m.push(Math.max(1,k(g,"month_week2"))),e.config.repeat_precise||b.start.setDate(1)),b._start=!0},week:function(m,b){var E=e.form_blocks.recurring._get_node_value,k=e.form_blocks.recurring._get_node_numeric_value;m.push(Math.max(1,k(g,"week_count"))),m.push(""),m.push("");for(var D=[],C=E(g,"week_day",!0),R=b.start.getDay(),P=!1,U=0;U<C.length;U++)D.push(C[U]),P=P||C[U]==R;D.length||(D.push(R),P=!0),D.sort(),e.config.repeat_precise?P||(e.transpose_day_week(b.start,D,1,7),b._start=!0):(b.start=e.date.week_start(b.start),b._start=!0),m.push(D.join(","))},day:function(m){var b=e.form_blocks.recurring._get_node_value,E=e.form_blocks.recurring._get_node_numeric_value;b(g,"day_type")=="d"?m.push(Math.max(1,E(g,"day_count"))):(m.push("week"),m.push(1),m.push(""),m.push(""),m.push(e.config.recurring_workdays.join(",")),m.splice(0,1))},year:function(m,b){var E=e.form_blocks.recurring._get_node_value;E(g,"year_type")=="d"?(m.push("1"),b.start.setMonth(0),b.start.setDate(E(g,"year_day")),b.start.setMonth(E(g,"year_month"))):(m.push("1"),m.push(E(g,"year_day2")),m.push(E(g,"year_week2")),b.start.setDate(1),b.start.setMonth(E(g,"year_month2"))),b._start=!0}},I={week:function(m,b){var E=e.form_blocks.recurring._set_node_value;E(g,"week_count",m[1]);for(var k=m[4].split(","),D={},C=0;C<k.length;C++)D[k[C]]=!0;E(g,"week_day",D)},month:function(m,b){var E=e.form_blocks.recurring._set_node_value;m[2]===""?(E(g,"month_type","d"),E(g,"month_count",m[1]),E(g,"month_day",b.start.getDate())):(E(g,"month_type","w"),E(g,"month_count2",m[1]),E(g,"month_week2",m[3]),E(g,"month_day2",m[2]))},day:function(m,b){var E=e.form_blocks.recurring._set_node_value;E(g,"day_type","d"),E(g,"day_count",m[1])},year:function(m,b){var E=e.form_blocks.recurring._set_node_value;m[2]===""?(E(g,"year_type","d"),E(g,"year_day",b.start.getDate()),E(g,"year_month",b.start.getMonth())):(E(g,"year_type","w"),E(g,"year_week2",m[3]),E(g,"year_day2",m[2]),E(g,"year_month2",b.start.getMonth()))}};e.form_blocks.recurring._set_repeat_code=function(m,b){var E=e.form_blocks.recurring._set_node_value,k=m.split("#");switch(m=k[0].split("_"),I[m[0]](m,b),k[1]){case"no":S(g,"no");break;case"":S(g,"date_of_end");var D=b.end;e.config.include_end_by&&(D=e.date.add(D,-1,"day")),E(g,"date_of_end",f(D));break;default:S(g,"occurences_count"),E(g,"occurences_count",k[1])}E(g,"repeat",m[0]);var C=e.form_blocks.recurring._get_form_node(g,"repeat",m[0]);C.nodeName=="SELECT"?(C.dispatchEvent(new Event("change")),C.dispatchEvent(new MouseEvent("click"))):C.dispatchEvent(new MouseEvent("click"))};for(var N=0;N<v.elements.length;N++){var A=v.elements[N];A.name==="repeat"&&(A.nodeName!="SELECT"||A.$_eventAttached?A.$_eventAttached||(A.$_eventAttached=!0,A.addEventListener("click",x)):(A.$_eventAttached=!0,A.addEventListener("change",x)))}e._lightbox._rec_init_done=!0},set_value:function(i,o,l){var s=e.form_blocks.recurring;e._lightbox._rec_init_done||s._init_set_value(i,o,l),i.open=!l.rec_type,i.blocked=this._is_modified_occurence(l);var d=s._ds;d.start=l.start_date,d.end=l._end_date,s._toggle_block(),o&&s._set_repeat_code(o,d)},get_value:function(i,o){if(i.open){var l=e.form_blocks.recurring._ds,s={};(function(){var d=e.formSection("time");if(d||(d=n("time")),d||(d=n("calendar_time")),!d)throw new Error(["Can't calculate the recurring rule, the Recurring form block can't find the Time control. Make sure you have the time control in 'scheduler.config.lightbox.sections' config.","You can use either the default time control https://docs.dhtmlx.com/scheduler/time.html, or the datepicker https://docs.dhtmlx.com/scheduler/minicalendar.html, or a custom control. ",'In the latter case, make sure the control is named "time":',"","scheduler.config.lightbox.sections = [",'{name:"time", height:72, type:"YOU CONTROL", map_to:"auto" }];'].join(`
`));return d})().getValue(s),l.start=s.start_date,o.rec_type=e.form_blocks.recurring._get_repeat_code(l),l._start?(o.start_date=new Date(l.start),o._start_date=new Date(l.start),l._start=!1):o._start_date=null,o._end_date=l.end,o.rec_pattern=o.rec_type.split("#")[0]}else o.rec_type=o.rec_pattern="",o._end_date=o.end_date;return o.rec_type},_get_button:function(){return t().header.firstChild.firstChild},_get_form:function(){return t().node},open:function(){var i=e.form_blocks.recurring;i._get_form().open||i._toggle_block()},close:function(){var i=e.form_blocks.recurring;i._get_form().open&&i._toggle_block()},_toggle_block:function(){var i=e.form_blocks.recurring,o=i._get_form(),l=i._get_button();o.open||o.blocked?(o.style.height="0px",l&&(l.style.backgroundPosition="-5px 20px",l.nextSibling.innerHTML=e.locale.labels.button_recurring)):(o.style.height="auto",l&&(l.style.backgroundPosition="-5px 0px",l.nextSibling.innerHTML=e.locale.labels.button_recurring_open)),o.open=!o.open,e.setLightboxSize()},focus:function(i){},button_click:function(i,o,l){e.form_blocks.recurring._get_form().blocked||e.form_blocks.recurring._toggle_block()}},e._rec_markers={},e._rec_markers_pull={},e._add_rec_marker=function(i,o){i._pid_time=o,this._rec_markers[i.id]=i,this._rec_markers_pull[i.event_pid]||(this._rec_markers_pull[i.event_pid]={}),this._rec_markers_pull[i.event_pid][o]=i},e._get_rec_marker=function(i,o){var l=this._rec_markers_pull[o];return l?l[i]:null},e._get_rec_markers=function(i){return this._rec_markers_pull[i]||[]},e._rec_temp=[],a=e.addEvent,e.addEvent=function(i,o,l,s,d){var c=a.apply(this,arguments);if(c&&e.getEvent(c)){var u=e.getEvent(c);u.start_date&&(u.start_date=r(u.start_date)),u.end_date&&(u.end_date=r(u.end_date)),this._is_modified_occurence(u)&&e._add_rec_marker(u,1e3*u.event_length),u.rec_type&&(u.rec_pattern=u.rec_type.split("#")[0])}return c},e.attachEvent("onEventIdChange",function(i,o){if(!this._ignore_call){this._ignore_call=!0,e._rec_markers[i]&&(e._rec_markers[o]=e._rec_markers[i],delete e._rec_markers[i]),e._rec_markers_pull[i]&&(e._rec_markers_pull[o]=e._rec_markers_pull[i],delete e._rec_markers_pull[i]);for(var l=0;l<this._rec_temp.length;l++)(s=this._rec_temp[l]).event_pid==i&&(s.event_pid=o,this.changeEventId(s.id,o+"#"+s.id.split("#")[1]));for(var l in this._rec_markers){var s;(s=this._rec_markers[l]).event_pid==i&&(s.event_pid=o,s._pid_changed=!0)}var d=e._rec_markers[o];d&&d._pid_changed&&(delete d._pid_changed,setTimeout(function(){if(e.$destroyed)return!0;e.callEvent("onEventChanged",[o,e.getEvent(o)])},1)),delete this._ignore_call}}),e.attachEvent("onConfirmedBeforeEventDelete",function(i){var o=this.getEvent(i);if(this._is_virtual_event(i)||this._is_modified_occurence(o)&&o.rec_type&&o.rec_type!="none"){i=i.split("#");var l=this.uid(),s=i[1]?i[1]:Math.round(o._pid_time/1e3),d=this._copy_event(o);d.id=l,d.event_pid=o.event_pid||i[0];var c=s;d.event_length=c,d.rec_type=d.rec_pattern="none",this.addEvent(d),this._add_rec_marker(d,1e3*c)}else{o.rec_type&&this._lightbox_id&&this._roll_back_dates(o);var u=this._get_rec_markers(i);for(var f in u)u.hasOwnProperty(f)&&(i=u[f].id,this.getEvent(i)&&this.deleteEvent(i,!0))}return!0}),e.attachEvent("onEventDeleted",function(i,o){!this._is_virtual_event(i)&&this._is_modified_occurence(o)&&(e._events[i]||(o.rec_type=o.rec_pattern="none",this.setEvent(i,o)))}),e.attachEvent("onEventChanged",function(i,o){if(this._loading)return!0;var l=this.getEvent(i);if(this._is_virtual_event(i)){i=i.split("#");var s=this.uid();this._not_render=!0;var d=this._copy_event(o);d.id=s,d.event_pid=i[0];var c=i[1];d.event_length=c,d.rec_type=d.rec_pattern="",this._add_rec_marker(d,1e3*c),this.addEvent(d),this._not_render=!1}else{l.start_date&&(l.start_date=r(l.start_date)),l.end_date&&(l.end_date=r(l.end_date)),l.rec_type&&this._lightbox_id&&this._roll_back_dates(l);var u=this._get_rec_markers(i);for(var f in u)u.hasOwnProperty(f)&&(delete this._rec_markers[u[f].id],this.deleteEvent(u[f].id,!0));delete this._rec_markers_pull[i];for(var v=!1,g=0;g<this._rendered.length;g++)this._rendered[g].getAttribute(this.config.event_attribute)==i&&(v=!0);v||(this._select_id=null)}return!0}),e.attachEvent("onEventAdded",function(i){if(!this._loading){var o=this.getEvent(i);o.rec_type&&!o.event_length&&this._roll_back_dates(o)}return!0}),e.attachEvent("onEventSave",function(i,o,l){return this.getEvent(i).rec_type||!o.rec_type||this._is_virtual_event(i)||(this._select_id=null),!0}),e.attachEvent("onEventCreated",function(i){var o=this.getEvent(i);return o.rec_type||(o.rec_type=o.rec_pattern=o.event_length=o.event_pid=""),!0}),e.attachEvent("onEventCancel",function(i){var o=this.getEvent(i);o.rec_type&&(this._roll_back_dates(o),this.render_view_data())}),e._roll_back_dates=function(i){i.start_date&&(i.start_date=r(i.start_date)),i.end_date&&(i.end_date=r(i.end_date)),i.event_length=Math.round((i.end_date.valueOf()-i.start_date.valueOf())/1e3),i.end_date=i._end_date,i._start_date&&(i.start_date.setMonth(0),i.start_date.setDate(i._start_date.getDate()),i.start_date.setMonth(i._start_date.getMonth()),i.start_date.setFullYear(i._start_date.getFullYear()))},e._is_virtual_event=function(i){return i.toString().indexOf("#")!=-1},e._is_modified_occurence=function(i){return i.event_pid&&i.event_pid!="0"},e.showLightbox_rec=e.showLightbox,e.showLightbox=function(i){var o=this.locale,l=e.config.lightbox_recurring,s=this.getEvent(i),d=s.event_pid,c=this._is_virtual_event(i);c&&(d=i.split("#")[0]);var u=function(v){var g=e.getEvent(v);return g._end_date=g.end_date,g.end_date=new Date(g.start_date.valueOf()+1e3*g.event_length),e.showLightbox_rec(v)};if((d||1*d==0)&&s.rec_type)return u(i);if(!d||d==="0"||!o.labels.confirm_recurring||l=="instance"||l=="series"&&!c)return this.showLightbox_rec(i);if(l=="ask"){var f=this;e.modalbox({text:o.labels.confirm_recurring,title:o.labels.title_confirm_recurring,width:"500px",position:"middle",buttons:[o.labels.button_edit_series,o.labels.button_edit_occurrence,o.labels.icon_cancel],callback:function(v){switch(+v){case 0:return u(d);case 1:return f.showLightbox_rec(i);case 2:return}}})}else u(d)},e.get_visible_events_rec=e.get_visible_events,e.get_visible_events=function(i){for(var o=0;o<this._rec_temp.length;o++)delete this._events[this._rec_temp[o].id];this._rec_temp=[];var l=this.get_visible_events_rec(i),s=[];for(o=0;o<l.length;o++)l[o].rec_type?l[o].rec_pattern!="none"&&this.repeat_date(l[o],s):s.push(l[o]);return s},function(){var i=e.isOneDayEvent;e.isOneDayEvent=function(l){return!!l.rec_type||i.call(this,l)};var o=e.updateEvent;e.updateEvent=function(l){var s=e.getEvent(l);s&&s.rec_type&&(s.rec_pattern=(s.rec_type||"").split("#")[0]),s&&s.rec_type&&!this._is_virtual_event(l)?e.update_view():o.call(this,l)}}(),e.transponse_size={day:1,week:7,month:1,year:12},e.date.day_week=function(i,o,l){i.setDate(1);var s=e.date.month_start(new Date(i)),d=1*o+(l=7*(l-1))-i.getDay()+1;i.setDate(d<=l?d+7:d);var c=e.date.month_start(new Date(i));return s.valueOf()===c.valueOf()},e.transpose_day_week=function(i,o,l,s,d){for(var c=(i.getDay()||(e.config.start_on_monday?7:0))-l,u=0;u<o.length;u++)if(o[u]>c)return i.setDate(i.getDate()+1*o[u]-c-(s?l:d));this.transpose_day_week(i,o,l+s,null,l)},e.transpose_type=function(i){var o="transpose_"+i;if(!this.date[o]){var l=i.split("_"),s="add_"+i,d=this.transponse_size[l[0]]*l[1];if(l[0]=="day"||l[0]=="week"){var c=null;if(l[4]&&(c=l[4].split(","),e.config.start_on_monday)){for(var u=0;u<c.length;u++)c[u]=1*c[u]||7;c.sort()}this.date[o]=function(f,v){var g=Math.floor((v.valueOf()-f.valueOf())/(864e5*d));return g>0&&f.setDate(f.getDate()+g*d),c&&e.transpose_day_week(f,c,1,d),f},this.date[s]=function(f,v){var g=new Date(f.valueOf());if(c)for(var h=0;h<v;h++)e.transpose_day_week(g,c,0,d);else g.setDate(g.getDate()+v*d);return g}}else l[0]!="month"&&l[0]!="year"||(this.date[o]=function(f,v,g){var h=Math.ceil((12*v.getFullYear()+1*v.getMonth()+1-(12*f.getFullYear()+1*f.getMonth()+1))/d-1);return h>=0&&(f.setDate(1),f.setMonth(f.getMonth()+h*d)),e.date[s](f,0,g)},this.date[s]=function(f,v,g,h){if(h?h++:h=1,h>12)return null;var p=new Date(f.valueOf());p.setDate(1),p.setMonth(p.getMonth()+v*d);var y=p.getMonth(),x=p.getFullYear();p.setDate(g.start_date.getDate()),l[3]&&e.date.day_week(p,l[2],l[3]);var S=e.config.recurring_overflow_instances;return p.getMonth()!=y&&S!="none"&&(p=S==="lastDay"?new Date(x,y+1,0,p.getHours(),p.getMinutes(),p.getSeconds(),p.getMilliseconds()):e.date[s](new Date(x,y+1,0),v||1,g,h)),p})}},e.repeat_date=function(i,o,l,s,d,c){s=s||this._min_date,d=d||this._max_date;var u=c||-1,f=new Date(i.start_date.valueOf()),v=f.getHours(),g=0;for(!i.rec_pattern&&i.rec_type&&(i.rec_pattern=i.rec_type.split("#")[0]),this.transpose_type(i.rec_pattern),f=e.date["transpose_"+i.rec_pattern](f,s,i);f&&(f<i.start_date||e._fix_daylight_saving_date(f,s,i,f,new Date(f.valueOf()+1e3*i.event_length)).valueOf()<=s.valueOf()||f.valueOf()+1e3*i.event_length<=s.valueOf());)f=this.date["add_"+i.rec_pattern](f,1,i);for(;f&&f<d&&f<i.end_date&&(u<0||g<u);){f.setHours(v);var h=e.config.occurrence_timestamp_in_utc?Date.UTC(f.getFullYear(),f.getMonth(),f.getDate(),f.getHours(),f.getMinutes(),f.getSeconds()):f.valueOf(),p=this._get_rec_marker(h,i.id);if(p)l&&(p.rec_type!="none"&&g++,o.push(p));else{var y=new Date(f.valueOf()+1e3*i.event_length),x=this._copy_event(i);if(x.text=i.text,x.start_date=f,x.event_pid=i.id,x.id=i.id+"#"+Math.round(h/1e3),x.end_date=y,x.end_date=e._fix_daylight_saving_date(x.start_date,x.end_date,i,f,x.end_date),x._timed=this.isOneDayEvent(x),!x._timed&&!this._table_view&&!this.config.multi_day)return;o.push(x),l||(this._events[x.id]=x,this._rec_temp.push(x)),g++}f=this.date["add_"+i.rec_pattern](f,1,i)}},e._fix_daylight_saving_date=function(i,o,l,s,d){var c=i.getTimezoneOffset()-o.getTimezoneOffset();return c?c>0?new Date(s.valueOf()+1e3*l.event_length-60*c*1e3):new Date(o.valueOf()-60*c*1e3):new Date(d.valueOf())},e.getRecDates=function(i,o){var l=typeof i=="object"?i:e.getEvent(i),s=[];if(o=o||100,!l.rec_type)return[{start_date:l.start_date,end_date:l.end_date}];if(l.rec_type=="none")return[];e.repeat_date(l,s,!0,l.start_date,l.end_date,o);for(var d=[],c=0;c<s.length;c++)s[c].rec_type!="none"&&d.push({start_date:s[c].start_date,end_date:s[c].end_date});return d},e.getEvents=function(i,o){var l=[];for(var s in this._events){var d=this._events[s];if(d&&d.start_date<o&&d.end_date>i)if(d.rec_pattern){if(d.rec_pattern=="none")continue;var c=[];this.repeat_date(d,c,!0,i,o);for(var u=0;u<c.length;u++)!c[u].rec_pattern&&c[u].start_date<o&&c[u].end_date>i&&!this._rec_markers[c[u].id]&&l.push(c[u])}else this._is_virtual_event(d.id)||l.push(d)}return l},e.config.repeat_date="%m.%d.%Y",e.config.lightbox.sections=[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"recurring",type:"recurring",map_to:"rec_type",button:"recurring"},{name:"time",height:72,type:"time",map_to:"auto"}],e._copy_dummy=function(i){var o=new Date(this.start_date),l=new Date(this.end_date);this.start_date=o,this.end_date=l,this.event_length=this.event_pid=this.rec_pattern=this.rec_type=null},e.config.include_end_by=!1,e.config.lightbox_recurring="ask",e.attachEvent("onClearAll",function(){e._rec_markers={},e._rec_markers_pull={},e._rec_temp=[]})},serialize:function(e){const t=id(e);e.data_attributes=function(){var n=[],r=e._helpers.formatDate,a=t();for(var i in a){var o=a[i];for(var l in o)l.substr(0,1)!="_"&&n.push([l,l=="start_date"||l=="end_date"?r:null]);break}return n},e.toXML=function(n){var r=[],a=this.data_attributes(),i=t();for(var o in i){var l=i[o];r.push("<event>");for(var s=0;s<a.length;s++)r.push("<"+a[s][0]+"><![CDATA["+(a[s][1]?a[s][1](l[a[s][0]]):l[a[s][0]])+"]]></"+a[s][0]+">");r.push("</event>")}return(n||"")+"<data>"+r.join(`
`)+"</data>"},e._serialize_json_value=function(n){return n===null||typeof n=="boolean"?n=""+n:(n||n===0||(n=""),n='"'+n.toString().replace(/\n/g,"").replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'),n},e.toJSON=function(){return JSON.stringify(this.serialize())},e.toICal=function(n){var r=e.date.date_to_str("%Y%m%dT%H%i%s"),a=e.date.date_to_str("%Y%m%d"),i=[],o=t();for(var l in o){var s=o[l];i.push("BEGIN:VEVENT"),s._timed&&(s.start_date.getHours()||s.start_date.getMinutes())?i.push("DTSTART:"+r(s.start_date)):i.push("DTSTART:"+a(s.start_date)),s._timed&&(s.end_date.getHours()||s.end_date.getMinutes())?i.push("DTEND:"+r(s.end_date)):i.push("DTEND:"+a(s.end_date)),i.push("SUMMARY:"+s.text),i.push("END:VEVENT")}return`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//dhtmlXScheduler//NONSGML v2.2//EN
DESCRIPTION:`+(n||"")+`
`+i.join(`
`)+`
END:VCALENDAR`}},timeline:function(e){Et("Timeline",e.assert)},tooltip:function(e){e.config.tooltip_timeout=30,e.config.tooltip_offset_y=20,e.config.tooltip_offset_x=10,e.config.tooltip_hide_timeout=30;const t=new Eh(e);e.ext.tooltips=t,e.attachEvent("onSchedulerReady",function(){t.tooltipFor({selector:"["+e.config.event_attribute+"]",html:n=>{if(e._mobile&&!e.config.touch_tooltip)return;const r=e._locate_event(n.target);if(e.getEvent(r)){const a=e.getEvent(r);return e.templates.tooltip_text(a.start_date,a.end_date,a)}return null},global:!1})}),e.attachEvent("onDestroy",function(){t.destructor()}),e.attachEvent("onLightbox",function(){t.hideTooltip()}),e.attachEvent("onBeforeDrag",function(){return e._mobile&&e.config.touch_tooltip||t.hideTooltip(),!0}),e.attachEvent("onEventDeleted",function(){return t.hideTooltip(),!0})},treetimeline:function(e){Et("Tree Timeline",e.assert)},units:function(e){Et("Units",e.assert)},url:function(e){e._get_url_nav=function(){for(var t={},n=(document.location.hash||"").replace("#","").split(","),r=0;r<n.length;r++){var a=n[r].split("=");a.length==2&&(t[a[0]]=a[1])}return t},e.attachEvent("onTemplatesReady",function(){var t=!0,n=e.date.str_to_date("%Y-%m-%d"),r=e.date.date_to_str("%Y-%m-%d"),a=e._get_url_nav().event||null;function i(o){if(e.$destroyed)return!0;a=o,e.getEvent(o)&&e.showEvent(o)}e.attachEvent("onAfterEventDisplay",function(o){return a=null,!0}),e.attachEvent("onBeforeViewChange",function(o,l,s,d){if(t){t=!1;var c=e._get_url_nav();if(c.event)try{if(e.getEvent(c.event))return setTimeout(function(){i(c.event)}),!1;var u=e.attachEvent("onXLE",function(){setTimeout(function(){i(c.event)}),e.detachEvent(u)})}catch{}if(c.date||c.mode){try{this.setCurrentView(c.date?n(c.date):null,c.mode||null)}catch{this.setCurrentView(c.date?n(c.date):null,s)}return!1}}var f=["date="+r(d||l),"mode="+(s||o)];a&&f.push("event="+a);var v="#"+f.join(",");return document.location.hash=v,!0})})},week_agenda:function(e){Et("Week Agenda",e.assert)},wp:function(e){e.attachEvent("onLightBox",function(){if(this._cover)try{this._cover.style.height=this.expanded?"100%":(document.body.parentNode||document.body).scrollHeight+"px"}catch{}}),e.form_blocks.select.set_value=function(t,n,r){n!==void 0&&n!==""||(n=(t.firstChild.options[0]||{}).value),t.firstChild.value=n||""}},year_view:function(e){e.templates.year_date=function(l){return e.date.date_to_str(e.locale.labels.year_tab+" %Y")(l)},e.templates.year_month=e.date.date_to_str("%F"),e.templates.year_scale_date=e.date.date_to_str("%D"),e.templates.year_tooltip=function(l,s,d){return d.text};const t=function(){return e._mode=="year"},n=function(l){var s=e.$domHelpers.closest(l,"[data-cell-date]");return s&&s.hasAttribute("data-cell-date")?e.templates.parse_date(s.getAttribute("data-cell-date")):null};e.dblclick_dhx_year_grid=function(l){if(t()){const s=l.target;if(e.$domHelpers.closest(s,".dhx_before")||e.$domHelpers.closest(s,".dhx_after"))return!1;const d=n(s);if(d){const c=d,u=this.date.add(c,1,"day");!this.config.readonly&&this.config.dblclick_create&&this.addEventNow(c.valueOf(),u.valueOf(),l)}}},e.attachEvent("onEventIdChange",function(){t()&&this.year_view(!0)});var r=e.render_data;e.render_data=function(l){if(!t())return r.apply(this,arguments);for(var s=0;s<l.length;s++)this._year_render_event(l[s])};var a=e.clear_view;e.clear_view=function(){if(!t())return a.apply(this,arguments);var l=e._year_marked_cells;for(var s in l)l.hasOwnProperty(s)&&l[s].classList.remove("dhx_year_event","dhx_cal_datepicker_event");e._year_marked_cells={}},e._hideToolTip=function(){this._tooltip&&(this._tooltip.style.display="none",this._tooltip.date=new Date(9999,1,1))},e._showToolTip=function(l,s,d,c){if(this._tooltip){if(this._tooltip.date.valueOf()==l.valueOf())return;this._tooltip.innerHTML=""}else{var u=this._tooltip=document.createElement("div");u.className="dhx_year_tooltip",this.config.rtl&&(u.className+=" dhx_tooltip_rtl"),document.body.appendChild(u),u.addEventListener("click",e._click.dhx_cal_data),u.addEventListener("click",function(x){if(x.target.closest(`[${e.config.event_attribute}]`)){const S=x.target.closest(`[${e.config.event_attribute}]`).getAttribute(e.config.event_attribute);e.showLightbox(S)}})}for(var f=this.getEvents(l,this.date.add(l,1,"day")),v="",g=0;g<f.length;g++){var h=f[g];if(this.filter_event(h.id,h)){var p=h.color?"--dhx-scheduler-event-background:"+h.color+";":"",y=h.textColor?"--dhx-scheduler-event-color:"+h.textColor+";":"";v+="<div class='dhx_tooltip_line' style='"+p+y+"' event_id='"+f[g].id+"' "+this.config.event_attribute+"='"+f[g].id+"'>",v+="<div class='dhx_tooltip_date' style='"+p+y+"'>"+(f[g]._timed?this.templates.event_date(f[g].start_date):"")+"</div>",v+="<div class='dhx_event_icon icon_details'>&nbsp;</div>",v+=this.templates.year_tooltip(f[g].start_date,f[g].end_date,f[g])+"</div>"}}this._tooltip.style.display="",this._tooltip.style.top="0px",document.body.offsetWidth-s.left-this._tooltip.offsetWidth<0?this._tooltip.style.left=s.left-this._tooltip.offsetWidth+"px":this._tooltip.style.left=s.left+c.offsetWidth+"px",this._tooltip.date=l,this._tooltip.innerHTML=v,document.body.offsetHeight-s.top-this._tooltip.offsetHeight<0?this._tooltip.style.top=s.top-this._tooltip.offsetHeight+c.offsetHeight+"px":this._tooltip.style.top=s.top+"px"},e._year_view_tooltip_handler=function(l){if(t()){var s=l.target||l.srcElement;s.tagName.toLowerCase()=="a"&&(s=s.parentNode),e._getClassName(s).indexOf("dhx_year_event")!=-1?e._showToolTip(e.templates.parse_date(s.getAttribute("data-year-date")),e.$domHelpers.getOffset(s),l,s):e._hideToolTip()}},e._init_year_tooltip=function(){e._detachDomEvent(e._els.dhx_cal_data[0],"mouseover",e._year_view_tooltip_handler),e.event(e._els.dhx_cal_data[0],"mouseover",e._year_view_tooltip_handler)},e._get_year_cell=function(l){for(var s=e.templates.format_date(l),d=this.$root.querySelectorAll(`.dhx_cal_data .dhx_cal_datepicker_date[data-cell-date="${s}"]`),c=0;c<d.length;c++)if(!e.$domHelpers.closest(d[c],".dhx_after, .dhx_before"))return d[c];return null},e._year_marked_cells={},e._mark_year_date=function(l,s){var d=e.templates.format_date(l),c=this._get_year_cell(l);if(c){var u=this.templates.event_class(s.start_date,s.end_date,s);e._year_marked_cells[d]||(c.classList.add("dhx_year_event","dhx_cal_datepicker_event"),c.setAttribute("data-year-date",d),c.setAttribute("date",d),e._year_marked_cells[d]=c),u&&c.classList.add(u)}},e._unmark_year_date=function(l){var s=this._get_year_cell(l);s&&s.classList.remove("dhx_year_event","dhx_cal_datepicker_event")},e._year_render_event=function(l){var s=l.start_date;for(s=s.valueOf()<this._min_date.valueOf()?this._min_date:this.date.date_part(new Date(s));s<l.end_date;)if(this._mark_year_date(s,l),(s=this.date.add(s,1,"day")).valueOf()>=this._max_date.valueOf())return},e.year_view=function(l){if(e.set_sizes(),e._table_view=l,!this._load_mode||!this._load())if(l){if(e._init_year_tooltip(),e._reset_year_scale(),e._load_mode&&e._load())return void(e._render_wait=!0);e.render_view_data()}else e._hideToolTip()},e._reset_year_scale=function(){var l=this._els.dhx_cal_data[0];l.scrollTop=0,l.innerHTML="";let s=this.date.year_start(new Date(this._date));this._min_date=this.date.week_start(new Date(s));const d=document.createElement("div");d.classList.add("dhx_year_wrapper");let c=s;for(let v=0;v<12;v++){let g=document.createElement("div");g.className="dhx_year_box",g.setAttribute("date",this._helpers.formatDate(c)),g.setAttribute("data-month-date",this._helpers.formatDate(c)),g.innerHTML=`<div class='dhx_year_month'>${this.templates.year_month(c)}</div>
			<div class='dhx_year_grid'></div>`;const h=g.querySelector(".dhx_year_grid"),p=e._createDatePicker(null,{date:c,filterDays:e.ignore_year,minWeeks:6});p._renderDayGrid(h),p.destructor(),d.appendChild(g),c=this.date.add(c,1,"month")}l.appendChild(d);let u=this.date.add(s,1,"year");u.valueOf()!=this.date.week_start(new Date(u)).valueOf()&&(u=this.date.week_start(new Date(u)),u=this.date.add(u,1,"week")),this._max_date=u;var f=this._getNavDateElement();f&&(f.innerHTML=this.templates[this._mode+"_date"](s,u,this._mode))};var i=e.getActionData;e.getActionData=function(l){return t()?{date:n(l.target),section:null}:i.apply(e,arguments)};var o=e._locate_event;e._locate_event=function(l){var s=o.apply(e,arguments);if(!s){var d=n(l);if(!d)return null;var c=e.getEvents(d,e.date.add(d,1,"day"));if(!c.length)return null;s=c[0].id}return s},e.attachEvent("onDestroy",function(){e._hideToolTip()})}},pi=new class{constructor(e){this._seed=0,this._schedulerPlugins=[],this._bundledExtensions=e,this._extensionsManager=new Pu(e)}plugin(e){this._schedulerPlugins.push(e),ft.scheduler&&e(ft.scheduler)}getSchedulerInstance(e){for(var t=Ru(this._extensionsManager),n=0;n<this._schedulerPlugins.length;n++)this._schedulerPlugins[n](t);return t._internal_id=this._seed++,this.$syncFactory&&this.$syncFactory(t),e&&this._initFromConfig(t,e),t}_initFromConfig(e,t){if(t.plugins&&e.plugins(t.plugins),t.config&&e.mixin(e.config,t.config,!0),t.templates&&e.attachEvent("onTemplatesReady",function(){e.mixin(e.templates,t.templates,!0)},{once:!0}),t.events)for(const n in t.events)e.attachEvent(n,t.events[n]);t.locale&&e.i18n.setLocale(t.locale),Array.isArray(t.calendars)&&t.calendars.forEach(function(n){e.addCalendar(n)}),t.container?e.init(t.container):e.init(),t.data&&(typeof t.data=="string"?e.load(t.data):e.parse(t.data))}}(kh),Fe=pi.getSchedulerInstance(),js={plugin:Fe.bind(pi.plugin,pi)};window.scheduler=Fe,window.Scheduler=js,window.$dhx||(window.$dhx={}),window.$dhx.scheduler=Fe,window.$dhx.Scheduler=js;const Th=()=>{};var Ys={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=a&63|128):(a&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=a&63|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=a&63|128)}return t},Ah=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=e[n++];t[r++]=String.fromCharCode((a&31)<<6|i&63)}else if(a>239&&a<365){const i=e[n++],o=e[n++],l=e[n++],s=((a&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(s&1023))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((a&15)<<12|(i&63)<<6|o&63)}}return t.join("")},pd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<e.length;a+=3){const i=e[a],o=a+1<e.length,l=o?e[a+1]:0,s=a+2<e.length,d=s?e[a+2]:0,c=i>>2,u=(i&3)<<4|l>>4;let f=(l&15)<<2|d>>6,v=d&63;s||(v=64,o||(f=64)),r.push(n[c],n[u],n[f],n[v])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(fd(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Ah(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<e.length;){const i=n[e.charAt(a++)],l=a<e.length?n[e.charAt(a)]:0;++a;const d=a<e.length?n[e.charAt(a)]:64;++a;const u=a<e.length?n[e.charAt(a)]:64;if(++a,i==null||l==null||d==null||u==null)throw new Sh;const f=i<<2|l>>4;if(r.push(f),d!==64){const v=l<<4&240|d>>2;if(r.push(v),u!==64){const g=d<<6&192|u;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Sh extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Dh=function(e){const t=fd(e);return pd.encodeByteArray(t,!0)},Yr=function(e){return Dh(e).replace(/\./g,"")},Ch=function(e){try{return pd.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ih(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh=()=>Ih().__FIREBASE_DEFAULTS__,Mh=()=>{if(typeof process>"u"||typeof Ys>"u")return;const e=Ys.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Oh=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Ch(e[1]);return t&&JSON.parse(t)},qi=()=>{try{return Th()||Nh()||Mh()||Oh()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Rh=e=>{var t,n;return(n=(t=qi())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},Ph=e=>{const t=Rh(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},md=()=>{var e;return(e=qi())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bi(e){return e.endsWith(".cloudworkstations.dev")}async function Vh(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",a=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Yr(JSON.stringify(n)),Yr(JSON.stringify(o)),""].join(".")}const Kn={};function Hh(){const e={prod:[],emulator:[]};for(const t of Object.keys(Kn))Kn[t]?e.emulator.push(t):e.prod.push(t);return e}function Fh(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let Ws=!1;function Uh(e,t){if(typeof window>"u"||typeof document>"u"||!Bi(window.location.host)||Kn[e]===t||Kn[e]||Ws)return;Kn[e]=t;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=Hh().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function s(f,v){f.setAttribute("width","24"),f.setAttribute("id",v),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function d(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{Ws=!0,o()},f}function c(f,v){f.setAttribute("id",v),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function u(){const f=Fh(r),v=n("text"),g=document.getElementById(v)||document.createElement("span"),h=n("learnmore"),p=document.getElementById(h)||document.createElement("a"),y=n("preprendIcon"),x=document.getElementById(y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const S=f.element;l(S),c(p,h);const O=d();s(x,y),S.append(x,g,p,O),document.body.appendChild(S)}i?(g.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",u):u()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qh(){var e;const t=(e=qi())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Bh(){return!qh()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jh(){try{return typeof indexedDB=="object"}catch{return!1}}function Yh(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var i;t(((i=a.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh="FirebaseError";class xn extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=Wh,Object.setPrototypeOf(this,xn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gd.prototype.create)}}class gd{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},a=`${this.service}/${t}`,i=this.errors[t],o=i?Kh(i,r):"Error",l=`${this.serviceName}: ${o} (${a}).`;return new xn(a,l,r)}}function Kh(e,t){return e.replace(Gh,(n,r)=>{const a=t[r];return a!=null?String(a):`<${r}?>`})}const Gh=/\{\$([^}]+)}/g;function Wr(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const i=e[a],o=t[a];if(Ks(i)&&Ks(o)){if(!Wr(i,o))return!1}else if(i!==o)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function Ks(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(e){return e&&e._delegate?e._delegate:e}class er{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new Lh;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),a=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(a)return null;throw i}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Xh(t))try{this.getOrInitializeService({instanceIdentifier:jt})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:a});r.resolve(i)}catch{}}}}clearInstance(t=jt){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=jt){return this.instances.has(t)}getOptions(t=jt){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(a)}return a}onInit(t,n){var r;const a=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;i.add(t),this.onInitCallbacks.set(a,i);const o=this.instances.get(a);return o&&t(o,a),()=>{i.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const a of r)try{a(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Qh(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=jt){return this.component?this.component.multipleInstances?t:jt:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Qh(e){return e===jt?void 0:e}function Xh(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new Jh(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(le||(le={}));const ef={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},tf=le.INFO,nf={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},rf=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),a=nf[t];if(a)console[a](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class vd{constructor(t){this.name=t,this._logLevel=tf,this._logHandler=rf,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in le))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?ef[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...t),this._logHandler(this,le.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...t),this._logHandler(this,le.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,le.INFO,...t),this._logHandler(this,le.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,le.WARN,...t),this._logHandler(this,le.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...t),this._logHandler(this,le.ERROR,...t)}}const af=(e,t)=>t.some(n=>e instanceof n);let Gs,Js;function of(){return Gs||(Gs=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sf(){return Js||(Js=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yd=new WeakMap,mi=new WeakMap,bd=new WeakMap,Za=new WeakMap,ji=new WeakMap;function lf(e){const t=new Promise((n,r)=>{const a=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{n(Dt(e.result)),a()},o=()=>{r(e.error),a()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&yd.set(n,e)}).catch(()=>{}),ji.set(t,e),t}function df(e){if(mi.has(e))return;const t=new Promise((n,r)=>{const a=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{n(),a()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});mi.set(e,t)}let gi={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return mi.get(e);if(t==="objectStoreNames")return e.objectStoreNames||bd.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Dt(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function cf(e){gi=e(gi)}function _f(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(ei(this),t,...n);return bd.set(r,t.sort?t.sort():[t]),Dt(r)}:sf().includes(e)?function(...t){return e.apply(ei(this),t),Dt(yd.get(this))}:function(...t){return Dt(e.apply(ei(this),t))}}function uf(e){return typeof e=="function"?_f(e):(e instanceof IDBTransaction&&df(e),af(e,of())?new Proxy(e,gi):e)}function Dt(e){if(e instanceof IDBRequest)return lf(e);if(Za.has(e))return Za.get(e);const t=uf(e);return t!==e&&(Za.set(e,t),ji.set(t,e)),t}const ei=e=>ji.get(e);function hf(e,t,{blocked:n,upgrade:r,blocking:a,terminated:i}={}){const o=indexedDB.open(e,t),l=Dt(o);return r&&o.addEventListener("upgradeneeded",s=>{r(Dt(o.result),s.oldVersion,s.newVersion,Dt(o.transaction),s)}),n&&o.addEventListener("blocked",s=>n(s.oldVersion,s.newVersion,s)),l.then(s=>{i&&s.addEventListener("close",()=>i()),a&&s.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const ff=["get","getKey","getAll","getAllKeys","count"],pf=["put","add","delete","clear"],ti=new Map;function Qs(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(ti.get(t))return ti.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=pf.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||ff.includes(n)))return;const i=async function(o,...l){const s=this.transaction(o,a?"readwrite":"readonly");let d=s.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),a&&s.done]))[0]};return ti.set(t,i),i}cf(e=>({...e,get:(t,n,r)=>Qs(t,n)||e.get(t,n,r),has:(t,n)=>!!Qs(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(gf(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function gf(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const vi="@firebase/app",Xs="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mt=new vd("@firebase/app"),vf="@firebase/app-compat",yf="@firebase/analytics-compat",bf="@firebase/analytics",wf="@firebase/app-check-compat",xf="@firebase/app-check",Ef="@firebase/auth",kf="@firebase/auth-compat",Tf="@firebase/database",Af="@firebase/data-connect",Sf="@firebase/database-compat",Df="@firebase/functions",Cf="@firebase/functions-compat",If="@firebase/installations",Nf="@firebase/installations-compat",Mf="@firebase/messaging",Of="@firebase/messaging-compat",Rf="@firebase/performance",Pf="@firebase/performance-compat",Lf="@firebase/remote-config",Vf="@firebase/remote-config-compat",$f="@firebase/storage",Hf="@firebase/storage-compat",Ff="@firebase/firestore",Uf="@firebase/ai",zf="@firebase/firestore-compat",qf="firebase",Bf="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="[DEFAULT]",jf={[vi]:"fire-core",[vf]:"fire-core-compat",[bf]:"fire-analytics",[yf]:"fire-analytics-compat",[xf]:"fire-app-check",[wf]:"fire-app-check-compat",[Ef]:"fire-auth",[kf]:"fire-auth-compat",[Tf]:"fire-rtdb",[Af]:"fire-data-connect",[Sf]:"fire-rtdb-compat",[Df]:"fire-fn",[Cf]:"fire-fn-compat",[If]:"fire-iid",[Nf]:"fire-iid-compat",[Mf]:"fire-fcm",[Of]:"fire-fcm-compat",[Rf]:"fire-perf",[Pf]:"fire-perf-compat",[Lf]:"fire-rc",[Vf]:"fire-rc-compat",[$f]:"fire-gcs",[Hf]:"fire-gcs-compat",[Ff]:"fire-fst",[zf]:"fire-fst-compat",[Uf]:"fire-vertex","fire-js":"fire-js",[qf]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr=new Map,Yf=new Map,bi=new Map;function Zs(e,t){try{e.container.addComponent(t)}catch(n){mt.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Gr(e){const t=e.name;if(bi.has(t))return mt.debug(`There were multiple attempts to register component ${t}.`),!1;bi.set(t,e);for(const n of Kr.values())Zs(n,e);for(const n of Yf.values())Zs(n,e);return!0}function Wf(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Kf(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ct=new gd("app","Firebase",Gf);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new er("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ct.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf=Bf;function wd(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:yi,automaticDataCollectionEnabled:!0},t),a=r.name;if(typeof a!="string"||!a)throw Ct.create("bad-app-name",{appName:String(a)});if(n||(n=md()),!n)throw Ct.create("no-options");const i=Kr.get(a);if(i){if(Wr(n,i.options)&&Wr(r,i.config))return i;throw Ct.create("duplicate-app",{appName:a})}const o=new Zh(a);for(const s of bi.values())o.addComponent(s);const l=new Jf(n,r,o);return Kr.set(a,l),l}function Xf(e=yi){const t=Kr.get(e);if(!t&&e===yi&&md())return wd();if(!t)throw Ct.create("no-app",{appName:e});return t}function un(e,t,n){var r;let a=(r=jf[e])!==null&&r!==void 0?r:e;n&&(a+=`-${n}`);const i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const l=[`Unable to register library "${a}" with version "${t}":`];i&&l.push(`library name "${a}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),mt.warn(l.join(" "));return}Gr(new er(`${a}-version`,()=>({library:a,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf="firebase-heartbeat-database",ep=1,tr="firebase-heartbeat-store";let ni=null;function xd(){return ni||(ni=hf(Zf,ep,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(tr)}catch(n){console.warn(n)}}}}).catch(e=>{throw Ct.create("idb-open",{originalErrorMessage:e.message})})),ni}async function tp(e){try{const n=(await xd()).transaction(tr),r=await n.objectStore(tr).get(Ed(e));return await n.done,r}catch(t){if(t instanceof xn)mt.warn(t.message);else{const n=Ct.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});mt.warn(n.message)}}}async function el(e,t){try{const r=(await xd()).transaction(tr,"readwrite");await r.objectStore(tr).put(t,Ed(e)),await r.done}catch(n){if(n instanceof xn)mt.warn(n.message);else{const r=Ct.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});mt.warn(r.message)}}}function Ed(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np=1024,rp=30;class ap{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new op(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=tl();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:a}),this._heartbeatsCache.heartbeats.length>rp){const o=sp(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){mt.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=tl(),{heartbeatsToSend:r,unsentEntries:a}=ip(this._heartbeatsCache.heartbeats),i=Yr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return mt.warn(n),""}}}function tl(){return new Date().toISOString().substring(0,10)}function ip(e,t=np){const n=[];let r=e.slice();for(const a of e){const i=n.find(o=>o.agent===a.agent);if(i){if(i.dates.push(a.date),nl(n)>t){i.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),nl(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class op{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jh()?Yh().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await tp(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return el(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return el(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...t.heartbeats]})}else return}}function nl(e){return Yr(JSON.stringify({version:2,heartbeats:e})).length}function sp(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(e){Gr(new er("platform-logger",t=>new mf(t),"PRIVATE")),Gr(new er("heartbeat",t=>new ap(t),"PRIVATE")),un(vi,Xs,e),un(vi,Xs,"esm2017"),un("fire-js","")}lp("");var dp="firebase",cp="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */un(dp,cp,"app");var rl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var It,kd;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(A,m){function b(){}b.prototype=m.prototype,A.D=m.prototype,A.prototype=new b,A.prototype.constructor=A,A.C=function(E,k,D){for(var C=Array(arguments.length-2),R=2;R<arguments.length;R++)C[R-2]=arguments[R];return m.prototype[k].apply(E,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,m,b){b||(b=0);var E=Array(16);if(typeof m=="string")for(var k=0;16>k;++k)E[k]=m.charCodeAt(b++)|m.charCodeAt(b++)<<8|m.charCodeAt(b++)<<16|m.charCodeAt(b++)<<24;else for(k=0;16>k;++k)E[k]=m[b++]|m[b++]<<8|m[b++]<<16|m[b++]<<24;m=A.g[0],b=A.g[1],k=A.g[2];var D=A.g[3],C=m+(D^b&(k^D))+E[0]+3614090360&4294967295;m=b+(C<<7&4294967295|C>>>25),C=D+(k^m&(b^k))+E[1]+3905402710&4294967295,D=m+(C<<12&4294967295|C>>>20),C=k+(b^D&(m^b))+E[2]+606105819&4294967295,k=D+(C<<17&4294967295|C>>>15),C=b+(m^k&(D^m))+E[3]+3250441966&4294967295,b=k+(C<<22&4294967295|C>>>10),C=m+(D^b&(k^D))+E[4]+4118548399&4294967295,m=b+(C<<7&4294967295|C>>>25),C=D+(k^m&(b^k))+E[5]+1200080426&4294967295,D=m+(C<<12&4294967295|C>>>20),C=k+(b^D&(m^b))+E[6]+2821735955&4294967295,k=D+(C<<17&4294967295|C>>>15),C=b+(m^k&(D^m))+E[7]+4249261313&4294967295,b=k+(C<<22&4294967295|C>>>10),C=m+(D^b&(k^D))+E[8]+1770035416&4294967295,m=b+(C<<7&4294967295|C>>>25),C=D+(k^m&(b^k))+E[9]+2336552879&4294967295,D=m+(C<<12&4294967295|C>>>20),C=k+(b^D&(m^b))+E[10]+4294925233&4294967295,k=D+(C<<17&4294967295|C>>>15),C=b+(m^k&(D^m))+E[11]+2304563134&4294967295,b=k+(C<<22&4294967295|C>>>10),C=m+(D^b&(k^D))+E[12]+1804603682&4294967295,m=b+(C<<7&4294967295|C>>>25),C=D+(k^m&(b^k))+E[13]+4254626195&4294967295,D=m+(C<<12&4294967295|C>>>20),C=k+(b^D&(m^b))+E[14]+2792965006&4294967295,k=D+(C<<17&4294967295|C>>>15),C=b+(m^k&(D^m))+E[15]+1236535329&4294967295,b=k+(C<<22&4294967295|C>>>10),C=m+(k^D&(b^k))+E[1]+4129170786&4294967295,m=b+(C<<5&4294967295|C>>>27),C=D+(b^k&(m^b))+E[6]+3225465664&4294967295,D=m+(C<<9&4294967295|C>>>23),C=k+(m^b&(D^m))+E[11]+643717713&4294967295,k=D+(C<<14&4294967295|C>>>18),C=b+(D^m&(k^D))+E[0]+3921069994&4294967295,b=k+(C<<20&4294967295|C>>>12),C=m+(k^D&(b^k))+E[5]+3593408605&4294967295,m=b+(C<<5&4294967295|C>>>27),C=D+(b^k&(m^b))+E[10]+38016083&4294967295,D=m+(C<<9&4294967295|C>>>23),C=k+(m^b&(D^m))+E[15]+3634488961&4294967295,k=D+(C<<14&4294967295|C>>>18),C=b+(D^m&(k^D))+E[4]+3889429448&4294967295,b=k+(C<<20&4294967295|C>>>12),C=m+(k^D&(b^k))+E[9]+568446438&4294967295,m=b+(C<<5&4294967295|C>>>27),C=D+(b^k&(m^b))+E[14]+3275163606&4294967295,D=m+(C<<9&4294967295|C>>>23),C=k+(m^b&(D^m))+E[3]+4107603335&4294967295,k=D+(C<<14&4294967295|C>>>18),C=b+(D^m&(k^D))+E[8]+1163531501&4294967295,b=k+(C<<20&4294967295|C>>>12),C=m+(k^D&(b^k))+E[13]+2850285829&4294967295,m=b+(C<<5&4294967295|C>>>27),C=D+(b^k&(m^b))+E[2]+4243563512&4294967295,D=m+(C<<9&4294967295|C>>>23),C=k+(m^b&(D^m))+E[7]+1735328473&4294967295,k=D+(C<<14&4294967295|C>>>18),C=b+(D^m&(k^D))+E[12]+2368359562&4294967295,b=k+(C<<20&4294967295|C>>>12),C=m+(b^k^D)+E[5]+4294588738&4294967295,m=b+(C<<4&4294967295|C>>>28),C=D+(m^b^k)+E[8]+2272392833&4294967295,D=m+(C<<11&4294967295|C>>>21),C=k+(D^m^b)+E[11]+1839030562&4294967295,k=D+(C<<16&4294967295|C>>>16),C=b+(k^D^m)+E[14]+4259657740&4294967295,b=k+(C<<23&4294967295|C>>>9),C=m+(b^k^D)+E[1]+2763975236&4294967295,m=b+(C<<4&4294967295|C>>>28),C=D+(m^b^k)+E[4]+1272893353&4294967295,D=m+(C<<11&4294967295|C>>>21),C=k+(D^m^b)+E[7]+4139469664&4294967295,k=D+(C<<16&4294967295|C>>>16),C=b+(k^D^m)+E[10]+3200236656&4294967295,b=k+(C<<23&4294967295|C>>>9),C=m+(b^k^D)+E[13]+681279174&4294967295,m=b+(C<<4&4294967295|C>>>28),C=D+(m^b^k)+E[0]+3936430074&4294967295,D=m+(C<<11&4294967295|C>>>21),C=k+(D^m^b)+E[3]+3572445317&4294967295,k=D+(C<<16&4294967295|C>>>16),C=b+(k^D^m)+E[6]+76029189&4294967295,b=k+(C<<23&4294967295|C>>>9),C=m+(b^k^D)+E[9]+3654602809&4294967295,m=b+(C<<4&4294967295|C>>>28),C=D+(m^b^k)+E[12]+3873151461&4294967295,D=m+(C<<11&4294967295|C>>>21),C=k+(D^m^b)+E[15]+530742520&4294967295,k=D+(C<<16&4294967295|C>>>16),C=b+(k^D^m)+E[2]+3299628645&4294967295,b=k+(C<<23&4294967295|C>>>9),C=m+(k^(b|~D))+E[0]+4096336452&4294967295,m=b+(C<<6&4294967295|C>>>26),C=D+(b^(m|~k))+E[7]+1126891415&4294967295,D=m+(C<<10&4294967295|C>>>22),C=k+(m^(D|~b))+E[14]+2878612391&4294967295,k=D+(C<<15&4294967295|C>>>17),C=b+(D^(k|~m))+E[5]+4237533241&4294967295,b=k+(C<<21&4294967295|C>>>11),C=m+(k^(b|~D))+E[12]+1700485571&4294967295,m=b+(C<<6&4294967295|C>>>26),C=D+(b^(m|~k))+E[3]+2399980690&4294967295,D=m+(C<<10&4294967295|C>>>22),C=k+(m^(D|~b))+E[10]+4293915773&4294967295,k=D+(C<<15&4294967295|C>>>17),C=b+(D^(k|~m))+E[1]+2240044497&4294967295,b=k+(C<<21&4294967295|C>>>11),C=m+(k^(b|~D))+E[8]+1873313359&4294967295,m=b+(C<<6&4294967295|C>>>26),C=D+(b^(m|~k))+E[15]+4264355552&4294967295,D=m+(C<<10&4294967295|C>>>22),C=k+(m^(D|~b))+E[6]+2734768916&4294967295,k=D+(C<<15&4294967295|C>>>17),C=b+(D^(k|~m))+E[13]+1309151649&4294967295,b=k+(C<<21&4294967295|C>>>11),C=m+(k^(b|~D))+E[4]+4149444226&4294967295,m=b+(C<<6&4294967295|C>>>26),C=D+(b^(m|~k))+E[11]+3174756917&4294967295,D=m+(C<<10&4294967295|C>>>22),C=k+(m^(D|~b))+E[2]+718787259&4294967295,k=D+(C<<15&4294967295|C>>>17),C=b+(D^(k|~m))+E[9]+3951481745&4294967295,A.g[0]=A.g[0]+m&4294967295,A.g[1]=A.g[1]+(k+(C<<21&4294967295|C>>>11))&4294967295,A.g[2]=A.g[2]+k&4294967295,A.g[3]=A.g[3]+D&4294967295}r.prototype.u=function(A,m){m===void 0&&(m=A.length);for(var b=m-this.blockSize,E=this.B,k=this.h,D=0;D<m;){if(k==0)for(;D<=b;)a(this,A,D),D+=this.blockSize;if(typeof A=="string"){for(;D<m;)if(E[k++]=A.charCodeAt(D++),k==this.blockSize){a(this,E),k=0;break}}else for(;D<m;)if(E[k++]=A[D++],k==this.blockSize){a(this,E),k=0;break}}this.h=k,this.o+=m},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var m=1;m<A.length-8;++m)A[m]=0;var b=8*this.o;for(m=A.length-8;m<A.length;++m)A[m]=b&255,b/=256;for(this.u(A),A=Array(16),m=b=0;4>m;++m)for(var E=0;32>E;E+=8)A[b++]=this.g[m]>>>E&255;return A};function i(A,m){var b=l;return Object.prototype.hasOwnProperty.call(b,A)?b[A]:b[A]=m(A)}function o(A,m){this.h=m;for(var b=[],E=!0,k=A.length-1;0<=k;k--){var D=A[k]|0;E&&D==m||(b[k]=D,E=!1)}this.g=b}var l={};function s(A){return-128<=A&&128>A?i(A,function(m){return new o([m|0],0>m?-1:0)}):new o([A|0],0>A?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return u;if(0>A)return p(d(-A));for(var m=[],b=1,E=0;A>=b;E++)m[E]=A/b|0,b*=4294967296;return new o(m,0)}function c(A,m){if(A.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(A.charAt(0)=="-")return p(c(A.substring(1),m));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=d(Math.pow(m,8)),E=u,k=0;k<A.length;k+=8){var D=Math.min(8,A.length-k),C=parseInt(A.substring(k,k+D),m);8>D?(D=d(Math.pow(m,D)),E=E.j(D).add(d(C))):(E=E.j(b),E=E.add(d(C)))}return E}var u=s(0),f=s(1),v=s(16777216);e=o.prototype,e.m=function(){if(h(this))return-p(this).m();for(var A=0,m=1,b=0;b<this.g.length;b++){var E=this.i(b);A+=(0<=E?E:4294967296+E)*m,m*=4294967296}return A},e.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(g(this))return"0";if(h(this))return"-"+p(this).toString(A);for(var m=d(Math.pow(A,6)),b=this,E="";;){var k=O(b,m).g;b=y(b,k.j(m));var D=((0<b.g.length?b.g[0]:b.h)>>>0).toString(A);if(b=k,g(b))return D+E;for(;6>D.length;)D="0"+D;E=D+E}},e.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function g(A){if(A.h!=0)return!1;for(var m=0;m<A.g.length;m++)if(A.g[m]!=0)return!1;return!0}function h(A){return A.h==-1}e.l=function(A){return A=y(this,A),h(A)?-1:g(A)?0:1};function p(A){for(var m=A.g.length,b=[],E=0;E<m;E++)b[E]=~A.g[E];return new o(b,~A.h).add(f)}e.abs=function(){return h(this)?p(this):this},e.add=function(A){for(var m=Math.max(this.g.length,A.g.length),b=[],E=0,k=0;k<=m;k++){var D=E+(this.i(k)&65535)+(A.i(k)&65535),C=(D>>>16)+(this.i(k)>>>16)+(A.i(k)>>>16);E=C>>>16,D&=65535,C&=65535,b[k]=C<<16|D}return new o(b,b[b.length-1]&-2147483648?-1:0)};function y(A,m){return A.add(p(m))}e.j=function(A){if(g(this)||g(A))return u;if(h(this))return h(A)?p(this).j(p(A)):p(p(this).j(A));if(h(A))return p(this.j(p(A)));if(0>this.l(v)&&0>A.l(v))return d(this.m()*A.m());for(var m=this.g.length+A.g.length,b=[],E=0;E<2*m;E++)b[E]=0;for(E=0;E<this.g.length;E++)for(var k=0;k<A.g.length;k++){var D=this.i(E)>>>16,C=this.i(E)&65535,R=A.i(k)>>>16,P=A.i(k)&65535;b[2*E+2*k]+=C*P,x(b,2*E+2*k),b[2*E+2*k+1]+=D*P,x(b,2*E+2*k+1),b[2*E+2*k+1]+=C*R,x(b,2*E+2*k+1),b[2*E+2*k+2]+=D*R,x(b,2*E+2*k+2)}for(E=0;E<m;E++)b[E]=b[2*E+1]<<16|b[2*E];for(E=m;E<2*m;E++)b[E]=0;return new o(b,0)};function x(A,m){for(;(A[m]&65535)!=A[m];)A[m+1]+=A[m]>>>16,A[m]&=65535,m++}function S(A,m){this.g=A,this.h=m}function O(A,m){if(g(m))throw Error("division by zero");if(g(A))return new S(u,u);if(h(A))return m=O(p(A),m),new S(p(m.g),p(m.h));if(h(m))return m=O(A,p(m)),new S(p(m.g),m.h);if(30<A.g.length){if(h(A)||h(m))throw Error("slowDivide_ only works with positive integers.");for(var b=f,E=m;0>=E.l(A);)b=I(b),E=I(E);var k=N(b,1),D=N(E,1);for(E=N(E,2),b=N(b,2);!g(E);){var C=D.add(E);0>=C.l(A)&&(k=k.add(b),D=C),E=N(E,1),b=N(b,1)}return m=y(A,k.j(m)),new S(k,m)}for(k=u;0<=A.l(m);){for(b=Math.max(1,Math.floor(A.m()/m.m())),E=Math.ceil(Math.log(b)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),D=d(b),C=D.j(m);h(C)||0<C.l(A);)b-=E,D=d(b),C=D.j(m);g(D)&&(D=f),k=k.add(D),A=y(A,C)}return new S(k,A)}e.A=function(A){return O(this,A).h},e.and=function(A){for(var m=Math.max(this.g.length,A.g.length),b=[],E=0;E<m;E++)b[E]=this.i(E)&A.i(E);return new o(b,this.h&A.h)},e.or=function(A){for(var m=Math.max(this.g.length,A.g.length),b=[],E=0;E<m;E++)b[E]=this.i(E)|A.i(E);return new o(b,this.h|A.h)},e.xor=function(A){for(var m=Math.max(this.g.length,A.g.length),b=[],E=0;E<m;E++)b[E]=this.i(E)^A.i(E);return new o(b,this.h^A.h)};function I(A){for(var m=A.g.length+1,b=[],E=0;E<m;E++)b[E]=A.i(E)<<1|A.i(E-1)>>>31;return new o(b,A.h)}function N(A,m){var b=m>>5;m%=32;for(var E=A.g.length-b,k=[],D=0;D<E;D++)k[D]=0<m?A.i(D+b)>>>m|A.i(D+b+1)<<32-m:A.i(D+b);return new o(k,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,kd=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=c,It=o}).apply(typeof rl<"u"?rl:typeof self<"u"?self:typeof window<"u"?window:{});var Nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Td,qn,Ad,Lr,wi,Sd,Dd,Cd;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,w,T){return _==Array.prototype||_==Object.prototype||(_[w]=T.value),_};function n(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof Nr=="object"&&Nr];for(var w=0;w<_.length;++w){var T=_[w];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var r=n(this);function a(_,w){if(w)e:{var T=r;_=_.split(".");for(var M=0;M<_.length-1;M++){var V=_[M];if(!(V in T))break e;T=T[V]}_=_[_.length-1],M=T[_],w=w(M),w!=M&&w!=null&&t(T,_,{configurable:!0,writable:!0,value:w})}}function i(_,w){_ instanceof String&&(_+="");var T=0,M=!1,V={next:function(){if(!M&&T<_.length){var H=T++;return{value:w(H,_[H]),done:!1}}return M=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}a("Array.prototype.values",function(_){return _||function(){return i(this,function(w,T){return T})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function s(_){var w=typeof _;return w=w!="object"?w:_?Array.isArray(_)?"array":w:"null",w=="array"||w=="object"&&typeof _.length=="number"}function d(_){var w=typeof _;return w=="object"&&_!=null||w=="function"}function c(_,w,T){return _.call.apply(_.bind,arguments)}function u(_,w,T){if(!_)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,M),_.apply(w,V)}}return function(){return _.apply(w,arguments)}}function f(_,w,T){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?c:u,f.apply(null,arguments)}function v(_,w){var T=Array.prototype.slice.call(arguments,1);return function(){var M=T.slice();return M.push.apply(M,arguments),_.apply(this,M)}}function g(_,w){function T(){}T.prototype=w.prototype,_.aa=w.prototype,_.prototype=new T,_.prototype.constructor=_,_.Qb=function(M,V,H){for(var j=Array(arguments.length-2),he=2;he<arguments.length;he++)j[he-2]=arguments[he];return w.prototype[V].apply(M,j)}}function h(_){const w=_.length;if(0<w){const T=Array(w);for(let M=0;M<w;M++)T[M]=_[M];return T}return[]}function p(_,w){for(let T=1;T<arguments.length;T++){const M=arguments[T];if(s(M)){const V=_.length||0,H=M.length||0;_.length=V+H;for(let j=0;j<H;j++)_[V+j]=M[j]}else _.push(M)}}class y{constructor(w,T){this.i=w,this.j=T,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function x(_){return/^[\s\xa0]*$/.test(_)}function S(){var _=l.navigator;return _&&(_=_.userAgent)?_:""}function O(_){return O[" "](_),_}O[" "]=function(){};var I=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function N(_,w,T){for(const M in _)w.call(T,_[M],M,_)}function A(_,w){for(const T in _)w.call(void 0,_[T],T,_)}function m(_){const w={};for(const T in _)w[T]=_[T];return w}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(_,w){let T,M;for(let V=1;V<arguments.length;V++){M=arguments[V];for(T in M)_[T]=M[T];for(let H=0;H<b.length;H++)T=b[H],Object.prototype.hasOwnProperty.call(M,T)&&(_[T]=M[T])}}function k(_){var w=1;_=_.split(":");const T=[];for(;0<w&&_.length;)T.push(_.shift()),w--;return _.length&&T.push(_.join(":")),T}function D(_){l.setTimeout(()=>{throw _},0)}function C(){var _=ee;let w=null;return _.g&&(w=_.g,_.g=_.g.next,_.g||(_.h=null),w.next=null),w}class R{constructor(){this.h=this.g=null}add(w,T){const M=P.get();M.set(w,T),this.h?this.h.next=M:this.g=M,this.h=M}}var P=new y(()=>new U,_=>_.reset());class U{constructor(){this.next=this.g=this.h=null}set(w,T){this.h=w,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let q,$=!1,ee=new R,ie=()=>{const _=l.Promise.resolve(void 0);q=()=>{_.then(Q)}};var Q=()=>{for(var _;_=C();){try{_.h.call(_.g)}catch(T){D(T)}var w=P;w.j(_),100>w.h&&(w.h++,_.next=w.g,w.g=_)}$=!1};function W(){this.s=this.s,this.C=this.C}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(_,w){this.type=_,this.g=this.target=w,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var re=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var _=!1,w=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const T=()=>{};l.addEventListener("test",T,w),l.removeEventListener("test",T,w)}catch{}return _}();function ge(_,w){if(J.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_){var T=this.type=_.type,M=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;if(this.target=_.target||_.srcElement,this.g=w,w=_.relatedTarget){if(I){e:{try{O(w.nodeName);var V=!0;break e}catch{}V=!1}V||(w=null)}}else T=="mouseover"?w=_.fromElement:T=="mouseout"&&(w=_.toElement);this.relatedTarget=w,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=typeof _.pointerType=="string"?_.pointerType:Ue[_.pointerType]||"",this.state=_.state,this.i=_,_.defaultPrevented&&ge.aa.h.call(this)}}g(ge,J);var Ue={2:"touch",3:"pen",4:"mouse"};ge.prototype.h=function(){ge.aa.h.call(this);var _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var ur="closure_listenable_"+(1e6*Math.random()|0),t_=0;function n_(_,w,T,M,V){this.listener=_,this.proxy=null,this.src=w,this.type=T,this.capture=!!M,this.ha=V,this.key=++t_,this.da=this.fa=!1}function hr(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function fr(_){this.src=_,this.g={},this.h=0}fr.prototype.add=function(_,w,T,M,V){var H=_.toString();_=this.g[H],_||(_=this.g[H]=[],this.h++);var j=Aa(_,w,M,V);return-1<j?(w=_[j],T||(w.fa=!1)):(w=new n_(w,this.src,H,!!M,V),w.fa=T,_.push(w)),w};function Ta(_,w){var T=w.type;if(T in _.g){var M=_.g[T],V=Array.prototype.indexOf.call(M,w,void 0),H;(H=0<=V)&&Array.prototype.splice.call(M,V,1),H&&(hr(w),_.g[T].length==0&&(delete _.g[T],_.h--))}}function Aa(_,w,T,M){for(var V=0;V<_.length;++V){var H=_[V];if(!H.da&&H.listener==w&&H.capture==!!T&&H.ha==M)return V}return-1}var Sa="closure_lm_"+(1e6*Math.random()|0),Da={};function Do(_,w,T,M,V){if(Array.isArray(w)){for(var H=0;H<w.length;H++)Do(_,w[H],T,M,V);return null}return T=No(T),_&&_[ur]?_.K(w,T,d(M)?!!M.capture:!1,V):r_(_,w,T,!1,M,V)}function r_(_,w,T,M,V,H){if(!w)throw Error("Invalid event type");var j=d(V)?!!V.capture:!!V,he=Ia(_);if(he||(_[Sa]=he=new fr(_)),T=he.add(w,T,M,j,H),T.proxy)return T;if(M=a_(),T.proxy=M,M.src=_,M.listener=T,_.addEventListener)re||(V=j),V===void 0&&(V=!1),_.addEventListener(w.toString(),M,V);else if(_.attachEvent)_.attachEvent(Io(w.toString()),M);else if(_.addListener&&_.removeListener)_.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return T}function a_(){function _(T){return w.call(_.src,_.listener,T)}const w=i_;return _}function Co(_,w,T,M,V){if(Array.isArray(w))for(var H=0;H<w.length;H++)Co(_,w[H],T,M,V);else M=d(M)?!!M.capture:!!M,T=No(T),_&&_[ur]?(_=_.i,w=String(w).toString(),w in _.g&&(H=_.g[w],T=Aa(H,T,M,V),-1<T&&(hr(H[T]),Array.prototype.splice.call(H,T,1),H.length==0&&(delete _.g[w],_.h--)))):_&&(_=Ia(_))&&(w=_.g[w.toString()],_=-1,w&&(_=Aa(w,T,M,V)),(T=-1<_?w[_]:null)&&Ca(T))}function Ca(_){if(typeof _!="number"&&_&&!_.da){var w=_.src;if(w&&w[ur])Ta(w.i,_);else{var T=_.type,M=_.proxy;w.removeEventListener?w.removeEventListener(T,M,_.capture):w.detachEvent?w.detachEvent(Io(T),M):w.addListener&&w.removeListener&&w.removeListener(M),(T=Ia(w))?(Ta(T,_),T.h==0&&(T.src=null,w[Sa]=null)):hr(_)}}}function Io(_){return _ in Da?Da[_]:Da[_]="on"+_}function i_(_,w){if(_.da)_=!0;else{w=new ge(w,this);var T=_.listener,M=_.ha||_.src;_.fa&&Ca(_),_=T.call(M,w)}return _}function Ia(_){return _=_[Sa],_ instanceof fr?_:null}var Na="__closure_events_fn_"+(1e9*Math.random()>>>0);function No(_){return typeof _=="function"?_:(_[Na]||(_[Na]=function(w){return _.handleEvent(w)}),_[Na])}function Me(){W.call(this),this.i=new fr(this),this.M=this,this.F=null}g(Me,W),Me.prototype[ur]=!0,Me.prototype.removeEventListener=function(_,w,T,M){Co(this,_,w,T,M)};function ze(_,w){var T,M=_.F;if(M)for(T=[];M;M=M.F)T.push(M);if(_=_.M,M=w.type||w,typeof w=="string")w=new J(w,_);else if(w instanceof J)w.target=w.target||_;else{var V=w;w=new J(M,_),E(w,V)}if(V=!0,T)for(var H=T.length-1;0<=H;H--){var j=w.g=T[H];V=pr(j,M,!0,w)&&V}if(j=w.g=_,V=pr(j,M,!0,w)&&V,V=pr(j,M,!1,w)&&V,T)for(H=0;H<T.length;H++)j=w.g=T[H],V=pr(j,M,!1,w)&&V}Me.prototype.N=function(){if(Me.aa.N.call(this),this.i){var _=this.i,w;for(w in _.g){for(var T=_.g[w],M=0;M<T.length;M++)hr(T[M]);delete _.g[w],_.h--}}this.F=null},Me.prototype.K=function(_,w,T,M){return this.i.add(String(_),w,!1,T,M)},Me.prototype.L=function(_,w,T,M){return this.i.add(String(_),w,!0,T,M)};function pr(_,w,T,M){if(w=_.i.g[String(w)],!w)return!0;w=w.concat();for(var V=!0,H=0;H<w.length;++H){var j=w[H];if(j&&!j.da&&j.capture==T){var he=j.listener,De=j.ha||j.src;j.fa&&Ta(_.i,j),V=he.call(De,M)!==!1&&V}}return V&&!M.defaultPrevented}function Mo(_,w,T){if(typeof _=="function")T&&(_=f(_,T));else if(_&&typeof _.handleEvent=="function")_=f(_.handleEvent,_);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:l.setTimeout(_,w||0)}function Oo(_){_.g=Mo(()=>{_.g=null,_.i&&(_.i=!1,Oo(_))},_.l);const w=_.h;_.h=null,_.m.apply(null,w)}class o_ extends W{constructor(w,T){super(),this.m=w,this.l=T,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Oo(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sn(_){W.call(this),this.h=_,this.g={}}g(Sn,W);var Ro=[];function Po(_){N(_.g,function(w,T){this.g.hasOwnProperty(T)&&Ca(w)},_),_.g={}}Sn.prototype.N=function(){Sn.aa.N.call(this),Po(this)},Sn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ma=l.JSON.stringify,s_=l.JSON.parse,l_=class{stringify(_){return l.JSON.stringify(_,void 0)}parse(_){return l.JSON.parse(_,void 0)}};function Oa(){}Oa.prototype.h=null;function Lo(_){return _.h||(_.h=_.i())}function Vo(){}var Dn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ra(){J.call(this,"d")}g(Ra,J);function Pa(){J.call(this,"c")}g(Pa,J);var Ut={},$o=null;function mr(){return $o=$o||new Me}Ut.La="serverreachability";function Ho(_){J.call(this,Ut.La,_)}g(Ho,J);function Cn(_){const w=mr();ze(w,new Ho(w))}Ut.STAT_EVENT="statevent";function Fo(_,w){J.call(this,Ut.STAT_EVENT,_),this.stat=w}g(Fo,J);function qe(_){const w=mr();ze(w,new Fo(w,_))}Ut.Ma="timingevent";function Uo(_,w){J.call(this,Ut.Ma,_),this.size=w}g(Uo,J);function In(_,w){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){_()},w)}function Nn(){this.g=!0}Nn.prototype.xa=function(){this.g=!1};function d_(_,w,T,M,V,H){_.info(function(){if(_.g)if(H)for(var j="",he=H.split("&"),De=0;De<he.length;De++){var de=he[De].split("=");if(1<de.length){var Oe=de[0];de=de[1];var Re=Oe.split("_");j=2<=Re.length&&Re[1]=="type"?j+(Oe+"="+de+"&"):j+(Oe+"=redacted&")}}else j=null;else j=H;return"XMLHTTP REQ ("+M+") [attempt "+V+"]: "+w+`
`+T+`
`+j})}function c_(_,w,T,M,V,H,j){_.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+V+"]: "+w+`
`+T+`
`+H+" "+j})}function Zt(_,w,T,M){_.info(function(){return"XMLHTTP TEXT ("+w+"): "+u_(_,T)+(M?" "+M:"")})}function __(_,w){_.info(function(){return"TIMEOUT: "+w})}Nn.prototype.info=function(){};function u_(_,w){if(!_.g)return w;if(!w)return null;try{var T=JSON.parse(w);if(T){for(_=0;_<T.length;_++)if(Array.isArray(T[_])){var M=T[_];if(!(2>M.length)){var V=M[1];if(Array.isArray(V)&&!(1>V.length)){var H=V[0];if(H!="noop"&&H!="stop"&&H!="close")for(var j=1;j<V.length;j++)V[j]=""}}}}return Ma(T)}catch{return w}}var gr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},zo={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},La;function vr(){}g(vr,Oa),vr.prototype.g=function(){return new XMLHttpRequest},vr.prototype.i=function(){return{}},La=new vr;function yt(_,w,T,M){this.j=_,this.i=w,this.l=T,this.R=M||1,this.U=new Sn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qo}function qo(){this.i=null,this.g="",this.h=!1}var Bo={},Va={};function $a(_,w,T){_.L=1,_.v=xr(_t(w)),_.m=T,_.P=!0,jo(_,null)}function jo(_,w){_.F=Date.now(),yr(_),_.A=_t(_.v);var T=_.A,M=_.R;Array.isArray(M)||(M=[String(M)]),is(T.i,"t",M),_.C=0,T=_.j.J,_.h=new qo,_.g=Es(_.j,T?w:null,!_.m),0<_.O&&(_.M=new o_(f(_.Y,_,_.g),_.O)),w=_.U,T=_.g,M=_.ca;var V="readystatechange";Array.isArray(V)||(V&&(Ro[0]=V.toString()),V=Ro);for(var H=0;H<V.length;H++){var j=Do(T,V[H],M||w.handleEvent,!1,w.h||w);if(!j)break;w.g[j.key]=j}w=_.H?m(_.H):{},_.m?(_.u||(_.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.A,_.u,_.m,w)):(_.u="GET",_.g.ea(_.A,_.u,null,w)),Cn(),d_(_.i,_.u,_.A,_.l,_.R,_.m)}yt.prototype.ca=function(_){_=_.target;const w=this.M;w&&ut(_)==3?w.j():this.Y(_)},yt.prototype.Y=function(_){try{if(_==this.g)e:{const Re=ut(this.g);var w=this.g.Ba();const nn=this.g.Z();if(!(3>Re)&&(Re!=3||this.g&&(this.h.h||this.g.oa()||us(this.g)))){this.J||Re!=4||w==7||(w==8||0>=nn?Cn(3):Cn(2)),Ha(this);var T=this.g.Z();this.X=T;t:if(Yo(this)){var M=us(this.g);_="";var V=M.length,H=ut(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){zt(this),Mn(this);var j="";break t}this.h.i=new l.TextDecoder}for(w=0;w<V;w++)this.h.h=!0,_+=this.h.i.decode(M[w],{stream:!(H&&w==V-1)});M.length=0,this.h.g+=_,this.C=0,j=this.h.g}else j=this.g.oa();if(this.o=T==200,c_(this.i,this.u,this.A,this.l,this.R,Re,T),this.o){if(this.T&&!this.K){t:{if(this.g){var he,De=this.g;if((he=De.g?De.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(he)){var de=he;break t}}de=null}if(T=de)Zt(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fa(this,T);else{this.o=!1,this.s=3,qe(12),zt(this),Mn(this);break e}}if(this.P){T=!0;let Ze;for(;!this.J&&this.C<j.length;)if(Ze=h_(this,j),Ze==Va){Re==4&&(this.s=4,qe(14),T=!1),Zt(this.i,this.l,null,"[Incomplete Response]");break}else if(Ze==Bo){this.s=4,qe(15),Zt(this.i,this.l,j,"[Invalid Chunk]"),T=!1;break}else Zt(this.i,this.l,Ze,null),Fa(this,Ze);if(Yo(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||j.length!=0||this.h.h||(this.s=1,qe(16),T=!1),this.o=this.o&&T,!T)Zt(this.i,this.l,j,"[Invalid Chunked Response]"),zt(this),Mn(this);else if(0<j.length&&!this.W){this.W=!0;var Oe=this.j;Oe.g==this&&Oe.ba&&!Oe.M&&(Oe.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),Ya(Oe),Oe.M=!0,qe(11))}}else Zt(this.i,this.l,j,null),Fa(this,j);Re==4&&zt(this),this.o&&!this.J&&(Re==4?ys(this.j,this):(this.o=!1,yr(this)))}else I_(this.g),T==400&&0<j.indexOf("Unknown SID")?(this.s=3,qe(12)):(this.s=0,qe(13)),zt(this),Mn(this)}}}catch{}finally{}};function Yo(_){return _.g?_.u=="GET"&&_.L!=2&&_.j.Ca:!1}function h_(_,w){var T=_.C,M=w.indexOf(`
`,T);return M==-1?Va:(T=Number(w.substring(T,M)),isNaN(T)?Bo:(M+=1,M+T>w.length?Va:(w=w.slice(M,M+T),_.C=M+T,w)))}yt.prototype.cancel=function(){this.J=!0,zt(this)};function yr(_){_.S=Date.now()+_.I,Wo(_,_.I)}function Wo(_,w){if(_.B!=null)throw Error("WatchDog timer not null");_.B=In(f(_.ba,_),w)}function Ha(_){_.B&&(l.clearTimeout(_.B),_.B=null)}yt.prototype.ba=function(){this.B=null;const _=Date.now();0<=_-this.S?(__(this.i,this.A),this.L!=2&&(Cn(),qe(17)),zt(this),this.s=2,Mn(this)):Wo(this,this.S-_)};function Mn(_){_.j.G==0||_.J||ys(_.j,_)}function zt(_){Ha(_);var w=_.M;w&&typeof w.ma=="function"&&w.ma(),_.M=null,Po(_.U),_.g&&(w=_.g,_.g=null,w.abort(),w.ma())}function Fa(_,w){try{var T=_.j;if(T.G!=0&&(T.g==_||Ua(T.h,_))){if(!_.K&&Ua(T.h,_)&&T.G==3){try{var M=T.Da.g.parse(w)}catch{M=null}if(Array.isArray(M)&&M.length==3){var V=M;if(V[0]==0){e:if(!T.u){if(T.g)if(T.g.F+3e3<_.F)Dr(T),Ar(T);else break e;ja(T),qe(18)}}else T.za=V[1],0<T.za-T.T&&37500>V[2]&&T.F&&T.v==0&&!T.C&&(T.C=In(f(T.Za,T),6e3));if(1>=Jo(T.h)&&T.ca){try{T.ca()}catch{}T.ca=void 0}}else Bt(T,11)}else if((_.K||T.g==_)&&Dr(T),!x(w))for(V=T.Da.g.parse(w),w=0;w<V.length;w++){let de=V[w];if(T.T=de[0],de=de[1],T.G==2)if(de[0]=="c"){T.K=de[1],T.ia=de[2];const Oe=de[3];Oe!=null&&(T.la=Oe,T.j.info("VER="+T.la));const Re=de[4];Re!=null&&(T.Aa=Re,T.j.info("SVER="+T.Aa));const nn=de[5];nn!=null&&typeof nn=="number"&&0<nn&&(M=1.5*nn,T.L=M,T.j.info("backChannelRequestTimeoutMs_="+M)),M=T;const Ze=_.g;if(Ze){const Ir=Ze.g?Ze.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ir){var H=M.h;H.g||Ir.indexOf("spdy")==-1&&Ir.indexOf("quic")==-1&&Ir.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(za(H,H.h),H.h=null))}if(M.D){const Wa=Ze.g?Ze.g.getResponseHeader("X-HTTP-Session-Id"):null;Wa&&(M.ya=Wa,pe(M.I,M.D,Wa))}}T.G=3,T.l&&T.l.ua(),T.ba&&(T.R=Date.now()-_.F,T.j.info("Handshake RTT: "+T.R+"ms")),M=T;var j=_;if(M.qa=xs(M,M.J?M.ia:null,M.W),j.K){Qo(M.h,j);var he=j,De=M.L;De&&(he.I=De),he.B&&(Ha(he),yr(he)),M.g=j}else gs(M);0<T.i.length&&Sr(T)}else de[0]!="stop"&&de[0]!="close"||Bt(T,7);else T.G==3&&(de[0]=="stop"||de[0]=="close"?de[0]=="stop"?Bt(T,7):Ba(T):de[0]!="noop"&&T.l&&T.l.ta(de),T.v=0)}}Cn(4)}catch{}}var f_=class{constructor(_,w){this.g=_,this.map=w}};function Ko(_){this.l=_||10,l.PerformanceNavigationTiming?(_=l.performance.getEntriesByType("navigation"),_=0<_.length&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Go(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function Jo(_){return _.h?1:_.g?_.g.size:0}function Ua(_,w){return _.h?_.h==w:_.g?_.g.has(w):!1}function za(_,w){_.g?_.g.add(w):_.h=w}function Qo(_,w){_.h&&_.h==w?_.h=null:_.g&&_.g.has(w)&&_.g.delete(w)}Ko.prototype.cancel=function(){if(this.i=Xo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Xo(_){if(_.h!=null)return _.i.concat(_.h.D);if(_.g!=null&&_.g.size!==0){let w=_.i;for(const T of _.g.values())w=w.concat(T.D);return w}return h(_.i)}function p_(_){if(_.V&&typeof _.V=="function")return _.V();if(typeof Map<"u"&&_ instanceof Map||typeof Set<"u"&&_ instanceof Set)return Array.from(_.values());if(typeof _=="string")return _.split("");if(s(_)){for(var w=[],T=_.length,M=0;M<T;M++)w.push(_[M]);return w}w=[],T=0;for(M in _)w[T++]=_[M];return w}function m_(_){if(_.na&&typeof _.na=="function")return _.na();if(!_.V||typeof _.V!="function"){if(typeof Map<"u"&&_ instanceof Map)return Array.from(_.keys());if(!(typeof Set<"u"&&_ instanceof Set)){if(s(_)||typeof _=="string"){var w=[];_=_.length;for(var T=0;T<_;T++)w.push(T);return w}w=[],T=0;for(const M in _)w[T++]=M;return w}}}function Zo(_,w){if(_.forEach&&typeof _.forEach=="function")_.forEach(w,void 0);else if(s(_)||typeof _=="string")Array.prototype.forEach.call(_,w,void 0);else for(var T=m_(_),M=p_(_),V=M.length,H=0;H<V;H++)w.call(void 0,M[H],T&&T[H],_)}var es=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function g_(_,w){if(_){_=_.split("&");for(var T=0;T<_.length;T++){var M=_[T].indexOf("="),V=null;if(0<=M){var H=_[T].substring(0,M);V=_[T].substring(M+1)}else H=_[T];w(H,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function qt(_){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,_ instanceof qt){this.h=_.h,br(this,_.j),this.o=_.o,this.g=_.g,wr(this,_.s),this.l=_.l;var w=_.i,T=new Pn;T.i=w.i,w.g&&(T.g=new Map(w.g),T.h=w.h),ts(this,T),this.m=_.m}else _&&(w=String(_).match(es))?(this.h=!1,br(this,w[1]||"",!0),this.o=On(w[2]||""),this.g=On(w[3]||"",!0),wr(this,w[4]),this.l=On(w[5]||"",!0),ts(this,w[6]||"",!0),this.m=On(w[7]||"")):(this.h=!1,this.i=new Pn(null,this.h))}qt.prototype.toString=function(){var _=[],w=this.j;w&&_.push(Rn(w,ns,!0),":");var T=this.g;return(T||w=="file")&&(_.push("//"),(w=this.o)&&_.push(Rn(w,ns,!0),"@"),_.push(encodeURIComponent(String(T)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.s,T!=null&&_.push(":",String(T))),(T=this.l)&&(this.g&&T.charAt(0)!="/"&&_.push("/"),_.push(Rn(T,T.charAt(0)=="/"?b_:y_,!0))),(T=this.i.toString())&&_.push("?",T),(T=this.m)&&_.push("#",Rn(T,x_)),_.join("")};function _t(_){return new qt(_)}function br(_,w,T){_.j=T?On(w,!0):w,_.j&&(_.j=_.j.replace(/:$/,""))}function wr(_,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);_.s=w}else _.s=null}function ts(_,w,T){w instanceof Pn?(_.i=w,E_(_.i,_.h)):(T||(w=Rn(w,w_)),_.i=new Pn(w,_.h))}function pe(_,w,T){_.i.set(w,T)}function xr(_){return pe(_,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),_}function On(_,w){return _?w?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Rn(_,w,T){return typeof _=="string"?(_=encodeURI(_).replace(w,v_),T&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function v_(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var ns=/[#\/\?@]/g,y_=/[#\?:]/g,b_=/[#\?]/g,w_=/[#\?@]/g,x_=/#/g;function Pn(_,w){this.h=this.g=null,this.i=_||null,this.j=!!w}function bt(_){_.g||(_.g=new Map,_.h=0,_.i&&g_(_.i,function(w,T){_.add(decodeURIComponent(w.replace(/\+/g," ")),T)}))}e=Pn.prototype,e.add=function(_,w){bt(this),this.i=null,_=en(this,_);var T=this.g.get(_);return T||this.g.set(_,T=[]),T.push(w),this.h+=1,this};function rs(_,w){bt(_),w=en(_,w),_.g.has(w)&&(_.i=null,_.h-=_.g.get(w).length,_.g.delete(w))}function as(_,w){return bt(_),w=en(_,w),_.g.has(w)}e.forEach=function(_,w){bt(this),this.g.forEach(function(T,M){T.forEach(function(V){_.call(w,V,M,this)},this)},this)},e.na=function(){bt(this);const _=Array.from(this.g.values()),w=Array.from(this.g.keys()),T=[];for(let M=0;M<w.length;M++){const V=_[M];for(let H=0;H<V.length;H++)T.push(w[M])}return T},e.V=function(_){bt(this);let w=[];if(typeof _=="string")as(this,_)&&(w=w.concat(this.g.get(en(this,_))));else{_=Array.from(this.g.values());for(let T=0;T<_.length;T++)w=w.concat(_[T])}return w},e.set=function(_,w){return bt(this),this.i=null,_=en(this,_),as(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[w]),this.h+=1,this},e.get=function(_,w){return _?(_=this.V(_),0<_.length?String(_[0]):w):w};function is(_,w,T){rs(_,w),0<T.length&&(_.i=null,_.g.set(en(_,w),h(T)),_.h+=T.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],w=Array.from(this.g.keys());for(var T=0;T<w.length;T++){var M=w[T];const H=encodeURIComponent(String(M)),j=this.V(M);for(M=0;M<j.length;M++){var V=H;j[M]!==""&&(V+="="+encodeURIComponent(String(j[M]))),_.push(V)}}return this.i=_.join("&")};function en(_,w){return w=String(w),_.j&&(w=w.toLowerCase()),w}function E_(_,w){w&&!_.j&&(bt(_),_.i=null,_.g.forEach(function(T,M){var V=M.toLowerCase();M!=V&&(rs(this,M),is(this,V,T))},_)),_.j=w}function k_(_,w){const T=new Nn;if(l.Image){const M=new Image;M.onload=v(wt,T,"TestLoadImage: loaded",!0,w,M),M.onerror=v(wt,T,"TestLoadImage: error",!1,w,M),M.onabort=v(wt,T,"TestLoadImage: abort",!1,w,M),M.ontimeout=v(wt,T,"TestLoadImage: timeout",!1,w,M),l.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=_}else w(!1)}function T_(_,w){const T=new Nn,M=new AbortController,V=setTimeout(()=>{M.abort(),wt(T,"TestPingServer: timeout",!1,w)},1e4);fetch(_,{signal:M.signal}).then(H=>{clearTimeout(V),H.ok?wt(T,"TestPingServer: ok",!0,w):wt(T,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(V),wt(T,"TestPingServer: error",!1,w)})}function wt(_,w,T,M,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),M(T)}catch{}}function A_(){this.g=new l_}function S_(_,w,T){const M=T||"";try{Zo(_,function(V,H){let j=V;d(V)&&(j=Ma(V)),w.push(M+H+"="+encodeURIComponent(j))})}catch(V){throw w.push(M+"type="+encodeURIComponent("_badmap")),V}}function Er(_){this.l=_.Ub||null,this.j=_.eb||!1}g(Er,Oa),Er.prototype.g=function(){return new kr(this.l,this.j)},Er.prototype.i=function(_){return function(){return _}}({});function kr(_,w){Me.call(this),this.D=_,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(kr,Me),e=kr.prototype,e.open=function(_,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=_,this.A=w,this.readyState=1,Vn(this)},e.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};_&&(w.body=_),(this.D||l).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ln(this)),this.readyState=0},e.Sa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,Vn(this)),this.g&&(this.readyState=3,Vn(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;os(this)}else _.text().then(this.Ra.bind(this),this.ga.bind(this))};function os(_){_.j.read().then(_.Pa.bind(_)).catch(_.ga.bind(_))}e.Pa=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var w=_.value?_.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!_.done}))&&(this.response=this.responseText+=w)}_.done?Ln(this):Vn(this),this.readyState==3&&os(this)}},e.Ra=function(_){this.g&&(this.response=this.responseText=_,Ln(this))},e.Qa=function(_){this.g&&(this.response=_,Ln(this))},e.ga=function(){this.g&&Ln(this)};function Ln(_){_.readyState=4,_.l=null,_.j=null,_.v=null,Vn(_)}e.setRequestHeader=function(_,w){this.u.append(_,w)},e.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],w=this.h.entries();for(var T=w.next();!T.done;)T=T.value,_.push(T[0]+": "+T[1]),T=w.next();return _.join(`\r
`)};function Vn(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(kr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function ss(_){let w="";return N(_,function(T,M){w+=M,w+=":",w+=T,w+=`\r
`}),w}function qa(_,w,T){e:{for(M in T){var M=!1;break e}M=!0}M||(T=ss(T),typeof _=="string"?T!=null&&encodeURIComponent(String(T)):pe(_,w,T))}function ye(_){Me.call(this),this.headers=new Map,this.o=_||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(ye,Me);var D_=/^https?$/i,C_=["POST","PUT"];e=ye.prototype,e.Ha=function(_){this.J=_},e.ea=function(_,w,T,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);w=w?w.toUpperCase():"GET",this.D=_,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():La.g(),this.v=this.o?Lo(this.o):Lo(La),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(w,String(_),!0),this.B=!1}catch(H){ls(this,H);return}if(_=T||"",T=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var V in M)T.set(V,M[V]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const H of M.keys())T.set(H,M.get(H));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(T.keys()).find(H=>H.toLowerCase()=="content-type"),V=l.FormData&&_ instanceof l.FormData,!(0<=Array.prototype.indexOf.call(C_,w,void 0))||M||V||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,j]of T)this.g.setRequestHeader(H,j);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_s(this),this.u=!0,this.g.send(_),this.u=!1}catch(H){ls(this,H)}};function ls(_,w){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=w,_.m=5,ds(_),Tr(_)}function ds(_){_.A||(_.A=!0,ze(_,"complete"),ze(_,"error"))}e.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=_||7,ze(this,"complete"),ze(this,"abort"),Tr(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Tr(this,!0)),ye.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?cs(this):this.bb())},e.bb=function(){cs(this)};function cs(_){if(_.h&&typeof o<"u"&&(!_.v[1]||ut(_)!=4||_.Z()!=2)){if(_.u&&ut(_)==4)Mo(_.Ea,0,_);else if(ze(_,"readystatechange"),ut(_)==4){_.h=!1;try{const j=_.Z();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var T;if(!(T=w)){var M;if(M=j===0){var V=String(_.D).match(es)[1]||null;!V&&l.self&&l.self.location&&(V=l.self.location.protocol.slice(0,-1)),M=!D_.test(V?V.toLowerCase():"")}T=M}if(T)ze(_,"complete"),ze(_,"success");else{_.m=6;try{var H=2<ut(_)?_.g.statusText:""}catch{H=""}_.l=H+" ["+_.Z()+"]",ds(_)}}finally{Tr(_)}}}}function Tr(_,w){if(_.g){_s(_);const T=_.g,M=_.v[0]?()=>{}:null;_.g=null,_.v=null,w||ze(_,"ready");try{T.onreadystatechange=M}catch{}}}function _s(_){_.I&&(l.clearTimeout(_.I),_.I=null)}e.isActive=function(){return!!this.g};function ut(_){return _.g?_.g.readyState:0}e.Z=function(){try{return 2<ut(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(_){if(this.g){var w=this.g.responseText;return _&&w.indexOf(_)==0&&(w=w.substring(_.length)),s_(w)}};function us(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.H){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function I_(_){const w={};_=(_.g&&2<=ut(_)&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<_.length;M++){if(x(_[M]))continue;var T=k(_[M]);const V=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const H=w[V]||[];w[V]=H,H.push(T)}A(w,function(M){return M.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $n(_,w,T){return T&&T.internalChannelParams&&T.internalChannelParams[_]||w}function hs(_){this.Aa=0,this.i=[],this.j=new Nn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$n("failFast",!1,_),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$n("baseRetryDelayMs",5e3,_),this.cb=$n("retryDelaySeedMs",1e4,_),this.Wa=$n("forwardChannelMaxRetries",2,_),this.wa=$n("forwardChannelRequestTimeoutMs",2e4,_),this.pa=_&&_.xmlHttpFactory||void 0,this.Xa=_&&_.Tb||void 0,this.Ca=_&&_.useFetchStreams||!1,this.L=void 0,this.J=_&&_.supportsCrossDomainXhr||!1,this.K="",this.h=new Ko(_&&_.concurrentRequestLimit),this.Da=new A_,this.P=_&&_.fastHandshake||!1,this.O=_&&_.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=_&&_.Rb||!1,_&&_.xa&&this.j.xa(),_&&_.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&_&&_.detectBufferingProxy||!1,this.ja=void 0,_&&_.longPollingTimeout&&0<_.longPollingTimeout&&(this.ja=_.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=hs.prototype,e.la=8,e.G=1,e.connect=function(_,w,T,M){qe(0),this.W=_,this.H=w||{},T&&M!==void 0&&(this.H.OSID=T,this.H.OAID=M),this.F=this.X,this.I=xs(this,null,this.W),Sr(this)};function Ba(_){if(fs(_),_.G==3){var w=_.U++,T=_t(_.I);if(pe(T,"SID",_.K),pe(T,"RID",w),pe(T,"TYPE","terminate"),Hn(_,T),w=new yt(_,_.j,w),w.L=2,w.v=xr(_t(T)),T=!1,l.navigator&&l.navigator.sendBeacon)try{T=l.navigator.sendBeacon(w.v.toString(),"")}catch{}!T&&l.Image&&(new Image().src=w.v,T=!0),T||(w.g=Es(w.j,null),w.g.ea(w.v)),w.F=Date.now(),yr(w)}ws(_)}function Ar(_){_.g&&(Ya(_),_.g.cancel(),_.g=null)}function fs(_){Ar(_),_.u&&(l.clearTimeout(_.u),_.u=null),Dr(_),_.h.cancel(),_.s&&(typeof _.s=="number"&&l.clearTimeout(_.s),_.s=null)}function Sr(_){if(!Go(_.h)&&!_.s){_.s=!0;var w=_.Ga;q||ie(),$||(q(),$=!0),ee.add(w,_),_.B=0}}function N_(_,w){return Jo(_.h)>=_.h.j-(_.s?1:0)?!1:_.s?(_.i=w.D.concat(_.i),!0):_.G==1||_.G==2||_.B>=(_.Va?0:_.Wa)?!1:(_.s=In(f(_.Ga,_,w),bs(_,_.B)),_.B++,!0)}e.Ga=function(_){if(this.s)if(this.s=null,this.G==1){if(!_){this.U=Math.floor(1e5*Math.random()),_=this.U++;const V=new yt(this,this.j,_);let H=this.o;if(this.S&&(H?(H=m(H),E(H,this.S)):H=this.S),this.m!==null||this.O||(V.H=H,H=null),this.P)e:{for(var w=0,T=0;T<this.i.length;T++){t:{var M=this.i[T];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(w+=M,4096<w){w=T;break e}if(w===4096||T===this.i.length-1){w=T+1;break e}}w=1e3}else w=1e3;w=ms(this,V,w),T=_t(this.I),pe(T,"RID",_),pe(T,"CVER",22),this.D&&pe(T,"X-HTTP-Session-Id",this.D),Hn(this,T),H&&(this.O?w="headers="+encodeURIComponent(String(ss(H)))+"&"+w:this.m&&qa(T,this.m,H)),za(this.h,V),this.Ua&&pe(T,"TYPE","init"),this.P?(pe(T,"$req",w),pe(T,"SID","null"),V.T=!0,$a(V,T,null)):$a(V,T,w),this.G=2}}else this.G==3&&(_?ps(this,_):this.i.length==0||Go(this.h)||ps(this))};function ps(_,w){var T;w?T=w.l:T=_.U++;const M=_t(_.I);pe(M,"SID",_.K),pe(M,"RID",T),pe(M,"AID",_.T),Hn(_,M),_.m&&_.o&&qa(M,_.m,_.o),T=new yt(_,_.j,T,_.B+1),_.m===null&&(T.H=_.o),w&&(_.i=w.D.concat(_.i)),w=ms(_,T,1e3),T.I=Math.round(.5*_.wa)+Math.round(.5*_.wa*Math.random()),za(_.h,T),$a(T,M,w)}function Hn(_,w){_.H&&N(_.H,function(T,M){pe(w,M,T)}),_.l&&Zo({},function(T,M){pe(w,M,T)})}function ms(_,w,T){T=Math.min(_.i.length,T);var M=_.l?f(_.l.Na,_.l,_):null;e:{var V=_.i;let H=-1;for(;;){const j=["count="+T];H==-1?0<T?(H=V[0].g,j.push("ofs="+H)):H=0:j.push("ofs="+H);let he=!0;for(let De=0;De<T;De++){let de=V[De].g;const Oe=V[De].map;if(de-=H,0>de)H=Math.max(0,V[De].g-100),he=!1;else try{S_(Oe,j,"req"+de+"_")}catch{M&&M(Oe)}}if(he){M=j.join("&");break e}}}return _=_.i.splice(0,T),w.D=_,M}function gs(_){if(!_.g&&!_.u){_.Y=1;var w=_.Fa;q||ie(),$||(q(),$=!0),ee.add(w,_),_.v=0}}function ja(_){return _.g||_.u||3<=_.v?!1:(_.Y++,_.u=In(f(_.Fa,_),bs(_,_.v)),_.v++,!0)}e.Fa=function(){if(this.u=null,vs(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var _=2*this.R;this.j.info("BP detection timer enabled: "+_),this.A=In(f(this.ab,this),_)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,qe(10),Ar(this),vs(this))};function Ya(_){_.A!=null&&(l.clearTimeout(_.A),_.A=null)}function vs(_){_.g=new yt(_,_.j,"rpc",_.Y),_.m===null&&(_.g.H=_.o),_.g.O=0;var w=_t(_.qa);pe(w,"RID","rpc"),pe(w,"SID",_.K),pe(w,"AID",_.T),pe(w,"CI",_.F?"0":"1"),!_.F&&_.ja&&pe(w,"TO",_.ja),pe(w,"TYPE","xmlhttp"),Hn(_,w),_.m&&_.o&&qa(w,_.m,_.o),_.L&&(_.g.I=_.L);var T=_.g;_=_.ia,T.L=1,T.v=xr(_t(w)),T.m=null,T.P=!0,jo(T,_)}e.Za=function(){this.C!=null&&(this.C=null,Ar(this),ja(this),qe(19))};function Dr(_){_.C!=null&&(l.clearTimeout(_.C),_.C=null)}function ys(_,w){var T=null;if(_.g==w){Dr(_),Ya(_),_.g=null;var M=2}else if(Ua(_.h,w))T=w.D,Qo(_.h,w),M=1;else return;if(_.G!=0){if(w.o)if(M==1){T=w.m?w.m.length:0,w=Date.now()-w.F;var V=_.B;M=mr(),ze(M,new Uo(M,T)),Sr(_)}else gs(_);else if(V=w.s,V==3||V==0&&0<w.X||!(M==1&&N_(_,w)||M==2&&ja(_)))switch(T&&0<T.length&&(w=_.h,w.i=w.i.concat(T)),V){case 1:Bt(_,5);break;case 4:Bt(_,10);break;case 3:Bt(_,6);break;default:Bt(_,2)}}}function bs(_,w){let T=_.Ta+Math.floor(Math.random()*_.cb);return _.isActive()||(T*=2),T*w}function Bt(_,w){if(_.j.info("Error code "+w),w==2){var T=f(_.fb,_),M=_.Xa;const V=!M;M=new qt(M||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||br(M,"https"),xr(M),V?k_(M.toString(),T):T_(M.toString(),T)}else qe(2);_.G=0,_.l&&_.l.sa(w),ws(_),fs(_)}e.fb=function(_){_?(this.j.info("Successfully pinged google.com"),qe(2)):(this.j.info("Failed to ping google.com"),qe(1))};function ws(_){if(_.G=0,_.ka=[],_.l){const w=Xo(_.h);(w.length!=0||_.i.length!=0)&&(p(_.ka,w),p(_.ka,_.i),_.h.i.length=0,h(_.i),_.i.length=0),_.l.ra()}}function xs(_,w,T){var M=T instanceof qt?_t(T):new qt(T);if(M.g!="")w&&(M.g=w+"."+M.g),wr(M,M.s);else{var V=l.location;M=V.protocol,w=w?w+"."+V.hostname:V.hostname,V=+V.port;var H=new qt(null);M&&br(H,M),w&&(H.g=w),V&&wr(H,V),T&&(H.l=T),M=H}return T=_.D,w=_.ya,T&&w&&pe(M,T,w),pe(M,"VER",_.la),Hn(_,M),M}function Es(_,w,T){if(w&&!_.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=_.Ca&&!_.pa?new ye(new Er({eb:T})):new ye(_.pa),w.Ha(_.J),w}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function ks(){}e=ks.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Cr(){}Cr.prototype.g=function(_,w){return new We(_,w)};function We(_,w){Me.call(this),this.g=new hs(w),this.l=_,this.h=w&&w.messageUrlParams||null,_=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(_?_["X-WebChannel-Content-Type"]=w.messageContentType:_={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(_?_["X-WebChannel-Client-Profile"]=w.va:_={"X-WebChannel-Client-Profile":w.va}),this.g.S=_,(_=w&&w.Sb)&&!x(_)&&(this.g.m=_),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!x(w)&&(this.g.D=w,_=this.h,_!==null&&w in _&&(_=this.h,w in _&&delete _[w])),this.j=new tn(this)}g(We,Me),We.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},We.prototype.close=function(){Ba(this.g)},We.prototype.o=function(_){var w=this.g;if(typeof _=="string"){var T={};T.__data__=_,_=T}else this.u&&(T={},T.__data__=Ma(_),_=T);w.i.push(new f_(w.Ya++,_)),w.G==3&&Sr(w)},We.prototype.N=function(){this.g.l=null,delete this.j,Ba(this.g),delete this.g,We.aa.N.call(this)};function Ts(_){Ra.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var w=_.__sm__;if(w){e:{for(const T in w){_=T;break e}_=void 0}(this.i=_)&&(_=this.i,w=w!==null&&_ in w?w[_]:void 0),this.data=w}else this.data=_}g(Ts,Ra);function As(){Pa.call(this),this.status=1}g(As,Pa);function tn(_){this.g=_}g(tn,ks),tn.prototype.ua=function(){ze(this.g,"a")},tn.prototype.ta=function(_){ze(this.g,new Ts(_))},tn.prototype.sa=function(_){ze(this.g,new As)},tn.prototype.ra=function(){ze(this.g,"b")},Cr.prototype.createWebChannel=Cr.prototype.g,We.prototype.send=We.prototype.o,We.prototype.open=We.prototype.m,We.prototype.close=We.prototype.close,Cd=function(){return new Cr},Dd=function(){return mr()},Sd=Ut,wi={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},gr.NO_ERROR=0,gr.TIMEOUT=8,gr.HTTP_ERROR=6,Lr=gr,zo.COMPLETE="complete",Ad=zo,Vo.EventType=Dn,Dn.OPEN="a",Dn.CLOSE="b",Dn.ERROR="c",Dn.MESSAGE="d",Me.prototype.listen=Me.prototype.K,qn=Vo,ye.prototype.listenOnce=ye.prototype.L,ye.prototype.getLastError=ye.prototype.Ka,ye.prototype.getLastErrorCode=ye.prototype.Ba,ye.prototype.getStatus=ye.prototype.Z,ye.prototype.getResponseJson=ye.prototype.Oa,ye.prototype.getResponseText=ye.prototype.oa,ye.prototype.send=ye.prototype.ea,ye.prototype.setWithCredentials=ye.prototype.Ha,Td=ye}).apply(typeof Nr<"u"?Nr:typeof self<"u"?self:typeof window<"u"?window:{});const al="@firebase/firestore",il="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}$e.UNAUTHENTICATED=new $e(null),$e.GOOGLE_CREDENTIALS=new $e("google-credentials-uid"),$e.FIRST_PARTY=new $e("first-party-uid"),$e.MOCK_USER=new $e("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let En="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gt=new vd("@firebase/firestore");function on(){return Gt.logLevel}function K(e,...t){if(Gt.logLevel<=le.DEBUG){const n=t.map(Yi);Gt.debug(`Firestore (${En}): ${e}`,...n)}}function gt(e,...t){if(Gt.logLevel<=le.ERROR){const n=t.map(Yi);Gt.error(`Firestore (${En}): ${e}`,...n)}}function fn(e,...t){if(Gt.logLevel<=le.WARN){const n=t.map(Yi);Gt.warn(`Firestore (${En}): ${e}`,...n)}}function Yi(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,Id(e,r,n)}function Id(e,t,n){let r=`FIRESTORE (${En}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw gt(r),new Error(r)}function ue(e,t,n,r){let a="Unexpected state";typeof n=="string"?a=n:r=n,e||Id(t,a,r)}function ne(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends xn{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class _p{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n($e.UNAUTHENTICATED))}shutdown(){}}class up{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class hp{constructor(t){this.t=t,this.currentUser=$e.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ue(this.o===void 0,42304);let r=this.i;const a=s=>this.i!==r?(r=this.i,n(s)):Promise.resolve();let i=new Kt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Kt,t.enqueueRetryable(()=>a(this.currentUser))};const o=()=>{const s=i;t.enqueueRetryable(async()=>{await s.promise,await a(this.currentUser)})},l=s=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=s,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(s=>l(s)),setTimeout(()=>{if(!this.auth){const s=this.t.getImmediate({optional:!0});s?l(s):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Kt)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string",31837,{l:r}),new Nd(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ue(t===null||typeof t=="string",2055,{h:t}),new $e(t)}}class fp{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=$e.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class pp{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new fp(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n($e.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ol{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class mp{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Kf(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ue(this.o===void 0,3512);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const a=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>a(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?a(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ol(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ue(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new ol(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gp(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Md(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=gp(40);for(let i=0;i<a.length;++i)r.length<20&&a[i]<n&&(r+=t.charAt(a[i]%62))}return r}}function ae(e,t){return e<t?-1:e>t?1:0}function xi(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),a=t.codePointAt(n);if(r!==a){if(r<128&&a<128)return ae(r,a);{const i=Md(),o=vp(i.encode(sl(e,n)),i.encode(sl(t,n)));return o!==0?o:ae(r,a)}}n+=r>65535?2:1}return ae(e.length,t.length)}function sl(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function vp(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return ae(e[n],t[n]);return ae(e.length,t.length)}function pn(e,t,n){return e.length===t.length&&e.every((r,a)=>n(r,t[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll=-62135596800,dl=1e6;class we{static now(){return we.fromMillis(Date.now())}static fromDate(t){return we.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*dl);return new we(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<ll)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/dl}_compareTo(t){return this.seconds===t.seconds?ae(this.nanoseconds,t.nanoseconds):ae(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-ll;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{static fromTimestamp(t){return new te(t)}static min(){return new te(new we(0,0))}static max(){return new te(new we(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl="__name__";class at{constructor(t,n,r){n===void 0?n=0:n>t.length&&Z(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&Z(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return at.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof at?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let a=0;a<r;a++){const i=at.compareSegments(t.get(a),n.get(a));if(i!==0)return i}return ae(t.length,n.length)}static compareSegments(t,n){const r=at.isNumericId(t),a=at.isNumericId(n);return r&&!a?-1:!r&&a?1:r&&a?at.extractNumericId(t).compare(at.extractNumericId(n)):xi(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return It.fromString(t.substring(4,t.length-2))}}class me extends at{construct(t,n,r){return new me(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new G(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(a=>a.length>0))}return new me(n)}static emptyPath(){return new me([])}}const yp=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ie extends at{construct(t,n,r){return new Ie(t,n,r)}static isValidIdentifier(t){return yp.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ie.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cl}static keyField(){return new Ie([cl])}static fromServerFormat(t){const n=[];let r="",a=0;const i=()=>{if(r.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;a<t.length;){const l=t[a];if(l==="\\"){if(a+1===t.length)throw new G(z.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const s=t[a+1];if(s!=="\\"&&s!=="."&&s!=="`")throw new G(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=s,a+=2}else l==="`"?(o=!o,a++):l!=="."||o?(r+=l,a++):(i(),a++)}if(i(),o)throw new G(z.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ie(n)}static emptyPath(){return new Ie([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(t){this.path=t}static fromPath(t){return new X(me.fromString(t))}static fromName(t){return new X(me.fromString(t).popFirst(5))}static empty(){return new X(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&me.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return me.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new X(new me(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=-1;function bp(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=te.fromTimestamp(r===1e9?new we(n+1,0):new we(n,r));return new Ot(a,X.empty(),t)}function wp(e){return new Ot(e.readTime,e.key,nr)}class Ot{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new Ot(te.min(),X.empty(),nr)}static max(){return new Ot(te.max(),X.empty(),nr)}}function xp(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=X.comparator(e.documentKey,t.documentKey),n!==0?n:ae(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class kp{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kn(e){if(e.code!==z.FAILED_PRECONDITION||e.message!==Ep)throw e;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&Z(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new F((r,a)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,a)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,a)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):F.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):F.reject(n)}static resolve(t){return new F((n,r)=>{n(t)})}static reject(t){return new F((n,r)=>{r(t)})}static waitFor(t){return new F((n,r)=>{let a=0,i=0,o=!1;t.forEach(l=>{++a,l.next(()=>{++i,o&&i===a&&n()},s=>r(s))}),o=!0,i===a&&n()})}static or(t){let n=F.resolve(!1);for(const r of t)n=n.next(a=>a?F.resolve(a):r());return n}static forEach(t,n){const r=[];return t.forEach((a,i)=>{r.push(n.call(this,a,i))}),this.waitFor(r)}static mapArray(t,n){return new F((r,a)=>{const i=t.length,o=new Array(i);let l=0;for(let s=0;s<i;s++){const d=s;n(t[d]).next(c=>{o[d]=c,++l,l===i&&r(o)},c=>a(c))}})}static doWhile(t,n){return new F((r,a)=>{const i=()=>{t()===!0?n().next(()=>{i()},a):r()};i()})}}function Tp(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Tn(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ce&&this.ce(t),t}}la.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi=-1;function da(e){return e==null}function Jr(e){return e===0&&1/e==-1/0}function Ap(e){return typeof e=="number"&&Number.isInteger(e)&&!Jr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd="";function Sp(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=_l(t)),t=Dp(e.get(n),t);return _l(t)}function Dp(e,t){let n=t;const r=e.length;for(let a=0;a<r;a++){const i=e.charAt(a);switch(i){case"\0":n+="";break;case Rd:n+="";break;default:n+=i}}return n}function _l(e){return e+Rd+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ul(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ht(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Pd(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(t,n){this.comparator=t,this.root=n||Ce.EMPTY}insert(t,n){return new ve(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ce.BLACK,null,null))}remove(t){return new ve(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ce.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(t,r.key);if(a===0)return n+r.left.size;a<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Mr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Mr(this.root,t,this.comparator,!1)}getReverseIterator(){return new Mr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Mr(this.root,t,this.comparator,!0)}}class Mr{constructor(t,n,r,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&a&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(i===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ce{constructor(t,n,r,a,i){this.key=t,this.value=n,this.color=r??Ce.RED,this.left=a??Ce.EMPTY,this.right=i??Ce.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,a,i){return new Ce(t??this.key,n??this.value,r??this.color,a??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let a=this;const i=r(t,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(t,n,r),null):i===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(t,n,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Ce.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,a=this;if(n(t,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(t,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(t,a.key)===0){if(a.right.isEmpty())return Ce.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(t,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ce.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ce.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Z(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Z(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Z(27949);return t+(this.isRed()?0:1)}}Ce.EMPTY=null,Ce.RED=!0,Ce.BLACK=!1;Ce.EMPTY=new class{constructor(){this.size=0}get key(){throw Z(57766)}get value(){throw Z(16141)}get color(){throw Z(16727)}get left(){throw Z(29726)}get right(){throw Z(36894)}copy(t,n,r,a,i){return this}insert(t,n,r){return new Ce(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(t){this.comparator=t,this.data=new ve(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,t[1])>=0)return;n(a.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new hl(this.data.getIterator())}getIteratorFrom(t){return new hl(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Te)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,i=r.getNext().key;if(this.comparator(a,i)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Te(this.comparator);return n.data=t,n}}class hl{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(t){this.fields=t,t.sort(Ie.comparator)}static empty(){return new Ge([])}unionWith(t){let n=new Te(Ie.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Ge(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return pn(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(a){try{return atob(a)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ld("Invalid base64 string: "+i):i}}(t);return new Ne(n)}static fromUint8Array(t){const n=function(a){let i="";for(let o=0;o<a.length;++o)i+=String.fromCharCode(a[o]);return i}(t);return new Ne(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ae(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ne.EMPTY_BYTE_STRING=new Ne("");const Cp=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Rt(e){if(ue(!!e,39018),typeof e=="string"){let t=0;const n=Cp.exec(e);if(ue(!!n,46558,{timestamp:e}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),t=Number(a)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:be(e.seconds),nanos:be(e.nanos)}}function be(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Pt(e){return typeof e=="string"?Ne.fromBase64String(e):Ne.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd="server_timestamp",$d="__type__",Hd="__previous_value__",Fd="__local_write_time__";function Ki(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[$d])===null||n===void 0?void 0:n.stringValue)===Vd}function ca(e){const t=e.mapValue.fields[Hd];return Ki(t)?ca(t):t}function rr(e){const t=Rt(e.mapValue.fields[Fd].timestampValue);return new we(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(t,n,r,a,i,o,l,s,d,c){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=s,this.useFetchStreams=d,this.isUsingEmulator=c}}const Qr="(default)";class ar{constructor(t,n){this.projectId=t,this.database=n||Qr}static empty(){return new ar("","")}get isDefaultDatabase(){return this.database===Qr}isEqual(t){return t instanceof ar&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud="__type__",Np="__max__",Or={mapValue:{}},zd="__vector__",Xr="value";function Lt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ki(e)?4:Op(e)?9007199254740991:Mp(e)?10:11:Z(28295,{value:e})}function lt(e,t){if(e===t)return!0;const n=Lt(e);if(n!==Lt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return rr(e).isEqual(rr(t));case 3:return function(a,i){if(typeof a.timestampValue=="string"&&typeof i.timestampValue=="string"&&a.timestampValue.length===i.timestampValue.length)return a.timestampValue===i.timestampValue;const o=Rt(a.timestampValue),l=Rt(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(a,i){return Pt(a.bytesValue).isEqual(Pt(i.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(a,i){return be(a.geoPointValue.latitude)===be(i.geoPointValue.latitude)&&be(a.geoPointValue.longitude)===be(i.geoPointValue.longitude)}(e,t);case 2:return function(a,i){if("integerValue"in a&&"integerValue"in i)return be(a.integerValue)===be(i.integerValue);if("doubleValue"in a&&"doubleValue"in i){const o=be(a.doubleValue),l=be(i.doubleValue);return o===l?Jr(o)===Jr(l):isNaN(o)&&isNaN(l)}return!1}(e,t);case 9:return pn(e.arrayValue.values||[],t.arrayValue.values||[],lt);case 10:case 11:return function(a,i){const o=a.mapValue.fields||{},l=i.mapValue.fields||{};if(ul(o)!==ul(l))return!1;for(const s in o)if(o.hasOwnProperty(s)&&(l[s]===void 0||!lt(o[s],l[s])))return!1;return!0}(e,t);default:return Z(52216,{left:e})}}function ir(e,t){return(e.values||[]).find(n=>lt(n,t))!==void 0}function mn(e,t){if(e===t)return 0;const n=Lt(e),r=Lt(t);if(n!==r)return ae(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ae(e.booleanValue,t.booleanValue);case 2:return function(i,o){const l=be(i.integerValue||i.doubleValue),s=be(o.integerValue||o.doubleValue);return l<s?-1:l>s?1:l===s?0:isNaN(l)?isNaN(s)?0:-1:1}(e,t);case 3:return fl(e.timestampValue,t.timestampValue);case 4:return fl(rr(e),rr(t));case 5:return xi(e.stringValue,t.stringValue);case 6:return function(i,o){const l=Pt(i),s=Pt(o);return l.compareTo(s)}(e.bytesValue,t.bytesValue);case 7:return function(i,o){const l=i.split("/"),s=o.split("/");for(let d=0;d<l.length&&d<s.length;d++){const c=ae(l[d],s[d]);if(c!==0)return c}return ae(l.length,s.length)}(e.referenceValue,t.referenceValue);case 8:return function(i,o){const l=ae(be(i.latitude),be(o.latitude));return l!==0?l:ae(be(i.longitude),be(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return pl(e.arrayValue,t.arrayValue);case 10:return function(i,o){var l,s,d,c;const u=i.fields||{},f=o.fields||{},v=(l=u[Xr])===null||l===void 0?void 0:l.arrayValue,g=(s=f[Xr])===null||s===void 0?void 0:s.arrayValue,h=ae(((d=v==null?void 0:v.values)===null||d===void 0?void 0:d.length)||0,((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0);return h!==0?h:pl(v,g)}(e.mapValue,t.mapValue);case 11:return function(i,o){if(i===Or.mapValue&&o===Or.mapValue)return 0;if(i===Or.mapValue)return 1;if(o===Or.mapValue)return-1;const l=i.fields||{},s=Object.keys(l),d=o.fields||{},c=Object.keys(d);s.sort(),c.sort();for(let u=0;u<s.length&&u<c.length;++u){const f=xi(s[u],c[u]);if(f!==0)return f;const v=mn(l[s[u]],d[c[u]]);if(v!==0)return v}return ae(s.length,c.length)}(e.mapValue,t.mapValue);default:throw Z(23264,{Pe:n})}}function fl(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ae(e,t);const n=Rt(e),r=Rt(t),a=ae(n.seconds,r.seconds);return a!==0?a:ae(n.nanos,r.nanos)}function pl(e,t){const n=e.values||[],r=t.values||[];for(let a=0;a<n.length&&a<r.length;++a){const i=mn(n[a],r[a]);if(i)return i}return ae(n.length,r.length)}function gn(e){return Ei(e)}function Ei(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=Rt(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Pt(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return X.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",a=!0;for(const i of n.values||[])a?a=!1:r+=",",r+=Ei(i);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let a="{",i=!0;for(const o of r)i?i=!1:a+=",",a+=`${o}:${Ei(n.fields[o])}`;return a+"}"}(e.mapValue):Z(61005,{value:e})}function Vr(e){switch(Lt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ca(e);return t?16+Vr(t):16;case 5:return 2*e.stringValue.length;case 6:return Pt(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((a,i)=>a+Vr(i),0)}(e.arrayValue);case 10:case 11:return function(r){let a=0;return Ht(r.fields,(i,o)=>{a+=i.length+Vr(o)}),a}(e.mapValue);default:throw Z(13486,{value:e})}}function ki(e){return!!e&&"integerValue"in e}function Gi(e){return!!e&&"arrayValue"in e}function ml(e){return!!e&&"nullValue"in e}function gl(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function $r(e){return!!e&&"mapValue"in e}function Mp(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[Ud])===null||n===void 0?void 0:n.stringValue)===zd}function Gn(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ht(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=Gn(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Gn(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Op(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Np}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(t){this.value=t}static empty(){return new Ye({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!$r(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Gn(n)}setAll(t){let n=Ie.emptyPath(),r={},a=[];t.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const s=this.getFieldsMap(n);this.applyChanges(s,r,a),r={},a=[],n=l.popLast()}o?r[l.lastSegment()]=Gn(o):a.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,a)}delete(t){const n=this.field(t.popLast());$r(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return lt(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let a=n.mapValue.fields[t.get(r)];$r(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=a),n=a}return n.mapValue.fields}applyChanges(t,n,r){Ht(n,(a,i)=>t[a]=i);for(const a of r)delete t[a]}clone(){return new Ye(Gn(this.value))}}function qd(e){const t=[];return Ht(e.fields,(n,r)=>{const a=new Ie([n]);if($r(r)){const i=qd(r.mapValue).fields;if(i.length===0)t.push(a);else for(const o of i)t.push(a.child(o))}else t.push(a)}),new Ge(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(t,n,r,a,i,o,l){this.key=t,this.documentType=n,this.version=r,this.readTime=a,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(t){return new He(t,0,te.min(),te.min(),te.min(),Ye.empty(),0)}static newFoundDocument(t,n,r,a){return new He(t,1,n,te.min(),r,a,0)}static newNoDocument(t,n){return new He(t,2,n,te.min(),te.min(),Ye.empty(),0)}static newUnknownDocument(t,n){return new He(t,3,n,te.min(),te.min(),Ye.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ye.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ye.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof He&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new He(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(t,n){this.position=t,this.inclusive=n}}function vl(e,t,n){let r=0;for(let a=0;a<e.position.length;a++){const i=t[a],o=e.position[a];if(i.field.isKeyField()?r=X.comparator(X.fromName(o.referenceValue),n.key):r=mn(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function yl(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!lt(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(t,n="asc"){this.field=t,this.dir=n}}function Rp(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{}class ke extends Bd{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new Lp(t,n,r):n==="array-contains"?new Hp(t,r):n==="in"?new Fp(t,r):n==="not-in"?new Up(t,r):n==="array-contains-any"?new zp(t,r):new ke(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new Vp(t,r):new $p(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(mn(n,this.value)):n!==null&&Lt(this.value)===Lt(n)&&this.matchesComparison(mn(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Z(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dt extends Bd{constructor(t,n){super(),this.filters=t,this.op=n,this.Te=null}static create(t,n){return new dt(t,n)}matches(t){return jd(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function jd(e){return e.op==="and"}function Yd(e){return Pp(e)&&jd(e)}function Pp(e){for(const t of e.filters)if(t instanceof dt)return!1;return!0}function Ti(e){if(e instanceof ke)return e.field.canonicalString()+e.op.toString()+gn(e.value);if(Yd(e))return e.filters.map(t=>Ti(t)).join(",");{const t=e.filters.map(n=>Ti(n)).join(",");return`${e.op}(${t})`}}function Wd(e,t){return e instanceof ke?function(r,a){return a instanceof ke&&r.op===a.op&&r.field.isEqual(a.field)&&lt(r.value,a.value)}(e,t):e instanceof dt?function(r,a){return a instanceof dt&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce((i,o,l)=>i&&Wd(o,a.filters[l]),!0):!1}(e,t):void Z(19439)}function Kd(e){return e instanceof ke?function(n){return`${n.field.canonicalString()} ${n.op} ${gn(n.value)}`}(e):e instanceof dt?function(n){return n.op.toString()+" {"+n.getFilters().map(Kd).join(" ,")+"}"}(e):"Filter"}class Lp extends ke{constructor(t,n,r){super(t,n,r),this.key=X.fromName(r.referenceValue)}matches(t){const n=X.comparator(t.key,this.key);return this.matchesComparison(n)}}class Vp extends ke{constructor(t,n){super(t,"in",n),this.keys=Gd("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class $p extends ke{constructor(t,n){super(t,"not-in",n),this.keys=Gd("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function Gd(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class Hp extends ke{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return Gi(n)&&ir(n.arrayValue,this.value)}}class Fp extends ke{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&ir(this.value.arrayValue,n)}}class Up extends ke{constructor(t,n){super(t,"not-in",n)}matches(t){if(ir(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ir(this.value.arrayValue,n)}}class zp extends ke{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!Gi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ir(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(t,n=null,r=[],a=[],i=null,o=null,l=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=i,this.startAt=o,this.endAt=l,this.Ie=null}}function bl(e,t=null,n=[],r=[],a=null,i=null,o=null){return new qp(e,t,n,r,a,i,o)}function Ji(e){const t=ne(e);if(t.Ie===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>Ti(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),da(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>gn(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>gn(r)).join(",")),t.Ie=n}return t.Ie}function Qi(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Rp(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Wd(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!yl(e.startAt,t.startAt)&&yl(e.endAt,t.endAt)}function Ai(e){return X.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(t,n=null,r=[],a=[],i=null,o="F",l=null,s=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=s,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Bp(e,t,n,r,a,i,o,l){return new _a(e,t,n,r,a,i,o,l)}function Xi(e){return new _a(e)}function wl(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function jp(e){return e.collectionGroup!==null}function Jn(e){const t=ne(e);if(t.Ee===null){t.Ee=[];const n=new Set;for(const i of t.explicitOrderBy)t.Ee.push(i),n.add(i.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Te(Ie.comparator);return o.filters.forEach(s=>{s.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(t).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||t.Ee.push(new ea(i,r))}),n.has(Ie.keyField().canonicalString())||t.Ee.push(new ea(Ie.keyField(),r))}return t.Ee}function ot(e){const t=ne(e);return t.de||(t.de=Yp(t,Jn(e))),t.de}function Yp(e,t){if(e.limitType==="F")return bl(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(a=>{const i=a.dir==="desc"?"asc":"desc";return new ea(a.field,i)});const n=e.endAt?new Zr(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Zr(e.startAt.position,e.startAt.inclusive):null;return bl(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Si(e,t,n){return new _a(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ua(e,t){return Qi(ot(e),ot(t))&&e.limitType===t.limitType}function Jd(e){return`${Ji(ot(e))}|lt:${e.limitType}`}function sn(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(a=>Kd(a)).join(", ")}]`),da(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(a=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(a)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(a=>gn(a)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(a=>gn(a)).join(",")),`Target(${r})`}(ot(e))}; limitType=${e.limitType})`}function ha(e,t){return t.isFoundDocument()&&function(r,a){const i=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):X.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(e,t)&&function(r,a){for(const i of Jn(r))if(!i.field.isKeyField()&&a.data.field(i.field)===null)return!1;return!0}(e,t)&&function(r,a){for(const i of r.filters)if(!i.matches(a))return!1;return!0}(e,t)&&function(r,a){return!(r.startAt&&!function(o,l,s){const d=vl(o,l,s);return o.inclusive?d<=0:d<0}(r.startAt,Jn(r),a)||r.endAt&&!function(o,l,s){const d=vl(o,l,s);return o.inclusive?d>=0:d>0}(r.endAt,Jn(r),a))}(e,t)}function Wp(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Qd(e){return(t,n)=>{let r=!1;for(const a of Jn(e)){const i=Kp(a,t,n);if(i!==0)return i;r=r||a.field.isKeyField()}return 0}}function Kp(e,t,n){const r=e.field.isKeyField()?X.comparator(t.key,n.key):function(i,o,l){const s=o.data.field(i),d=l.data.field(i);return s!==null&&d!==null?mn(s,d):Z(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Z(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[a,i]of r)if(this.equalsFn(a,t))return i}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),a=this.inner[r];if(a===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],t))return void(a[i]=[t,n]);a.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],t))return r.length===1?delete this.inner[n]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(t){Ht(this.inner,(n,r)=>{for(const[a,i]of r)t(a,i)})}isEmpty(){return Pd(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp=new ve(X.comparator);function vt(){return Gp}const Xd=new ve(X.comparator);function Bn(...e){let t=Xd;for(const n of e)t=t.insert(n.key,n);return t}function Zd(e){let t=Xd;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function Yt(){return Qn()}function ec(){return Qn()}function Qn(){return new Qt(e=>e.toString(),(e,t)=>e.isEqual(t))}const Jp=new ve(X.comparator),Qp=new Te(X.comparator);function oe(...e){let t=Qp;for(const n of e)t=t.add(n);return t}const Xp=new Te(ae);function Zp(){return Xp}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zi(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Jr(t)?"-0":t}}function tc(e){return{integerValue:""+e}}function em(e,t){return Ap(t)?tc(t):Zi(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(){this._=void 0}}function tm(e,t,n){return e instanceof ta?function(a,i){const o={fields:{[$d]:{stringValue:Vd},[Fd]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return i&&Ki(i)&&(i=ca(i)),i&&(o.fields[Hd]=i),{mapValue:o}}(n,t):e instanceof or?rc(e,t):e instanceof sr?ac(e,t):function(a,i){const o=nc(a,i),l=xl(o)+xl(a.Re);return ki(o)&&ki(a.Re)?tc(l):Zi(a.serializer,l)}(e,t)}function nm(e,t,n){return e instanceof or?rc(e,t):e instanceof sr?ac(e,t):n}function nc(e,t){return e instanceof na?function(r){return ki(r)||function(i){return!!i&&"doubleValue"in i}(r)}(t)?t:{integerValue:0}:null}class ta extends fa{}class or extends fa{constructor(t){super(),this.elements=t}}function rc(e,t){const n=ic(t);for(const r of e.elements)n.some(a=>lt(a,r))||n.push(r);return{arrayValue:{values:n}}}class sr extends fa{constructor(t){super(),this.elements=t}}function ac(e,t){let n=ic(t);for(const r of e.elements)n=n.filter(a=>!lt(a,r));return{arrayValue:{values:n}}}class na extends fa{constructor(t,n){super(),this.serializer=t,this.Re=n}}function xl(e){return be(e.integerValue||e.doubleValue)}function ic(e){return Gi(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function rm(e,t){return e.field.isEqual(t.field)&&function(r,a){return r instanceof or&&a instanceof or||r instanceof sr&&a instanceof sr?pn(r.elements,a.elements,lt):r instanceof na&&a instanceof na?lt(r.Re,a.Re):r instanceof ta&&a instanceof ta}(e.transform,t.transform)}class am{constructor(t,n){this.version=t,this.transformResults=n}}class nt{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new nt}static exists(t){return new nt(void 0,t)}static updateTime(t){return new nt(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Hr(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class pa{}function oc(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new eo(e.key,nt.none()):new lr(e.key,e.data,nt.none());{const n=e.data,r=Ye.empty();let a=new Te(Ie.comparator);for(let i of t.fields)if(!a.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),a=a.add(i)}return new Ft(e.key,r,new Ge(a.toArray()),nt.none())}}function im(e,t,n){e instanceof lr?function(a,i,o){const l=a.value.clone(),s=kl(a.fieldTransforms,i,o.transformResults);l.setAll(s),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):e instanceof Ft?function(a,i,o){if(!Hr(a.precondition,i))return void i.convertToUnknownDocument(o.version);const l=kl(a.fieldTransforms,i,o.transformResults),s=i.data;s.setAll(sc(a)),s.setAll(l),i.convertToFoundDocument(o.version,s).setHasCommittedMutations()}(e,t,n):function(a,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Xn(e,t,n,r){return e instanceof lr?function(i,o,l,s){if(!Hr(i.precondition,o))return l;const d=i.value.clone(),c=Tl(i.fieldTransforms,s,o);return d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ft?function(i,o,l,s){if(!Hr(i.precondition,o))return l;const d=Tl(i.fieldTransforms,s,o),c=o.data;return c.setAll(sc(i)),c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(u=>u.field))}(e,t,n,r):function(i,o,l){return Hr(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(e,t,n)}function om(e,t){let n=null;for(const r of e.fieldTransforms){const a=t.data.field(r.field),i=nc(r.transform,a||null);i!=null&&(n===null&&(n=Ye.empty()),n.set(r.field,i))}return n||null}function El(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&pn(r,a,(i,o)=>rm(i,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class lr extends pa{constructor(t,n,r,a=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Ft extends pa{constructor(t,n,r,a,i=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function sc(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function kl(e,t,n){const r=new Map;ue(e.length===n.length,32656,{Ve:n.length,me:e.length});for(let a=0;a<n.length;a++){const i=e[a],o=i.transform,l=t.data.field(i.field);r.set(i.field,nm(o,l,n[a]))}return r}function Tl(e,t,n){const r=new Map;for(const a of e){const i=a.transform,o=n.data.field(a.field);r.set(a.field,tm(i,o,t))}return r}class eo extends pa{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sm extends pa{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(t,n,r,a){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const i=this.mutations[a];i.key.isEqual(t.key)&&im(i,t,r[a])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=Xn(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=Xn(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=ec();return this.mutations.forEach(a=>{const i=t.get(a.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(a.key)?null:l;const s=oc(o,l);s!==null&&r.set(a.key,s),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),oe())}isEqual(t){return this.batchId===t.batchId&&pn(this.mutations,t.mutations,(n,r)=>El(n,r))&&pn(this.baseMutations,t.baseMutations,(n,r)=>El(n,r))}}class to{constructor(t,n,r,a){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}static from(t,n,r){ue(t.mutations.length===r.length,58842,{fe:t.mutations.length,ge:r.length});let a=function(){return Jp}();const i=t.mutations;for(let o=0;o<i.length;o++)a=a.insert(i[o].key,r[o].version);return new to(t,n,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe,se;function _m(e){switch(e){case z.OK:return Z(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return Z(15467,{code:e})}}function lc(e){if(e===void 0)return gt("GRPC error has no .code"),z.UNKNOWN;switch(e){case xe.OK:return z.OK;case xe.CANCELLED:return z.CANCELLED;case xe.UNKNOWN:return z.UNKNOWN;case xe.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case xe.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case xe.INTERNAL:return z.INTERNAL;case xe.UNAVAILABLE:return z.UNAVAILABLE;case xe.UNAUTHENTICATED:return z.UNAUTHENTICATED;case xe.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case xe.NOT_FOUND:return z.NOT_FOUND;case xe.ALREADY_EXISTS:return z.ALREADY_EXISTS;case xe.PERMISSION_DENIED:return z.PERMISSION_DENIED;case xe.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case xe.ABORTED:return z.ABORTED;case xe.OUT_OF_RANGE:return z.OUT_OF_RANGE;case xe.UNIMPLEMENTED:return z.UNIMPLEMENTED;case xe.DATA_LOSS:return z.DATA_LOSS;default:return Z(39323,{code:e})}}(se=xe||(xe={}))[se.OK=0]="OK",se[se.CANCELLED=1]="CANCELLED",se[se.UNKNOWN=2]="UNKNOWN",se[se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",se[se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",se[se.NOT_FOUND=5]="NOT_FOUND",se[se.ALREADY_EXISTS=6]="ALREADY_EXISTS",se[se.PERMISSION_DENIED=7]="PERMISSION_DENIED",se[se.UNAUTHENTICATED=16]="UNAUTHENTICATED",se[se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",se[se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",se[se.ABORTED=10]="ABORTED",se[se.OUT_OF_RANGE=11]="OUT_OF_RANGE",se[se.UNIMPLEMENTED=12]="UNIMPLEMENTED",se[se.INTERNAL=13]="INTERNAL",se[se.UNAVAILABLE=14]="UNAVAILABLE",se[se.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=new It([4294967295,4294967295],0);function Al(e){const t=Md().encode(e),n=new kd;return n.update(t),new Uint8Array(n.digest())}function Sl(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),a=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new It([n,r],0),new It([a,i],0)]}class no{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new jn(`Invalid padding: ${n}`);if(r<0)throw new jn(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new jn(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new jn(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*t.length-n,this.ye=It.fromNumber(this.pe)}we(t,n,r){let a=t.add(n.multiply(It.fromNumber(r)));return a.compare(um)===1&&(a=new It([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ye).toNumber()}be(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.pe===0)return!1;const n=Al(t),[r,a]=Sl(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,a,i);if(!this.be(o))return!1}return!0}static create(t,n,r){const a=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),o=new no(i,a,n);return r.forEach(l=>o.insert(l)),o}insert(t){if(this.pe===0)return;const n=Al(t),[r,a]=Sl(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,a,i);this.Se(o)}}Se(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class jn extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(t,n,r,a,i){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const a=new Map;return a.set(t,dr.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new ma(te.min(),a,new ve(ae),vt(),oe())}}class dr{constructor(t,n,r,a,i){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new dr(r,n,oe(),oe(),oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(t,n,r,a){this.De=t,this.removedTargetIds=n,this.key=r,this.ve=a}}class dc{constructor(t,n){this.targetId=t,this.Ce=n}}class cc{constructor(t,n,r=Ne.EMPTY_BYTE_STRING,a=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=a}}class Dl{constructor(){this.Fe=0,this.Me=Cl(),this.xe=Ne.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(t){t.approximateByteSize()>0&&(this.Ne=!0,this.xe=t)}qe(){let t=oe(),n=oe(),r=oe();return this.Me.forEach((a,i)=>{switch(i){case 0:t=t.add(a);break;case 2:n=n.add(a);break;case 1:r=r.add(a);break;default:Z(38017,{changeType:i})}}),new dr(this.xe,this.Oe,t,n,r)}Qe(){this.Ne=!1,this.Me=Cl()}$e(t,n){this.Ne=!0,this.Me=this.Me.insert(t,n)}Ue(t){this.Ne=!0,this.Me=this.Me.remove(t)}Ke(){this.Fe+=1}We(){this.Fe-=1,ue(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class hm{constructor(t){this.ze=t,this.je=new Map,this.He=vt(),this.Je=Rr(),this.Ye=Rr(),this.Ze=new ve(ae)}Xe(t){for(const n of t.De)t.ve&&t.ve.isFoundDocument()?this.et(n,t.ve):this.tt(n,t.key,t.ve);for(const n of t.removedTargetIds)this.tt(n,t.key,t.ve)}nt(t){this.forEachTarget(t,n=>{const r=this.rt(n);switch(t.state){case 0:this.it(n)&&r.ke(t.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(t.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(t.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(t.resumeToken));break;default:Z(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.je.forEach((r,a)=>{this.it(a)&&n(a)})}ot(t){const n=t.targetId,r=t.Ce.count,a=this._t(n);if(a){const i=a.target;if(Ai(i))if(r===0){const o=new X(i.path);this.tt(n,o,He.newNoDocument(o,te.min()))}else ue(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const l=this.ct(t),s=l?this.lt(l,t,o):1;if(s!==0){this.st(n);const d=s===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ct(t){const n=t.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:i=0}=n;let o,l;try{o=Pt(r).toUint8Array()}catch(s){if(s instanceof Ld)return fn("Decoding the base64 bloom filter in existence filter failed ("+s.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw s}try{l=new no(o,a,i)}catch(s){return fn(s instanceof jn?"BloomFilter error: ":"Applying bloom filter failed: ",s),null}return l.pe===0?null:l}lt(t,n,r){return n.Ce.count===r-this.Tt(t,n.targetId)?0:2}Tt(t,n){const r=this.ze.getRemoteKeysForTarget(n);let a=0;return r.forEach(i=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;t.mightContain(l)||(this.tt(n,i,null),a++)}),a}It(t){const n=new Map;this.je.forEach((i,o)=>{const l=this._t(o);if(l){if(i.current&&Ai(l.target)){const s=new X(l.target.path);this.Et(s).has(o)||this.dt(o,s)||this.tt(o,s,He.newNoDocument(s,t))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=oe();this.Ye.forEach((i,o)=>{let l=!0;o.forEachWhile(s=>{const d=this._t(s);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(t));const a=new ma(t,n,this.Ze,this.He,r);return this.He=vt(),this.Je=Rr(),this.Ye=Rr(),this.Ze=new ve(ae),a}et(t,n){if(!this.it(t))return;const r=this.dt(t,n.key)?2:0;this.rt(t).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(t)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(t))}tt(t,n,r){if(!this.it(t))return;const a=this.rt(t);this.dt(t,n)?a.$e(n,1):a.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(t)),this.Ye=this.Ye.insert(n,this.At(n).add(t)),r&&(this.He=this.He.insert(n,r))}removeTarget(t){this.je.delete(t)}ut(t){const n=this.rt(t).qe();return this.ze.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Ke(t){this.rt(t).Ke()}rt(t){let n=this.je.get(t);return n||(n=new Dl,this.je.set(t,n)),n}At(t){let n=this.Ye.get(t);return n||(n=new Te(ae),this.Ye=this.Ye.insert(t,n)),n}Et(t){let n=this.Je.get(t);return n||(n=new Te(ae),this.Je=this.Je.insert(t,n)),n}it(t){const n=this._t(t)!==null;return n||K("WatchChangeAggregator","Detected inactive target",t),n}_t(t){const n=this.je.get(t);return n&&n.Be?null:this.ze.Rt(t)}st(t){this.je.set(t,new Dl),this.ze.getRemoteKeysForTarget(t).forEach(n=>{this.tt(t,n,null)})}dt(t,n){return this.ze.getRemoteKeysForTarget(t).has(n)}}function Rr(){return new ve(X.comparator)}function Cl(){return new ve(X.comparator)}const fm={asc:"ASCENDING",desc:"DESCENDING"},pm={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mm={and:"AND",or:"OR"};class gm{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function Di(e,t){return e.useProto3Json||da(t)?t:{value:t}}function ra(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function _c(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function vm(e,t){return ra(e,t.toTimestamp())}function st(e){return ue(!!e,49232),te.fromTimestamp(function(n){const r=Rt(n);return new we(r.seconds,r.nanos)}(e))}function ro(e,t){return Ci(e,t).canonicalString()}function Ci(e,t){const n=function(a){return new me(["projects",a.projectId,"databases",a.database])}(e).child("documents");return t===void 0?n:n.child(t)}function uc(e){const t=me.fromString(e);return ue(gc(t),10190,{key:t.toString()}),t}function Ii(e,t){return ro(e.databaseId,t.path)}function ri(e,t){const n=uc(t);if(n.get(1)!==e.databaseId.projectId)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new X(fc(n))}function hc(e,t){return ro(e.databaseId,t)}function ym(e){const t=uc(e);return t.length===4?me.emptyPath():fc(t)}function Ni(e){return new me(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function fc(e){return ue(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Il(e,t,n){return{name:Ii(e,t),fields:n.value.mapValue.fields}}function bm(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Z(39313,{state:d})}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(d,c){return d.useProto3Json?(ue(c===void 0||typeof c=="string",58123),Ne.fromBase64String(c||"")):(ue(c===void 0||c instanceof Buffer||c instanceof Uint8Array,16193),Ne.fromUint8Array(c||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(d){const c=d.code===void 0?z.UNKNOWN:lc(d.code);return new G(c,d.message||"")}(o);n=new cc(r,a,i,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const a=ri(e,r.document.name),i=st(r.document.updateTime),o=r.document.createTime?st(r.document.createTime):te.min(),l=new Ye({mapValue:{fields:r.document.fields}}),s=He.newFoundDocument(a,i,o,l),d=r.targetIds||[],c=r.removedTargetIds||[];n=new Fr(d,c,s.key,s)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const a=ri(e,r.document),i=r.readTime?st(r.readTime):te.min(),o=He.newNoDocument(a,i),l=r.removedTargetIds||[];n=new Fr([],l,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const a=ri(e,r.document),i=r.removedTargetIds||[];n=new Fr([],i,a,null)}else{if(!("filter"in t))return Z(11601,{Vt:t});{t.filter;const r=t.filter;r.targetId;const{count:a=0,unchangedNames:i}=r,o=new cm(a,i),l=r.targetId;n=new dc(l,o)}}return n}function wm(e,t){let n;if(t instanceof lr)n={update:Il(e,t.key,t.value)};else if(t instanceof eo)n={delete:Ii(e,t.key)};else if(t instanceof Ft)n={update:Il(e,t.key,t.data),updateMask:Im(t.fieldMask)};else{if(!(t instanceof sm))return Z(16599,{ft:t.type});n={verify:Ii(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof ta)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof or)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof sr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof na)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw Z(20930,{transform:o.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(a,i){return i.updateTime!==void 0?{updateTime:vm(a,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Z(27497)}(e,t.precondition)),n}function xm(e,t){return e&&e.length>0?(ue(t!==void 0,14353),e.map(n=>function(a,i){let o=a.updateTime?st(a.updateTime):st(i);return o.isEqual(te.min())&&(o=st(i)),new am(o,a.transformResults||[])}(n,t))):[]}function Em(e,t){return{documents:[hc(e,t.path)]}}function km(e,t){const n={structuredQuery:{}},r=t.path;let a;t.collectionGroup!==null?(a=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=hc(e,a);const i=function(d){if(d.length!==0)return mc(dt.create(d,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(c=>function(f){return{field:ln(f.field),direction:Sm(f.dir)}}(c))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Di(e,t.limit);return l!==null&&(n.structuredQuery.limit=l),t.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(t.endAt)),{gt:n,parent:a}}function Tm(e){let t=ym(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){ue(r===1,65062);const c=n.from[0];c.allDescendants?a=c.collectionId:t=t.child(c.collectionId)}let i=[];n.where&&(i=function(u){const f=pc(u);return f instanceof dt&&Yd(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(u){return u.map(f=>function(g){return new ea(dn(g.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(n.orderBy));let l=null;n.limit&&(l=function(u){let f;return f=typeof u=="object"?u.value:u,da(f)?null:f}(n.limit));let s=null;n.startAt&&(s=function(u){const f=!!u.before,v=u.values||[];return new Zr(v,f)}(n.startAt));let d=null;return n.endAt&&(d=function(u){const f=!u.before,v=u.values||[];return new Zr(v,f)}(n.endAt)),Bp(t,a,o,i,l,"F",s,d)}function Am(e,t){const n=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Z(28987,{purpose:a})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function pc(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=dn(n.unaryFilter.field);return ke.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=dn(n.unaryFilter.field);return ke.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=dn(n.unaryFilter.field);return ke.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=dn(n.unaryFilter.field);return ke.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Z(61313);default:return Z(60726)}}(e):e.fieldFilter!==void 0?function(n){return ke.create(dn(n.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Z(58110);default:return Z(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return dt.create(n.compositeFilter.filters.map(r=>pc(r)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Z(1026)}}(n.compositeFilter.op))}(e):Z(30097,{filter:e})}function Sm(e){return fm[e]}function Dm(e){return pm[e]}function Cm(e){return mm[e]}function ln(e){return{fieldPath:e.canonicalString()}}function dn(e){return Ie.fromServerFormat(e.fieldPath)}function mc(e){return e instanceof ke?function(n){if(n.op==="=="){if(gl(n.value))return{unaryFilter:{field:ln(n.field),op:"IS_NAN"}};if(ml(n.value))return{unaryFilter:{field:ln(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gl(n.value))return{unaryFilter:{field:ln(n.field),op:"IS_NOT_NAN"}};if(ml(n.value))return{unaryFilter:{field:ln(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ln(n.field),op:Dm(n.op),value:n.value}}}(e):e instanceof dt?function(n){const r=n.getFilters().map(a=>mc(a));return r.length===1?r[0]:{compositeFilter:{op:Cm(n.op),filters:r}}}(e):Z(54877,{filter:e})}function Im(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function gc(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(t,n,r,a,i=te.min(),o=te.min(),l=Ne.EMPTY_BYTE_STRING,s=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=s}withSequenceNumber(t){return new St(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new St(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new St(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new St(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(t){this.wt=t}}function Mm(e){const t=Tm({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Si(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(){this.Cn=new Rm}addToCollectionParentIndex(t,n){return this.Cn.add(n),F.resolve()}getCollectionParents(t,n){return F.resolve(this.Cn.getEntries(n))}addFieldIndex(t,n){return F.resolve()}deleteFieldIndex(t,n){return F.resolve()}deleteAllFieldIndexes(t){return F.resolve()}createTargetIndexes(t,n){return F.resolve()}getDocumentsMatchingTarget(t,n){return F.resolve(null)}getIndexType(t,n){return F.resolve(0)}getFieldIndexes(t,n){return F.resolve([])}getNextCollectionGroupToUpdate(t){return F.resolve(null)}getMinOffset(t,n){return F.resolve(Ot.min())}getMinOffsetFromCollectionGroup(t,n){return F.resolve(Ot.min())}updateCollectionGroup(t,n,r){return F.resolve()}updateIndexEntries(t,n){return F.resolve()}}class Rm{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),a=this.index[n]||new Te(me.comparator),i=!a.has(r);return this.index[n]=a.add(r),i}has(t){const n=t.lastSegment(),r=t.popLast(),a=this.index[n];return a&&a.has(r)}getEntries(t){return(this.index[t]||new Te(me.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vc=41943040;class je{static withCacheSize(t){return new je(t,je.DEFAULT_COLLECTION_PERCENTILE,je.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */je.DEFAULT_COLLECTION_PERCENTILE=10,je.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,je.DEFAULT=new je(vc,je.DEFAULT_COLLECTION_PERCENTILE,je.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),je.DISABLED=new je(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(t){this.ur=t}next(){return this.ur+=2,this.ur}static cr(){return new vn(0)}static lr(){return new vn(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml="LruGarbageCollector",Pm=1048576;function Ol([e,t],[n,r]){const a=ae(e,n);return a===0?ae(t,r):a}class Lm{constructor(t){this.Er=t,this.buffer=new Te(Ol),this.dr=0}Ar(){return++this.dr}Rr(t){const n=[t,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Ol(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Vm{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(t){K(Ml,`Garbage collection scheduled in ${t}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Tn(n)?K(Ml,"Ignoring IndexedDB error during garbage collection: ",n):await kn(n)}await this.mr(3e5)})}}class $m{constructor(t,n){this.gr=t,this.params=n}calculateTargetCount(t,n){return this.gr.pr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return F.resolve(la.le);const r=new Lm(n);return this.gr.forEachTarget(t,a=>r.Rr(a.sequenceNumber)).next(()=>this.gr.yr(t,a=>r.Rr(a))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.gr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.gr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(Nl)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Nl):this.wr(t,n))}getCacheSize(t){return this.gr.getCacheSize(t)}wr(t,n){let r,a,i,o,l,s,d;const c=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),a=this.params.maximumSequenceNumbersToCollect):a=u,o=Date.now(),this.nthSequenceNumber(t,a))).next(u=>(r=u,l=Date.now(),this.removeTargets(t,r,n))).next(u=>(i=u,s=Date.now(),this.removeOrphanedDocuments(t,r))).next(u=>(d=Date.now(),on()<=le.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-c}ms
	Determined least recently used ${a} in `+(l-o)+`ms
	Removed ${i} targets in `+(s-l)+`ms
	Removed ${u} documents in `+(d-s)+`ms
Total Duration: ${d-c}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:i,documentsRemoved:u})))}}function Hm(e,t){return new $m(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(){this.changes=new Qt(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,He.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(t,n,r,a){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(a=>(r=a,this.remoteDocumentCache.getEntry(t,n))).next(a=>(r!==null&&Xn(r.mutation,a,Ge.empty(),we.now()),a))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,oe()).next(()=>r))}getLocalViewOfDocuments(t,n,r=oe()){const a=Yt();return this.populateOverlays(t,a,n).next(()=>this.computeViews(t,n,a,r).next(i=>{let o=Bn();return i.forEach((l,s)=>{o=o.insert(l,s.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=Yt();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,oe()))}populateOverlays(t,n,r){const a=[];return r.forEach(i=>{n.has(i)||a.push(i)}),this.documentOverlayCache.getOverlays(t,a).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(t,n,r,a){let i=vt();const o=Qn(),l=function(){return Qn()}();return n.forEach((s,d)=>{const c=r.get(d.key);a.has(d.key)&&(c===void 0||c.mutation instanceof Ft)?i=i.insert(d.key,d):c!==void 0?(o.set(d.key,c.mutation.getFieldMask()),Xn(c.mutation,d,c.mutation.getFieldMask(),we.now())):o.set(d.key,Ge.empty())}),this.recalculateAndSaveOverlays(t,i).next(s=>(s.forEach((d,c)=>o.set(d,c)),n.forEach((d,c)=>{var u;return l.set(d,new Um(c,(u=o.get(d))!==null&&u!==void 0?u:null))}),l))}recalculateAndSaveOverlays(t,n){const r=Qn();let a=new ve((o,l)=>o-l),i=oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const l of o)l.keys().forEach(s=>{const d=n.get(s);if(d===null)return;let c=r.get(s)||Ge.empty();c=l.applyToLocalView(d,c),r.set(s,c);const u=(a.get(l.batchId)||oe()).add(s);a=a.insert(l.batchId,u)})}).next(()=>{const o=[],l=a.getReverseIterator();for(;l.hasNext();){const s=l.getNext(),d=s.key,c=s.value,u=ec();c.forEach(f=>{if(!i.has(f)){const v=oc(n.get(f),r.get(f));v!==null&&u.set(f,v),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,d,u))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,a){return function(o){return X.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):jp(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,a):this.getDocumentsMatchingCollectionQuery(t,n,r,a)}getNextDocuments(t,n,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,a).next(i=>{const o=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,a-i.size):F.resolve(Yt());let l=nr,s=i;return o.next(d=>F.forEach(d,(c,u)=>(l<u.largestBatchId&&(l=u.largestBatchId),i.get(c)?F.resolve():this.remoteDocumentCache.getEntry(t,c).next(f=>{s=s.insert(c,f)}))).next(()=>this.populateOverlays(t,d,i)).next(()=>this.computeViews(t,s,d,oe())).next(c=>({batchId:l,changes:Zd(c)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new X(n)).next(r=>{let a=Bn();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a})}getDocumentsMatchingCollectionGroupQuery(t,n,r,a){const i=n.collectionGroup;let o=Bn();return this.indexManager.getCollectionParents(t,i).next(l=>F.forEach(l,s=>{const d=function(u,f){return new _a(f,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,s.child(i));return this.getDocumentsMatchingCollectionQuery(t,d,r,a).next(c=>{c.forEach((u,f)=>{o=o.insert(u,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,a){let i;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,i,a))).next(o=>{i.forEach((s,d)=>{const c=d.getKey();o.get(c)===null&&(o=o.insert(c,He.newInvalidDocument(c)))});let l=Bn();return o.forEach((s,d)=>{const c=i.get(s);c!==void 0&&Xn(c.mutation,d,Ge.empty(),we.now()),ha(n,d)&&(l=l.insert(s,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(t){this.serializer=t,this.kr=new Map,this.qr=new Map}getBundleMetadata(t,n){return F.resolve(this.kr.get(n))}saveBundleMetadata(t,n){return this.kr.set(n.id,function(a){return{id:a.id,version:a.version,createTime:st(a.createTime)}}(n)),F.resolve()}getNamedQuery(t,n){return F.resolve(this.qr.get(n))}saveNamedQuery(t,n){return this.qr.set(n.name,function(a){return{name:a.name,query:Mm(a.bundledQuery),readTime:st(a.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(){this.overlays=new ve(X.comparator),this.Qr=new Map}getOverlay(t,n){return F.resolve(this.overlays.get(n))}getOverlays(t,n){const r=Yt();return F.forEach(n,a=>this.getOverlay(t,a).next(i=>{i!==null&&r.set(a,i)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((a,i)=>{this.St(t,n,i)}),F.resolve()}removeOverlaysForBatchId(t,n,r){const a=this.Qr.get(r);return a!==void 0&&(a.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),F.resolve()}getOverlaysForCollection(t,n,r){const a=Yt(),i=n.length+1,o=new X(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const s=l.getNext().value,d=s.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&s.largestBatchId>r&&a.set(s.getKey(),s)}return F.resolve(a)}getOverlaysForCollectionGroup(t,n,r,a){let i=new ve((d,c)=>d-c);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let c=i.get(d.largestBatchId);c===null&&(c=Yt(),i=i.insert(d.largestBatchId,c)),c.set(d.getKey(),d)}}const l=Yt(),s=i.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach((d,c)=>l.set(d,c)),!(l.size()>=a)););return F.resolve(l)}St(t,n,r){const a=this.overlays.get(r.key);if(a!==null){const o=this.Qr.get(a.largestBatchId).delete(r.key);this.Qr.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new dm(n,r));let i=this.Qr.get(n);i===void 0&&(i=oe(),this.Qr.set(n,i)),this.Qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(){this.sessionToken=Ne.EMPTY_BYTE_STRING}getSessionToken(t){return F.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(){this.$r=new Te(Ae.Ur),this.Kr=new Te(Ae.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(t,n){const r=new Ae(t,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.zr(new Ae(t,n))}jr(t,n){t.forEach(r=>this.removeReference(r,n))}Hr(t){const n=new X(new me([])),r=new Ae(n,t),a=new Ae(n,t+1),i=[];return this.Kr.forEachInRange([r,a],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(t=>this.zr(t))}zr(t){this.$r=this.$r.delete(t),this.Kr=this.Kr.delete(t)}Yr(t){const n=new X(new me([])),r=new Ae(n,t),a=new Ae(n,t+1);let i=oe();return this.Kr.forEachInRange([r,a],o=>{i=i.add(o.key)}),i}containsKey(t){const n=new Ae(t,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class Ae{constructor(t,n){this.key=t,this.Zr=n}static Ur(t,n){return X.comparator(t.key,n.key)||ae(t.Zr,n.Zr)}static Wr(t,n){return ae(t.Zr,n.Zr)||X.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new Te(Ae.Ur)}checkEmpty(t){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,a){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new lm(i,n,r,a);this.mutationQueue.push(o);for(const l of a)this.Xr=this.Xr.add(new Ae(l.key,i)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return F.resolve(o)}lookupMutationBatch(t,n){return F.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,a=this.ti(r),i=a<0?0:a;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?Wi:this.nr-1)}getAllMutationBatches(t){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new Ae(n,0),a=new Ae(n,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,a],o=>{const l=this.ei(o.Zr);i.push(l)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Te(ae);return n.forEach(a=>{const i=new Ae(a,0),o=new Ae(a,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],l=>{r=r.add(l.Zr)})}),F.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,a=r.length+1;let i=r;X.isDocumentKey(i)||(i=i.child(""));const o=new Ae(new X(i),0);let l=new Te(ae);return this.Xr.forEachWhile(s=>{const d=s.key.path;return!!r.isPrefixOf(d)&&(d.length===a&&(l=l.add(s.Zr)),!0)},o),F.resolve(this.ni(l))}ni(t){const n=[];return t.forEach(r=>{const a=this.ei(r);a!==null&&n.push(a)}),n}removeMutationBatch(t,n){ue(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return F.forEach(n.mutations,a=>{const i=new Ae(a.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,a.key)}).next(()=>{this.Xr=r})}sr(t){}containsKey(t,n){const r=new Ae(n,0),a=this.Xr.firstAfterOrEqual(r);return F.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(t){return this.mutationQueue.length,F.resolve()}ri(t,n){return this.ti(t)}ti(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}ei(t){const n=this.ti(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(t){this.ii=t,this.docs=function(){return new ve(X.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,a=this.docs.get(r),i=a?a.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():He.newInvalidDocument(n))}getEntries(t,n){let r=vt();return n.forEach(a=>{const i=this.docs.get(a);r=r.insert(a,i?i.document.mutableCopy():He.newInvalidDocument(a))}),F.resolve(r)}getDocumentsMatchingQuery(t,n,r,a){let i=vt();const o=n.path,l=new X(o.child("__id-9223372036854775808__")),s=this.docs.getIteratorFrom(l);for(;s.hasNext();){const{key:d,value:{document:c}}=s.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||xp(wp(c),r)<=0||(a.has(c.key)||ha(n,c))&&(i=i.insert(c.key,c.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(t,n,r,a){Z(9500)}si(t,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new Km(this)}getSize(t){return F.resolve(this.size)}}class Km extends Fm{constructor(t){super(),this.Br=t}applyChanges(t){const n=[];return this.changes.forEach((r,a)=>{a.isValidDocument()?n.push(this.Br.addEntry(t,a)):this.Br.removeEntry(r)}),F.waitFor(n)}getFromCache(t,n){return this.Br.getEntry(t,n)}getAllFromCache(t,n){return this.Br.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(t){this.persistence=t,this.oi=new Qt(n=>Ji(n),Qi),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this._i=0,this.ai=new ao,this.targetCount=0,this.ui=vn.cr()}forEachTarget(t,n){return this.oi.forEach((r,a)=>n(a)),F.resolve()}getLastRemoteSnapshotVersion(t){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return F.resolve(this._i)}allocateTargetId(t){return this.highestTargetId=this.ui.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),F.resolve()}Tr(t){this.oi.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.ui=new vn(n),this.highestTargetId=n),t.sequenceNumber>this._i&&(this._i=t.sequenceNumber)}addTargetData(t,n){return this.Tr(n),this.targetCount+=1,F.resolve()}updateTargetData(t,n){return this.Tr(n),F.resolve()}removeTargetData(t,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(t,n,r){let a=0;const i=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(t,l.targetId)),a++)}),F.waitFor(i).next(()=>a)}getTargetCount(t){return F.resolve(this.targetCount)}getTargetData(t,n){const r=this.oi.get(n)||null;return F.resolve(r)}addMatchingKeys(t,n,r){return this.ai.Gr(n,r),F.resolve()}removeMatchingKeys(t,n,r){this.ai.jr(n,r);const a=this.persistence.referenceDelegate,i=[];return a&&n.forEach(o=>{i.push(a.markPotentiallyOrphaned(t,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(t,n){return this.ai.Hr(n),F.resolve()}getMatchingKeysForTargetId(t,n){const r=this.ai.Yr(n);return F.resolve(r)}containsKey(t,n){return F.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(t,n){this.ci={},this.overlays={},this.li=new la(0),this.hi=!1,this.hi=!0,this.Pi=new jm,this.referenceDelegate=t(this),this.Ti=new Gm(this),this.indexManager=new Om,this.remoteDocumentCache=function(a){return new Wm(a)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new Nm(n),this.Ei=new qm(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new Bm,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ci[t.toKey()];return r||(r=new Ym(n,this.referenceDelegate),this.ci[t.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(t,n,r){K("MemoryPersistence","Starting transaction:",t);const a=new Jm(this.li.next());return this.referenceDelegate.di(),r(a).next(i=>this.referenceDelegate.Ai(a).next(()=>i)).toPromise().then(i=>(a.raiseOnCommittedEvent(),i))}Ri(t,n){return F.or(Object.values(this.ci).map(r=>()=>r.containsKey(t,n)))}}class Jm extends kp{constructor(t){super(),this.currentSequenceNumber=t}}class io{constructor(t){this.persistence=t,this.Vi=new ao,this.mi=null}static fi(t){return new io(t)}get gi(){if(this.mi)return this.mi;throw Z(60996)}addReference(t,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),F.resolve()}removeReference(t,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),F.resolve()}markPotentiallyOrphaned(t,n){return this.gi.add(n.toString()),F.resolve()}removeTarget(t,n){this.Vi.Hr(n.targetId).forEach(a=>this.gi.add(a.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(a=>{a.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(t,n))}di(){this.mi=new Set}Ai(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.gi,r=>{const a=X.fromPath(r);return this.pi(t,a).next(i=>{i||n.removeEntry(a,te.min())})}).next(()=>(this.mi=null,n.apply(t)))}updateLimboDocument(t,n){return this.pi(t,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(t){return 0}pi(t,n){return F.or([()=>F.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ri(t,n)])}}class aa{constructor(t,n){this.persistence=t,this.yi=new Qt(r=>Sp(r.path),(r,a)=>r.isEqual(a)),this.garbageCollector=Hm(this,n)}static fi(t,n){return new aa(t,n)}di(){}Ai(t){return F.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}pr(t){const n=this.br(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(a=>r+a))}br(t){let n=0;return this.yr(t,r=>{n++}).next(()=>n)}yr(t,n){return F.forEach(this.yi,(r,a)=>this.Dr(t,r,a).next(i=>i?F.resolve():n(a)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const a=this.persistence.getRemoteDocumentCache(),i=a.newChangeBuffer();return a.si(t,o=>this.Dr(t,o,n).next(l=>{l||(r++,i.removeEntry(o,te.min()))})).next(()=>i.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.yi.set(n,t.currentSequenceNumber),F.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.yi.set(r,t.currentSequenceNumber),F.resolve()}removeReference(t,n,r){return this.yi.set(r,t.currentSequenceNumber),F.resolve()}updateLimboDocument(t,n){return this.yi.set(n,t.currentSequenceNumber),F.resolve()}Ii(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=Vr(t.data.value)),n}Dr(t,n,r){return F.or([()=>this.persistence.Ri(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const a=this.yi.get(n);return F.resolve(a!==void 0&&a>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(t,n,r,a){this.targetId=t,this.fromCache=n,this.ds=r,this.As=a}static Rs(t,n){let r=oe(),a=oe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new oo(t,n.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return Bh()?8:Tp(zh())>0?6:4}()}initialize(t,n){this.ys=t,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(t,n,r,a){const i={result:null};return this.ws(t,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.bs(t,n,a,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Qm;return this.Ss(t,n,o).next(l=>{if(i.result=l,this.fs)return this.Ds(t,n,o,l.size)})}).next(()=>i.result)}Ds(t,n,r,a){return r.documentReadCount<this.gs?(on()<=le.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",sn(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),F.resolve()):(on()<=le.DEBUG&&K("QueryEngine","Query:",sn(n),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.ps*a?(on()<=le.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",sn(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ot(n))):F.resolve())}ws(t,n){if(wl(n))return F.resolve(null);let r=ot(n);return this.indexManager.getIndexType(t,r).next(a=>a===0?null:(n.limit!==null&&a===1&&(n=Si(n,null,"F"),r=ot(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=oe(...i);return this.ys.getDocuments(t,o).next(l=>this.indexManager.getMinOffset(t,r).next(s=>{const d=this.vs(n,l);return this.Cs(n,d,o,s.readTime)?this.ws(t,Si(n,null,"F")):this.Fs(t,d,n,s)}))})))}bs(t,n,r,a){return wl(n)||a.isEqual(te.min())?F.resolve(null):this.ys.getDocuments(t,r).next(i=>{const o=this.vs(n,i);return this.Cs(n,o,r,a)?F.resolve(null):(on()<=le.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),sn(n)),this.Fs(t,o,n,bp(a,nr)).next(l=>l))})}vs(t,n){let r=new Te(Qd(t));return n.forEach((a,i)=>{ha(t,i)&&(r=r.add(i))}),r}Cs(t,n,r,a){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const i=t.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Ss(t,n,r){return on()<=le.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",sn(n)),this.ys.getDocumentsMatchingQuery(t,n,Ot.min(),r)}Fs(t,n,r,a){return this.ys.getDocumentsMatchingQuery(t,r,a).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so="LocalStore",Zm=3e8;class eg{constructor(t,n,r,a){this.persistence=t,this.Ms=n,this.serializer=a,this.xs=new ve(ae),this.Os=new Qt(i=>Ji(i),Qi),this.Ns=new Map,this.Bs=t.getRemoteDocumentCache(),this.Ti=t.getTargetCache(),this.Ei=t.getBundleCache(),this.Ls(r)}Ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new zm(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.xs))}}function tg(e,t,n,r){return new eg(e,t,n,r)}async function bc(e,t){const n=ne(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let a;return n.mutationQueue.getAllMutationBatches(r).next(i=>(a=i,n.Ls(t),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let s=oe();for(const d of a){o.push(d.batchId);for(const c of d.mutations)s=s.add(c.key)}for(const d of i){l.push(d.batchId);for(const c of d.mutations)s=s.add(c.key)}return n.localDocuments.getDocuments(r,s).next(d=>({ks:d,removedBatchIds:o,addedBatchIds:l}))})})}function ng(e,t){const n=ne(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const a=t.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(l,s,d,c){const u=d.batch,f=u.keys();let v=F.resolve();return f.forEach(g=>{v=v.next(()=>c.getEntry(s,g)).next(h=>{const p=d.docVersions.get(g);ue(p!==null,48541),h.version.compareTo(p)<0&&(u.applyToRemoteDocument(h,d),h.isValidDocument()&&(h.setReadTime(d.commitVersion),c.addEntry(h)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(s,u))}(n,r,t,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,a,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let s=oe();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(s=s.add(l.batch.mutations[d].key));return s}(t))).next(()=>n.localDocuments.getDocuments(r,a))})}function wc(e){const t=ne(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Ti.getLastRemoteSnapshotVersion(n))}function rg(e,t){const n=ne(e),r=t.snapshotVersion;let a=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});a=n.xs;const l=[];t.targetChanges.forEach((c,u)=>{const f=a.get(u);if(!f)return;l.push(n.Ti.removeMatchingKeys(i,c.removedDocuments,u).next(()=>n.Ti.addMatchingKeys(i,c.addedDocuments,u)));let v=f.withSequenceNumber(i.currentSequenceNumber);t.targetMismatches.get(u)!==null?v=v.withResumeToken(Ne.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):c.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(c.resumeToken,r)),a=a.insert(u,v),function(h,p,y){return h.resumeToken.approximateByteSize()===0||p.snapshotVersion.toMicroseconds()-h.snapshotVersion.toMicroseconds()>=Zm?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(f,v,c)&&l.push(n.Ti.updateTargetData(i,v))});let s=vt(),d=oe();if(t.documentUpdates.forEach(c=>{t.resolvedLimboDocuments.has(c)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,c))}),l.push(ag(i,o,t.documentUpdates).next(c=>{s=c.qs,d=c.Qs})),!r.isEqual(te.min())){const c=n.Ti.getLastRemoteSnapshotVersion(i).next(u=>n.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(c)}return F.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,s,d)).next(()=>s)}).then(i=>(n.xs=a,i))}function ag(e,t,n){let r=oe(),a=oe();return n.forEach(i=>r=r.add(i)),t.getEntries(e,r).next(i=>{let o=vt();return n.forEach((l,s)=>{const d=i.get(l);s.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(l)),s.isNoDocument()&&s.version.isEqual(te.min())?(t.removeEntry(l,s.readTime),o=o.insert(l,s)):!d.isValidDocument()||s.version.compareTo(d.version)>0||s.version.compareTo(d.version)===0&&d.hasPendingWrites?(t.addEntry(s),o=o.insert(l,s)):K(so,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",s.version)}),{qs:o,Qs:a}})}function ig(e,t){const n=ne(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=Wi),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function og(e,t){const n=ne(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let a;return n.Ti.getTargetData(r,t).next(i=>i?(a=i,F.resolve(a)):n.Ti.allocateTargetId(r).next(o=>(a=new St(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,a).next(()=>a))))}).then(r=>{const a=n.xs.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(t,r.targetId)),r})}async function Mi(e,t,n){const r=ne(e),a=r.xs.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,a))}catch(o){if(!Tn(o))throw o;K(so,`Failed to update sequence numbers for target ${t}: ${o}`)}r.xs=r.xs.remove(t),r.Os.delete(a.target)}function Rl(e,t,n){const r=ne(e);let a=te.min(),i=oe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(s,d,c){const u=ne(s),f=u.Os.get(c);return f!==void 0?F.resolve(u.xs.get(f)):u.Ti.getTargetData(d,c)}(r,o,ot(t)).next(l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,l.targetId).next(s=>{i=s})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,t,n?a:te.min(),n?i:oe())).next(l=>(sg(r,Wp(t),l),{documents:l,$s:i})))}function sg(e,t,n){let r=e.Ns.get(t)||te.min();n.forEach((a,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),e.Ns.set(t,r)}class Pl{constructor(){this.activeTargetIds=Zp()}js(t){this.activeTargetIds=this.activeTargetIds.add(t)}Hs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}zs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class lg{constructor(){this.xo=new Pl,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.xo.js(t),this.Oo[t]||"not-current"}updateQueryState(t,n,r){this.Oo[t]=n}removeLocalQueryTarget(t){this.xo.Hs(t)}isLocalQueryTarget(t){return this.xo.activeTargetIds.has(t)}clearQueryState(t){delete this.Oo[t]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(t){return this.xo.activeTargetIds.has(t)}start(){return this.xo=new Pl,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{No(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll="ConnectivityMonitor";class Vl{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(t){this.Qo.push(t)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){K(Ll,"Network connectivity changed: AVAILABLE");for(const t of this.Qo)t(0)}qo(){K(Ll,"Network connectivity changed: UNAVAILABLE");for(const t of this.Qo)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pr=null;function Oi(){return Pr===null?Pr=function(){return 268435456+Math.round(2147483648*Math.random())}():Pr++,"0x"+Pr.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai="RestConnection",cg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class _g{get Uo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+t.host,this.Wo=`projects/${r}/databases/${a}`,this.Go=this.databaseId.database===Qr?`project_id=${r}`:`project_id=${r}&database_id=${a}`}zo(t,n,r,a,i){const o=Oi(),l=this.jo(t,n.toUriEncodedString());K(ai,`Sending RPC '${t}' ${o}:`,l,r);const s={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(s,a,i);const{host:d}=new URL(l),c=Bi(d);return this.Jo(t,l,s,r,c).then(u=>(K(ai,`Received RPC '${t}' ${o}: `,u),u),u=>{throw fn(ai,`RPC '${t}' ${o} failed with error: `,u,"url: ",l,"request:",r),u})}Yo(t,n,r,a,i,o){return this.zo(t,n,r,a,i)}Ho(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+En}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,i)=>t[i]=a),r&&r.headers.forEach((a,i)=>t[i]=a)}jo(t,n){const r=cg[t];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(t){this.Zo=t.Zo,this.Xo=t.Xo}e_(t){this.t_=t}n_(t){this.r_=t}i_(t){this.s_=t}onMessage(t){this.o_=t}close(){this.Xo()}send(t){this.Zo(t)}__(){this.t_()}a_(){this.r_()}u_(t){this.s_(t)}c_(t){this.o_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pe="WebChannelConnection";class hg extends _g{constructor(t){super(t),this.l_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,n,r,a,i){const o=Oi();return new Promise((l,s)=>{const d=new Td;d.setWithCredentials(!0),d.listenOnce(Ad.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Lr.NO_ERROR:const u=d.getResponseJson();K(Pe,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(u)),l(u);break;case Lr.TIMEOUT:K(Pe,`RPC '${t}' ${o} timed out`),s(new G(z.DEADLINE_EXCEEDED,"Request time out"));break;case Lr.HTTP_ERROR:const f=d.getStatus();if(K(Pe,`RPC '${t}' ${o} failed with status:`,f,"response text:",d.getResponseText()),f>0){let v=d.getResponseJson();Array.isArray(v)&&(v=v[0]);const g=v==null?void 0:v.error;if(g&&g.status&&g.message){const h=function(y){const x=y.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(x)>=0?x:z.UNKNOWN}(g.status);s(new G(h,g.message))}else s(new G(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else s(new G(z.UNAVAILABLE,"Connection failed."));break;default:Z(9055,{h_:t,streamId:o,P_:d.getLastErrorCode(),T_:d.getLastError()})}}finally{K(Pe,`RPC '${t}' ${o} completed.`)}});const c=JSON.stringify(a);K(Pe,`RPC '${t}' ${o} sending request:`,a),d.send(n,"POST",c,r,15)})}I_(t,n,r){const a=Oi(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Cd(),l=Dd(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(s.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(s.useFetchStreams=!0),this.Ho(s.initMessageHeaders,n,r),s.encodeInitMessageHeaders=!0;const c=i.join("");K(Pe,`Creating RPC '${t}' stream ${a}: ${c}`,s);const u=o.createWebChannel(c,s);this.E_(u);let f=!1,v=!1;const g=new ug({Zo:p=>{v?K(Pe,`Not sending because RPC '${t}' stream ${a} is closed:`,p):(f||(K(Pe,`Opening RPC '${t}' stream ${a} transport.`),u.open(),f=!0),K(Pe,`RPC '${t}' stream ${a} sending:`,p),u.send(p))},Xo:()=>u.close()}),h=(p,y,x)=>{p.listen(y,S=>{try{x(S)}catch(O){setTimeout(()=>{throw O},0)}})};return h(u,qn.EventType.OPEN,()=>{v||(K(Pe,`RPC '${t}' stream ${a} transport opened.`),g.__())}),h(u,qn.EventType.CLOSE,()=>{v||(v=!0,K(Pe,`RPC '${t}' stream ${a} transport closed`),g.u_(),this.d_(u))}),h(u,qn.EventType.ERROR,p=>{v||(v=!0,fn(Pe,`RPC '${t}' stream ${a} transport errored. Name:`,p.name,"Message:",p.message),g.u_(new G(z.UNAVAILABLE,"The operation could not be completed")))}),h(u,qn.EventType.MESSAGE,p=>{var y;if(!v){const x=p.data[0];ue(!!x,16349);const S=x,O=(S==null?void 0:S.error)||((y=S[0])===null||y===void 0?void 0:y.error);if(O){K(Pe,`RPC '${t}' stream ${a} received error:`,O);const I=O.status;let N=function(b){const E=xe[b];if(E!==void 0)return lc(E)}(I),A=O.message;N===void 0&&(N=z.INTERNAL,A="Unknown error status: "+I+" with message "+O.message),v=!0,g.u_(new G(N,A)),u.close()}else K(Pe,`RPC '${t}' stream ${a} received:`,x),g.c_(x)}}),h(l,Sd.STAT_EVENT,p=>{p.stat===wi.PROXY?K(Pe,`RPC '${t}' stream ${a} detected buffering proxy`):p.stat===wi.NOPROXY&&K(Pe,`RPC '${t}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{g.a_()},0),g}terminate(){this.l_.forEach(t=>t.close()),this.l_=[]}E_(t){this.l_.push(t)}d_(t){this.l_=this.l_.filter(n=>n===t)}}function ii(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(e){return new gm(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(t,n,r=1e3,a=1.5,i=6e4){this.xi=t,this.timerId=n,this.A_=r,this.R_=a,this.V_=i,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(t){this.cancel();const n=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),a=Math.max(0,n-r);a>0&&K("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.m_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,a,()=>(this.g_=Date.now(),t())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l="PersistentStream";class Ec{constructor(t,n,r,a,i,o,l,s){this.xi=t,this.S_=r,this.D_=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=s,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new xc(t,n)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(t){this.U_(),this.stream.send(t)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(t,n){this.U_(),this.K_(),this.x_.cancel(),this.v_++,t!==4?this.x_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(gt(n.toString()),gt("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.i_(n)}W_(){}auth(){this.state=1;const t=this.G_(this.v_),n=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,a])=>{this.v_===n&&this.z_(r,a)},r=>{t(()=>{const a=new G(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(a)})})}z_(t,n){const r=this.G_(this.v_);this.stream=this.H_(t,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(a=>{r(()=>this.j_(a))}),this.stream.onMessage(a=>{r(()=>++this.M_==1?this.J_(a):this.onNext(a))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(t){return K($l,`close with error: ${t}`),this.stream=null,this.close(4,t)}G_(t){return n=>{this.xi.enqueueAndForget(()=>this.v_===t?n():(K($l,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class fg extends Ec{constructor(t,n,r,a,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,a,o),this.serializer=i}H_(t,n){return this.connection.I_("Listen",t,n)}J_(t){return this.onNext(t)}onNext(t){this.x_.reset();const n=bm(this.serializer,t),r=function(i){if(!("targetChange"in i))return te.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?st(o.readTime):te.min()}(t);return this.listener.Y_(n,r)}Z_(t){const n={};n.database=Ni(this.serializer),n.addTarget=function(i,o){let l;const s=o.target;if(l=Ai(s)?{documents:Em(i,s)}:{query:km(i,s).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=_c(i,o.resumeToken);const d=Di(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(te.min())>0){l.readTime=ra(i,o.snapshotVersion.toTimestamp());const d=Di(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,t);const r=Am(this.serializer,t);r&&(n.labels=r),this.Q_(n)}X_(t){const n={};n.database=Ni(this.serializer),n.removeTarget=t,this.Q_(n)}}class pg extends Ec{constructor(t,n,r,a,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,a,o),this.serializer=i}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(t,n){return this.connection.I_("Write",t,n)}J_(t){return ue(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ue(!t.writeResults||t.writeResults.length===0,55816),this.listener.na()}onNext(t){ue(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.x_.reset();const n=xm(t.writeResults,t.commitTime),r=st(t.commitTime);return this.listener.ra(r,n)}ia(){const t={};t.database=Ni(this.serializer),this.Q_(t)}ta(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>wm(this.serializer,r))};this.Q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{}class gg extends mg{constructor(t,n,r,a){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=a,this.sa=!1}oa(){if(this.sa)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.")}zo(t,n,r,a){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(t,Ci(n,r),a,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(z.UNKNOWN,i.toString())})}Yo(t,n,r,a,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(t,Ci(n,r),a,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(z.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class vg{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(t){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.la("Offline")))}set(t){this.Ta(),this._a=0,t==="Online"&&(this.ua=!1),this.la(t)}la(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ha(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(gt(n),this.ua=!1):K("OnlineStateTracker",n)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="RemoteStore";class yg{constructor(t,n,r,a,i){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=i,this.Ra.No(o=>{r.enqueueAndForget(async()=>{Xt(this)&&(K(Jt,"Restarting streams for network reachability change."),await async function(s){const d=ne(s);d.da.add(4),await cr(d),d.Va.set("Unknown"),d.da.delete(4),await va(d)}(this))})}),this.Va=new vg(r,a)}}async function va(e){if(Xt(e))for(const t of e.Aa)await t(!0)}async function cr(e){for(const t of e.Aa)await t(!1)}function kc(e,t){const n=ne(e);n.Ea.has(t.targetId)||(n.Ea.set(t.targetId,t),uo(n)?_o(n):An(n).N_()&&co(n,t))}function lo(e,t){const n=ne(e),r=An(n);n.Ea.delete(t),r.N_()&&Tc(n,t),n.Ea.size===0&&(r.N_()?r.k_():Xt(n)&&n.Va.set("Unknown"))}function co(e,t){if(e.ma.Ke(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(te.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}An(e).Z_(t)}function Tc(e,t){e.ma.Ke(t),An(e).X_(t)}function _o(e){e.ma=new hm({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Rt:t=>e.Ea.get(t)||null,Pt:()=>e.datastore.serializer.databaseId}),An(e).start(),e.Va.ca()}function uo(e){return Xt(e)&&!An(e).O_()&&e.Ea.size>0}function Xt(e){return ne(e).da.size===0}function Ac(e){e.ma=void 0}async function bg(e){e.Va.set("Online")}async function wg(e){e.Ea.forEach((t,n)=>{co(e,t)})}async function xg(e,t){Ac(e),uo(e)?(e.Va.Pa(t),_o(e)):e.Va.set("Unknown")}async function Eg(e,t,n){if(e.Va.set("Online"),t instanceof cc&&t.state===2&&t.cause)try{await async function(a,i){const o=i.cause;for(const l of i.targetIds)a.Ea.has(l)&&(await a.remoteSyncer.rejectListen(l,o),a.Ea.delete(l),a.ma.removeTarget(l))}(e,t)}catch(r){K(Jt,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await ia(e,r)}else if(t instanceof Fr?e.ma.Xe(t):t instanceof dc?e.ma.ot(t):e.ma.nt(t),!n.isEqual(te.min()))try{const r=await wc(e.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.ma.It(o);return l.targetChanges.forEach((s,d)=>{if(s.resumeToken.approximateByteSize()>0){const c=i.Ea.get(d);c&&i.Ea.set(d,c.withResumeToken(s.resumeToken,o))}}),l.targetMismatches.forEach((s,d)=>{const c=i.Ea.get(s);if(!c)return;i.Ea.set(s,c.withResumeToken(Ne.EMPTY_BYTE_STRING,c.snapshotVersion)),Tc(i,s);const u=new St(c.target,s,d,c.sequenceNumber);co(i,u)}),i.remoteSyncer.applyRemoteEvent(l)}(e,n)}catch(r){K(Jt,"Failed to raise snapshot:",r),await ia(e,r)}}async function ia(e,t,n){if(!Tn(t))throw t;e.da.add(1),await cr(e),e.Va.set("Offline"),n||(n=()=>wc(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{K(Jt,"Retrying IndexedDB access"),await n(),e.da.delete(1),await va(e)})}function Sc(e,t){return t().catch(n=>ia(e,n,t))}async function ya(e){const t=ne(e),n=Vt(t);let r=t.Ia.length>0?t.Ia[t.Ia.length-1].batchId:Wi;for(;kg(t);)try{const a=await ig(t.localStore,r);if(a===null){t.Ia.length===0&&n.k_();break}r=a.batchId,Tg(t,a)}catch(a){await ia(t,a)}Dc(t)&&Cc(t)}function kg(e){return Xt(e)&&e.Ia.length<10}function Tg(e,t){e.Ia.push(t);const n=Vt(e);n.N_()&&n.ea&&n.ta(t.mutations)}function Dc(e){return Xt(e)&&!Vt(e).O_()&&e.Ia.length>0}function Cc(e){Vt(e).start()}async function Ag(e){Vt(e).ia()}async function Sg(e){const t=Vt(e);for(const n of e.Ia)t.ta(n.mutations)}async function Dg(e,t,n){const r=e.Ia.shift(),a=to.from(r,t,n);await Sc(e,()=>e.remoteSyncer.applySuccessfulWrite(a)),await ya(e)}async function Cg(e,t){t&&Vt(e).ea&&await async function(r,a){if(function(o){return _m(o)&&o!==z.ABORTED}(a.code)){const i=r.Ia.shift();Vt(r).L_(),await Sc(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,a)),await ya(r)}}(e,t),Dc(e)&&Cc(e)}async function Hl(e,t){const n=ne(e);n.asyncQueue.verifyOperationInProgress(),K(Jt,"RemoteStore received new credentials");const r=Xt(n);n.da.add(3),await cr(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.da.delete(3),await va(n)}async function Ig(e,t){const n=ne(e);t?(n.da.delete(2),await va(n)):t||(n.da.add(2),await cr(n),n.Va.set("Unknown"))}function An(e){return e.fa||(e.fa=function(n,r,a){const i=ne(n);return i.oa(),new fg(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)}(e.datastore,e.asyncQueue,{e_:bg.bind(null,e),n_:wg.bind(null,e),i_:xg.bind(null,e),Y_:Eg.bind(null,e)}),e.Aa.push(async t=>{t?(e.fa.L_(),uo(e)?_o(e):e.Va.set("Unknown")):(await e.fa.stop(),Ac(e))})),e.fa}function Vt(e){return e.ga||(e.ga=function(n,r,a){const i=ne(n);return i.oa(),new pg(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)}(e.datastore,e.asyncQueue,{e_:()=>Promise.resolve(),n_:Ag.bind(null,e),i_:Cg.bind(null,e),na:Sg.bind(null,e),ra:Dg.bind(null,e)}),e.Aa.push(async t=>{t?(e.ga.L_(),await ya(e)):(await e.ga.stop(),e.Ia.length>0&&(K(Jt,`Stopping write stream with ${e.Ia.length} pending writes`),e.Ia=[]))})),e.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(t,n,r,a,i){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=i,this.deferred=new Kt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,a,i){const o=Date.now()+r,l=new ho(t,n,o,a,i);return l.start(r),l}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(z.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fo(e,t){if(gt("AsyncQueue",`${t}: ${e}`),Tn(e))return new G(z.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{static emptySet(t){return new hn(t.comparator)}constructor(t){this.comparator=t?(n,r)=>t(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=Bn(),this.sortedSet=new ve(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof hn)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,i=r.getNext().key;if(!a.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new hn;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(){this.pa=new ve(X.comparator)}track(t){const n=t.doc.key,r=this.pa.get(n);r?t.type!==0&&r.type===3?this.pa=this.pa.insert(n,t):t.type===3&&r.type!==1?this.pa=this.pa.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.pa=this.pa.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.pa=this.pa.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.pa=this.pa.remove(n):t.type===1&&r.type===2?this.pa=this.pa.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.pa=this.pa.insert(n,{type:2,doc:t.doc}):Z(63341,{Vt:t,ya:r}):this.pa=this.pa.insert(n,t)}wa(){const t=[];return this.pa.inorderTraversal((n,r)=>{t.push(r)}),t}}class yn{constructor(t,n,r,a,i,o,l,s,d){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=s,this.hasCachedResults=d}static fromInitialDocuments(t,n,r,a,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new yn(t,n,hn.emptySet(n),o,r,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ua(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==r[a].type||!n[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(t=>t.va())}}class Mg{constructor(){this.queries=Ul(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const a=ne(n),i=a.queries;a.queries=Ul(),i.forEach((o,l)=>{for(const s of l.Sa)s.onError(r)})})(this,new G(z.ABORTED,"Firestore shutting down"))}}function Ul(){return new Qt(e=>Jd(e),ua)}async function Og(e,t){const n=ne(e);let r=3;const a=t.query;let i=n.queries.get(a);i?!i.Da()&&t.va()&&(r=2):(i=new Ng,r=t.va()?0:1);try{switch(r){case 0:i.ba=await n.onListen(a,!0);break;case 1:i.ba=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(o){const l=fo(o,`Initialization of query '${sn(t.query)}' failed`);return void t.onError(l)}n.queries.set(a,i),i.Sa.push(t),t.Fa(n.onlineState),i.ba&&t.Ma(i.ba)&&po(n)}async function Rg(e,t){const n=ne(e),r=t.query;let a=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(t);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?a=t.va()?0:1:!i.Da()&&t.va()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Pg(e,t){const n=ne(e);let r=!1;for(const a of t){const i=a.query,o=n.queries.get(i);if(o){for(const l of o.Sa)l.Ma(a)&&(r=!0);o.ba=a}}r&&po(n)}function Lg(e,t,n){const r=ne(e),a=r.queries.get(t);if(a)for(const i of a.Sa)i.onError(n);r.queries.delete(t)}function po(e){e.Ca.forEach(t=>{t.next()})}var Ri,zl;(zl=Ri||(Ri={})).xa="default",zl.Cache="cache";class Vg{constructor(t,n,r){this.query=t,this.Oa=n,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(t){if(!this.options.includeMetadataChanges){const r=[];for(const a of t.docChanges)a.type!==3&&r.push(a);t=new yn(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.Na?this.La(t)&&(this.Oa.next(t),n=!0):this.ka(t,this.onlineState)&&(this.qa(t),n=!0),this.Ba=t,n}onError(t){this.Oa.error(t)}Fa(t){this.onlineState=t;let n=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,t)&&(this.qa(this.Ba),n=!0),n}ka(t,n){if(!t.fromCache||!this.va())return!0;const r=n!=="Offline";return(!this.options.Qa||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}La(t){if(t.docChanges.length>0)return!0;const n=this.Ba&&this.Ba.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}qa(t){t=yn.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Na=!0,this.Oa.next(t)}va(){return this.options.source!==Ri.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(t){this.key=t}}class Nc{constructor(t){this.key=t}}class $g{constructor(t,n){this.query=t,this.Ha=n,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=oe(),this.mutatedKeys=oe(),this.Za=Qd(t),this.Xa=new hn(this.Za)}get eu(){return this.Ha}tu(t,n){const r=n?n.nu:new Fl,a=n?n.Xa:this.Xa;let i=n?n.mutatedKeys:this.mutatedKeys,o=a,l=!1;const s=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(t.inorderTraversal((c,u)=>{const f=a.get(c),v=ha(this.query,u)?u:null,g=!!f&&this.mutatedKeys.has(f.key),h=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let p=!1;f&&v?f.data.isEqual(v.data)?g!==h&&(r.track({type:3,doc:v}),p=!0):this.ru(f,v)||(r.track({type:2,doc:v}),p=!0,(s&&this.Za(v,s)>0||d&&this.Za(v,d)<0)&&(l=!0)):!f&&v?(r.track({type:0,doc:v}),p=!0):f&&!v&&(r.track({type:1,doc:f}),p=!0,(s||d)&&(l=!0)),p&&(v?(o=o.add(v),i=h?i.add(c):i.delete(c)):(o=o.delete(c),i=i.delete(c)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const c=this.query.limitType==="F"?o.last():o.first();o=o.delete(c.key),i=i.delete(c.key),r.track({type:1,doc:c})}return{Xa:o,nu:r,Cs:l,mutatedKeys:i}}ru(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,a){const i=this.Xa;this.Xa=t.Xa,this.mutatedKeys=t.mutatedKeys;const o=t.nu.wa();o.sort((c,u)=>function(v,g){const h=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Z(20277,{Vt:p})}};return h(v)-h(g)}(c.type,u.type)||this.Za(c.doc,u.doc)),this.iu(r),a=a!=null&&a;const l=n&&!a?this.su():[],s=this.Ya.size===0&&this.current&&!a?1:0,d=s!==this.Ja;return this.Ja=s,o.length!==0||d?{snapshot:new yn(this.query,t.Xa,i,o,t.mutatedKeys,s===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:l}:{ou:l}}Fa(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new Fl,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(t){return!this.Ha.has(t)&&!!this.Xa.has(t)&&!this.Xa.get(t).hasLocalMutations}iu(t){t&&(t.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=t.current)}su(){if(!this.current)return[];const t=this.Ya;this.Ya=oe(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return t.forEach(r=>{this.Ya.has(r)||n.push(new Nc(r))}),this.Ya.forEach(r=>{t.has(r)||n.push(new Ic(r))}),n}au(t){this.Ha=t.$s,this.Ya=oe();const n=this.tu(t.documents);return this.applyChanges(n,!0)}uu(){return yn.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const mo="SyncEngine";class Hg{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class Fg{constructor(t){this.key=t,this.cu=!1}}class Ug{constructor(t,n,r,a,i,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new Qt(l=>Jd(l),ua),this.Pu=new Map,this.Tu=new Set,this.Iu=new ve(X.comparator),this.Eu=new Map,this.du=new ao,this.Au={},this.Ru=new Map,this.Vu=vn.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function zg(e,t,n=!0){const r=Vc(e);let a;const i=r.hu.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.uu()):a=await Mc(r,t,n,!0),a}async function qg(e,t){const n=Vc(e);await Mc(n,t,!0,!1)}async function Mc(e,t,n,r){const a=await og(e.localStore,ot(t)),i=a.targetId,o=e.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Bg(e,t,i,o==="current",a.resumeToken)),e.isPrimaryClient&&n&&kc(e.remoteStore,a),l}async function Bg(e,t,n,r,a){e.fu=(u,f,v)=>async function(h,p,y,x){let S=p.view.tu(y);S.Cs&&(S=await Rl(h.localStore,p.query,!1).then(({documents:A})=>p.view.tu(A,S)));const O=x&&x.targetChanges.get(p.targetId),I=x&&x.targetMismatches.get(p.targetId)!=null,N=p.view.applyChanges(S,h.isPrimaryClient,O,I);return Bl(h,p.targetId,N.ou),N.snapshot}(e,u,f,v);const i=await Rl(e.localStore,t,!0),o=new $g(t,i.$s),l=o.tu(i.documents),s=dr.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",a),d=o.applyChanges(l,e.isPrimaryClient,s);Bl(e,n,d.ou);const c=new Hg(t,n,o);return e.hu.set(t,c),e.Pu.has(n)?e.Pu.get(n).push(t):e.Pu.set(n,[t]),d.snapshot}async function jg(e,t,n){const r=ne(e),a=r.hu.get(t),i=r.Pu.get(a.targetId);if(i.length>1)return r.Pu.set(a.targetId,i.filter(o=>!ua(o,t))),void r.hu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await Mi(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&lo(r.remoteStore,a.targetId),Pi(r,a.targetId)}).catch(kn)):(Pi(r,a.targetId),await Mi(r.localStore,a.targetId,!0))}async function Yg(e,t){const n=ne(e),r=n.hu.get(t),a=n.Pu.get(r.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),lo(n.remoteStore,r.targetId))}async function Wg(e,t,n){const r=ev(e);try{const a=await function(o,l){const s=ne(o),d=we.now(),c=l.reduce((v,g)=>v.add(g.key),oe());let u,f;return s.persistence.runTransaction("Locally write mutations","readwrite",v=>{let g=vt(),h=oe();return s.Bs.getEntries(v,c).next(p=>{g=p,g.forEach((y,x)=>{x.isValidDocument()||(h=h.add(y))})}).next(()=>s.localDocuments.getOverlayedDocuments(v,g)).next(p=>{u=p;const y=[];for(const x of l){const S=om(x,u.get(x.key).overlayedDocument);S!=null&&y.push(new Ft(x.key,S,qd(S.value.mapValue),nt.exists(!0)))}return s.mutationQueue.addMutationBatch(v,d,y,l)}).next(p=>{f=p;const y=p.applyToLocalDocumentSet(u,h);return s.documentOverlayCache.saveOverlays(v,p.batchId,y)})}).then(()=>({batchId:f.batchId,changes:Zd(u)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(a.batchId),function(o,l,s){let d=o.Au[o.currentUser.toKey()];d||(d=new ve(ae)),d=d.insert(l,s),o.Au[o.currentUser.toKey()]=d}(r,a.batchId,n),await _r(r,a.changes),await ya(r.remoteStore)}catch(a){const i=fo(a,"Failed to persist write");n.reject(i)}}async function Oc(e,t){const n=ne(e);try{const r=await rg(n.localStore,t);t.targetChanges.forEach((a,i)=>{const o=n.Eu.get(i);o&&(ue(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?o.cu=!0:a.modifiedDocuments.size>0?ue(o.cu,14607):a.removedDocuments.size>0&&(ue(o.cu,42227),o.cu=!1))}),await _r(n,r,t)}catch(r){await kn(r)}}function ql(e,t,n){const r=ne(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const a=[];r.hu.forEach((i,o)=>{const l=o.view.Fa(t);l.snapshot&&a.push(l.snapshot)}),function(o,l){const s=ne(o);s.onlineState=l;let d=!1;s.queries.forEach((c,u)=>{for(const f of u.Sa)f.Fa(l)&&(d=!0)}),d&&po(s)}(r.eventManager,t),a.length&&r.lu.Y_(a),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Kg(e,t,n){const r=ne(e);r.sharedClientState.updateQueryState(t,"rejected",n);const a=r.Eu.get(t),i=a&&a.key;if(i){let o=new ve(X.comparator);o=o.insert(i,He.newNoDocument(i,te.min()));const l=oe().add(i),s=new ma(te.min(),new Map,new ve(ae),o,l);await Oc(r,s),r.Iu=r.Iu.remove(i),r.Eu.delete(t),go(r)}else await Mi(r.localStore,t,!1).then(()=>Pi(r,t,n)).catch(kn)}async function Gg(e,t){const n=ne(e),r=t.batch.batchId;try{const a=await ng(n.localStore,t);Pc(n,r,null),Rc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await _r(n,a)}catch(a){await kn(a)}}async function Jg(e,t,n){const r=ne(e);try{const a=await function(o,l){const s=ne(o);return s.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let c;return s.mutationQueue.lookupMutationBatch(d,l).next(u=>(ue(u!==null,37113),c=u.keys(),s.mutationQueue.removeMutationBatch(d,u))).next(()=>s.mutationQueue.performConsistencyCheck(d)).next(()=>s.documentOverlayCache.removeOverlaysForBatchId(d,c,l)).next(()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,c)).next(()=>s.localDocuments.getDocuments(d,c))})}(r.localStore,t);Pc(r,t,n),Rc(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await _r(r,a)}catch(a){await kn(a)}}function Rc(e,t){(e.Ru.get(t)||[]).forEach(n=>{n.resolve()}),e.Ru.delete(t)}function Pc(e,t,n){const r=ne(e);let a=r.Au[r.currentUser.toKey()];if(a){const i=a.get(t);i&&(n?i.reject(n):i.resolve(),a=a.remove(t)),r.Au[r.currentUser.toKey()]=a}}function Pi(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Pu.get(t))e.hu.delete(r),n&&e.lu.gu(r,n);e.Pu.delete(t),e.isPrimaryClient&&e.du.Hr(t).forEach(r=>{e.du.containsKey(r)||Lc(e,r)})}function Lc(e,t){e.Tu.delete(t.path.canonicalString());const n=e.Iu.get(t);n!==null&&(lo(e.remoteStore,n),e.Iu=e.Iu.remove(t),e.Eu.delete(n),go(e))}function Bl(e,t,n){for(const r of n)r instanceof Ic?(e.du.addReference(r.key,t),Qg(e,r)):r instanceof Nc?(K(mo,"Document no longer in limbo: "+r.key),e.du.removeReference(r.key,t),e.du.containsKey(r.key)||Lc(e,r.key)):Z(19791,{pu:r})}function Qg(e,t){const n=t.key,r=n.path.canonicalString();e.Iu.get(n)||e.Tu.has(r)||(K(mo,"New document in limbo: "+n),e.Tu.add(r),go(e))}function go(e){for(;e.Tu.size>0&&e.Iu.size<e.maxConcurrentLimboResolutions;){const t=e.Tu.values().next().value;e.Tu.delete(t);const n=new X(me.fromString(t)),r=e.Vu.next();e.Eu.set(r,new Fg(n)),e.Iu=e.Iu.insert(n,r),kc(e.remoteStore,new St(ot(Xi(n.path)),r,"TargetPurposeLimboResolution",la.le))}}async function _r(e,t,n){const r=ne(e),a=[],i=[],o=[];r.hu.isEmpty()||(r.hu.forEach((l,s)=>{o.push(r.fu(s,t,n).then(d=>{var c;if((d||n)&&r.isPrimaryClient){const u=d?!d.fromCache:(c=n==null?void 0:n.targetChanges.get(s.targetId))===null||c===void 0?void 0:c.current;r.sharedClientState.updateQueryState(s.targetId,u?"current":"not-current")}if(d){a.push(d);const u=oo.Rs(s.targetId,d);i.push(u)}}))}),await Promise.all(o),r.lu.Y_(a),await async function(s,d){const c=ne(s);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>F.forEach(d,f=>F.forEach(f.ds,v=>c.persistence.referenceDelegate.addReference(u,f.targetId,v)).next(()=>F.forEach(f.As,v=>c.persistence.referenceDelegate.removeReference(u,f.targetId,v)))))}catch(u){if(!Tn(u))throw u;K(so,"Failed to update sequence numbers: "+u)}for(const u of d){const f=u.targetId;if(!u.fromCache){const v=c.xs.get(f),g=v.snapshotVersion,h=v.withLastLimboFreeSnapshotVersion(g);c.xs=c.xs.insert(f,h)}}}(r.localStore,i))}async function Xg(e,t){const n=ne(e);if(!n.currentUser.isEqual(t)){K(mo,"User change. New user:",t.toKey());const r=await bc(n.localStore,t);n.currentUser=t,function(i,o){i.Ru.forEach(l=>{l.forEach(s=>{s.reject(new G(z.CANCELLED,o))})}),i.Ru.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await _r(n,r.ks)}}function Zg(e,t){const n=ne(e),r=n.Eu.get(t);if(r&&r.cu)return oe().add(r.key);{let a=oe();const i=n.Pu.get(t);if(!i)return a;for(const o of i){const l=n.hu.get(o);a=a.unionWith(l.view.eu)}return a}}function Vc(e){const t=ne(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Oc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Zg.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Kg.bind(null,t),t.lu.Y_=Pg.bind(null,t.eventManager),t.lu.gu=Lg.bind(null,t.eventManager),t}function ev(e){const t=ne(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Gg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Jg.bind(null,t),t}class oa{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ga(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Su(t),await this.persistence.start(),this.localStore=this.Du(t),this.gcScheduler=this.vu(t,this.localStore),this.indexBackfillerScheduler=this.Cu(t,this.localStore)}vu(t,n){return null}Cu(t,n){return null}Du(t){return tg(this.persistence,new Xm,t.initialUser,this.serializer)}Su(t){return new yc(io.fi,this.serializer)}bu(t){return new lg}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}oa.provider={build:()=>new oa};class tv extends oa{constructor(t){super(),this.cacheSizeBytes=t}vu(t,n){ue(this.persistence.referenceDelegate instanceof aa,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Vm(r,t.asyncQueue,n)}Su(t){const n=this.cacheSizeBytes!==void 0?je.withCacheSize(this.cacheSizeBytes):je.DEFAULT;return new yc(r=>aa.fi(r,n),this.serializer)}}class Li{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ql(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xg.bind(null,this.syncEngine),await Ig(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new Mg}()}createDatastore(t){const n=ga(t.databaseInfo.databaseId),r=function(i){return new hg(i)}(t.databaseInfo);return function(i,o,l,s){return new gg(i,o,l,s)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,a,i,o,l){return new yg(r,a,i,o,l)}(this.localStore,this.datastore,t.asyncQueue,n=>ql(this.syncEngine,n,0),function(){return Vl.C()?new Vl:new dg}())}createSyncEngine(t,n){return function(a,i,o,l,s,d,c){const u=new Ug(a,i,o,l,s,d);return c&&(u.mu=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(a){const i=ne(a);K(Jt,"RemoteStore shutting down."),i.da.add(5),await cr(i),i.Ra.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Li.provider={build:()=>new Li};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Mu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Mu(this.observer.error,t):gt("Uncaught Error in snapshot listener:",t.toString()))}xu(){this.muted=!0}Mu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $t="FirestoreClient";class rv{constructor(t,n,r,a,i){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=$e.UNAUTHENTICATED,this.clientId=Od.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{K($t,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(K($t,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Kt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=fo(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function oi(e,t){e.asyncQueue.verifyOperationInProgress(),K($t,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async a=>{r.isEqual(a)||(await bc(t.localStore,a),r=a)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function jl(e,t){e.asyncQueue.verifyOperationInProgress();const n=await av(e);K($t,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>Hl(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,a)=>Hl(t.remoteStore,a)),e._onlineComponents=t}async function av(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){K($t,"Using user provided OfflineComponentProvider");try{await oi(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(a){return a.name==="FirebaseError"?a.code===z.FAILED_PRECONDITION||a.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(n))throw n;fn("Error using user provided cache. Falling back to memory cache: "+n),await oi(e,new oa)}}else K($t,"Using default OfflineComponentProvider"),await oi(e,new tv(void 0));return e._offlineComponents}async function $c(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(K($t,"Using user provided OnlineComponentProvider"),await jl(e,e._uninitializedComponentsProvider._online)):(K($t,"Using default OnlineComponentProvider"),await jl(e,new Li))),e._onlineComponents}function iv(e){return $c(e).then(t=>t.syncEngine)}async function Yl(e){const t=await $c(e),n=t.eventManager;return n.onListen=zg.bind(null,t.syncEngine),n.onUnlisten=jg.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=qg.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Yg.bind(null,t.syncEngine),n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(e,t,n){if(!n)throw new G(z.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function ov(e,t,n,r){if(t===!0&&r===!0)throw new G(z.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Kl(e){if(!X.isDocumentKey(e))throw new G(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Gl(e){if(X.isDocumentKey(e))throw new G(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function vo(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Z(12329,{type:typeof e})}function Nt(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new G(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=vo(e);throw new G(z.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc="firestore.googleapis.com",Jl=!0;class Ql{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new G(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Uc,this.ssl=Jl}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:Jl;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=vc;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<Pm)throw new G(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}ov("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Hc((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,a){return r.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ba{constructor(t,n,r,a){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ql({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new G(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ql(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new _p;switch(r.type){case"firstParty":return new pp(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Wl.get(n);r&&(K("ComponentProvider","Removing Datastore"),Wl.delete(n),r.terminate())}(this),Promise.resolve()}}function sv(e,t,n,r={}){var a;e=Nt(e,ba);const i=Bi(t),o=e._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),s=`${t}:${n}`;i&&(Vh(`https://${s}`),Uh("Firestore",!0)),o.host!==Uc&&o.host!==s&&fn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:s,ssl:i,emulatorOptions:r});if(!Wr(d,l)&&(e._setSettings(d),r.mockUserToken)){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=$e.MOCK_USER;else{c=$h(r.mockUserToken,(a=e._app)===null||a===void 0?void 0:a.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new G(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new $e(f)}e._authCredentials=new up(new Nd(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new wa(this.firestore,t,this._query)}}class Je{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mt(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Je(this.firestore,t,this._key)}}class Mt extends wa{constructor(t,n,r){super(t,n,Xi(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Je(this.firestore,null,new X(t))}withConverter(t){return new Mt(this.firestore,t,this._path)}}function lv(e,t,...n){if(e=pt(e),Fc("collection","path",t),e instanceof ba){const r=me.fromString(t,...n);return Gl(r),new Mt(e,null,r)}{if(!(e instanceof Je||e instanceof Mt))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(me.fromString(t,...n));return Gl(r),new Mt(e.firestore,null,r)}}function yo(e,t,...n){if(e=pt(e),arguments.length===1&&(t=Od.newId()),Fc("doc","path",t),e instanceof ba){const r=me.fromString(t,...n);return Kl(r),new Je(e,null,new X(r))}{if(!(e instanceof Je||e instanceof Mt))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(me.fromString(t,...n));return Kl(r),new Je(e.firestore,e instanceof Mt?e.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl="AsyncQueue";class Zl{constructor(t=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new xc(this,"async_queue_retry"),this.rc=()=>{const r=ii();r&&K(Xl,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=t;const n=ii();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.oc(),this._c(t)}enterRestrictedMode(t){if(!this.Yu){this.Yu=!0,this.tc=t||!1;const n=ii();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.rc)}}enqueue(t){if(this.oc(),this.Yu)return new Promise(()=>{});const n=new Kt;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ju.push(t),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(t){if(!Tn(t))throw t;K(Xl,"Operation failed with retryable error: "+t)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(t){const n=this.sc.then(()=>(this.ec=!0,t().catch(r=>{throw this.Xu=r,this.ec=!1,gt("INTERNAL UNHANDLED ERROR: ",ed(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=n,n}enqueueAfterDelay(t,n,r){this.oc(),this.nc.indexOf(t)>-1&&(n=0);const a=ho.createAndSchedule(this,t,n,r,i=>this.uc(i));return this.Zu.push(a),a}oc(){this.Xu&&Z(47125,{cc:ed(this.Xu)})}verifyOperationInProgress(){}async lc(){let t;do t=this.sc,await t;while(t!==this.sc)}hc(t){for(const n of this.Zu)if(n.timerId===t)return!0;return!1}Pc(t){return this.lc().then(()=>{this.Zu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Zu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.lc()})}Tc(t){this.nc.push(t)}uc(t){const n=this.Zu.indexOf(t);this.Zu.splice(n,1)}}function ed(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function td(e){return function(n,r){if(typeof n!="object"||n===null)return!1;const a=n;for(const i of r)if(i in a&&typeof a[i]=="function")return!0;return!1}(e,["next","error","complete"])}class bn extends ba{constructor(t,n,r,a){super(t,n,r,a),this.type="firestore",this._queue=new Zl,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Zl(t),this._firestoreClient=void 0,await t}}}function dv(e,t){const n=typeof e=="object"?e:Xf(),r=typeof e=="string"?e:Qr,a=Wf(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const i=Ph("firestore");i&&sv(a,...i)}return a}function zc(e){if(e._terminated)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||cv(e),e._firestoreClient}function cv(e){var t,n,r;const a=e._freezeSettings(),i=function(l,s,d,c){return new Ip(l,s,d,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Hc(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||!((n=a.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=a.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new rv(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(l){const s=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(s),_online:s}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(t){this._byteString=t}static fromBase64String(t){try{return new wn(Ne.fromBase64String(t))}catch(n){throw new G(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new wn(Ne.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new G(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ie(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new G(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new G(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ae(this._lat,t._lat)||ae(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,a){if(r.length!==a.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==a[i])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v=/^__.*__$/;class uv{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Ft(t,this.data,this.fieldMask,n,this.fieldTransforms):new lr(t,this.data,n,this.fieldTransforms)}}class qc{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new Ft(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function Bc(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Z(40011,{Ic:e})}}class Eo{constructor(t,n,r,a,i,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=a,i===void 0&&this.Ec(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(t){return new Eo(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),a=this.dc({path:r,Rc:!1});return a.Vc(t),a}mc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),a=this.dc({path:r,Rc:!1});return a.Ec(),a}fc(t){return this.dc({path:void 0,Rc:!0})}gc(t){return sa(t,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ec(){if(this.path)for(let t=0;t<this.path.length;t++)this.Vc(this.path.get(t))}Vc(t){if(t.length===0)throw this.gc("Document fields must not be empty");if(Bc(this.Ic)&&_v.test(t))throw this.gc('Document fields cannot begin and end with "__"')}}class hv{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||ga(t)}bc(t,n,r,a=!1){return new Eo({Ic:t,methodName:n,wc:r,path:Ie.emptyPath(),Rc:!1,yc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jc(e){const t=e._freezeSettings(),n=ga(e._databaseId);return new hv(e._databaseId,!!t.ignoreUndefinedProperties,n)}function fv(e,t,n,r,a,i={}){const o=e.bc(i.merge||i.mergeFields?2:0,t,n,a);ko("Data must be an object, but it was:",o,r);const l=Yc(r,o);let s,d;if(i.merge)s=new Ge(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const c=[];for(const u of i.mergeFields){const f=Vi(t,u,n);if(!o.contains(f))throw new G(z.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Kc(c,f)||c.push(f)}s=new Ge(c),d=o.fieldTransforms.filter(u=>s.covers(u.field))}else s=null,d=o.fieldTransforms;return new uv(new Ye(l),s,d)}class Ea extends bo{_toFieldTransform(t){if(t.Ic!==2)throw t.Ic===1?t.gc(`${this._methodName}() can only appear at the top level of your update data`):t.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Ea}}function pv(e,t,n,r){const a=e.bc(1,t,n);ko("Data must be an object, but it was:",a,r);const i=[],o=Ye.empty();Ht(r,(s,d)=>{const c=To(t,s,n);d=pt(d);const u=a.mc(c);if(d instanceof Ea)i.push(c);else{const f=ka(d,u);f!=null&&(i.push(c),o.set(c,f))}});const l=new Ge(i);return new qc(o,l,a.fieldTransforms)}function mv(e,t,n,r,a,i){const o=e.bc(1,t,n),l=[Vi(t,r,n)],s=[a];if(i.length%2!=0)throw new G(z.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push(Vi(t,i[f])),s.push(i[f+1]);const d=[],c=Ye.empty();for(let f=l.length-1;f>=0;--f)if(!Kc(d,l[f])){const v=l[f];let g=s[f];g=pt(g);const h=o.mc(v);if(g instanceof Ea)d.push(v);else{const p=ka(g,h);p!=null&&(d.push(v),c.set(v,p))}}const u=new Ge(d);return new qc(c,u,o.fieldTransforms)}function ka(e,t){if(Wc(e=pt(e)))return ko("Unsupported field value:",t,e),Yc(e,t);if(e instanceof bo)return function(r,a){if(!Bc(a.Ic))throw a.gc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.gc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(a);i&&a.fieldTransforms.push(i)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Rc&&t.Ic!==4)throw t.gc("Nested arrays are not supported");return function(r,a){const i=[];let o=0;for(const l of r){let s=ka(l,a.fc(o));s==null&&(s={nullValue:"NULL_VALUE"}),i.push(s),o++}return{arrayValue:{values:i}}}(e,t)}return function(r,a){if((r=pt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return em(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=we.fromDate(r);return{timestampValue:ra(a.serializer,i)}}if(r instanceof we){const i=new we(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ra(a.serializer,i)}}if(r instanceof wo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof wn)return{bytesValue:_c(a.serializer,r._byteString)};if(r instanceof Je){const i=a.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw a.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ro(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof xo)return function(o,l){return{mapValue:{fields:{[Ud]:{stringValue:zd},[Xr]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.gc("VectorValues must only contain numeric values.");return Zi(l.serializer,d)})}}}}}}(r,a);throw a.gc(`Unsupported field value: ${vo(r)}`)}(e,t)}function Yc(e,t){const n={};return Pd(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ht(e,(r,a)=>{const i=ka(a,t.Ac(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Wc(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof we||e instanceof wo||e instanceof wn||e instanceof Je||e instanceof bo||e instanceof xo)}function ko(e,t,n){if(!Wc(n)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(n)){const r=vo(n);throw r==="an object"?t.gc(e+" a custom object"):t.gc(e+" "+r)}}function Vi(e,t,n){if((t=pt(t))instanceof xa)return t._internalPath;if(typeof t=="string")return To(e,t);throw sa("Field path arguments must be of type string or ",e,!1,void 0,n)}const gv=new RegExp("[~\\*/\\[\\]]");function To(e,t,n){if(t.search(gv)>=0)throw sa(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new xa(...t.split("."))._internalPath}catch{throw sa(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function sa(e,t,n,r,a){const i=r&&!r.isEmpty(),o=a!==void 0;let l=`Function ${t}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let s="";return(i||o)&&(s+=" (found",i&&(s+=` in field ${r}`),o&&(s+=` in document ${a}`),s+=")"),new G(z.INVALID_ARGUMENT,l+e+s)}function Kc(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(t,n,r,a,i){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new vv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(Jc("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class vv extends Gc{data(){return super.data()}}function Jc(e,t){return typeof t=="string"?To(e,t):t instanceof xa?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new G(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bv{convertValue(t,n="none"){switch(Lt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return be(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Pt(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw Z(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Ht(t,(a,i)=>{r[a]=this.convertValue(i,n)}),r}convertVectorValue(t){var n,r,a;const i=(a=(r=(n=t.fields)===null||n===void 0?void 0:n[Xr].arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.map(o=>be(o.doubleValue));return new xo(i)}convertGeoPoint(t){return new wo(be(t.latitude),be(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=ca(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(rr(t));default:return null}}convertTimestamp(t){const n=Rt(t);return new we(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=me.fromString(t);ue(gc(r),9688,{name:t});const a=new ar(r.get(1),r.get(3)),i=new X(r.popFirst(5));return a.isEqual(n)||gt(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(e,t,n){let r;return r=e?e.toFirestore(t):t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Qc extends Gc{constructor(t,n,r,a,i,o){super(t,n,r,a,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new Ur(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(Jc("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ur extends Qc{data(t={}){return super.data(t)}}class xv{constructor(t,n,r,a){this._firestore=t,this._userDataWriter=n,this._snapshot=a,this.metadata=new Yn(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new Ur(this._firestore,this._userDataWriter,r.key,r,new Yn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(a,i){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map(l=>{const s=new Ur(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Yn(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:s,oldIndex:-1,newIndex:o++}})}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const s=new Ur(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Yn(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,c=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),c=o.indexOf(l.doc.key)),{type:Ev(l.type),doc:s,oldIndex:d,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Ev(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z(61501,{type:e})}}class Xc extends bv{constructor(t){super(),this.firestore=t}convertBytes(t){return new wn(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Je(this.firestore,null,n)}}function kv(e,t,n,...r){e=Nt(e,Je);const a=Nt(e.firestore,bn),i=jc(a);let o;return o=typeof(t=pt(t))=="string"||t instanceof xa?mv(i,"updateDoc",e._key,t,n,r):pv(i,"updateDoc",e._key,t),Ao(a,[o.toMutation(e._key,nt.exists(!0))])}function Tv(e){return Ao(Nt(e.firestore,bn),[new eo(e._key,nt.none())])}function Av(e,t){const n=Nt(e.firestore,bn),r=yo(e),a=wv(e.converter,t);return Ao(n,[fv(jc(e.firestore),"addDoc",r._key,a,e.converter!==null,{}).toMutation(r._key,nt.exists(!1))]).then(()=>r)}function Sv(e,...t){var n,r,a;e=pt(e);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof t[o]!="object"||td(t[o])||(i=t[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(td(t[o])){const u=t[o];t[o]=(n=u.next)===null||n===void 0?void 0:n.bind(u),t[o+1]=(r=u.error)===null||r===void 0?void 0:r.bind(u),t[o+2]=(a=u.complete)===null||a===void 0?void 0:a.bind(u)}let s,d,c;if(e instanceof Je)d=Nt(e.firestore,bn),c=Xi(e._key.path),s={next:u=>{t[o]&&t[o](Dv(d,e,u))},error:t[o+1],complete:t[o+2]};else{const u=Nt(e,wa);d=Nt(u.firestore,bn),c=u._query;const f=new Xc(d);s={next:v=>{t[o]&&t[o](new xv(d,f,u,v))},error:t[o+1],complete:t[o+2]},yv(e._query)}return function(f,v,g,h){const p=new nv(h),y=new Vg(v,p,g);return f.asyncQueue.enqueueAndForget(async()=>Og(await Yl(f),y)),()=>{p.xu(),f.asyncQueue.enqueueAndForget(async()=>Rg(await Yl(f),y))}}(zc(d),c,l,s)}function Ao(e,t){return function(r,a){const i=new Kt;return r.asyncQueue.enqueueAndForget(async()=>Wg(await iv(r),a,i)),i.promise}(zc(e),t)}function Dv(e,t,n){const r=n.docs.get(t._key),a=new Xc(e);return new Qc(e,a,t._key,r,new Yn(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(a){En=a})(Qf),Gr(new er("firestore",(r,{instanceIdentifier:a,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new bn(new hp(r.getProvider("auth-internal")),new mp(o,r.getProvider("app-check-internal")),function(d,c){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new G(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ar(d.options.projectId,c)}(o,a),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),un(al,il,t),un(al,il,"esm2017")})();const Cv={apiKey:"AIzaSyBZtEdhST7BD-yIw2buJelAtnJ9uFT3WiA",authDomain:"scheduler-with-firebase.firebaseapp.com",projectId:"scheduler-with-firebase",storageBucket:"scheduler-with-firebase.firebasestorage.app",messagingSenderId:"512323964322",appId:"1:512323964322:web:9b3478a50226fae4f936fb",measurementId:"G-90JM6QYPJ9"},Iv=wd(Cv),So=dv(Iv);Fe.config.details_on_dblclick=!0;Fe.config.details_on_create=!0;Fe.config.header=["day","week","month","date","prev","today","next"];Fe.init("scheduler_here",new Date(2022,3,20),"week");Fe.parse([{start_date:"2022-04-18 09:00",end_date:"2022-04-18 12:00",text:"English lesson"},{start_date:"2022-04-20 10:00",end_date:"2022-04-21 16:00",text:"Math exam"},{start_date:"2022-04-21 10:00",end_date:"2022-04-21 14:00",text:"Science lesson"},{start_date:"2022-04-23 16:00",end_date:"2022-04-23 17:00",text:"English lesson"},{start_date:"2022-04-22 09:00",end_date:"2022-04-22 17:00",text:"Usual event"}]);const Zc=lv(So,"events");Sv(Zc,e=>{e.docChanges().forEach(t=>{const n=t.doc.data();switch(n.start_date=n.start_date.toDate(),n.end_date=n.end_date.toDate(),t.type){case"added":Fe.getEvent(t.doc.id)||Fe.addEvent({id:t.doc.id,...n});break;case"modified":Fe.addEvent({id:t.doc.id,...n});break;case"removed":Fe.deleteEvent(t.doc.id)}})});const e_=e=>({text:e.text,start_date:we.fromDate(new Date(e.start_date)),end_date:we.fromDate(new Date(e.end_date))});Fe.attachEvent("onEventAdded",async(e,t)=>{if(t._remote)return!0;const{id:n,...r}=t,a=await Av(Zc,e_(r));return Fe.changeEventId(n,a.id),!0});Fe.attachEvent("onEventChanged",(e,t)=>t._remote?!0:kv(yo(So,"events",e),e_(t)));Fe.attachEvent("onEventDeleted",e=>Tv(yo(So,"events",e)));
