(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();/** @license

dhtmlxScheduler v.7.2.5 Standard

To use dhtmlxScheduler in non-GPL projects (and get Pro version of the product), please obtain Commercial/Enterprise or Ultimate license on our site https://dhtmlx.com/docs/products/dhtmlxScheduler/#licensing or contact us at sales@dhtmlx.com

(c) XB Software Ltd.

*/const ct=typeof window<"u"?window:global;function Dc(e){let t=[],n=!1,r=null,i=null;function a(){return e.config.drag_highlight&&e.markTimespan}function o(d){const c=e.getView(d);return c?c.layout:d}function l(d){const{event:c,layout:u,viewName:f,sectionId:y,eventNode:g}=d;(function(v,x){switch(x){case"month":v.style.top="",v.style.left="";break;case"timeline":v.style.left="",v.style.marginLeft="1px";break;default:v.style.top=""}})(g,u);const h={};let p={start_date:c.start_date,end_date:c.end_date,css:"dhx_scheduler_dnd_marker",html:g};if(u=="timeline"){const v=e.getView(f);if(v.round_position){const x=e._get_date_index(v,c.start_date),S=v._trace_x[x];p.start_date=S}}return u!="timeline"&&u!="month"||(p={...p,end_date:e.date.add(c.start_date,1,"minute")}),y&&(h[f]=y,p.sections=h),p}function s(d){const{layout:c}=d;let u;switch(c){case"month":u=function(f){let y=[];const{event:g,layout:h,viewName:p,sectionId:v}=f,x=[];let S=new Date(g.start_date);for(;S.valueOf()<g.end_date.valueOf();){let N={start_date:S};x.push(N),S=e.date.week_start(e.date.add(S,1,"week"))}let O=e.$container.querySelectorAll(`[${e.config.event_attribute}='${g.id}']`);for(let N=0;N<O.length;N++){const I={event:x[N],layout:h,viewName:p,sectionId:v,eventNode:O[N].cloneNode(!0)};y.push(l(I))}return y}(d);break;case"timeline":case"units":u=function(f){let y=[];const{event:g,layout:h,viewName:p,eventNode:v}=f;let x=function(S){const O=e.getView(S);return O.y_property?O.y_property:O.map_to?O.map_to:void 0}(p);if(x){const S=String(g[x]).split(e.config.section_delimiter).map(N=>String(N)),O=[];for(let N=0;N<S.length;N++){O[N]=v.cloneNode(!0);const I={event:g,layout:h,viewName:p,sectionId:S[N],eventNode:O[N]};y.push(l(I))}}return y}(d);break;default:u=function(f){const{event:y,layout:g,viewName:h,sectionId:p}=f;let v=[],x=e.$container.querySelectorAll(`[${e.config.event_attribute}='${y.id}']:not(.dhx_cal_select_menu):not(.dhx_drag_marker)`);if(x)for(let S=0;S<x.length;S++){let O=x[S].cloneNode(!0);const N={event:{start_date:new Date(+O.getAttribute("data-bar-start")),end_date:new Date(+O.getAttribute("data-bar-end"))},layout:g,viewName:h,sectionId:p,eventNode:O};v.push(l(N))}return v}(d)}u.forEach(f=>{t.push(e.markTimespan(f))})}e.attachEvent("onBeforeDrag",function(d,c,u){return a()&&(n=!0,i=e.getEvent(d),r=u.target.closest(`[${e.config.event_attribute}]`),o(e.getState().mode)=="units"&&e.config.cascade_event_display&&(e.unselect(d),r=u.target.closest(`[${e.config.event_attribute}]`))),!0}),e.attachEvent("onEventDrag",function(d,c,u){if(n&&a()){n=!1;const f=e.getState().mode,y=o(f),g=e.getActionData(u).section;i&&s({event:i,layout:y,viewName:f,sectionId:g,eventNode:r})}}),e.attachEvent("onDragEnd",function(d,c,u){for(let f=0;f<t.length;f++)e.unmarkTimespan(t[f]);t=[],r=null,i=null})}function Cc(e){e.config.mark_now=!0,e.config.display_marked_timespans=!0,e.config.overwrite_marked_timespans=!0;var t="dhx_time_block",n="default",r=function(a,o,l){var s=typeof a=="object"?a:{days:a};return s.type=t,s.css="",o&&(l&&(s.sections=l),s=function(d,c,u){return c instanceof Date&&u instanceof Date?(d.start_date=c,d.end_date=u):(d.days=c,d.zones=u),d}(s,a,o)),s};function i(a,o,l,s,d){var c=e,u=[],f={_props:"map_to",matrix:"y_property"};for(var y in f){var g=f[y];if(c[y])for(var h in c[y]){var p=c[y][h][g];a[p]&&(u=c._add_timespan_zones(u,e._get_blocked_zones(o[h],a[p],l,s,d)))}}return u=c._add_timespan_zones(u,e._get_blocked_zones(o,"global",l,s,d))}e.blockTime=function(a,o,l){var s=r(a,o,l);return e.addMarkedTimespan(s)},e.unblockTime=function(a,o,l){var s=r(a,o=o||"fullday",l);return e.deleteMarkedTimespan(s)},e.checkInMarkedTimespan=function(a,o,l){o=o||n;for(var s=!0,d=new Date(a.start_date.valueOf()),c=e.date.add(d,1,"day"),u=e._marked_timespans;d<a.end_date;d=e.date.date_part(c),c=e.date.add(d,1,"day")){var f=+e.date.date_part(new Date(d)),y=i(a,u,d.getDay(),f,o);if(y)for(var g=0;g<y.length;g+=2){var h=e._get_zone_minutes(d),p=a.end_date>c||a.end_date.getDate()!=d.getDate()?1440:e._get_zone_minutes(a.end_date),v=y[g],x=y[g+1];if(v<p&&x>h&&!(s=typeof l=="function"&&l(a,h,p,v,x)))break}}return!s},e.checkLimitViolation=function(a){if(!a||!e.config.check_limits)return!0;var o=e,l=o.config,s=[];if(a.rec_type&&a._end_date||a.rrule){const y=a._end_date||a.end_date;return!l.limit_start||!l.limit_end||y.valueOf()>=l.limit_start.valueOf()&&a.start_date.valueOf()<=l.limit_end.valueOf()}s=[a];for(var d=!0,c=0;c<s.length;c++){var u=!0,f=s[c];f._timed=e.isOneDayEvent(f),(u=!l.limit_start||!l.limit_end||f.start_date.valueOf()>=l.limit_start.valueOf()&&f.end_date.valueOf()<=l.limit_end.valueOf())&&(u=!e.checkInMarkedTimespan(f,t,function(y,g,h,p,v){var x=!0;return g<=v&&g>=p&&((v==1440||h<=v)&&(x=!1),y._timed&&o._drag_id&&o._drag_mode=="new-size"?(y.start_date.setHours(0),y.start_date.setMinutes(v)):x=!1),(h>=p&&h<=v||g<p&&h>v)&&(y._timed&&o._drag_id&&o._drag_mode=="new-size"?(y.end_date.setHours(0),y.end_date.setMinutes(p)):x=!1),x})),u||(u=o.checkEvent("onLimitViolation")?o.callEvent("onLimitViolation",[f.id,f]):u),d=d&&u}return d||(o._drag_id=null,o._drag_mode=null),d},e._get_blocked_zones=function(a,o,l,s,d){var c=[];if(a&&a[o])for(var u=a[o],f=this._get_relevant_blocked_zones(l,s,u,d),y=0;y<f.length;y++)c=this._add_timespan_zones(c,f[y].zones);return c},e._get_relevant_blocked_zones=function(a,o,l,s){var d;return e.config.overwrite_marked_timespans?d=l[o]&&l[o][s]?l[o][s]:l[a]&&l[a][s]?l[a][s]:[]:(d=[],l[o]&&l[o][s]&&(d=d.concat(l[o][s])),l[a]&&l[a][s]&&(d=d.concat(l[a][s]))),d},e._mark_now=function(a){var o="dhx_now_time";this._els[o]||(this._els[o]=[]);var l=e._currentDate(),s=this.config;if(e._remove_mark_now(),!a&&s.mark_now&&l<this._max_date&&l>this._min_date&&l.getHours()>=s.first_hour&&l.getHours()<s.last_hour){var d=this.locate_holder_day(l);this._els[o]=e._append_mark_now(d,l)}},e._append_mark_now=function(a,o){var l="dhx_now_time",s=e._get_zone_minutes(o),d={zones:[s,s+1],css:l,type:l};if(!this._table_view){if(this._props&&this._props[this._mode]){var c,u,f=this._props[this._mode],y=f.size||f.options.length;f.days>1?(f.size&&f.options.length&&(a=(f.position+a)/f.options.length*f.size),c=a,u=a+y):u=(c=0)+y;for(var g=[],h=c;h<u;h++){var p=h;d.days=p;var v=e._render_marked_timespan(d,null,p)[0];g.push(v)}return g}return d.days=a,e._render_marked_timespan(d,null,a)}if(this._mode=="month")return d.days=+e.date.date_part(o),e._render_marked_timespan(d,null,null)},e._remove_mark_now=function(){for(var a="dhx_now_time",o=this._els[a],l=0;l<o.length;l++){var s=o[l],d=s.parentNode;d&&d.removeChild(s)}this._els[a]=[]},e._marked_timespans={global:{}},e._get_zone_minutes=function(a){return 60*a.getHours()+a.getMinutes()},e._prepare_timespan_options=function(a){var o=[],l=[];if(a.days=="fullweek"&&(a.days=[0,1,2,3,4,5,6]),a.days instanceof Array){for(var s=a.days.slice(),d=0;d<s.length;d++){var c=e._lame_clone(a);c.days=s[d],o.push.apply(o,e._prepare_timespan_options(c))}return o}if(!a||!(a.start_date&&a.end_date&&a.end_date>a.start_date||a.days!==void 0&&a.zones)&&!a.type)return o;a.zones=="fullday"&&(a.zones=[0,1440]),a.zones&&a.invert_zones&&(a.zones=e.invertZones(a.zones)),a.id=e.uid(),a.css=a.css||"",a.type=a.type||n;var u=a.sections;if(u){for(var f in u)if(u.hasOwnProperty(f)){var y=u[f];for(y instanceof Array||(y=[y]),d=0;d<y.length;d++)(O=e._lame_copy({},a)).sections={},O.sections[f]=y[d],l.push(O)}}else l.push(a);for(var g=0;g<l.length;g++){var h=l[g],p=h.start_date,v=h.end_date;if(p&&v)for(var x=e.date.date_part(new Date(p)),S=e.date.add(x,1,"day");x<v;){var O;delete(O=e._lame_copy({},h)).start_date,delete O.end_date,O.days=x.valueOf();var N=p>x?e._get_zone_minutes(p):0,I=v>S||v.getDate()!=x.getDate()?1440:e._get_zone_minutes(v);O.zones=[N,I],o.push(O),x=S,S=e.date.add(S,1,"day")}else h.days instanceof Date&&(h.days=e.date.date_part(h.days).valueOf()),h.zones=a.zones.slice(),o.push(h)}return o},e._get_dates_by_index=function(a,o,l){var s=[];o=e.date.date_part(new Date(o||e._min_date)),l=new Date(l||e._max_date);for(var d=o.getDay(),c=a-d>=0?a-d:7-o.getDay()+a,u=e.date.add(o,c,"day");u<l;u=e.date.add(u,1,"week"))s.push(u);return s},e._get_css_classes_by_config=function(a){var o=[];return a.type==t&&(o.push(t),a.css&&o.push(t+"_reset")),o.push("dhx_marked_timespan",a.css),o.join(" ")},e._get_block_by_config=function(a){var o=document.createElement("div");return a.html&&(typeof a.html=="string"?o.innerHTML=a.html:o.appendChild(a.html)),o},e._render_marked_timespan=function(a,o,l){var s=[],d=e.config,c=this._min_date,u=this._max_date,f=!1;if(!d.display_marked_timespans)return s;if(!l&&l!==0){if(a.days<7)l=a.days;else{var y=new Date(a.days);if(f=+y,!(+u>+y&&+c<=+y))return s;l=y.getDay()}var g=c.getDay();g>l?l=7-(g-l):l-=g}var h=a.zones,p=e._get_css_classes_by_config(a);if(e._table_view&&e._mode=="month"){var v=[],x=[];if(o)v.push(o),x.push(l);else{x=f?[f]:e._get_dates_by_index(l);for(var S=0;S<x.length;S++)v.push(this._scales[x[S]])}for(S=0;S<v.length;S++){o=v[S],l=x[S];var O=this.locate_holder_day(l,!1)%this._cols.length;if(!this._ignores[O]){var N=e._get_block_by_config(a);N.className=p,N.style.top="0px",N.style.height="100%";for(var I=0;I<h.length;I+=2){var A=h[S];if((E=h[S+1])<=A)return[];(D=N.cloneNode(!0)).style.left="0px",D.style.width="100%",o.appendChild(D),s.push(D)}}}}else{var m=l;if(this._ignores[this.locate_holder_day(l,!1)])return s;if(this._props&&this._props[this._mode]&&a.sections&&a.sections[this._mode]){var b=this._props[this._mode];m=b.order[a.sections[this._mode]];var k=b.order[a.sections[this._mode]];b.days>1?m=m*(b.size||b.options.length)+k:(m=k,b.size&&m>b.position+b.size&&(m=0))}for(o=o||e.locate_holder(m),S=0;S<h.length;S+=2){var E,D;if(A=Math.max(h[S],60*d.first_hour),(E=Math.min(h[S+1],60*d.last_hour))<=A){if(S+2<h.length)continue;return[]}(D=e._get_block_by_config(a)).className=p;var C=24*this.config.hour_size_px+1,R=36e5;D.style.top=Math.round((60*A*1e3-this.config.first_hour*R)*this.config.hour_size_px/R)%C+"px",D.style.height=Math.max(Math.round(60*(E-A)*1e3*this.config.hour_size_px/R)%C,1)+"px",o.appendChild(D),s.push(D)}}return s},e._mark_timespans=function(){var a=this._els.dhx_cal_data[0],o=[];if(e._table_view&&e._mode=="month")for(var l in this._scales){var s=new Date(+l);o.push.apply(o,e._on_scale_add_marker(this._scales[l],s))}else{s=new Date(e._min_date);for(var d=0,c=a.childNodes.length;d<c;d++){var u=a.childNodes[d];u.firstChild&&e._getClassName(u.firstChild).indexOf("dhx_scale_hour")>-1||(o.push.apply(o,e._on_scale_add_marker(u,s)),s=e.date.add(s,1,"day"))}}return o},e.markTimespan=function(a){if(!this._els)throw new Error("`scheduler.markTimespan` can't be used before scheduler initialization. Place `scheduler.markTimespan` call after `scheduler.init`.");var o=!1;this._els.dhx_cal_data||(e.get_elements(),o=!0);var l=e._marked_timespans_ids,s=e._marked_timespans_types,d=e._marked_timespans;e.deleteMarkedTimespan(),e.addMarkedTimespan(a);var c=e._mark_timespans();return o&&(e._els=[]),e._marked_timespans_ids=l,e._marked_timespans_types=s,e._marked_timespans=d,c},e.unmarkTimespan=function(a){if(a)for(var o=0;o<a.length;o++){var l=a[o];l.parentNode&&l.parentNode.removeChild(l)}},e._addMarkerTimespanConfig=function(a){var o="global",l=e._marked_timespans,s=a.id,d=e._marked_timespans_ids;d[s]||(d[s]=[]);var c=a.days,u=a.sections,f=a.type;if(a.id=s,u){for(var y in u)if(u.hasOwnProperty(y)){l[y]||(l[y]={});var g=u[y],h=l[y];h[g]||(h[g]={}),h[g][c]||(h[g][c]={}),h[g][c][f]||(h[g][c][f]=[],e._marked_timespans_types||(e._marked_timespans_types={}),e._marked_timespans_types[f]||(e._marked_timespans_types[f]=!0));var p=h[g][c][f];a._array=p,p.push(a),d[s].push(a)}}else l[o][c]||(l[o][c]={}),l[o][c][f]||(l[o][c][f]=[]),e._marked_timespans_types||(e._marked_timespans_types={}),e._marked_timespans_types[f]||(e._marked_timespans_types[f]=!0),p=l[o][c][f],a._array=p,p.push(a),d[s].push(a)},e._marked_timespans_ids={},e.addMarkedTimespan=function(a){var o=e._prepare_timespan_options(a);if(o.length){for(var l=o[0].id,s=0;s<o.length;s++)e._addMarkerTimespanConfig(o[s]);return l}},e._add_timespan_zones=function(a,o){var l=a.slice();if(o=o.slice(),!l.length)return o;for(var s=0;s<l.length;s+=2)for(var d=l[s],c=l[s+1],u=s+2==l.length,f=0;f<o.length;f+=2){var y=o[f],g=o[f+1];if(g>c&&y<=c||y<d&&g>=d)l[s]=Math.min(d,y),l[s+1]=Math.max(c,g),s-=2;else{if(!u)continue;var h=d>y?0:2;l.splice(s+h,0,y,g)}o.splice(f--,2);break}return l},e._subtract_timespan_zones=function(a,o){for(var l=a.slice(),s=0;s<l.length;s+=2)for(var d=l[s],c=l[s+1],u=0;u<o.length;u+=2){var f=o[u],y=o[u+1];if(y>d&&f<c){var g=!1;d>=f&&c<=y&&l.splice(s,2),d<f&&(l.splice(s,2,d,f),g=!0),c>y&&l.splice(g?s+2:s,g?0:2,y,c),s-=2;break}}return l},e.invertZones=function(a){return e._subtract_timespan_zones([0,1440],a.slice())},e._delete_marked_timespan_by_id=function(a){var o=e._marked_timespans_ids[a];if(o){for(var l=0;l<o.length;l++)for(var s=o[l],d=s._array,c=0;c<d.length;c++)if(d[c]==s){d.splice(c,1);break}}},e._delete_marked_timespan_by_config=function(a){var o,l=e._marked_timespans,s=a.sections,d=a.days,c=a.type||n;if(s){for(var u in s)if(s.hasOwnProperty(u)&&l[u]){var f=s[u];l[u][f]&&(o=l[u][f])}}else o=l.global;if(o){if(d!==void 0)o[d]&&o[d][c]&&(e._addMarkerTimespanConfig(a),e._delete_marked_timespans_list(o[d][c],a));else for(var y in o)if(o[y][c]){var g=e._lame_clone(a);a.days=y,e._addMarkerTimespanConfig(g),e._delete_marked_timespans_list(o[y][c],a)}}},e._delete_marked_timespans_list=function(a,o){for(var l=0;l<a.length;l++){var s=a[l],d=e._subtract_timespan_zones(s.zones,o.zones);if(d.length)s.zones=d;else{a.splice(l,1),l--;for(var c=e._marked_timespans_ids[s.id],u=0;u<c.length;u++)if(c[u]==s){c.splice(u,1);break}}}},e.deleteMarkedTimespan=function(a){if(arguments.length||(e._marked_timespans={global:{}},e._marked_timespans_ids={},e._marked_timespans_types={}),typeof a!="object")e._delete_marked_timespan_by_id(a);else{a.start_date&&a.end_date||(a.days!==void 0||a.type||(a.days="fullweek"),a.zones||(a.zones="fullday"));var o=[];if(a.type)o.push(a.type);else for(var l in e._marked_timespans_types)o.push(l);for(var s=e._prepare_timespan_options(a),d=0;d<s.length;d++)for(var c=s[d],u=0;u<o.length;u++){var f=e._lame_clone(c);f.type=o[u],e._delete_marked_timespan_by_config(f)}}},e._get_types_to_render=function(a,o){var l=a?e._lame_copy({},a):{};for(var s in o||{})o.hasOwnProperty(s)&&(l[s]=o[s]);return l},e._get_configs_to_render=function(a){var o=[];for(var l in a)a.hasOwnProperty(l)&&o.push.apply(o,a[l]);return o},e._on_scale_add_marker=function(a,o){if(!e._table_view||e._mode=="month"){var l=o.getDay(),s=o.valueOf(),d=this._mode,c=e._marked_timespans,u=[],f=[];if(this._props&&this._props[d]){var y=this._props[d],g=y.options,h=g[e._get_unit_index(y,o)];if(y.days>1){var p=Math.round((o-e._min_date)/864e5),v=y.size||g.length;o=e.date.add(e._min_date,Math.floor(p/v),"day"),o=e.date.date_part(o)}else o=e.date.date_part(new Date(this._date));if(l=o.getDay(),s=o.valueOf(),c[d]&&c[d][h.key]){var x=c[d][h.key],S=e._get_types_to_render(x[l],x[s]);u.push.apply(u,e._get_configs_to_render(S))}}var O=c.global;if(e.config.overwrite_marked_timespans){var N=O[s]||O[l];u.push.apply(u,e._get_configs_to_render(N))}else O[s]&&u.push.apply(u,e._get_configs_to_render(O[s])),O[l]&&u.push.apply(u,e._get_configs_to_render(O[l]));for(var I=0;I<u.length;I++)f.push.apply(f,e._render_marked_timespan(u[I],a,o));return f}},e.attachEvent("onScaleAdd",function(){e._on_scale_add_marker.apply(e,arguments)}),e.dblclick_dhx_marked_timespan=function(a,o){e.callEvent("onScaleDblClick",[e.getActionData(a).date,o,a]),e.config.dblclick_create&&e.addEventNow(e.getActionData(a).date,null,a)}}function Nc(e){var t={},n=!1;function r(s,d){d=typeof d=="function"?d:function(){},t[s]||(t[s]=this[s],this[s]=d)}function i(s){t[s]&&(this[s]=t[s],t[s]=null)}function a(s){for(var d in s)r.call(this,d,s[d])}function o(){for(var s in t)i.call(this,s)}function l(s){try{s()}catch(d){window.console.error(d)}}return e.$stateProvider.registerProvider("batchUpdate",function(){return{batch_update:n}},!1),function(s,d){if(n)return void l(s);var c,u=this._dp&&this._dp.updateMode!="off";u&&(c=this._dp.updateMode,this._dp.setUpdateMode("off"));const f={setModeDate:{date:null,mode:null},needRender:!1,needUpdateView:!1,repaintEvents:{}},y=(h,p)=>{h&&(f.setModeDate.date=h),p&&(f.setModeDate.mode=p)};var g={render:(h,p)=>{f.needRender=!0,y(h,p)},setCurrentView:(h,p)=>{f.needRender=!0,y(h,p)},updateView:(h,p)=>{f.needUpdateView=!0,y(h,p)},render_data:()=>f.needRender=!0,render_view_data:h=>{h&&h.length?h.forEach(p=>f.repaintEvents[p.id]=!0):f.needRender=!0}};if(a.call(this,g),n=!0,this.callEvent("onBeforeBatchUpdate",[]),l(s),this.callEvent("onAfterBatchUpdate",[]),o.call(this),n=!1,!d)if(f.needRender)e.render(f.setModeDate.date,f.setModeDate.mode);else if(f.needUpdateView)e.updateView(f.setModeDate.date,f.setModeDate.mode);else for(const h in f.repaintEvents)e.updateEvent(h);u&&(this._dp.setUpdateMode(c),this._dp.sendData())}}let Ic=class{constructor(t){const{url:n,token:r}=t;this._url=n,this._token=r,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:"application/json","Content-Type":"application/json","Remote-Token":this._token}}fetch(t,n){const r={credentials:"include",headers:this.headers()};return n&&(r.method="POST",r.body=n),fetch(t,r).then(i=>i.json())}load(t){return t&&(this._url=t),this.fetch(this._url).then(n=>this.parse(n))}parse(t){const{key:n,websocket:r}=t;n&&(this._token=t.key);for(const i in t.data)this.data[i]=t.data[i];for(const i in t.api){const a=this.api[i]={},o=t.api[i];for(const l in o)a[l]=this._wrapper(i+"."+l)}return r&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(n,r,i,a){let o=r;o[0]==="/"&&(o=document.location.protocol+"//"+document.location.host+r),o=o.replace(/^http(s|):/,"ws$1:");const l=o.indexOf("?")!=-1?"&":"?";o=`${o}${l}token=${i}&ws=1`;const s=new WebSocket(o);return s.onclose=()=>setTimeout(()=>n.connect(),2e3),s.onmessage=d=>{const c=JSON.parse(d.data);switch(c.action){case"result":n.result(c.body,[]);break;case"event":n.fire(c.body.name,c.body.value);break;case"start":a();break;default:n.onError(c.data)}},s}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(t){return(function(){const n=[].slice.call(arguments);let r=null;const i=new Promise((a,o)=>{r={data:{id:this._uid(),name:t,args:n},status:1,resolve:a,reject:o},this._queue.push(r)});return this.onCall(r,i),this._mode===3?this._send(r):setTimeout(()=>this._send(),1),i}).bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(this._mode==2)return void setTimeout(()=>this._send(),100);const n=t?[t]:this._queue.filter(i=>i.status===1);if(!n.length)return;const r=n.map(i=>(i.status=2,i.data));this._mode!==3?this.fetch(this._url,JSON.stringify(r)).catch(i=>this.onError(i)).then(i=>this.result(i,r)):this._socket.send(JSON.stringify({action:"call",body:r}))}result(t,n){const r={};if(t)for(let i=0;i<t.length;i++)r[t[i].id]=t[i];else for(let i=0;i<n.length;i++)r[n[i].id]={id:n[i].id,error:"Network Error",data:null};for(let i=this._queue.length-1;i>=0;i--){const a=this._queue[i],o=r[a.data.id];o&&(this.onResponse(a,o),o.error?a.reject(o.error):a.resolve(o.data),this._queue.splice(i,1))}}on(t,n){const r=this._uid();let i=this._events[t];const a=!!i;return a||(i=this._events[t]=[]),i.push({id:r,handler:n}),a||this._mode!=3||this._socket.send(JSON.stringify({action:"subscribe",name:t})),{name:t,id:r}}_resubscribe(){if(this._mode==3)for(const t in this._events)this._socket.send(JSON.stringify({action:"subscribe",name:t}))}detach(t){if(!t){if(this._mode==3)for(const a in this._events)this._socket.send(JSON.stringify({action:"unsubscribe",key:a}));return void(this._events={})}const{id:n,name:r}=t,i=this._events[r];if(i){const a=i.filter(o=>o.id!=n);a.length?this._events[r]=a:(delete this._events[r],this._mode==3&&this._socket.send(JSON.stringify({action:"unsubscribe",name:r})))}}fire(t,n){const r=this._events[t];if(r)for(let i=0;i<r.length;i++)r[i].handler(n)}onError(t){return null}onCall(t,n){}onResponse(t,n){}},Mc=class{constructor(t,n){const r=new Ic({url:t,token:n});r.fetch=function(i,a){const o={headers:this.headers()};return a&&(o.method="POST",o.body=a),fetch(i,o).then(l=>l.json())},this._ready=r.load().then(i=>this._remote=i)}ready(){return this._ready}on(t,n){this.ready().then(r=>{if(typeof t=="string")r.on(t,n);else for(const i in t)r.on(i,t[i])})}};function Oc(e){function t(r,i){switch(r){case"add-event":(function(a){if(e.getEvent(a.id))return void console.warn(`Event with ID ${a.id} already exists. Skipping add.`);a.start_date=e.templates.parse_date(a.start_date),a.end_date=e.templates.parse_date(a.end_date),a.original_start&&(a.original_start=e.templates.parse_date(a.original_start)),n(()=>{e.addEvent(a)})})(i);break;case"update-event":(function(a){const o=a.id;if(!e.getEvent(o))return void console.warn(`Event with ID ${o} does not exist. Skipping update.`);const l=e.getEvent(o);n(()=>{for(let s in a)s!=="start_date"&&s!=="end_date"&&(l[s]=a[s]);l.start_date=e.templates.parse_date(a.start_date),l.end_date=e.templates.parse_date(a.end_date),a.original_start&&(a.original_start=e.templates.parse_date(a.original_start)),e.callEvent("onEventChanged",[o,l]),e.updateEvent(o),o!==a.id&&e.changeEventId(o,a.id)})})(i);break;case"delete-event":(function(a){const o=a.id;if(!e.getEvent(o))return void(a.event_pid&&n(()=>{e.addEvent(a)}));n(()=>{const l=e.getEvent(o);if(l){if(l.rec_type||l.rrule){e._roll_back_dates(l);const s=e._get_rec_markers(o);for(const d in s)e.getEvent(d)&&e.deleteEvent(d,!0)}if(e.getState().lightbox_id==o&&(this._new_event=this._lightbox_id,a.id=this._lightbox_id,this._events[this._lightbox_id]=a,e.callEvent("onLiveUpdateCollision",[o,null,"delete",a])===!1))return void e.endLightbox(!1,e._lightbox);e.deleteEvent(o,!0)}})})(i)}}function n(r){e._dp?e._dp.ignore(r):r()}return{events:function(r){if(!r||!r.event||!r.event.id)return void console.error("Invalid message format:",r);const{type:i,event:a}=r;if(!e._dp._in_progress[a.id]){if(i==="add-event"){for(const o in e._dp._in_progress)if(e._dp.getState(o)==="inserted")return void e._dp.attachEvent("onFullSync",function(){e.getEvent(a.id)||t(i,a)},{once:!0})}t(i,a)}}}}function Rc(e){(function(t){const n={};t.attachEvent("onConfirmedBeforeEventDelete",function(r){return n[r]=!0,!0}),t.attachEvent("onEventDeleted",function(r,i){if(!n[r])return;delete n[r];let a=t.copy(i);t.config.undo_deleted&&!t.getState().new_event&&t.message({text:`<div class="dhx_info_message">
                            <span class="undo_popup_text">Event deleted</span>
                            <button class="undo_button" data-deleted-event-id="${i.id}">Undo</button>
                        </div>`,expire:1e4,type:"popup_after_delete",callback:function(o){o.target.closest(`[data-deleted-event-id="${i.id}"]`)&&(a.rrule&&a.duration&&(a.end_date=new Date(a.start_date.valueOf()+1e3*a.duration),t.addEvent(a)),t.addEvent(a),t.render())}})})})(e),Dc(e),Cc(e),function(t){t.batchUpdate=Nc(t)}(e),function(t){t.ext||(t.ext={}),t.ext.liveUpdates={RemoteEvents:Mc,remoteUpdates:Oc(t)}}(e)}var Pc=Date.now();function Aa(e){return!(!e||typeof e!="object")&&!!(e.getFullYear&&e.getMonth&&e.getDate)}const Qe={uid:function(){return Pc++},mixin:function(e,t,n){for(var r in t)(e[r]===void 0||n)&&(e[r]=t[r]);return e},copy:function e(t){var n,r,i;if(t&&typeof t=="object")switch(!0){case Aa(t):r=new Date(t);break;case(i=t,Array.isArray?Array.isArray(i):i&&i.length!==void 0&&i.pop&&i.push):for(r=new Array(t.length),n=0;n<t.length;n++)r[n]=e(t[n]);break;case function(a){return a&&typeof a=="object"&&Function.prototype.toString.call(a.constructor)==="function String() { [native code] }"}(t):r=new String(t);break;case function(a){return a&&typeof a=="object"&&Function.prototype.toString.call(a.constructor)==="function Number() { [native code] }"}(t):r=new Number(t);break;case function(a){return a&&typeof a=="object"&&Function.prototype.toString.call(a.constructor)==="function Boolean() { [native code] }"}(t):r=new Boolean(t);break;default:for(n in r={},t){const a=typeof t[n];a==="string"||a==="number"||a==="boolean"?r[n]=t[n]:Aa(t[n])?r[n]=new Date(t[n]):Object.prototype.hasOwnProperty.apply(t,[n])&&(r[n]=e(t[n]))}}return r||t},defined:function(e){return e!==void 0},isDate:Aa,delay:function(e,t){var n,r=function(){r.$cancelTimeout(),r.$pending=!0;var i=Array.prototype.slice.call(arguments);n=setTimeout(function(){e.apply(this,i),r.$pending=!1},t)};return r.$pending=!1,r.$cancelTimeout=function(){clearTimeout(n),r.$pending=!1},r.$execute=function(){var i=Array.prototype.slice.call(arguments);e.apply(this,i),r.$cancelTimeout()},r}};function Lc(e){function t(g){var h=document.createElement("div");return(g||"").split(" ").forEach(function(p){h.classList.add(p)}),h}var n=function(){return t("dhx_cal_navbar_rows_container")},r=function(){return t("dhx_cal_navbar_row")},i=function(g){var h=t("dhx_cal_tab");return h.setAttribute("name",g.view+"_tab"),h.setAttribute("data-tab",g.view),e.config.fix_tab_position&&(g.$firstTab?h.classList.add("dhx_cal_tab_first"):g.$lastTab?h.classList.add("dhx_cal_tab_last"):g.view!=="week"&&h.classList.add("dhx_cal_tab_standalone"),g.$segmentedTab&&h.classList.add("dhx_cal_tab_segmented")),h},a=function(){return t("dhx_cal_date")},o=function(g){return t("dhx_cal_nav_button dhx_cal_nav_button_custom dhx_cal_tab")},l=function(g){return t("dhx_cal_"+g.view+"_button dhx_cal_nav_button")},s=function(){return t("dhx_cal_line_spacer")},d=function(g){var h=t("dhx_minical_icon");return g.click||h.$_eventAttached||e.event(h,"click",function(){e.isCalendarVisible()?e.destroyCalendar():e.renderCalendar({position:this,date:e.getState().date,navigation:!0,handler:function(p,v){e.setCurrentView(p),e.destroyCalendar()}})}),h};function c(g){var h=function(x){var S;if(x.view)switch(x.view){case"today":case"next":case"prev":S=l;break;case"date":S=a;break;case"spacer":S=s;break;case"button":S=o;break;case"minicalendar":S=d;break;default:S=i}else x.rows?S=n:x.cols&&(S=r);return S}(g);if(h){var p=h(g);if(g.css&&p.classList.add(g.css),g.width&&((v=g.width)===1*v&&(v+="px"),p.style.width=v),g.height&&((v=g.height)===1*v&&(v+="px"),p.style.height=v),g.click&&e.event(p,"click",g.click),g.html&&(p.innerHTML=g.html),g.align){var v="";g.align=="right"?v="flex-end":g.align=="left"&&(v="flex-start"),p.style.justifyContent=v}return p}}function u(g){return typeof g=="string"&&(g={view:g}),g.view||g.rows||g.cols||(g.view="button"),g}function f(g){var h,p=document.createDocumentFragment();h=Array.isArray(g)?g:[g];for(var v=0;v<h.length;v++){var x,S=u(h[v]);S.view==="day"&&h[v+1]&&((x=u(h[v+1])).view!=="week"&&x.view!=="month"||(S.$firstTab=!0,S.$segmentedTab=!0)),S.view==="week"&&h[v-1]&&((x=u(h[v+1])).view!=="week"&&x.view!=="month"||(S.$segmentedTab=!0)),S.view==="month"&&h[v-1]&&((x=u(h[v-1])).view!=="week"&&x.view!=="day"||(S.$lastTab=!0,S.$segmentedTab=!0));var O=c(S);p.appendChild(O),(S.cols||S.rows)&&O.appendChild(f(S.cols||S.rows))}return p}e._init_nav_bar=function(g){var h=this.$container.querySelector(".dhx_cal_navline");return h||((h=document.createElement("div")).className="dhx_cal_navline dhx_cal_navline_flex",e._update_nav_bar(g,h),h)};var y=null;e._update_nav_bar=function(g,h){if(g){var p=!1,v=g.height||e.xy.nav_height;y!==null&&y===v||(p=!0),p&&(e.xy.nav_height=v),h.innerHTML="",h.appendChild(f(g)),e.unset_actions(),e._els=[],e.get_elements(),e.set_actions(),h.style.display=v===0?"none":"",y=v}}}function Vc(e){function t(a){return a.isConnected!==void 0?a.isConnected:document.body.contains(a)}function n(a){return{w:a.innerWidth||document.documentElement.clientWidth,h:a.innerHeight||document.documentElement.clientHeight}}function r(a,o){var l,s=n(o);a.event(o,"resize",function(){clearTimeout(l),l=setTimeout(function(){if(t(a.$container)&&!a.$destroyed){var d,c,u=n(o);c=u,((d=s).w!=c.w||d.h!=c.h)&&(s=u,i(a))}},150)})}function i(a){a.$initialized&&!a.$destroyed&&a.$root&&t(a.$root)&&a.callEvent("onSchedulerResize",[])&&(a.updateView(),a.callEvent("onAfterSchedulerResize",[]))}(function(a){var o=a.$container;if(window.getComputedStyle(o).getPropertyValue("position")=="static"&&(o.style.position="relative"),window.ResizeObserver){let s=!0;const d=new ResizeObserver(function(c){s?s=!1:i(a)});d.observe(o),a.attachEvent("onDestroy",function(){d.unobserve(o)})}else{var l=document.createElement("iframe");l.className="scheduler_container_resize_watcher",l.tabIndex=-1,a.config.wai_aria_attributes&&(l.setAttribute("role","none"),l.setAttribute("aria-hidden",!0)),window.Sfdc||window.$A||window.Aura?function(s){var d=s.$root.offsetHeight,c=s.$root.offsetWidth;(function u(){s.$destroyed||(s.$root&&(s.$root.offsetHeight==d&&s.$root.offsetWidth==c||i(s),d=s.$root.offsetHeight,c=s.$root.offsetWidth),setTimeout(u,200))})()}(a):(o.appendChild(l),l.contentWindow?r(a,l.contentWindow):(o.removeChild(l),r(a,window)))}})(e)}let $c=class{constructor(){this._silent_mode=!1,this.listeners={}}_silentStart(){this._silent_mode=!0}_silentEnd(){this._silent_mode=!1}};function fi(e){const t=new $c;e.attachEvent=function(n,r,i){n="ev_"+n.toLowerCase(),t.listeners[n]||(t.listeners[n]=function(o){let l={},s=0;const d=function(){let c=!0;for(const u in l){const f=l[u].apply(o,arguments);c=c&&f}return c};return d.addEvent=function(c,u){if(typeof c=="function"){let f;if(u&&u.id?f=u.id:(f=s,s++),u&&u.once){const y=c;c=function(){y(),d.removeEvent(f)}}return l[f]=c,f}return!1},d.removeEvent=function(c){delete l[c]},d.clear=function(){l={}},d}(this)),i&&i.thisObject&&(r=r.bind(i.thisObject));let a=n+":"+t.listeners[n].addEvent(r,i);return i&&i.id&&(a=i.id),a},e.attachAll=function(n){this.attachEvent("listen_all",n)},e.callEvent=function(n,r){if(t._silent_mode)return!0;const i="ev_"+n.toLowerCase(),a=t.listeners;return a.ev_listen_all&&a.ev_listen_all.apply(this,[n].concat(r)),!a[i]||a[i].apply(this,r)},e.checkEvent=function(n){return!!t.listeners["ev_"+n.toLowerCase()]},e.detachEvent=function(n){if(n){let r=t.listeners;for(const a in r)r[a].removeEvent(n);const i=n.split(":");if(r=t.listeners,i.length===2){const a=i[0],o=i[1];r[a]&&r[a].removeEvent(o)}}},e.detachAllEvents=function(){for(const n in t.listeners)t.listeners[n].clear()}}const Xo={event:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},eventRemove:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}};function Hc(e){var t=function(){var n=function(r,i){r=r||Xo.event,i=i||Xo.eventRemove;var a=[],o={attach:function(l,s,d,c){a.push({element:l,event:s,callback:d,capture:c}),r(l,s,d,c)},detach:function(l,s,d,c){i(l,s,d,c);for(var u=0;u<a.length;u++){var f=a[u];f.element===l&&f.event===s&&f.callback===d&&f.capture===c&&(a.splice(u,1),u--)}},detachAll:function(){for(var l=a.slice(),s=0;s<l.length;s++){var d=l[s];o.detach(d.element,d.event,d.callback,d.capture),o.detach(d.element,d.event,d.callback,void 0),o.detach(d.element,d.event,d.callback,!1),o.detach(d.element,d.event,d.callback,!0)}a.splice(0,a.length)},extend:function(){return n(this.event,this.eventRemove)}};return o};return n()}();e.event=t.attach,e.eventRemove=t.detach,e._eventRemoveAll=t.detachAll,e._createDomEventScope=t.extend,e._trim=function(n){return(String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")}).apply(n)},e._isDate=function(n){return!(!n||typeof n!="object")&&!!(n.getFullYear&&n.getMonth&&n.getDate)},e._isObject=function(n){return n&&typeof n=="object"}}function wl(e){if(!e)return"";var t=e.className||"";return t.baseVal&&(t=t.baseVal),t.indexOf||(t=""),t||""}function xl(e,t,n){n===void 0&&(n=!0);for(var r=e.target||e.srcElement,i="";r;){if(i=wl(r)){var a=i.indexOf(t);if(a>=0){if(!n)return r;var o=a===0||!(i.charAt(a-1)||"").trim(),l=a+t.length>=i.length||!i.charAt(a+t.length).trim();if(o&&l)return r}}r=r.parentNode}return null}function Fc(e){var t=!1,n=!1;if(window.getComputedStyle){var r=window.getComputedStyle(e,null);t=r.display,n=r.visibility}else e.currentStyle&&(t=e.currentStyle.display,n=e.currentStyle.visibility);var i=!1,a=xl({target:e},"dhx_form_repeat",!1);return a&&(i=a.style.height=="0px"),i=i||!e.offsetHeight,t!="none"&&n!="hidden"&&!i}function Uc(e){return!isNaN(e.getAttribute("tabindex"))&&1*e.getAttribute("tabindex")>=0}function zc(e){return!{a:!0,area:!0}[e.nodeName.loLowerCase()]||!!e.getAttribute("href")}function qc(e){return!{input:!0,select:!0,textarea:!0,button:!0,object:!0}[e.nodeName.toLowerCase()]||!e.hasAttribute("disabled")}function kl(){return document.head.createShadowRoot||document.head.attachShadow}function Zo(e){if(!e||!kl())return document.body;for(;e.parentNode&&(e=e.parentNode);)if(e instanceof ShadowRoot)return e.host;return document.body}const yt={getAbsoluteLeft:function(e){return this.getOffset(e).left},getAbsoluteTop:function(e){return this.getOffset(e).top},getOffsetSum:function(e){for(var t=0,n=0;e;)t+=parseInt(e.offsetTop),n+=parseInt(e.offsetLeft),e=e.offsetParent;return{top:t,left:n}},getOffsetRect:function(e){var t=e.getBoundingClientRect(),n=0,r=0;if(/Mobi/.test(navigator.userAgent)){var i=document.createElement("div");i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.width="1px",i.style.height="1px",document.body.appendChild(i);var a=i.getBoundingClientRect();n=t.top-a.top,r=t.left-a.left,i.parentNode.removeChild(i)}else{var o=document.body,l=document.documentElement,s=window.pageYOffset||l.scrollTop||o.scrollTop,d=window.pageXOffset||l.scrollLeft||o.scrollLeft,c=l.clientTop||o.clientTop||0,u=l.clientLeft||o.clientLeft||0;n=t.top+s-c,r=t.left+d-u}return{top:Math.round(n),left:Math.round(r)}},getOffset:function(e){return e.getBoundingClientRect?this.getOffsetRect(e):this.getOffsetSum(e)},closest:function(e,t){return e&&t?$a(e,t):null},insertAfter:function(e,t){t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)},remove:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},isChildOf:function(e,t){return t.contains(e)},getFocusableNodes:function(e){for(var t=e.querySelectorAll(["a[href]","area[href]","input","select","textarea","button","iframe","object","embed","[tabindex]","[contenteditable]"].join(", ")),n=Array.prototype.slice.call(t,0),r=0;r<n.length;r++)n[r].$position=r;for(n.sort(function(a,o){return a.tabIndex===0&&o.tabIndex!==0?1:a.tabIndex!==0&&o.tabIndex===0?-1:a.tabIndex===o.tabIndex?a.$position-o.$position:a.tabIndex<o.tabIndex?-1:1}),r=0;r<n.length;r++){var i=n[r];(Uc(i)||qc(i)||zc(i))&&Fc(i)||(n.splice(r,1),r--)}return n},getClassName:wl,locateCss:xl,getRootNode:Zo,hasShadowParent:function(e){return!!Zo(e)},isShadowDomSupported:kl,getActiveElement:function(){var e=document.activeElement;return e.shadowRoot&&(e=e.shadowRoot.activeElement),e===document.body&&document.getSelection&&(e=document.getSelection().focusNode||document.body),e},getRelativeEventPosition:function(e,t){var n=document.documentElement,r=function(i){var a=0,o=0,l=0,s=0;if(i.getBoundingClientRect){var d=i.getBoundingClientRect(),c=document.body,u=document.documentElement||document.body.parentNode||document.body,f=window.pageYOffset||u.scrollTop||c.scrollTop,y=window.pageXOffset||u.scrollLeft||c.scrollLeft,g=u.clientTop||c.clientTop||0,h=u.clientLeft||c.clientLeft||0;a=d.top+f-g,o=d.left+y-h,l=document.body.offsetWidth-d.right,s=document.body.offsetHeight-d.bottom}else{for(;i;)a+=parseInt(i.offsetTop,10),o+=parseInt(i.offsetLeft,10),i=i.offsetParent;l=document.body.offsetWidth-i.offsetWidth-o,s=document.body.offsetHeight-i.offsetHeight-a}return{y:Math.round(a),x:Math.round(o),width:i.offsetWidth,height:i.offsetHeight,right:Math.round(l),bottom:Math.round(s)}}(t);return{x:e.clientX-n.clientLeft-r.x+t.scrollLeft,y:e.clientY-n.clientTop-r.y+t.scrollTop}},getTargetNode:function(e){var t;return e.tagName?t=e:(t=(e=e||window.event).target||e.srcElement).shadowRoot&&e.composedPath&&(t=e.composedPath()[0]),t},getNodePosition:function(e){var t=0,n=0,r=0,i=0;if(e.getBoundingClientRect){var a=e.getBoundingClientRect(),o=document.body,l=document.documentElement||document.body.parentNode||document.body,s=window.pageYOffset||l.scrollTop||o.scrollTop,d=window.pageXOffset||l.scrollLeft||o.scrollLeft,c=l.clientTop||o.clientTop||0,u=l.clientLeft||o.clientLeft||0;t=a.top+s-c,n=a.left+d-u,r=document.body.offsetWidth-a.right,i=document.body.offsetHeight-a.bottom}else{for(;e;)t+=parseInt(e.offsetTop,10),n+=parseInt(e.offsetLeft,10),e=e.offsetParent;r=document.body.offsetWidth-e.offsetWidth-n,i=document.body.offsetHeight-e.offsetHeight-t}return{y:Math.round(t),x:Math.round(n),width:e.offsetWidth,height:e.offsetHeight,right:Math.round(r),bottom:Math.round(i)}}};var $a;if(Element.prototype.closest)$a=function(e,t){return e.closest(t)};else{var jc=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;$a=function(e,t){var n=e;do{if(jc.call(n,t))return n;n=n.parentElement||n.parentNode}while(n!==null&&n.nodeType===1);return null}}var gt=typeof window<"u";const Bc={isIE:gt&&(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0),isOpera:gt&&navigator.userAgent.indexOf("Opera")>=0,isChrome:gt&&navigator.userAgent.indexOf("Chrome")>=0,isKHTML:gt&&(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0),isFF:gt&&navigator.userAgent.indexOf("Firefox")>=0,isIPad:gt&&navigator.userAgent.search(/iPad/gi)>=0,isEdge:gt&&navigator.userAgent.indexOf("Edge")!=-1,isNode:!gt||typeof navigator>"u"};function Sa(e){if(typeof e=="string"||typeof e=="number")return e;var t="";for(var n in e){var r="";e.hasOwnProperty(n)&&(r=n+"="+(r=typeof e[n]=="string"?encodeURIComponent(e[n]):typeof e[n]=="number"?e[n]:encodeURIComponent(JSON.stringify(e[n]))),t.length&&(r="&"+r),t+=r)}return t}function Yc(e){var t=function(a,o){for(var l="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",s=a.match(/%[a-zA-Z]/g),d=0;d<s.length;d++)switch(s[d]){case"%j":case"%d":l+="set[2]=temp["+d+"]||1;";break;case"%n":case"%m":l+="set[1]=(temp["+d+"]||1)-1;";break;case"%y":l+="set[0]=temp["+d+"]*1+(temp["+d+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":l+="set[3]=temp["+d+"]||0;";break;case"%i":l+="set[4]=temp["+d+"]||0;";break;case"%Y":l+="set[0]=temp["+d+"]||0;";break;case"%a":case"%A":l+="set[3]=set[3]%12+((temp["+d+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":l+="set[5]=temp["+d+"]||0;";break;case"%M":l+="set[1]=this.locale.date.month_short_hash[temp["+d+"]]||0;";break;case"%F":l+="set[1]=this.locale.date.month_full_hash[temp["+d+"]]||0;"}var c="set[0],set[1],set[2],set[3],set[4],set[5]";return o&&(c=" Date.UTC("+c+")"),new Function("date","var set=[0,0,1,0,0,0]; "+l+" return new Date("+c+");")},n=function(a,o){const l=a.match(/%[a-zA-Z]/g);return function(s){for(var d=[0,0,1,0,0,0],c=s.match(/[a-zA-Z]+|[0-9]+/g),u=0;u<l.length;u++)switch(l[u]){case"%j":case"%d":d[2]=c[u]||1;break;case"%n":case"%m":d[1]=(c[u]||1)-1;break;case"%y":d[0]=1*c[u]+(c[u]>50?1900:2e3);break;case"%g":case"%G":case"%h":case"%H":d[3]=c[u]||0;break;case"%i":d[4]=c[u]||0;break;case"%Y":d[0]=c[u]||0;break;case"%a":case"%A":d[3]=d[3]%12+((c[u]||"").toLowerCase()=="am"?0:12);break;case"%s":d[5]=c[u]||0;break;case"%M":d[1]=e.locale.date.month_short_hash[c[u]]||0;break;case"%F":d[1]=e.locale.date.month_full_hash[c[u]]||0}return o?new Date(Date.UTC(d[0],d[1],d[2],d[3],d[4],d[5])):new Date(d[0],d[1],d[2],d[3],d[4],d[5])}};let r;function i(){var a=!1;return e.config.csp==="auto"?(r===void 0&&(r=function(){try{new Function("cspEnabled = false;"),r=!1}catch{r=!0}return r}()),a=r):a=e.config.csp,a}e.date={init:function(){for(var a=e.locale.date.month_short,o=e.locale.date.month_short_hash={},l=0;l<a.length;l++)o[a[l]]=l;for(a=e.locale.date.month_full,o=e.locale.date.month_full_hash={},l=0;l<a.length;l++)o[a[l]]=l},date_part:function(a){const o=new Date(a);var l=new Date(o);return o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0),o.getHours()&&(o.getDate()<l.getDate()||o.getMonth()<l.getMonth()||o.getFullYear()<l.getFullYear())&&o.setTime(o.getTime()+36e5*(24-o.getHours())),o},time_part:function(a){return(a.valueOf()/1e3-60*a.getTimezoneOffset())%86400},week_start:function(a){var o=a.getDay();return e.config.start_on_monday&&(o===0?o=6:o--),this.date_part(this.add(a,-1*o,"day"))},month_start:function(a){const o=new Date(a);return o.setDate(1),this.date_part(o)},year_start:function(a){const o=new Date(a);return o.setMonth(0),this.month_start(o)},day_start:function(a){const o=new Date(a);return this.date_part(o)},_add_days:function(a,o){var l=new Date(a.valueOf());if(l.setDate(l.getDate()+o),o==Math.round(o)&&o>0){var s=(+l-+a)%864e5;if(s&&a.getTimezoneOffset()==l.getTimezoneOffset()){var d=s/36e5;l.setTime(l.getTime()+60*(24-d)*60*1e3)}}return o>=0&&!a.getHours()&&l.getHours()&&(l.getDate()<a.getDate()||l.getMonth()<a.getMonth()||l.getFullYear()<a.getFullYear())&&l.setTime(l.getTime()+36e5*(24-l.getHours())),l},add:function(a,o,l){var s=new Date(a.valueOf());switch(l){case"day":s=e.date._add_days(s,o);break;case"week":s=e.date._add_days(s,7*o);break;case"month":s.setMonth(s.getMonth()+o);break;case"year":s.setYear(s.getFullYear()+o);break;case"hour":s.setTime(s.getTime()+60*o*60*1e3);break;case"minute":s.setTime(s.getTime()+60*o*1e3);break;default:return e.date["add_"+l](a,o,l)}return s},to_fixed:function(a){return a<10?"0"+a:a},copy:function(a){return new Date(a.valueOf())},date_to_str:function(a,o){return i()?function(l,s){return function(d){return l.replace(/%[a-zA-Z]/g,function(c){switch(c){case"%d":return s?e.date.to_fixed(d.getUTCDate()):e.date.to_fixed(d.getDate());case"%m":return s?e.date.to_fixed(d.getUTCMonth()+1):e.date.to_fixed(d.getMonth()+1);case"%j":return s?d.getUTCDate():d.getDate();case"%n":return s?d.getUTCMonth()+1:d.getMonth()+1;case"%y":return s?e.date.to_fixed(d.getUTCFullYear()%100):e.date.to_fixed(d.getFullYear()%100);case"%Y":return s?d.getUTCFullYear():d.getFullYear();case"%D":return s?e.locale.date.day_short[d.getUTCDay()]:e.locale.date.day_short[d.getDay()];case"%l":return s?e.locale.date.day_full[d.getUTCDay()]:e.locale.date.day_full[d.getDay()];case"%M":return s?e.locale.date.month_short[d.getUTCMonth()]:e.locale.date.month_short[d.getMonth()];case"%F":return s?e.locale.date.month_full[d.getUTCMonth()]:e.locale.date.month_full[d.getMonth()];case"%h":return s?e.date.to_fixed((d.getUTCHours()+11)%12+1):e.date.to_fixed((d.getHours()+11)%12+1);case"%g":return s?(d.getUTCHours()+11)%12+1:(d.getHours()+11)%12+1;case"%G":return s?d.getUTCHours():d.getHours();case"%H":return s?e.date.to_fixed(d.getUTCHours()):e.date.to_fixed(d.getHours());case"%i":return s?e.date.to_fixed(d.getUTCMinutes()):e.date.to_fixed(d.getMinutes());case"%a":return s?d.getUTCHours()>11?"pm":"am":d.getHours()>11?"pm":"am";case"%A":return s?d.getUTCHours()>11?"PM":"AM":d.getHours()>11?"PM":"AM";case"%s":return s?e.date.to_fixed(d.getUTCSeconds()):e.date.to_fixed(d.getSeconds());case"%W":return s?e.date.to_fixed(e.date.getUTCISOWeek(d)):e.date.to_fixed(e.date.getISOWeek(d));default:return c}})}}(a,o):(a=a.replace(/%[a-zA-Z]/g,function(l){switch(l){case"%d":return'"+this.date.to_fixed(date.getDate())+"';case"%m":return'"+this.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+this.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+this.locale.date.day_short[date.getDay()]+"';case"%l":return'"+this.locale.date.day_full[date.getDay()]+"';case"%M":return'"+this.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+this.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+this.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+this.date.to_fixed(date.getHours())+"';case"%i":return'"+this.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+this.date.to_fixed(date.getSeconds())+"';case"%W":return'"+this.date.to_fixed(this.date.getISOWeek(date))+"';default:return l}}),o&&(a=a.replace(/date\.get/g,"date.getUTC")),new Function("date",'return "'+a+'";').bind(e))},str_to_date:function(a,o,l){var s=i()?n:t,d=s(a,o),c=/^[0-9]{4}(\-|\/)[0-9]{2}(\-|\/)[0-9]{2} ?(([0-9]{1,2}:[0-9]{1,2})(:[0-9]{1,2})?)?$/,u=/^[0-9]{2}\/[0-9]{2}\/[0-9]{4} ?(([0-9]{1,2}:[0-9]{2})(:[0-9]{1,2})?)?$/,f=/^[0-9]{2}\-[0-9]{2}\-[0-9]{4} ?(([0-9]{1,2}:[0-9]{1,2})(:[0-9]{1,2})?)?$/,y=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,g=s("%Y-%m-%d %H:%i:%s",o),h=s("%m/%d/%Y %H:%i:%s",o),p=s("%d-%m-%Y %H:%i:%s",o);return function(v){if(!l&&!e.config.parse_exact_format){if(v&&v.getISOWeek)return new Date(v);if(typeof v=="number")return new Date(v);if(x=v,c.test(String(x)))return g(v);if(function(S){return u.test(String(S))}(v))return h(v);if(function(S){return f.test(String(S))}(v))return p(v);if(function(S){return y.test(S)}(v))return new Date(v)}var x;return d.call(e,v)}},getISOWeek:function(a){if(!a)return!1;var o=(a=this.date_part(new Date(a))).getDay();o===0&&(o=7);var l=new Date(a.valueOf());l.setDate(a.getDate()+(4-o));var s=l.getFullYear(),d=Math.round((l.getTime()-new Date(s,0,1).getTime())/864e5);return 1+Math.floor(d/7)},getUTCISOWeek:function(a){return this.getISOWeek(this.convert_to_utc(a))},convert_to_utc:function(a){return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())}}}function El(e){return(function(){var t={};for(var n in this._events){var r=this._events[n];r.id.toString().indexOf("#")==-1&&(t[r.id]=r)}return t}).bind(e)}function Wc(e){e._loaded={},e._load=function(n,r){if(n=n||this._load_url){var i;if(n+=(n.indexOf("?")==-1?"?":"&")+"timeshift="+new Date().getTimezoneOffset(),this.config.prevent_cache&&(n+="&uid="+this.uid()),r=r||this._date,this._load_mode){var a=this.templates.load_format;for(r=this.date[this._load_mode+"_start"](new Date(r.valueOf()));r>this._min_date;)r=this.date.add(r,-1,this._load_mode);i=r;for(var o=!0;i<this._max_date;)i=this.date.add(i,1,this._load_mode),this._loaded[a(r)]&&o?r=this.date.add(r,1,this._load_mode):o=!1;var l=i;do i=l,l=this.date.add(i,-1,this._load_mode);while(l>r&&this._loaded[a(l)]);if(i<=r)return!1;for(e.ajax.get(n+"&from="+a(r)+"&to="+a(i),s);r<i;)this._loaded[a(r)]=!0,r=this.date.add(r,1,this._load_mode)}else e.ajax.get(n,s);return this.callEvent("onXLS",[]),this.callEvent("onLoadStart",[]),!0}function s(d){e.on_load(d),e.callEvent("onLoadEnd",[])}},e._parsers={},function(n){n._parsers.xml={canParse:function(r,i){if(i.responseXML&&i.responseXML.firstChild)return!0;try{var a=n.ajax.parse(i.responseText),o=n.ajax.xmltop("data",a);if(o&&o.tagName==="data")return!0}catch{}return!1},parse:function(r){var i;if(r.xmlDoc.responseXML||(r.xmlDoc.responseXML=n.ajax.parse(r.xmlDoc.responseText)),(i=n.ajax.xmltop("data",r.xmlDoc)).tagName!="data")return null;var a=i.getAttribute("dhx_security");a&&(window.dhtmlx&&(window.dhtmlx.security_key=a),n.security_key=a);for(var o=n.ajax.xpath("//coll_options",r.xmlDoc),l=0;l<o.length;l++){var s=o[l].getAttribute("for"),d=n.serverList[s];d||(n.serverList[s]=d=[]),d.splice(0,d.length);for(var c=n.ajax.xpath(".//item",o[l]),u=0;u<c.length;u++){for(var f=c[u].attributes,y={key:c[u].getAttribute("value"),label:c[u].getAttribute("label")},g=0;g<f.length;g++){var h=f[g];h.nodeName!="value"&&h.nodeName!="label"&&(y[h.nodeName]=h.nodeValue)}d.push(y)}}o.length&&n.callEvent("onOptionsLoad",[]);var p=n.ajax.xpath("//userdata",r.xmlDoc);for(l=0;l<p.length;l++){var v=n._xmlNodeToJSON(p[l]);n._userdata[v.name]=v.text}var x=[];for(i=n.ajax.xpath("//event",r.xmlDoc),l=0;l<i.length;l++){var S=x[l]=n._xmlNodeToJSON(i[l]);n._init_event(S)}return x}}}(e),function(n){n.json=n._parsers.json={canParse:function(r){if(r&&typeof r=="object")return!0;if(typeof r=="string")try{var i=JSON.parse(r);return Object.prototype.toString.call(i)==="[object Object]"||Object.prototype.toString.call(i)==="[object Array]"}catch{return!1}return!1},parse:function(r){var i=[];typeof r=="string"&&(r=JSON.parse(r)),Object.prototype.toString.call(r)==="[object Array]"?i=r:r&&(r.events?i=r.events:r.data&&(i=r.data)),i=i||[],r.dhx_security&&(window.dhtmlx&&(window.dhtmlx.security_key=r.dhx_security),n.security_key=r.dhx_security);var a=r&&r.collections?r.collections:{},o=!1;for(var l in a)if(a.hasOwnProperty(l)){o=!0;var s=a[l],d=n.serverList[l];d||(n.serverList[l]=d=[]),d.splice(0,d.length);for(var c=0;c<s.length;c++){var u=s[c],f={key:u.value,label:u.label};for(var y in u)if(u.hasOwnProperty(y)){if(y=="value"||y=="label")continue;f[y]=u[y]}d.push(f)}}o&&n.callEvent("onOptionsLoad",[]);for(var g=[],h=0;h<i.length;h++){var p=i[h];n._init_event(p),g.push(p)}return g}}}(e),function(n){n.ical=n._parsers.ical={canParse:function(r){return typeof r=="string"&&new RegExp("^BEGIN:VCALENDAR").test(r)},parse:function(r){var i=r.match(RegExp(this.c_start+"[^\f]*"+this.c_end,""));if(i.length){i[0]=i[0].replace(/[\r\n]+ /g,""),i[0]=i[0].replace(/[\r\n]+(?=[a-z \t])/g," "),i[0]=i[0].replace(/;[^:\r\n]*:/g,":");for(var a,o=[],l=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");(a=l.exec(i))!==null;){for(var s,d={},c=/[^\r\n]+[\r\n]+/g;(s=c.exec(a[1]))!==null;)this.parse_param(s.toString(),d);d.uid&&!d.id&&(d.id=d.uid),o.push(d)}return o}},parse_param:function(r,i){var a=r.indexOf(":");if(a!=-1){var o=r.substr(0,a).toLowerCase(),l=r.substr(a+1).replace(/\\,/g,",").replace(/[\r\n]+$/,"");o=="summary"?o="text":o=="dtstart"?(o="start_date",l=this.parse_date(l,0,0)):o=="dtend"&&(o="end_date",l=this.parse_date(l,0,0)),i[o]=l}},parse_date:function(r,i,a){var o=r.split("T"),l=!1;o[1]&&(i=o[1].substr(0,2),a=o[1].substr(2,2),l=o[1][6]=="Z");var s=o[0].substr(0,4),d=parseInt(o[0].substr(4,2),10)-1,c=o[0].substr(6,2);return n.config.server_utc||l?new Date(Date.UTC(s,d,c,i,a)):new Date(s,d,c,i,a)},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"}}(e),e.on_load=function(n){var r;this.callEvent("onBeforeParse",[]);var i=!1,a=!1;for(var o in this._parsers){var l=this._parsers[o];if(l.canParse(n.xmlDoc.responseText,n.xmlDoc)){try{var s=n.xmlDoc.responseText;o==="xml"&&(s=n),(r=l.parse(s))||(i=!0)}catch{i=!0}a=!0;break}}if(!a)if(this._process&&this[this._process])try{r=this[this._process].parse(n.xmlDoc.responseText)}catch{i=!0}else i=!0;(i||n.xmlDoc.status&&n.xmlDoc.status>=400)&&(this.callEvent("onLoadError",[n.xmlDoc]),r=[]),this._process_loading(r),this.callEvent("onXLE",[]),this.callEvent("onParse",[])},e._process_loading=function(n){this._loading=!0,this._not_render=!0;for(var r=0;r<n.length;r++)this.callEvent("onEventLoading",[n[r]])&&this.addEvent(n[r]);this._not_render=!1,this._render_wait&&this.render_view_data(),this._loading=!1,this._after_call&&this._after_call(),this._after_call=null},e._init_event=function(n){n.text=n.text||n._tagvalue||"",n.start_date=e._init_date(n.start_date),n.end_date=e._init_date(n.end_date)},e._init_date=function(n){return n?typeof n=="string"?e._helpers.parseDate(n):new Date(n):null};const t=El(e);e.serialize=function(){const n=[],r=t();for(var i in r){const l={};var a=r[i];for(var o in a){if(o.charAt(0)=="$"||o.charAt(0)=="_")continue;let s;const d=a[o];s=e.utils.isDate(d)?e.defined(e.templates.xml_format)?e.templates.xml_format(d):e.templates.format_date(d):d,l[o]=s}n.push(l)}return n},e.parse=function(n,r){this._process=r,this.on_load({xmlDoc:{responseText:n}})},e.load=function(n,r){typeof r=="string"&&(this._process=r,r=arguments[2]),this._load_url=n,this._after_call=r,this._load(n,this._date)},e.setLoadMode=function(n){n=="all"&&(n=""),this._load_mode=n},e.serverList=function(n,r){return r?(this.serverList[n]=r.slice(0),this.serverList[n]):(this.serverList[n]=this.serverList[n]||[],this.serverList[n])},e._userdata={},e._xmlNodeToJSON=function(n){for(var r={},i=0;i<n.attributes.length;i++)r[n.attributes[i].name]=n.attributes[i].value;for(i=0;i<n.childNodes.length;i++){var a=n.childNodes[i];a.nodeType==1&&(r[a.tagName]=a.firstChild?a.firstChild.nodeValue:"")}return r.text||(r.text=n.firstChild?n.firstChild.nodeValue:""),r},e.attachEvent("onXLS",function(){var n;this.config.show_loading===!0&&((n=this.config.show_loading=document.createElement("div")).className="dhx_loading",n.style.left=Math.round((this._x-128)/2)+"px",n.style.top=Math.round((this._y-15)/2)+"px",this._obj.appendChild(n))}),e.attachEvent("onXLE",function(){var n=this.config.show_loading;n&&typeof n=="object"&&(n.parentNode&&n.parentNode.removeChild(n),this.config.show_loading=!0)})}function Kc(e){function t(){const n=e.config.csp===!0,r=!!window.Sfdc||!!window.$A||window.Aura||"$shadowResolver$"in document.body;return n||r?e.$root:document.body}e._lightbox_controls={},e.formSection=function(n){for(var r=this.config.lightbox.sections,i=0;i<r.length&&r[i].name!=n;i++);if(i===r.length)return null;var a=r[i];e._lightbox||e.getLightbox();var o=e._lightbox.querySelector(`#${a.id}`),l=o.nextSibling,s={section:a,header:o,node:l,getValue:function(c){return e.form_blocks[a.type].get_value(l,c||{},a)},setValue:function(c,u){return e.form_blocks[a.type].set_value(l,c,u||{},a)}},d=e._lightbox_controls["get_"+a.type+"_control"];return d?d(s):s},e._lightbox_controls.get_template_control=function(n){return n.control=n.node,n},e._lightbox_controls.get_select_control=function(n){return n.control=n.node.getElementsByTagName("select")[0],n},e._lightbox_controls.get_textarea_control=function(n){return n.control=n.node.getElementsByTagName("textarea")[0],n},e._lightbox_controls.get_time_control=function(n){return n.control=n.node.getElementsByTagName("select"),n},e._lightbox_controls.defaults={template:{height:30},textarea:{height:200},select:{height:23},time:{height:20}},e.form_blocks={template:{render:function(n){return`<div class='dhx_cal_ltext dhx_cal_template' ${n.height?`style='height:${n.height}px;'`:""}></div>`},set_value:function(n,r,i,a){n.innerHTML=r||""},get_value:function(n,r,i){return n.innerHTML||""},focus:function(n){}},textarea:{render:function(n){return`<div class='dhx_cal_ltext' ${n.height?`style='height:${n.height}px;'`:""}><textarea ${n.placeholder?`placeholder='${n.placeholder}'`:""}></textarea></div>`},set_value:function(n,r,i){e.form_blocks.textarea._get_input(n).value=r||""},get_value:function(n,r){return e.form_blocks.textarea._get_input(n).value},focus:function(n){var r=e.form_blocks.textarea._get_input(n);e._focus(r,!0)},_get_input:function(n){return n.getElementsByTagName("textarea")[0]}},select:{render:function(n){for(var r=`<div class='dhx_cal_ltext dhx_cal_select' ${n.height?`style='height:${n.height}px;'`:""}><select style='width:100%;'>`,i=0;i<n.options.length;i++)r+="<option value='"+n.options[i].key+"'>"+n.options[i].label+"</option>";return r+="</select></div>"},set_value:function(n,r,i,a){var o=n.firstChild;!o._dhx_onchange&&a.onchange&&(e.event(o,"change",a.onchange),o._dhx_onchange=!0),r===void 0&&(r=(o.options[0]||{}).value),o.value=r||""},get_value:function(n,r){return n.firstChild.value},focus:function(n){var r=n.firstChild;e._focus(r,!0)}},time:{render:function(n){n.time_format||(n.time_format=["%H:%i","%d","%m","%Y"]),n._time_format_order={};var r=n.time_format,i=e.config,a=e.date.date_part(e._currentDate()),o=1440,l=0;e.config.limit_time_select&&(o=60*i.last_hour+1,l=60*i.first_hour,a.setHours(i.first_hour));for(var s="",d=0;d<r.length;d++){var c=r[d];d>0&&(s+=" ");var u="",f="";switch(c){case"%Y":var y,g,h;u="dhx_lightbox_year_select",n._time_format_order[3]=d,n.year_range&&(isNaN(n.year_range)?n.year_range.push&&(g=n.year_range[0],h=n.year_range[1]):y=n.year_range),y=y||10;var p=p||Math.floor(y/2);g=g||a.getFullYear()-p,h=h||g+y;for(var v=g;v<h;v++)f+="<option value='"+v+"'>"+v+"</option>";break;case"%m":for(u="dhx_lightbox_month_select",n._time_format_order[2]=d,v=0;v<12;v++)f+="<option value='"+v+"'>"+this.locale.date.month_full[v]+"</option>";break;case"%d":for(u="dhx_lightbox_day_select",n._time_format_order[1]=d,v=1;v<32;v++)f+="<option value='"+v+"'>"+v+"</option>";break;case"%H:%i":u="dhx_lightbox_time_select",n._time_format_order[0]=d,v=l;var x=a.getDate();for(n._time_values=[];v<o;)f+="<option value='"+v+"'>"+this.templates.time_picker(a)+"</option>",n._time_values.push(v),a.setTime(a.valueOf()+60*this.config.time_step*1e3),v=24*(a.getDate()!=x?1:0)*60+60*a.getHours()+a.getMinutes()}if(f){var S=e._waiAria.lightboxSelectAttrString(c);s+="<select class='"+u+"' "+(n.readonly?"disabled='disabled'":"")+S+">"+f+"</select> "}}return`<div class='dhx_section_time' ${n.height?`style='height:${n.height}px;'`:""}>${s}<span style='font-weight:normal; font-size:10pt;' class='dhx_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>${s}</div>`},set_value:function(n,r,i,a){var o,l,s=e.config,d=n.getElementsByTagName("select"),c=a._time_format_order;if(s.full_day){if(!n._full_day){var u="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+e.locale.labels.full_day+"&nbsp;</label></input>";e.config.wide_form||(u=n.previousSibling.innerHTML+u),n.previousSibling.innerHTML=u,n._full_day=!0}var f=n.previousSibling.getElementsByTagName("input")[0];f.checked=e.date.time_part(i.start_date)===0&&e.date.time_part(i.end_date)===0,d[c[0]].disabled=f.checked,d[c[0]+d.length/2].disabled=f.checked,f.$_eventAttached||(f.$_eventAttached=!0,e.event(f,"click",function(){if(f.checked){var p={};e.form_blocks.time.get_value(n,p,a),o=e.date.date_part(p.start_date),(+(l=e.date.date_part(p.end_date))==+o||+l>=+o&&(i.end_date.getHours()!==0||i.end_date.getMinutes()!==0))&&(l=e.date.add(l,1,"day"))}else o=null,l=null;d[c[0]].disabled=f.checked,d[c[0]+d.length/2].disabled=f.checked,h(d,0,o||i.start_date),h(d,4,l||i.end_date)}))}if(s.auto_end_date&&s.event_duration)for(var y=function(){s.auto_end_date&&s.event_duration&&(o=new Date(d[c[3]].value,d[c[2]].value,d[c[1]].value,0,d[c[0]].value),l=new Date(o.getTime()+60*e.config.event_duration*1e3),h(d,4,l))},g=0;g<4;g++)d[g].$_eventAttached||(d[g].$_eventAttached=!0,e.event(d[g],"change",y));function h(p,v,x){for(var S=a._time_values,O=60*x.getHours()+x.getMinutes(),N=O,I=!1,A=0;A<S.length;A++){var m=S[A];if(m===O){I=!0;break}m<O&&(N=m)}p[v+c[0]].value=I?O:N,I||N||(p[v+c[0]].selectedIndex=-1),p[v+c[1]].value=x.getDate(),p[v+c[2]].value=x.getMonth(),p[v+c[3]].value=x.getFullYear()}h(d,0,i.start_date),h(d,4,i.end_date)},get_value:function(n,r,i){var a=n.getElementsByTagName("select"),o=i._time_format_order;if(r.start_date=new Date(a[o[3]].value,a[o[2]].value,a[o[1]].value,0,a[o[0]].value),r.end_date=new Date(a[o[3]+4].value,a[o[2]+4].value,a[o[1]+4].value,0,a[o[0]+4].value),!a[o[3]].value||!a[o[3]+4].value){var l=e.getEvent(e._lightbox_id);l&&(r.start_date=l.start_date,r.end_date=l.end_date)}return r.end_date<=r.start_date&&(r.end_date=e.date.add(r.start_date,e.config.time_step,"minute")),{start_date:new Date(r.start_date),end_date:new Date(r.end_date)}},focus:function(n){e._focus(n.getElementsByTagName("select")[0])}}},e._setLbPosition=function(n){n&&(n.style.top=Math.max(t().offsetHeight/2-n.offsetHeight/2,0)+"px",n.style.left=Math.max(t().offsetWidth/2-n.offsetWidth/2,0)+"px")},e.showCover=function(n){n&&(n.style.display="block",this._setLbPosition(n)),e.config.responsive_lightbox&&(document.documentElement.classList.add("dhx_cal_overflow_container"),t().classList.add("dhx_cal_overflow_container")),this.show_cover(),this._cover.style.display=""},e.showLightbox=function(n){if(n)if(this.callEvent("onBeforeLightbox",[n])){this.showCover(r);var r=this.getLightbox();this._setLbPosition(r),this._fill_lightbox(n,r),this._waiAria.lightboxVisibleAttr(r),this.callEvent("onLightbox",[n])}else this._new_event&&(this._new_event=null)},e._fill_lightbox=function(n,r){var i=this.getEvent(n),a=r.getElementsByTagName("span"),o=[];if(e.templates.lightbox_header){o.push("");var l=e.templates.lightbox_header(i.start_date,i.end_date,i);o.push(l),a[1].innerHTML="",a[2].innerHTML=l}else{var s=this.templates.event_header(i.start_date,i.end_date,i),d=(this.templates.event_bar_text(i.start_date,i.end_date,i)||"").substr(0,70);o.push(s),o.push(d),a[1].innerHTML=s,a[2].innerHTML=d}this._waiAria.lightboxHeader(r,o.join(" "));for(var c=this.config.lightbox.sections,u=0;u<c.length;u++){var f=c[u],y=e._get_lightbox_section_node(f),g=this.form_blocks[f.type],h=i[f.map_to]!==void 0?i[f.map_to]:f.default_value;g.set_value.call(this,y,h,i,f),c[u].focus&&g.focus.call(this,y)}e._lightbox_id=n},e._get_lightbox_section_node=function(n){return e._lightbox.querySelector(`#${n.id}`).nextSibling},e._lightbox_out=function(n){for(var r=this.config.lightbox.sections,i=0;i<r.length;i++){var a=e._lightbox.querySelector(`#${r[i].id}`);a=a&&a.nextSibling;var o=this.form_blocks[r[i].type].get_value.call(this,a,n,r[i]);r[i].map_to!="auto"&&(n[r[i].map_to]=o)}return n},e._empty_lightbox=function(n){var r=e._lightbox_id,i=this.getEvent(r);this._lame_copy(i,n),this.setEvent(i.id,i),this._edit_stop_event(i,!0),this.render_view_data()},e.hide_lightbox=function(n){e.endLightbox(!1,this.getLightbox())},e.hideCover=function(n){n&&(n.style.display="none"),this.hide_cover(),e.config.responsive_lightbox&&(document.documentElement.classList.remove("dhx_cal_overflow_container"),t().classList.remove("dhx_cal_overflow_container"))},e.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},e.show_cover=function(){this._cover||(this._cover=document.createElement("div"),this._cover.className="dhx_cal_cover",this._cover.style.display="none",e.event(this._cover,"mousemove",e._move_while_dnd),e.event(this._cover,"mouseup",e._finish_dnd),t().appendChild(this._cover))},e.save_lightbox=function(){var n=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));this.checkEvent("onEventSave")&&!this.callEvent("onEventSave",[this._lightbox_id,n,this._new_event])||(this._empty_lightbox(n),this.hide_lightbox())},e.startLightbox=function(n,r){this._lightbox_id=n,this._custom_lightbox=!0,this._temp_lightbox=this._lightbox,this._lightbox=r,this.showCover(r)},e.endLightbox=function(n,r){r=r||e.getLightbox();var i=e.getEvent(this._lightbox_id);i&&this._edit_stop_event(i,n),n&&e.render_view_data(),this.hideCover(r),this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1),this._temp_lightbox=this._lightbox_id=null,this._waiAria.lightboxHiddenAttr(r),this.resetLightbox(),this.callEvent("onAfterLightbox",[])},e.resetLightbox=function(){e._lightbox&&!e._custom_lightbox&&e._lightbox.parentNode.removeChild(e._lightbox),e._lightbox=null},e.cancel_lightbox=function(){this._lightbox_id&&this.callEvent("onEventCancel",[this._lightbox_id,!!this._new_event]),this.hide_lightbox()},e.hideLightbox=e.cancel_lightbox,e._init_lightbox_events=function(){if(this.getLightbox().$_eventAttached)return;const n=this.getLightbox();n.$_eventAttached=!0,e.event(n,"click",function(r){r.target.closest(".dhx_cal_ltitle_close_btn")&&e.cancel_lightbox();const i=e.$domHelpers.closest(r.target,".dhx_btn_set");if(!i){const l=e.$domHelpers.closest(r.target,".dhx_custom_button[data-section-index]");if(l){const s=Number(l.getAttribute("data-section-index"));e.form_blocks[e.config.lightbox.sections[s].type].button_click(e.$domHelpers.closest(l,".dhx_cal_lsection"),l,r)}return}const a=i?i.getAttribute("data-action"):null;switch(a){case"dhx_save_btn":case"save":if(e.config.readonly_active)return;e.save_lightbox();break;case"dhx_delete_btn":case"delete":if(e.config.readonly_active)return;var o=e.locale.labels.confirm_deleting;e._dhtmlx_confirm({message:o,title:e.locale.labels.title_confirm_deleting,callback:function(){let l=e.getEvent(e._lightbox_id);l._thisAndFollowing?(l._removeFollowing=!0,e.callEvent("onEventSave",[l.id,l,e._new_event])):e.deleteEvent(e._lightbox_id),e._new_event=null,e.hide_lightbox()},config:{ok:e.locale.labels.icon_delete}});break;case"dhx_cancel_btn":case"cancel":e.cancel_lightbox();break;default:e.callEvent("onLightboxButton",[a,i,r])}}),e.event(n,"keydown",function(r){var i=r||window.event,a=r.target||r.srcElement,o=a.querySelector("[dhx_button]");switch(o||(o=a.parentNode.querySelector(".dhx_custom_button, .dhx_readonly")),(r||i).keyCode){case 32:if((r||i).shiftKey)return;o&&o.click&&o.click();break;case e.keys.edit_save:if((r||i).shiftKey)return;if(o&&o.click)o.click();else{if(e.config.readonly_active)return;e.save_lightbox()}break;case e.keys.edit_cancel:e.cancel_lightbox()}}),e.event(n,"click",function(r){if(r.target.closest(".dhx_lightbox_day_select")||r.target.closest(".dhx_lightbox_month_select")){const i=n.querySelectorAll(".dhx_lightbox_month_select"),a=n.querySelectorAll(".dhx_lightbox_day_select"),o=n.querySelectorAll(".dhx_lightbox_year_select");i.length&&a.length&&o&&i.forEach((l,s)=>{const d=a[s],c=parseInt(l.value,10);let u=parseInt(o[s].value,10);u||(u=new Date(e.getState().date).getFullYear());const f=function(h,p){return new Date(h,p+1,0).getDate()}(u,c),y=f||31;let g=d.value;d.innerHTML="";for(let h=1;h<=y;h++){const p=document.createElement("option");p.value=h,p.textContent=h,d.appendChild(p)}d.value=Math.min(g,y)})}})},e.setLightboxSize=function(){},e._init_dnd_events=function(){e.event(t(),"mousemove",e._move_while_dnd),e.event(t(),"mouseup",e._finish_dnd),e._init_dnd_events=function(){}},e._move_while_dnd=function(n){if(e._dnd_start_lb){document.dhx_unselectable||(t().classList.add("dhx_unselectable"),document.dhx_unselectable=!0);var r=e.getLightbox(),i=[n.pageX,n.pageY];r.style.top=e._lb_start[1]+i[1]-e._dnd_start_lb[1]+"px",r.style.left=e._lb_start[0]+i[0]-e._dnd_start_lb[0]+"px"}},e._ready_to_dnd=function(n){var r=e.getLightbox();e._lb_start=[r.offsetLeft,r.offsetTop],e._dnd_start_lb=[n.pageX,n.pageY]},e._finish_dnd=function(){e._lb_start&&(e._lb_start=e._dnd_start_lb=!1,t().classList.remove("dhx_unselectable"),document.dhx_unselectable=!1)},e.getLightbox=function(){if(!this._lightbox){var n=document.createElement("div");n.className="dhx_cal_light",e.config.wide_form&&(n.className+=" dhx_cal_light_wide"),e.form_blocks.recurring&&(n.className+=" dhx_cal_light_rec"),e.config.rtl&&(n.className+=" dhx_cal_light_rtl"),e.config.responsive_lightbox&&(n.className+=" dhx_cal_light_responsive"),n.style.visibility="hidden";var r=this._lightbox_template,i=this.config.buttons_right;r+="<div class='dhx_cal_lcontrols'>";for(var a=0;a<i.length;a++)r+="<div "+this._waiAria.lightboxButtonAttrString(i[a])+" data-action='"+i[a]+"' class='dhx_btn_set dhx_"+(e.config.rtl?"right":"left")+"_btn_set "+i[a]+"_set'><div class='dhx_btn_inner "+i[a]+"'></div><div>"+e.locale.labels[i[a]]+"</div></div>";i=this.config.buttons_left;var o=e.config.rtl;for(a=0;a<i.length;a++)r+="<div class='dhx_cal_lcontrols_push_right'></div>",r+="<div "+this._waiAria.lightboxButtonAttrString(i[a])+" data-action='"+i[a]+"' class='dhx_btn_set dhx_"+(o?"left":"right")+"_btn_set "+i[a]+"_set'><div class='dhx_btn_inner "+i[a]+"'></div><div>"+e.locale.labels[i[a]]+"</div></div>";r+="</div>",r+="</div>",n.innerHTML=r,e.config.drag_lightbox&&(e.event(n.firstChild,"mousedown",e._ready_to_dnd),e.event(n.firstChild,"selectstart",function(y){return y.preventDefault(),!1}),n.firstChild.style.cursor="move",e._init_dnd_events()),this._waiAria.lightboxAttr(n),this.show_cover(),this._cover.insertBefore(n,this._cover.firstChild),this._lightbox=n;var l=this.config.lightbox.sections;for(r="",a=0;a<l.length;a++){var s=this.form_blocks[l[a].type];if(s){l[a].id="area_"+this.uid();var d="";l[a].button&&(d="<div "+e._waiAria.lightboxSectionButtonAttrString(this.locale.labels["button_"+l[a].button])+" class='dhx_custom_button' data-section-index='"+a+"' index='"+a+"'><div class='dhx_custom_button_"+l[a].button+"'></div><div>"+this.locale.labels["button_"+l[a].button]+"</div></div>"),this.config.wide_form&&(r+="<div class='dhx_wrap_section'>");var c=this.locale.labels["section_"+l[a].name];typeof c!="string"&&(c=l[a].name),r+="<div id='"+l[a].id+"' class='dhx_cal_lsection dhx_cal_lsection_"+l[a].name+"'>"+d+"<label>"+c+"</label></div>"+s.render.call(this,l[a]),r+="</div>"}}var u=n.getElementsByTagName("div");for(a=0;a<u.length;a++){var f=u[a];if(e._getClassName(f)=="dhx_cal_larea"){f.innerHTML=r;break}}e._bindLightboxLabels(l),this.setLightboxSize(),this._init_lightbox_events(this),n.style.visibility="visible"}return this._lightbox},e._bindLightboxLabels=function(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.id&&e._lightbox.querySelector(`#${i.id}`)){for(var a=e._lightbox.querySelector(`#${i.id}`).querySelector("label"),o=e._get_lightbox_section_node(i);o&&!o.querySelector;)o=o.nextSibling;var l=!0;if(o){var s=o.querySelector("input, select, textarea");s&&(i.inputId=s.id||"input_"+e.uid(),s.id||(s.id=i.inputId),a.setAttribute("for",i.inputId),l=!1)}l&&e.form_blocks[i.type].focus&&e.event(a,"click",function(d){return function(){var c=e.form_blocks[d.type],u=e._get_lightbox_section_node(d);c&&c.focus&&c.focus.call(e,u)}}(i))}}},e.attachEvent("onEventIdChange",function(n,r){this._lightbox_id==n&&(this._lightbox_id=r)}),e._lightbox_template=`<div class='dhx_cal_ltitle'><div class="dhx_cal_ltitle_descr"><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span>
</div>
<div class="dhx_cal_ltitle_controls">
<a class="dhx_cal_ltitle_close_btn scheduler_icon close"></a>
</div></div><div class='dhx_cal_larea'></div>`}function Gc(e){e._init_touch_events=function(){if((this.config.touch&&(navigator.userAgent.indexOf("Mobile")!=-1||navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("Android")!=-1||navigator.userAgent.indexOf("Touch")!=-1)&&!window.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&(this.xy.scroll_width=0,this._mobile=!0),this.config.touch){var t=!0;try{document.createEvent("TouchEvent")}catch{t=!1}t?this._touch_events(["touchmove","touchstart","touchend"],function(n){return n.touches&&n.touches.length>1?null:n.touches[0]?{target:n.target,pageX:n.touches[0].pageX,pageY:n.touches[0].pageY,clientX:n.touches[0].clientX,clientY:n.touches[0].clientY}:n},function(){return!1}):window.PointerEvent||window.navigator.pointerEnabled?this._touch_events(["pointermove","pointerdown","pointerup"],function(n){return n.pointerType=="mouse"?null:n},function(n){return!n||n.pointerType=="mouse"}):window.navigator.msPointerEnabled&&this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(n){return n.pointerType==n.MSPOINTER_TYPE_MOUSE?null:n},function(n){return!n||n.pointerType==n.MSPOINTER_TYPE_MOUSE})}},e._touch_events=function(t,n,r){var i,a,o,l,s,d,c=0;function u(y,g,h){e.event(y,g,function(p){return!!e._is_lightbox_open()||(r(p)?void 0:h(p))},{passive:!1})}function f(y){r(y)||(e._hide_global_tip(),l&&(e._on_mouse_up(n(y)),e._temp_touch_block=!1),e._drag_id=null,e._drag_mode=null,e._drag_pos=null,e._pointerDragId=null,clearTimeout(o),l=d=!1,s=!0)}u(document.body,t[0],function(y){if(!r(y)){var g=n(y);if(g){if(l)return function(h){if(!r(h)){var p=e.getState().drag_mode,v=!!e.matrix&&e.matrix[e._mode],x=e.render_view_data;p=="create"&&v&&(e.render_view_data=function(){for(var S=e.getState().drag_id,O=e.getEvent(S),N=v.y_property,I=e.getEvents(O.start_date,O.end_date),A=0;A<I.length;A++)I[A][N]!=O[N]&&(I.splice(A,1),A--);O._sorder=I.length-1,O._count=I.length,this.render_data([O],e.getState().mode)}),e._on_mouse_move(h),p=="create"&&v&&(e.render_view_data=x),h.preventDefault&&h.preventDefault(),h.cancelBubble=!0}}(g),y.preventDefault&&y.preventDefault(),y.cancelBubble=!0,e._update_global_tip(),!1;a=n(y),d&&(a?(i.target!=a.target||Math.abs(i.pageX-a.pageX)>5||Math.abs(i.pageY-a.pageY)>5)&&(s=!0,clearTimeout(o)):s=!0)}}}),u(this._els.dhx_cal_data[0],"touchcancel",f),u(this._els.dhx_cal_data[0],"contextmenu",function(y){if(!r(y))return d?(y&&y.preventDefault&&y.preventDefault(),y.cancelBubble=!0,!1):void 0}),u(this._obj,t[1],function(y){var g;if(document&&document.body&&document.body.classList.add("dhx_cal_touch_active"),!r(y))if(e._pointerDragId=y.pointerId,l=s=!1,d=!0,g=a=n(y)){var h=new Date;if(!s&&!l&&h-c<250)return e._click.dhx_cal_data(g),window.setTimeout(function(){e.$destroyed||e._on_dbl_click(g)},50),y.preventDefault&&y.preventDefault(),y.cancelBubble=!0,e._block_next_stop=!0,!1;if(c=h,!s&&!l&&e.config.touch_drag){var p=e._locate_event(document.activeElement),v=e._locate_event(g.target),x=i?e._locate_event(i.target):null;if(p&&v&&p==v&&p!=x)return y.preventDefault&&y.preventDefault(),y.cancelBubble=!0,e._ignore_next_click=!1,e._click.dhx_cal_data(g),i=g,!1;o=setTimeout(function(){if(!e.$destroyed){l=!0;var S=i.target,O=e._getClassName(S);S&&O.indexOf("dhx_body")!=-1&&(S=S.previousSibling),e._on_mouse_down(i,S),e._drag_mode&&e._drag_mode!="create"&&e.for_rendered(e._drag_id,function(N,I){N.style.display="none",e._rendered.splice(I,1)}),e.config.touch_tip&&e._show_global_tip(),e.updateEvent(e._drag_id)}},e.config.touch_drag),i=g}}else s=!0}),u(this._els.dhx_cal_data[0],t[2],function(y){if(document&&document.body&&document.body.classList.remove("dhx_cal_touch_active"),!r(y))return e.config.touch_swipe_dates&&!l&&function(g,h,p,v){if(!g||!h)return!1;for(var x=g.target;x&&x!=e._obj;)x=x.parentNode;if(x!=e._obj||e.matrix&&e.matrix[e.getState().mode]&&e.matrix[e.getState().mode].scrollable)return!1;var S=Math.abs(g.pageY-h.pageY),O=Math.abs(g.pageX-h.pageX);return S<v&&O>p&&(!S||O/S>3)&&(g.pageX>h.pageX?e._click.dhx_cal_next_button():e._click.dhx_cal_prev_button(),!0)}(i,a,200,100)&&(e._block_next_stop=!0),l&&(e._ignore_next_click=!0,setTimeout(function(){e._ignore_next_click=!1},100)),f(y),e._block_next_stop?(e._block_next_stop=!1,y.preventDefault&&y.preventDefault(),y.cancelBubble=!0,!1):void 0}),e.event(document.body,t[2],f)},e._show_global_tip=function(){e._hide_global_tip();var t=e._global_tip=document.createElement("div");t.className="dhx_global_tip",e._update_global_tip(1),document.body.appendChild(t)},e._update_global_tip=function(t){var n=e._global_tip;if(n){var r="";if(e._drag_id&&!t){var i=e.getEvent(e._drag_id);i&&(r="<div>"+(i._timed?e.templates.event_header(i.start_date,i.end_date,i):e.templates.day_date(i.start_date,i.end_date,i))+"</div>")}e._drag_mode=="create"||e._drag_mode=="new-size"?n.innerHTML=(e.locale.labels.drag_to_create||"Drag to create")+r:n.innerHTML=(e.locale.labels.drag_to_move||"Drag to move")+r}},e._hide_global_tip=function(){var t=e._global_tip;t&&t.parentNode&&(t.parentNode.removeChild(t),e._global_tip=0)}}function Jc(e){var t,n;function r(){if(e._is_material_skin())return!0;if(n!==void 0)return n;var l=document.createElement("div");l.style.position="absolute",l.style.left="-9999px",l.style.top="-9999px",l.innerHTML="<div class='dhx_cal_container'><div class='dhx_cal_data'><div class='dhx_cal_event'><div class='dhx_body'></div></div><div>",document.body.appendChild(l);var s=window.getComputedStyle(l.querySelector(".dhx_body")).getPropertyValue("box-sizing");document.body.removeChild(l),(n=s==="border-box")||setTimeout(function(){n=void 0},1e3)}function i(){if(!e._is_material_skin()&&!e._border_box_events()){var l=n;n=void 0,t=void 0,l!==r()&&e.$container&&e.getState().mode&&e.setCurrentView()}}function a(l){var s=l.getMinutes();return s=s<10?"0"+s:s,"<span class='dhx_scale_h'>"+l.getHours()+"</span><span class='dhx_scale_m'>&nbsp;"+s+"</span>"}e._addThemeClass=function(){document.documentElement.setAttribute("data-scheduler-theme",e.skin)},e._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]},e._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]},e._is_material_skin=function(){return e.skin?(e.skin+"").indexOf("material")>-1:function(){if(t===void 0){var l=document.createElement("div");l.style.position="absolute",l.style.left="-9999px",l.style.top="-9999px",l.innerHTML="<div class='dhx_cal_container'><div class='dhx_cal_scale_placeholder'></div><div>",document.body.appendChild(l);var s=window.getComputedStyle(l.querySelector(".dhx_cal_scale_placeholder")).getPropertyValue("position");t=s==="absolute",setTimeout(function(){t=null,l&&l.parentNode&&l.parentNode.removeChild(l)},500)}return t}()},e._build_skin_info=function(){(function(){const y=e.$container;clearInterval(o),y&&(o=setInterval(()=>{const g=getComputedStyle(y).getPropertyValue("--dhx-scheduler-theme");g&&g!==e.skin&&e.setSkin(g)},100))})();const l=getComputedStyle(this.$container),s=l.getPropertyValue("--dhx-scheduler-theme");let d,c=!!s,u={},f=!1;if(c){d=s;for(let y in e.xy)u[y]=l.getPropertyValue(`--dhx-scheduler-xy-${y}`);u.hour_size_px=l.getPropertyValue("--dhx-scheduler-config-hour_size_px"),u.wide_form=l.getPropertyValue("--dhx-scheduler-config-form_wide")}else d=function(){for(var y=document.getElementsByTagName("link"),g=0;g<y.length;g++){var h=y[g].href.match("dhtmlxscheduler_([a-z]+).css");if(h)return h[1]}}(),f=e._is_material_skin();if(e._theme_info={theme:d,cssVarTheme:c,oldMaterialTheme:f,values:u},e._theme_info.cssVarTheme){const y=this._theme_info.values;for(let g in e.xy)isNaN(parseInt(y[g]))||(e.xy[g]=parseInt(y[g]))}},e.event(window,"DOMContentLoaded",i),e.event(window,"load",i),e._border_box_events=function(){return r()},e._configure=function(l,s,d){for(var c in s)l[c]===void 0&&(l[c]=s[c][d])},e.setSkin=function(l){this.skin=l,e._addThemeClass(),e.$container&&(this._skin_init(),this.render())};let o=null;e.attachEvent("onDestroy",function(){clearInterval(o)}),e._skin_init=function(){this._build_skin_info(),this.skin||(this.skin=this._theme_info.theme),e._addThemeClass(),e.skin==="flat"?e.templates.hour_scale=a:e.templates.hour_scale===a&&(e.templates.hour_scale=e.date.date_to_str(e.config.hour_date)),e.attachEvent("onTemplatesReady",function(){var l=e.date.date_to_str("%d");e.templates._old_month_day||(e.templates._old_month_day=e.templates.month_day);var s=e.templates._old_month_day;e.templates.month_day=function(d){if(this._mode=="month"){var c=l(d);return d.getDate()==1&&(c=e.locale.date.month_full[d.getMonth()]+" "+c),+d==+e.date.date_part(this._currentDate())&&(c=e.locale.labels.dhx_cal_today_button+" "+c),c}return s.call(this,d)},e.config.fix_tab_position&&(e._els.dhx_cal_navline[0].querySelectorAll("[data-tab]").forEach(d=>{switch(d.getAttribute("data-tab")||d.getAttribute("name")){case"day":case"day_tab":d.classList.add("dhx_cal_tab_first"),d.classList.add("dhx_cal_tab_segmented");break;case"week":case"week_tab":d.classList.add("dhx_cal_tab_segmented");break;case"month":case"month_tab":d.classList.add("dhx_cal_tab_last"),d.classList.add("dhx_cal_tab_segmented");break;default:d.classList.add("dhx_cal_tab_standalone")}}),function(d){if(e.config.header)return;const c=Array.from(d.querySelectorAll(".dhx_cal_tab")),u=["day","week","month"].map(y=>c.find(g=>g.getAttribute("data-tab")===y)).filter(y=>y!==void 0);let f=c.length>0?c[0]:null;u.reverse().forEach(y=>{d.insertBefore(y,f),f=y})}(e._els.dhx_cal_navline[0]))},{once:!0})}}function Qc(e,t){this.$scheduler=e,this.$dp=t,this._dataProcessorHandlers=[],this.attach=function(){var n=this.$dp,r=this.$scheduler;this._dataProcessorHandlers.push(r.attachEvent("onEventAdded",function(i){!this._loading&&this._validId(i)&&n.setUpdated(i,!0,"inserted")})),this._dataProcessorHandlers.push(r.attachEvent("onConfirmedBeforeEventDelete",function(i){if(this._validId(i)){var a=n.getState(i);return a=="inserted"||this._new_event?(n.setUpdated(i,!1),!0):a!="deleted"&&(a=="true_deleted"||(n.setUpdated(i,!0,"deleted"),!1))}})),this._dataProcessorHandlers.push(r.attachEvent("onEventChanged",function(i){!this._loading&&this._validId(i)&&n.setUpdated(i,!0,"updated")})),this._dataProcessorHandlers.push(r.attachEvent("onClearAll",function(){n._in_progress={},n._invalid={},n.updatedRows=[],n._waitMode=0})),n.attachEvent("insertCallback",r._update_callback),n.attachEvent("updateCallback",r._update_callback),n.attachEvent("deleteCallback",function(i,a){r.getEvent(a)?(r.setUserData(a,this.action_param,"true_deleted"),r.deleteEvent(a)):r._add_rec_marker&&r._update_callback(i,a)})},this.detach=function(){for(var n in this._dataProcessorHandlers){var r=this._dataProcessorHandlers[n];this.$scheduler.detachEvent(r)}this._dataProcessorHandlers=[]}}function Ha(e){return this.serverProcessor=e,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this._headers=null,this._payload=null,this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),fi(this),this}function Xc(e){var t="data-dhxbox",n=null;function r(v,x,S){var O=v.callback;O&&O(x,S),g.hide(v.box),n=v.box=null}function i(v){if(n){var x=v.which||v.keyCode,S=!1;if(h.keyboard){if(x==13||x==32){var O=v.target||v.srcElement;yt.getClassName(O).indexOf("scheduler_popup_button")>-1&&O.click?O.click():(r(n,!0),S=!0)}x==27&&(r(n,!1),S=!0)}return S?(v.preventDefault&&v.preventDefault(),!(v.cancelBubble=!0)):void 0}}function a(v){a.cover||(a.cover=document.createElement("div"),e.event(a.cover,"keydown",i),a.cover.className="dhx_modal_cover",document.body.appendChild(a.cover)),a.cover.style.display=v?"inline-block":"none"}function o(v,x,S){var O=e._waiAria.messageButtonAttrString(v),N=(x||"").toLowerCase().replace(/ /g,"_");return`<div ${O} class='scheduler_popup_button dhtmlx_popup_button ${`scheduler_${N}_button dhtmlx_${N}_button`}' data-result='${S}' result='${S}' ><div>${v}</div></div>`}function l(){for(var v=[].slice.apply(arguments,[0]),x=0;x<v.length;x++)if(v[x])return v[x]}function s(v,x,S){var O=v.tagName?v:function(A,m,b){var k=document.createElement("div"),E=Qe.uid();e._waiAria.messageModalAttr(k,E),k.className=" scheduler_modal_box dhtmlx_modal_box scheduler-"+A.type+" dhtmlx-"+A.type,k.setAttribute(t,1);var D="";if(A.width&&(k.style.width=A.width),A.height&&(k.style.height=A.height),A.title&&(D+='<div class="scheduler_popup_title dhtmlx_popup_title">'+A.title+"</div>"),D+='<div class="scheduler_popup_text dhtmlx_popup_text" id="'+E+'"><span>'+(A.content?"":A.text)+'</span></div><div  class="scheduler_popup_controls dhtmlx_popup_controls">',m&&(D+=o(l(A.ok,e.locale.labels.message_ok,"OK"),"ok",!0)),b&&(D+=o(l(A.cancel,e.locale.labels.message_cancel,"Cancel"),"cancel",!1)),A.buttons)for(var C=0;C<A.buttons.length;C++){var R=A.buttons[C];D+=typeof R=="object"?o(R.label,R.css||"scheduler_"+R.label.toLowerCase()+"_button dhtmlx_"+R.label.toLowerCase()+"_button",R.value||C):o(R,R,C)}if(D+="</div>",k.innerHTML=D,A.content){var P=A.content;typeof P=="string"&&(P=document.getElementById(P)),P.style.display=="none"&&(P.style.display=""),k.childNodes[A.title?1:0].appendChild(P)}return e.event(k,"click",function(F){var q=F.target||F.srcElement;if(q.className||(q=q.parentNode),yt.closest(q,".scheduler_popup_button")){var $=q.getAttribute("data-result");r(A,$=$=="true"||$!="false"&&$,F)}}),A.box=k,(m||b)&&(n=A),k}(v,x,S);v.hidden||a(!0),document.body.appendChild(O);var N=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-O.offsetWidth)/2)),I=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-O.offsetHeight)/2));return v.position=="top"?O.style.top="-3px":O.style.top=I+"px",O.style.left=N+"px",e.event(O,"keydown",i),g.focus(O),v.hidden&&g.hide(O),e.callEvent("onMessagePopup",[O]),O}function d(v){return s(v,!0,!1)}function c(v){return s(v,!0,!0)}function u(v){return s(v)}function f(v,x,S){return typeof v!="object"&&(typeof x=="function"&&(S=x,x=""),v={text:v,type:x,callback:S}),v}function y(v,x,S,O,N){return typeof v!="object"&&(v={text:v,type:x,expire:S,id:O,callback:N}),v.id=v.id||Qe.uid(),v.expire=v.expire||h.expire,v}e.event(document,"keydown",i,!0);var g=function(){var v=f.apply(this,arguments);return v.type=v.type||"alert",u(v)};g.hide=function(v){for(;v&&v.getAttribute&&!v.getAttribute(t);)v=v.parentNode;v&&(v.parentNode.removeChild(v),a(!1),e.callEvent("onAfterMessagePopup",[v]))},g.focus=function(v){setTimeout(function(){var x=yt.getFocusableNodes(v);x.length&&x[0].focus&&x[0].focus()},1)};var h=function(v,x,S,O){switch((v=y.apply(this,arguments)).type=v.type||"info",v.type.split("-")[0]){case"alert":return d(v);case"confirm":return c(v);case"modalbox":return u(v);default:return function(N){h.area||(h.area=document.createElement("div"),h.area.className="scheduler_message_area dhtmlx_message_area",h.area.style[h.position]="5px",document.body.appendChild(h.area)),h.hide(N.id);var I=document.createElement("div");return I.innerHTML="<div>"+N.text+"</div>",I.className="scheduler-info dhtmlx-info scheduler-"+N.type+" dhtmlx-"+N.type,e.event(I,"click",function(A){N.callback&&N.callback.call(this,A),h.hide(N.id),N=null}),e._waiAria.messageInfoAttr(I),h.position=="bottom"&&h.area.firstChild?h.area.insertBefore(I,h.area.firstChild):h.area.appendChild(I),N.expire>0&&(h.timers[N.id]=window.setTimeout(function(){h&&h.hide(N.id)},N.expire)),h.pull[N.id]=I,I=null,N.id}(v)}};h.seed=new Date().valueOf(),h.uid=Qe.uid,h.expire=4e3,h.keyboard=!0,h.position="top",h.pull={},h.timers={},h.hideAll=function(){for(var v in h.pull)h.hide(v)},h.hide=function(v){var x=h.pull[v];x&&x.parentNode&&(window.setTimeout(function(){x.parentNode.removeChild(x),x=null},2e3),x.className+=" hidden",h.timers[v]&&window.clearTimeout(h.timers[v]),delete h.pull[v])};var p=[];return e.attachEvent("onMessagePopup",function(v){p.push(v)}),e.attachEvent("onAfterMessagePopup",function(v){for(var x=0;x<p.length;x++)p[x]===v&&(p.splice(x,1),x--)}),e.attachEvent("onDestroy",function(){a.cover&&a.cover.parentNode&&a.cover.parentNode.removeChild(a.cover);for(var v=0;v<p.length;v++)p[v].parentNode&&p[v].parentNode.removeChild(p[v]);p=null,h.area&&h.area.parentNode&&h.area.parentNode.removeChild(h.area),h=null}),{alert:function(){var v=f.apply(this,arguments);return v.type=v.type||"confirm",d(v)},confirm:function(){var v=f.apply(this,arguments);return v.type=v.type||"alert",c(v)},message:h,modalbox:g}}Ha.prototype={setTransactionMode:function(e,t){typeof e=="object"?(this._tMode=e.mode||this._tMode,e.headers!==void 0&&(this._headers=e.headers),e.payload!==void 0&&(this._payload=e.payload),this._tSend=!!t):(this._tMode=e,this._tSend=t),this._tMode=="REST"&&(this._tSend=!1,this._endnm=!0),this._tMode==="JSON"||this._tMode==="REST-JSON"?(this._tSend=!1,this._endnm=!0,this._serializeAsJson=!0,this._headers=this._headers||{},this._headers["Content-Type"]="application/json"):this._headers&&!this._headers["Content-Type"]&&(this._headers["Content-Type"]="application/x-www-form-urlencoded"),this._tMode==="CUSTOM"&&(this._tSend=!1,this._endnm=!0,this._router=e.router)},escape:function(e){return this._utf?encodeURIComponent(e):escape(e)},enableUTFencoding:function(e){this._utf=!!e},setDataColumns:function(e){this._columns=typeof e=="string"?e.split(","):e},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(e){this._endnm=!!e},enablePartialDataSend:function(e){this._changed=!!e},setUpdateMode:function(e,t){this.autoUpdate=e=="cell",this.updateMode=e,this.dnd=t},ignore:function(e,t){this._silent_mode=!0,e.call(t||window),this._silent_mode=!1},setUpdated:function(e,t,n){if(!this._silent_mode){var r=this.findRow(e);n=n||"updated";var i=this.$scheduler.getUserData(e,this.action_param);i&&n=="updated"&&(n=i),t?(this.set_invalid(e,!1),this.updatedRows[r]=e,this.$scheduler.setUserData(e,this.action_param,n),this._in_progress[e]&&(this._in_progress[e]="wait")):this.is_invalid(e)||(this.updatedRows.splice(r,1),this.$scheduler.setUserData(e,this.action_param,"")),this.markRow(e,t,n),t&&this.autoUpdate&&this.sendData(e)}},markRow:function(e,t,n){var r="",i=this.is_invalid(e);if(i&&(r=this.styles[i],t=!0),this.callEvent("onRowMark",[e,t,n,i])&&(r=this.styles[t?n:"clear"]+r,this.$scheduler[this._methods[0]](e,r),i&&i.details)){r+=this.styles[i+"_cell"];for(var a=0;a<i.details.length;a++)i.details[a]&&this.$scheduler[this._methods[1]](e,a,r)}},getActionByState:function(e){return e==="inserted"?"create":e==="updated"?"update":e==="deleted"?"delete":"update"},getState:function(e){return this.$scheduler.getUserData(e,this.action_param)},is_invalid:function(e){return this._invalid[e]},set_invalid:function(e,t,n){n&&(t={value:t,details:n,toString:function(){return this.value.toString()}}),this._invalid[e]=t},checkBeforeUpdate:function(e){return!0},sendData:function(e){return this.$scheduler.editStop&&this.$scheduler.editStop(),e===void 0||this._tSend?this.sendAllData():!this._in_progress[e]&&(this.messages=[],!(!this.checkBeforeUpdate(e)&&this.callEvent("onValidationError",[e,this.messages]))&&void this._beforeSendData(this._getRowData(e),e))},_beforeSendData:function(e,t){if(!this.callEvent("onBeforeUpdate",[t,this.getState(t),e]))return!1;this._sendData(e,t)},serialize:function(e,t){if(this._serializeAsJson)return this._serializeAsJSON(e);if(typeof e=="string")return e;if(t!==void 0)return this.serialize_one(e,"");var n=[],r=[];for(var i in e)e.hasOwnProperty(i)&&(n.push(this.serialize_one(e[i],i+this.post_delim)),r.push(i));return n.push("ids="+this.escape(r.join(","))),this.$scheduler.security_key&&n.push("dhx_security="+this.$scheduler.security_key),n.join("&")},serialize_one:function(e,t){if(typeof e=="string")return e;var n=[],r="";for(var i in e)if(e.hasOwnProperty(i)){if((i=="id"||i==this.action_param)&&this._tMode=="REST")continue;r=typeof e[i]=="string"||typeof e[i]=="number"?e[i]:JSON.stringify(e[i]),n.push(this.escape((t||"")+i)+"="+this.escape(r))}return n.join("&")},_applyPayload:function(e){var t=this.$scheduler.ajax;if(this._payload)for(var n in this._payload)e=e+t.urlSeparator(e)+this.escape(n)+"="+this.escape(this._payload[n]);return e},_sendData:function(e,t){if(e){if(!this.callEvent("onBeforeDataSending",t?[t,this.getState(t),e]:[null,null,e]))return!1;t&&(this._in_progress[t]=new Date().valueOf());var n=this,r=this.$scheduler.ajax;if(this._tMode!=="CUSTOM"){var i,a={callback:function(g){var h=[];if(t)h.push(t);else if(e)for(var p in e)h.push(p);return n.afterUpdate(n,g,h)},headers:n._headers},o=this.serverProcessor+(this._user?r.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.$scheduler.getUserData(0,"version")].join("&"):""),l=this._applyPayload(o);switch(this._tMode){case"GET":i=this._cleanupArgumentsBeforeSend(e),a.url=l+r.urlSeparator(l)+this.serialize(i,t),a.method="GET";break;case"POST":i=this._cleanupArgumentsBeforeSend(e),a.url=l,a.method="POST",a.data=this.serialize(i,t);break;case"JSON":i={};var s=this._cleanupItemBeforeSend(e);for(var d in s)d!==this.action_param&&d!=="id"&&d!=="gr_id"&&(i[d]=s[d]);a.url=l,a.method="POST",a.data=JSON.stringify({id:t,action:e[this.action_param],data:i});break;case"REST":case"REST-JSON":switch(l=o.replace(/(&|\?)editing=true/,""),i="",this.getState(t)){case"inserted":a.method="POST",a.data=this.serialize(e,t);break;case"deleted":a.method="DELETE",l=l+(l.slice(-1)==="/"?"":"/")+t;break;default:a.method="PUT",a.data=this.serialize(e,t),l=l+(l.slice(-1)==="/"?"":"/")+t}a.url=this._applyPayload(l)}return this._waitMode++,r.query(a)}{var c=this.getState(t),u=this.getActionByState(c),f=function(h){var p=c;if(h&&h.responseText&&h.setRequestHeader){h.status!==200&&(p="error");try{h=JSON.parse(h.responseText)}catch{}}p=p||"updated";var v=t,x=t;h&&(p=h.action||p,v=h.sid||v,x=h.id||h.tid||x),n.afterUpdateCallback(v,x,p,h)};const g="event";var y;if(this._router instanceof Function)y=this._router(g,u,e,t);else switch(c){case"inserted":y=this._router[g].create(e);break;case"deleted":y=this._router[g].delete(t);break;default:y=this._router[g].update(e,t)}if(y){if(!y.then&&y.id===void 0&&y.tid===void 0&&y.action===void 0)throw new Error("Incorrect router return value. A Promise or a response object is expected");y.then?y.then(f).catch(function(h){h&&h.action?f(h):f({action:"error",value:h})}):f(y)}else f(null)}}},sendAllData:function(){if(this.updatedRows.length&&this.updateMode!=="off"){this.messages=[];var e=!0;if(this._forEachUpdatedRow(function(t){e=e&&this.checkBeforeUpdate(t)}),!e&&!this.callEvent("onValidationError",["",this.messages]))return!1;this._tSend?this._sendData(this._getAllData()):this._forEachUpdatedRow(function(t){if(!this._in_progress[t]){if(this.is_invalid(t))return;this._beforeSendData(this._getRowData(t),t)}})}},_getAllData:function(e){var t={},n=!1;return this._forEachUpdatedRow(function(r){if(!this._in_progress[r]&&!this.is_invalid(r)){var i=this._getRowData(r);this.callEvent("onBeforeUpdate",[r,this.getState(r),i])&&(t[r]=i,n=!0,this._in_progress[r]=new Date().valueOf())}}),n?t:null},findRow:function(e){var t=0;for(t=0;t<this.updatedRows.length&&e!=this.updatedRows[t];t++);return t},defineAction:function(e,t){this._uActions||(this._uActions={}),this._uActions[e]=t},afterUpdateCallback:function(e,t,n,r){if(this.$scheduler){var i=e,a=n!=="error"&&n!=="invalid";if(a||this.set_invalid(e,n),this._uActions&&this._uActions[n]&&!this._uActions[n](r))return delete this._in_progress[i];this._in_progress[i]!=="wait"&&this.setUpdated(e,!1);var o=e;switch(n){case"inserted":case"insert":t!=e&&(this.setUpdated(e,!1),this.$scheduler[this._methods[2]](e,t),e=t);break;case"delete":case"deleted":return this.$scheduler.setUserData(e,this.action_param,"true_deleted"),this.$scheduler[this._methods[3]](e,t),delete this._in_progress[i],this.callEvent("onAfterUpdate",[e,n,t,r])}this._in_progress[i]!=="wait"?(a&&this.$scheduler.setUserData(e,this.action_param,""),delete this._in_progress[i]):(delete this._in_progress[i],this.setUpdated(t,!0,this.$scheduler.getUserData(e,this.action_param))),this.callEvent("onAfterUpdate",[o,n,t,r])}},_errorResponse:function(e,t){return this.$scheduler&&this.$scheduler.callEvent&&this.$scheduler.callEvent("onSaveError",[t,e.xmlDoc]),this.cleanUpdate(t)},_setDefaultTransactionMode:function(){this.serverProcessor&&(this.setTransactionMode("POST",!0),this.serverProcessor+=(this.serverProcessor.indexOf("?")!==-1?"&":"?")+"editing=true",this._serverProcessor=this.serverProcessor)},afterUpdate:function(e,t,n){var r=this.$scheduler.ajax;if(t.xmlDoc.status===200){var i;try{i=JSON.parse(t.xmlDoc.responseText)}catch{t.xmlDoc.responseText.length||(i={})}if(i){var a=i.action||this.getState(n)||"updated",o=i.sid||n[0],l=i.tid||n[0];return e.afterUpdateCallback(o,l,a,i),void e.finalizeUpdate()}var s=r.xmltop("data",t.xmlDoc);if(!s)return this._errorResponse(t,n);var d=r.xpath("//data/action",s);if(!d.length)return this._errorResponse(t,n);for(var c=0;c<d.length;c++){var u=d[c];a=u.getAttribute("type"),o=u.getAttribute("sid"),l=u.getAttribute("tid"),e.afterUpdateCallback(o,l,a,u)}e.finalizeUpdate()}else this._errorResponse(t,n)},cleanUpdate:function(e){if(e)for(var t=0;t<e.length;t++)delete this._in_progress[e[t]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--,this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(e){if(!this._initialized){this.$scheduler=e,this.$scheduler._dp_init&&this.$scheduler._dp_init(this),this._setDefaultTransactionMode(),this._methods=this._methods||["_set_event_text_style","","_dp_change_event_id","_dp_hook_delete"],function(n,r){n._validId=function(i){return!this._is_virtual_event||!this._is_virtual_event(i)},n.setUserData=function(i,a,o){if(i){var l=this.getEvent(i);l&&(l[a]=o)}else this._userdata[a]=o},n.getUserData=function(i,a){if(i){var o=this.getEvent(i);return o?o[a]:null}return this._userdata[a]},n._set_event_text_style=function(i,a){if(n.getEvent(i)){this.for_rendered(i,function(l){l.style.cssText+=";"+a});var o=this.getEvent(i);o._text_style=a,this.event_updated(o)}},n._update_callback=function(i,a){var o=n._xmlNodeToJSON(i.firstChild);o.rec_type=="none"&&(o.rec_pattern="none"),o.text=o.text||o._tagvalue,o.start_date=n._helpers.parseDate(o.start_date),o.end_date=n._helpers.parseDate(o.end_date),n.addEvent(o),n._add_rec_marker&&n.setCurrentView()},n._dp_change_event_id=function(i,a){n.getEvent(i)&&n.changeEventId(i,a)},n._dp_hook_delete=function(i,a){if(n.getEvent(i))return a&&i!=a&&(this.getUserData(i,r.action_param)=="true_deleted"&&this.setUserData(i,r.action_param,"updated"),this.changeEventId(i,a)),this.deleteEvent(a,!0)},n.setDp=function(){this._dp=r},n.setDp()}(this.$scheduler,this);var t=new Qc(this.$scheduler,this);t.attach(),this.attachEvent("onDestroy",function(){delete this._getRowData,delete this.$scheduler._dp,delete this.$scheduler._dataprocessor,delete this.$scheduler._set_event_text_style,delete this.$scheduler._dp_change_event_id,delete this.$scheduler._dp_hook_delete,delete this.$scheduler,t.detach()}),this.$scheduler.callEvent("onDataProcessorReady",[this]),this._initialized=!0,e._dataprocessor=this}},setOnAfterUpdate:function(e){this.attachEvent("onAfterUpdate",e)},setOnBeforeUpdateHandler:function(e){this.attachEvent("onBeforeDataSending",e)},setAutoUpdate:function(e,t){e=e||2e3,this._user=t||new Date().valueOf(),this._need_update=!1,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(i,a,o,l){this.afterAutoUpdate(i,a,o,l)}),this.attachEvent("onFullSync",function(){this.fullSync()});var n=this;let r=ct.setInterval(function(){n.loadUpdate()},e);this.attachEvent("onDestroy",function(){clearInterval(r)})},afterAutoUpdate:function(e,t,n,r){return t!="collision"||(this._need_update=!0,!1)},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(e,t){var n=this.$scheduler.ajax;if(this._update_busy)return!1;this._update_busy=!0,n.get(e,t)},_getXmlNodeValue:function(e){return e.firstChild?e.firstChild.nodeValue:""},loadUpdate:function(){var e=this,t=this.$scheduler.ajax,n=this.$scheduler.getUserData(0,"version"),r=this.serverProcessor+t.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+n].join("&");r=r.replace("editing=true&",""),this.getUpdates(r,function(i){var a=t.xpath("//userdata",i);e.$scheduler.setUserData(0,"version",e._getXmlNodeValue(a[0]));var o=t.xpath("//update",i);if(o.length){e._silent_mode=!0;for(var l=0;l<o.length;l++){var s=o[l].getAttribute("status"),d=o[l].getAttribute("id"),c=o[l].getAttribute("parent");switch(s){case"inserted":this.callEvent("insertCallback",[o[l],d,c]);break;case"updated":this.callEvent("updateCallback",[o[l],d,c]);break;case"deleted":this.callEvent("deleteCallback",[o[l],d,c])}}e._silent_mode=!1}e._update_busy=!1,e=null})},destructor:function(){this.callEvent("onDestroy",[]),this.detachAllEvents(),this.updatedRows=[],this._in_progress={},this._invalid={},this._headers=null,this._payload=null,delete this._initialized},url:function(e){this.serverProcessor=this._serverProcessor=e},_serializeAsJSON:function(e){if(typeof e=="string")return e;var t=this.$scheduler.utils.copy(e);return this._tMode==="REST-JSON"&&(delete t.id,delete t[this.action_param]),JSON.stringify(t)},_cleanupArgumentsBeforeSend:function(e){var t;if(e[this.action_param]===void 0)for(var n in t={},e)t[n]=this._cleanupArgumentsBeforeSend(e[n]);else t=this._cleanupItemBeforeSend(e);return t},_cleanupItemBeforeSend:function(e){var t=null;return e&&(e[this.action_param]==="deleted"?((t={}).id=e.id,t[this.action_param]=e[this.action_param]):t=e),t},_forEachUpdatedRow:function(e){for(var t=this.updatedRows.slice(),n=0;n<t.length;n++){var r=t[n];this.$scheduler.getUserData(r,this.action_param)&&e.call(this,r)}},_prepareItemForJson(e){const t={},n=this.$scheduler,r=n.utils.copy(e);for(let i in r){let a=r[i];i.indexOf("_")!==0&&(a?a.getUTCFullYear?t[i]=n._helpers.formatDate(a):t[i]=typeof a=="object"?this._prepareItemForJson(a):a:a!==void 0&&(t[i]=a))}return t[this.action_param]=n.getUserData(e.id,this.action_param),t},_prepareItemForForm(e){const t={},n=this.$scheduler,r=n.utils.copy(e);for(var i in r){let a=r[i];i.indexOf("_")!==0&&(a?a.getUTCFullYear?t[i]=n._helpers.formatDate(a):t[i]=typeof a=="object"?this._prepareItemForForm(a):a:t[i]="")}return t[this.action_param]=n.getUserData(e.id,this.action_param),t},_prepareDataItem:function(e){return this._serializeAsJson?this._prepareItemForJson(e):this._prepareItemForForm(e)},_getRowData:function(e){var t=this.$scheduler.getEvent(e);return t||(t={id:e}),this._prepareDataItem(t)}};const Zc={date:{month_full:[" ","","","","","","","",""," "," "," "],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"  ,   ",confirm_deleting:"       ",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"       ",section_recurring:" ",button_recurring:"",button_recurring_open:"",button_edit_series:" ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"  ",repeat_week:"  ",repeat_text_week_count:"   :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:" ",repeat_text_month_count:"",repeat_text_month_count2_before:"",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end2:"",repeat_radio_end3:" ",repeat_never:"",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},e_={date:{month_full:["","","","","Ma","","","","","","",""],month_short:["","","","","Ma","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"   , ?",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"      ?",section_recurring:"",button_recurring:"",button_recurring_open:"",button_edit_series:" ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"ic",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"  ",repeat_week:"  ",repeat_text_week_count:"",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:"  ",repeat_text_month_count:"",repeat_text_month_count2_before:" ",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end2:"",repeat_radio_end3:" ",repeat_never:"",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","e","","","","",""],day_for_recurring:["","","","","","",""]}},t_={date:{month_full:["Gener","Febrer","Mar","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],month_short:["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],day_full:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"],day_short:["Dg","Dl","Dm","Dc","Dj","Dv","Ds"]},labels:{dhx_cal_today_button:"Hui",day_tab:"Dia",week_tab:"Setmana",month_tab:"Mes",new_event:"Nou esdeveniment",icon_save:"Guardar",icon_cancel:"Cancellar",icon_details:"Detalls",icon_edit:"Editar",icon_delete:"Esborrar",confirm_closing:"",confirm_deleting:"L'esdeveniment s'esborrar definitivament, continuar ?",section_description:"Descripci",section_time:"Periode de temps",full_day:"Tot el dia",confirm_recurring:"Desitja modificar el conjunt d'esdeveniments repetits?",section_recurring:"Repeteixca l'esdeveniment",button_recurring:"Impedit",button_recurring_open:"Perms",button_edit_series:"Edit srie",button_edit_occurrence:"Edita Instncia",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Data",description:"Descripci",year_tab:"Any",week_agenda_tab:"Agenda",grid_tab:"Taula",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Diari",repeat_radio_week:"Setmanal",repeat_radio_month:"Mensual",repeat_radio_year:"Anual",repeat_radio_day_type:"Cada",repeat_text_day_count:"dia",repeat_radio_day_type2:"Cada dia laborable",repeat_week:" Repetir cada",repeat_text_week_count:"setmana els dies segents:",repeat_radio_month_type:"Repetir",repeat_radio_month_start:"El",repeat_text_month_day:"dia cada",repeat_text_month_count:"mes",repeat_text_month_count2_before:"cada",repeat_text_month_count2_after:"mes",repeat_year_label:"El",select_year_day2:"de",repeat_text_year_day:"dia",select_year_month:"mes",repeat_radio_end:"Sense data de finalitzaci",repeat_text_occurrences_count:"ocurrncies",repeat_radio_end2:"Desprs",repeat_radio_end3:"Finalitzar el",repeat_never:"Mai",repeat_daily:"Cada dia",repeat_workdays:"Cada dia laborable",repeat_weekly:"Cada setmana",repeat_monthly:"Cada mes",repeat_yearly:"Cada any",repeat_custom:"Personalitzat",repeat_freq_day:"Dia",repeat_freq_week:"Setmana",repeat_freq_month:"Mes",repeat_freq_year:"Any",repeat_on_date:"En la data",repeat_ends:"Finalitza",month_for_recurring:["Gener","Febrer","Mar","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],day_for_recurring:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"]}},n_={date:{month_full:["","","","","","","","","","","",""],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:"",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"!",confirm_deleting:"?",section_description:"",section_time:"",full_day:"",confirm_recurring:"?",section_recurring:"",button_recurring:"",button_recurring_open:"",button_edit_series:"",button_edit_occurrence:"",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"",repeat_week:"  ",repeat_text_week_count:":",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:" ",repeat_text_month_count:"",repeat_text_month_count2_before:"",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"",repeat_text_occurrences_count:"",repeat_radio_end2:"",repeat_radio_end3:"",repeat_never:"",repeat_daily:"",repeat_workdays:"",repeat_weekly:"",repeat_monthly:"",repeat_yearly:"",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:"",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},r_={date:{month_full:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],month_short:["Led","n","Be","Dub","Kv","er","ec","Srp","Z","j","List","Pro"],day_full:["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota"],day_short:["Ne","Po","t","St","t","P","So"]},labels:{dhx_cal_today_button:"Dnes",day_tab:"Den",week_tab:"Tden",month_tab:"Msc",new_event:"Nov udlost",icon_save:"Uloit",icon_cancel:"Zpt",icon_details:"Detail",icon_edit:"Edituj",icon_delete:"Smazat",confirm_closing:"",confirm_deleting:"Udlost bude trvale smazna, opravdu?",section_description:"Poznmky",section_time:"Doba platnosti",confirm_recurring:"Pejete si upravit celou adu opakovanch udlost?",section_recurring:"Opakovn udlosti",button_recurring:"Vypnuto",button_recurring_open:"Zapnuto",button_edit_series:"Edit series",button_edit_occurrence:"Upravit instance",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Program",date:"Datum",description:"Poznmka",year_tab:"Rok",full_day:"Full day",week_agenda_tab:"Program",grid_tab:"Mka",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Denn",repeat_radio_week:"Tdn",repeat_radio_month:"Msn",repeat_radio_year:"Ron",repeat_radio_day_type:"kad",repeat_text_day_count:"Den",repeat_radio_day_type2:"pracovn dny",repeat_week:"Opakuje kadch",repeat_text_week_count:"Tdn na:",repeat_radio_month_type:"u kadho",repeat_radio_month_start:"na",repeat_text_month_day:"Den kadho",repeat_text_month_count:"Msc",repeat_text_month_count2_before:"kad",repeat_text_month_count2_after:"Msc",repeat_year_label:"na",select_year_day2:"v",repeat_text_year_day:"Den v",select_year_month:"",repeat_radio_end:"bez data ukonen",repeat_text_occurrences_count:"Udlosti",repeat_radio_end2:"po",repeat_radio_end3:"Konec",repeat_never:"Nikdy",repeat_daily:"Kad den",repeat_workdays:"Kad pracovn den",repeat_weekly:"Kad tden",repeat_monthly:"Kad msc",repeat_yearly:"Kad rok",repeat_custom:"Vlastn",repeat_freq_day:"Den",repeat_freq_week:"Tden",repeat_freq_month:"Msc",repeat_freq_year:"Rok",repeat_on_date:"Na datum",repeat_ends:"Kon",month_for_recurring:["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],day_for_recurring:["Nedle ","Pondl","ter","Steda","tvrtek","Ptek","Sobota"]}},a_={date:{month_full:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Man","Tir","Ons","Tor","Fre","Lr"]},labels:{dhx_cal_today_button:"Idag",day_tab:"Dag",week_tab:"Uge",month_tab:"Mned",new_event:"Ny begivenhed",icon_save:"Gem",icon_cancel:"Fortryd",icon_details:"Detaljer",icon_edit:"Tilret",icon_delete:"Slet",confirm_closing:"Dine rettelser vil g tabt.. Er dy sikker?",confirm_deleting:"Bigivenheden vil blive slettet permanent. Er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",confirm_recurring:"Vil du tilrette hele serien af gentagne begivenheder?",section_recurring:"Gentag begivenhed",button_recurring:"Frakoblet",button_recurring_open:"Tilkoblet",button_edit_series:"Rediger serien",button_edit_occurrence:"Rediger en kopi",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Dagsorden",date:"Dato",description:"Beskrivelse",year_tab:"r",week_agenda_tab:"Dagsorden",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daglig",repeat_radio_week:"Ugenlig",repeat_radio_month:"Mnedlig",repeat_radio_year:"rlig",repeat_radio_day_type:"Hver",repeat_text_day_count:"dag",repeat_radio_day_type2:"P hver arbejdsdag",repeat_week:" Gentager sig hver",repeat_text_week_count:"uge p flgende dage:",repeat_radio_month_type:"Hver den",repeat_radio_month_start:"Den",repeat_text_month_day:" i hver",repeat_text_month_count:"mned",repeat_text_month_count2_before:"hver",repeat_text_month_count2_after:"mned",repeat_year_label:"Den",select_year_day2:"i",repeat_text_year_day:"dag i",select_year_month:"",repeat_radio_end:"Ingen slutdato",repeat_text_occurrences_count:"gentagelse",repeat_radio_end2:"Efter",repeat_radio_end3:"Slut",repeat_never:"Aldrig",repeat_daily:"Hver dag",repeat_workdays:"Hver hverdag",repeat_weekly:"Hver uge",repeat_monthly:"Hver mned",repeat_yearly:"Hvert r",repeat_custom:"Brugerdefineret",repeat_freq_day:"Dag",repeat_freq_week:"Uge",repeat_freq_month:"Mned",repeat_freq_year:"r",repeat_on_date:"P dato",repeat_ends:"Slutter",month_for_recurring:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],day_for_recurring:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"]}},i_={date:{month_full:[" Januar"," Februar"," Mrz "," April"," Mai"," Juni"," Juli"," August"," September "," Oktober"," November "," Dezember"],month_short:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],day_full:["Sonntag","Montag","Dienstag"," Mittwoch"," Donnerstag","Freitag","Samstag"],day_short:["So","Mo","Di","Mi","Do","Fr","Sa"]},labels:{dhx_cal_today_button:"Heute",day_tab:"Tag",week_tab:"Woche",month_tab:"Monat",new_event:"neuer Eintrag",icon_save:"Speichern",icon_cancel:"Abbrechen",icon_details:"Details",icon_edit:"ndern",icon_delete:"Lschen",confirm_closing:"",confirm_deleting:"Der Eintrag wird gelscht",section_description:"Beschreibung",section_time:"Zeitspanne",full_day:"Ganzer Tag",confirm_recurring:"Wollen Sie alle Eintrge bearbeiten oder nur diesen einzelnen Eintrag?",section_recurring:"Wiederholung",button_recurring:"Aus",button_recurring_open:"An",button_edit_series:"Bearbeiten Sie die Serie",button_edit_occurrence:"Bearbeiten Sie eine Kopie",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Datum",description:"Beschreibung",year_tab:"Jahre",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Tglich",repeat_radio_week:"Wchentlich",repeat_radio_month:"Monatlich",repeat_radio_year:"Jhrlich",repeat_radio_day_type:"jeden",repeat_text_day_count:"Tag",repeat_radio_day_type2:"an jedem Arbeitstag",repeat_week:" Wiederholt sich jede",repeat_text_week_count:"Woche am:",repeat_radio_month_type:"an jedem",repeat_radio_month_start:"am",repeat_text_month_day:"Tag eines jeden",repeat_text_month_count:"Monats",repeat_text_month_count2_before:"jeden",repeat_text_month_count2_after:"Monats",repeat_year_label:"am",select_year_day2:"im",repeat_text_year_day:"Tag im",select_year_month:"",repeat_radio_end:"kein Enddatum",repeat_text_occurrences_count:"Ereignissen",repeat_radio_end3:"Schlu",repeat_radio_end2:"nach",repeat_never:"Nie",repeat_daily:"Jeden Tag",repeat_workdays:"Jeden Werktag",repeat_weekly:"Jede Woche",repeat_monthly:"Jeden Monat",repeat_yearly:"Jedes Jahr",repeat_custom:"Benutzerdefiniert",repeat_freq_day:"Tag",repeat_freq_week:"Woche",repeat_freq_month:"Monat",repeat_freq_year:"Jahr",repeat_on_date:"Am Datum",repeat_ends:"Endet",month_for_recurring:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],day_for_recurring:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]}},o_={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"    .   ;",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"        ;",section_recurring:" ",button_recurring:"",button_recurring_open:"",button_edit_series:"  ",button_edit_occurrence:"  ",button_edit_occurrence_and_following:"This and following events",agenda_tab:" ",date:"",description:"",year_tab:"",week_agenda_tab:" ",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:" ",repeat_week:"  ",repeat_text_week_count:"   :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:" ",repeat_text_month_count:"",repeat_text_month_count2_before:"",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end3:" ",repeat_radio_end2:" ",repeat_never:"",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},s_={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Edit recurring event",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"All events",button_edit_occurrence:"This event",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Date",description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daily",repeat_radio_week:"Weekly",repeat_radio_month:"Monthly",repeat_radio_year:"Yearly",repeat_radio_day_type:"Every",repeat_text_day_count:"day",repeat_radio_day_type2:"Every workday",repeat_week:" Repeat every",repeat_text_week_count:"week next days:",repeat_radio_month_type:"Repeat",repeat_radio_month_start:"On",repeat_text_month_day:"day every",repeat_text_month_count:"month",repeat_text_month_count2_before:"every",repeat_text_month_count2_after:"month",repeat_year_label:"On",select_year_day2:"of",repeat_text_year_day:"day",select_year_month:"month",repeat_radio_end:"No end date",repeat_text_occurrences_count:"occurrences",repeat_radio_end2:"After",repeat_radio_end3:"End by",repeat_never:"Never",repeat_daily:"Every day",repeat_workdays:"Every weekday",repeat_weekly:"Every week",repeat_monthly:"Every month",repeat_yearly:"Every year",repeat_custom:"Custom",repeat_freq_day:"Day",repeat_freq_week:"Week",repeat_freq_month:"Month",repeat_freq_year:"Year",repeat_on_date:"On date",repeat_ends:"Ends",month_for_recurring:["January","February","March","April","May","June","July","August","September","October","November","December"],day_for_recurring:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},l_={date:{month_full:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],month_short:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],day_full:["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"],day_short:["Dom","Lun","Mar","Mi","Jue","Vie","Sb"]},labels:{dhx_cal_today_button:"Hoy",day_tab:"Da",week_tab:"Semana",month_tab:"Mes",new_event:"Nuevo evento",icon_save:"Guardar",icon_cancel:"Cancelar",icon_details:"Detalles",icon_edit:"Editar",icon_delete:"Eliminar",confirm_closing:"",confirm_deleting:"El evento se borrar definitivamente, continuar?",section_description:"Descripcin",section_time:"Perodo",full_day:"Todo el da",confirm_recurring:"Desea modificar el conjunto de eventos repetidos?",section_recurring:"Repita el evento",button_recurring:"Impedido",button_recurring_open:"Permitido",button_edit_series:"Editar la serie",button_edit_occurrence:"Editar este evento",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Da",date:"Fecha",description:"Descripcin",year_tab:"Ao",week_agenda_tab:"Da",grid_tab:"Reja",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Diariamente",repeat_radio_week:"Semanalmente",repeat_radio_month:"Mensualmente",repeat_radio_year:"Anualmente",repeat_radio_day_type:"Cada",repeat_text_day_count:"dia",repeat_radio_day_type2:"Cada jornada de trabajo",repeat_week:" Repetir cada",repeat_text_week_count:"semana:",repeat_radio_month_type:"Repita",repeat_radio_month_start:"El",repeat_text_month_day:"dia cada ",repeat_text_month_count:"mes",repeat_text_month_count2_before:"cada",repeat_text_month_count2_after:"mes",repeat_year_label:"El",select_year_day2:"del",repeat_text_year_day:"dia",select_year_month:"mes",repeat_radio_end:"Sin fecha de finalizacin",repeat_text_occurrences_count:"ocurrencias",repeat_radio_end3:"Fin",repeat_radio_end2:"Despus de",repeat_never:"Nunca",repeat_daily:"Cada da",repeat_workdays:"Cada da laborable",repeat_weekly:"Cada semana",repeat_monthly:"Cada mes",repeat_yearly:"Cada ao",repeat_custom:"Personalizado",repeat_freq_day:"Da",repeat_freq_week:"Semana",repeat_freq_month:"Mes",repeat_freq_year:"Ao",repeat_on_date:"En la fecha",repeat_ends:"Termina",month_for_recurring:["Enero","Febrero","rzo","bril","Mayo","Junio","Julio","gosto","Setiembre","Octubre","Noviembre","Diciembre"],day_for_recurring:["Domingo","Lunes","Martes","Mircoles","Jeuves","Viernes","Sabado"]}},d_={date:{month_full:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes&auml;kuu","Hein&auml;kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],month_short:["Tam","Hel","Maa","Huh","Tou","Kes","Hei","Elo","Syy","Lok","Mar","Jou"],day_full:["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"],day_short:["Su","Ma","Ti","Ke","To","Pe","La"]},labels:{dhx_cal_today_button:"Tnn",day_tab:"Piv",week_tab:"Viikko",month_tab:"Kuukausi",new_event:"Uusi tapahtuma",icon_save:"Tallenna",icon_cancel:"Peru",icon_details:"Tiedot",icon_edit:"Muokkaa",icon_delete:"Poista",confirm_closing:"",confirm_deleting:"Haluatko varmasti poistaa tapahtuman?",section_description:"Kuvaus",section_time:"Aikajakso",full_day:"Koko piv",confirm_recurring:"Haluatko varmasti muokata toistuvan tapahtuman kaikkia jaksoja?",section_recurring:"Toista tapahtuma",button_recurring:"Ei k&auml;yt&ouml;ss&auml;",button_recurring_open:"K&auml;yt&ouml;ss&auml;",button_edit_series:"Muokkaa sarja",button_edit_occurrence:"Muokkaa kopio",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Esityslista",date:"Pivmr",description:"Kuvaus",year_tab:"Vuoden",week_agenda_tab:"Esityslista",grid_tab:"Ritil",drag_to_create:"Luo uusi vetmll",drag_to_move:"Siirr vetmll",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"P&auml;ivitt&auml;in",repeat_radio_week:"Viikoittain",repeat_radio_month:"Kuukausittain",repeat_radio_year:"Vuosittain",repeat_radio_day_type:"Joka",repeat_text_day_count:"p&auml;iv&auml;",repeat_radio_day_type2:"Joka arkip&auml;iv&auml;",repeat_week:"Toista joka",repeat_text_week_count:"viikko n&auml;in&auml; p&auml;ivin&auml;:",repeat_radio_month_type:"Toista",repeat_radio_month_start:"",repeat_text_month_day:"p&auml;iv&auml;n&auml; joka",repeat_text_month_count:"kuukausi",repeat_text_month_count2_before:"joka",repeat_text_month_count2_after:"kuukausi",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"p&auml;iv&auml;",select_year_month:"kuukausi",repeat_radio_end:"Ei loppumisaikaa",repeat_text_occurrences_count:"Toiston j&auml;lkeen",repeat_radio_end3:"Loppuu",repeat_radio_end2:"",repeat_never:"Ei koskaan",repeat_daily:"Joka piv",repeat_workdays:"Joka arkipiv",repeat_weekly:"Joka viikko",repeat_monthly:"Joka kuukausi",repeat_yearly:"Joka vuosi",repeat_custom:"Mukautettu",repeat_freq_day:"Piv",repeat_freq_week:"Viikko",repeat_freq_month:"Kuukausi",repeat_freq_year:"Vuosi",repeat_on_date:"Tiettyn pivn",repeat_ends:"Pttyy",month_for_recurring:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes&auml;kuu","Hein&auml;kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],day_for_recurring:["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"]}},c_={date:{month_full:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],month_short:["Jan","Fv","Mar","Avr","Mai","Juin","Juil","Ao","Sep","Oct","Nov","Dc"],day_full:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],day_short:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},labels:{dhx_cal_today_button:"Aujourd'hui",day_tab:"Jour",week_tab:"Semaine",month_tab:"Mois",new_event:"Nouvel vnement",icon_save:"Enregistrer",icon_cancel:"Annuler",icon_details:"Dtails",icon_edit:"Modifier",icon_delete:"Effacer",confirm_closing:"",confirm_deleting:"L'vnement sera effac sans appel, tes-vous sr ?",section_description:"Description",section_time:"Priode",full_day:"Journe complte",confirm_recurring:"Voulez-vous diter toute une srie d'vnements rpts?",section_recurring:"Priodicit",button_recurring:"Dsactiv",button_recurring_open:"Activ",button_edit_series:"Modifier la srie",button_edit_occurrence:"Modifier une copie",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Jour",date:"Date",description:"Description",year_tab:"Anne",week_agenda_tab:"Jour",grid_tab:"Grille",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Quotidienne",repeat_radio_week:"Hebdomadaire",repeat_radio_month:"Mensuelle",repeat_radio_year:"Annuelle",repeat_radio_day_type:"Chaque",repeat_text_day_count:"jour",repeat_radio_day_type2:"Chaque journe de travail",repeat_week:" Rpter toutes les",repeat_text_week_count:"semaine:",repeat_radio_month_type:"Rpter",repeat_radio_month_start:"Le",repeat_text_month_day:"jour chaque",repeat_text_month_count:"mois",repeat_text_month_count2_before:"chaque",repeat_text_month_count2_after:"mois",repeat_year_label:"Le",select_year_day2:"du",repeat_text_year_day:"jour",select_year_month:"mois",repeat_radio_end:"Pas de date d&quot;achvement",repeat_text_occurrences_count:"occurrences",repeat_radio_end3:"Fin",repeat_radio_end2:"Aprs",repeat_never:"Jamais",repeat_daily:"Chaque jour",repeat_workdays:"Chaque jour ouvrable",repeat_weekly:"Chaque semaine",repeat_monthly:"Chaque mois",repeat_yearly:"Chaque anne",repeat_custom:"Personnalis",repeat_freq_day:"Jour",repeat_freq_week:"Semaine",repeat_freq_month:"Mois",repeat_freq_year:"Anne",repeat_on_date:" la date",repeat_ends:"Se termine",month_for_recurring:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],day_for_recurring:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"]}},__={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"  .?",section_description:"",section_time:"",confirm_recurring:"      ?",section_recurring:" ",button_recurring:" ",button_recurring_open:"",full_day:" ",button_edit_series:"  ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",agenda_tab:" ",date:"",description:"",year_tab:"",week_agenda_tab:" ",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"  ",message_ok:"OK",message_cancel:"",next:"",prev:"",year:"",month:"",day:"",hour:"",minute:"",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:" ",repeat_text_day_count:"",repeat_radio_day_type2:"   ",repeat_week:"  ",repeat_text_week_count:"  :",repeat_radio_month_type:" ",repeat_radio_month_start:"",repeat_text_month_day:" ",repeat_text_month_count:"",repeat_text_month_count2_before:" ",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end3:" ",repeat_radio_end2:"",repeat_never:" ",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:" ",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:"",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},u_={date:{month_full:["Janur","Februr","Mrcius","prilis","Mjus","Jnius","Jlius","Augusztus","Szeptember","Oktber","November","December"],month_short:["Jan","Feb","Mr","pr","Mj","Jn","Jl","Aug","Sep","Okt","Nov","Dec"],day_full:["Vasrnap","Htf","Kedd","Szerda","Cstrtk","Pntek","szombat"],day_short:["Va","H","Ke","Sze","Cs","P","Szo"]},labels:{dhx_cal_today_button:"Ma",day_tab:"Nap",week_tab:"Ht",month_tab:"Hnap",new_event:"j esemny",icon_save:"Ments",icon_cancel:"Mgse",icon_details:"Rszletek",icon_edit:"Szerkeszts",icon_delete:"Trls",confirm_closing:"",confirm_deleting:"Az esemny trlve lesz, biztosan folytatja?",section_description:"Lers",section_time:"Idszak",full_day:"Egesz napos",confirm_recurring:"Biztosan szerkeszteni akarod az sszes ismtld esemny belltst?",section_recurring:"Esemny ismtlse",button_recurring:"Tilts",button_recurring_open:"Engedlyezs",button_edit_series:"Edit series",button_edit_occurrence:"Szerkeszts brsg",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Napirend",date:"Dtum",description:"Lers",year_tab:"v",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Napi",repeat_radio_week:"Heti",repeat_radio_month:"Havi",repeat_radio_year:"ves",repeat_radio_day_type:"Minden",repeat_text_day_count:"nap",repeat_radio_day_type2:"Minden munkanap",repeat_week:" Ismtelje meg minden",repeat_text_week_count:"hten a kvetkez napokon:",repeat_radio_month_type:"Ismtls",repeat_radio_month_start:"Ekkor",repeat_text_month_day:"nap minden",repeat_text_month_count:"hnapban",repeat_text_month_count2_before:"minden",repeat_text_month_count2_after:"hnapban",repeat_year_label:"Ekkor",select_year_day2:"-n/-n",repeat_text_year_day:"nap",select_year_month:"hnap",repeat_radio_end:"Nincs befejezsi dtum",repeat_text_occurrences_count:"esemny",repeat_radio_end2:"Utn",repeat_radio_end3:"Befejez dtum",repeat_never:"Soha",repeat_daily:"Minden nap",repeat_workdays:"Minden munkanap",repeat_weekly:"Minden hten",repeat_monthly:"Minden hnapban",repeat_yearly:"Minden vben",repeat_custom:"Egyedi",repeat_freq_day:"Nap",repeat_freq_week:"Ht",repeat_freq_month:"Hnap",repeat_freq_year:"v",repeat_on_date:"Dtum szerint",repeat_ends:"Befejezdik",month_for_recurring:["Janur","Februr","Mrcius","prilis","Mjus","Jnius","Jlius","Augusztus","Szeptember","Oktber","November","December"],day_for_recurring:["Vasrnap","Htf","Kedd","Szerda","Cstrtk","Pntek","Szombat"]}},h_={date:{month_full:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],day_full:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],day_short:["Ming","Sen","Sel","Rab","Kam","Jum","Sab"]},labels:{dhx_cal_today_button:"Hari Ini",day_tab:"Hari",week_tab:"Minggu",month_tab:"Bulan",new_event:"Acara Baru",icon_save:"Simpan",icon_cancel:"Batal",icon_details:"Detail",icon_edit:"Edit",icon_delete:"Hapus",confirm_closing:"",confirm_deleting:"Acara akan dihapus",section_description:"Keterangan",section_time:"Periode",full_day:"Hari penuh",confirm_recurring:"Apakah acara ini akan berulang?",section_recurring:"Acara Rutin",button_recurring:"Tidak Difungsikan",button_recurring_open:"Difungsikan",button_edit_series:"Mengedit seri",button_edit_occurrence:"Mengedit salinan",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Tanggal",description:"Keterangan",year_tab:"Tahun",week_agenda_tab:"Agenda",grid_tab:"Tabel",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Harian",repeat_radio_week:"Mingguan",repeat_radio_month:"Bulanan",repeat_radio_year:"Tahunan",repeat_radio_day_type:"Setiap",repeat_text_day_count:"hari",repeat_radio_day_type2:"Setiap hari kerja",repeat_week:" Ulangi setiap",repeat_text_week_count:"minggu pada hari berikut:",repeat_radio_month_type:"Ulangi",repeat_radio_month_start:"Pada",repeat_text_month_day:"hari setiap",repeat_text_month_count:"bulan",repeat_text_month_count2_before:"setiap",repeat_text_month_count2_after:"bulan",repeat_year_label:"Pada",select_year_day2:"dari",repeat_text_year_day:"hari",select_year_month:"bulan",repeat_radio_end:"Tanpa tanggal akhir",repeat_text_occurrences_count:"kejadian",repeat_radio_end2:"Setelah",repeat_radio_end3:"Berakhir pada",repeat_never:"Tidak pernah",repeat_daily:"Setiap hari",repeat_workdays:"Setiap hari kerja",repeat_weekly:"Setiap minggu",repeat_monthly:"Setiap bulan",repeat_yearly:"Setiap tahun",repeat_custom:"Kustom",repeat_freq_day:"Hari",repeat_freq_week:"Minggu",repeat_freq_month:"Bulan",repeat_freq_year:"Tahun",repeat_on_date:"Pada tanggal",repeat_ends:"Berakhir",month_for_recurring:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],day_for_recurring:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]}},f_={date:{month_full:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],month_short:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],day_full:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato"],day_short:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]},labels:{dhx_cal_today_button:"Oggi",day_tab:"Giorno",week_tab:"Settimana",month_tab:"Mese",new_event:"Nuovo evento",icon_save:"Salva",icon_cancel:"Chiudi",icon_details:"Dettagli",icon_edit:"Modifica",icon_delete:"Elimina",confirm_closing:"",confirm_deleting:"L'evento sar eliminato, siete sicuri?",section_description:"Descrizione",section_time:"Periodo di tempo",full_day:"Intera giornata",confirm_recurring:"Vuoi modificare l'intera serie di eventi?",section_recurring:"Ripetere l'evento",button_recurring:"Disattivato",button_recurring_open:"Attivato",button_edit_series:"Modificare la serie",button_edit_occurrence:"Modificare una copia",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Data",description:"Descrizione",year_tab:"Anno",week_agenda_tab:"Agenda",grid_tab:"Griglia",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Quotidiano",repeat_radio_week:"Settimanale",repeat_radio_month:"Mensile",repeat_radio_year:"Annuale",repeat_radio_day_type:"Ogni",repeat_text_day_count:"giorno",repeat_radio_day_type2:"Ogni giornata lavorativa",repeat_week:" Ripetere ogni",repeat_text_week_count:"settimana:",repeat_radio_month_type:"Ripetere",repeat_radio_month_start:"Il",repeat_text_month_day:"giorno ogni",repeat_text_month_count:"mese",repeat_text_month_count2_before:"ogni",repeat_text_month_count2_after:"mese",repeat_year_label:"Il",select_year_day2:"del",repeat_text_year_day:"giorno",select_year_month:"mese",repeat_radio_end:"Senza data finale",repeat_text_occurrences_count:"occorenze",repeat_radio_end3:"Fine",repeat_radio_end2:"Dopo",repeat_never:"Mai",repeat_daily:"Ogni giorno",repeat_workdays:"Ogni giorno feriale",repeat_weekly:"Ogni settimana",repeat_monthly:"Ogni mese",repeat_yearly:"Ogni anno",repeat_custom:"Personalizzato",repeat_freq_day:"Giorno",repeat_freq_week:"Settimana",repeat_freq_month:"Mese",repeat_freq_year:"Anno",repeat_on_date:"Alla data",repeat_ends:"Finisce",month_for_recurring:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Jiugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],day_for_recurring:["Domenica","Luned","Marted","Mercoled","Joved","Venerd","Sabato"]}},p_={date:{month_full:["1","2","3","4","5","6","7","8","9","10","11","12"],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:"",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"",section_description:"",section_time:"",confirm_recurring:"",section_recurring:"",button_recurring:"",button_recurring_open:"",full_day:"",button_edit_series:"",button_edit_occurrence:"",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"",repeat_week:" ",repeat_text_week_count:" :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:"",repeat_text_month_count:"",repeat_text_month_count2_before:"",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"",repeat_text_occurrences_count:"",repeat_radio_end2:"",repeat_radio_end3:"",repeat_never:"",repeat_daily:"",repeat_workdays:"",repeat_weekly:"",repeat_monthly:"",repeat_yearly:"",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:"",repeat_ends:"",month_for_recurring:["1","2","3","4","5","6","7","8","9","10","11","12"],day_for_recurring:["","","","","","",""]}};class m_{constructor(t){this._locales={};for(const n in t)this._locales[n]=t[n]}addLocale(t,n){this._locales[t]=n}getLocale(t){return this._locales[t]}}const g_={date:{month_full:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Mon","Tir","Ons","Tor","Fre","Lr"]},labels:{dhx_cal_today_button:"I dag",day_tab:"Dag",week_tab:"Uke",month_tab:"Mned",new_event:"Ny hendelse",icon_save:"Lagre",icon_cancel:"Avbryt",icon_details:"Detaljer",icon_edit:"Rediger",icon_delete:"Slett",confirm_closing:"",confirm_deleting:"Hendelsen vil bli slettet permanent. Er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",confirm_recurring:"Vil du forandre hele dette settet av repeterende hendelser?",section_recurring:"Repeter hendelsen",button_recurring:"Av",button_recurring_open:"P",button_edit_series:"Rediger serien",button_edit_occurrence:"Redigere en kopi",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Dato",description:"Beskrivelse",year_tab:"r",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daglig",repeat_radio_week:"Ukentlig",repeat_radio_month:"Mnedlig",repeat_radio_year:"rlig",repeat_radio_day_type:"Hver",repeat_text_day_count:"dag",repeat_radio_day_type2:"Alle hverdager",repeat_week:" Gjentas hver",repeat_text_week_count:"uke p:",repeat_radio_month_type:"P hver",repeat_radio_month_start:"P",repeat_text_month_day:"dag hver",repeat_text_month_count:"mned",repeat_text_month_count2_before:"hver",repeat_text_month_count2_after:"mned",repeat_year_label:"p",select_year_day2:"i",repeat_text_year_day:"dag i",select_year_month:"",repeat_radio_end:"Ingen sluttdato",repeat_text_occurrences_count:"forekomst",repeat_radio_end3:"Stop den",repeat_radio_end2:"Etter",repeat_never:"Aldri",repeat_daily:"Hver dag",repeat_workdays:"Hver ukedag",repeat_weekly:"Hver uke",repeat_monthly:"Hver mned",repeat_yearly:"Hvert r",repeat_custom:"Tilpasset",repeat_freq_day:"Dag",repeat_freq_week:"Uke",repeat_freq_month:"Mned",repeat_freq_year:"r",repeat_on_date:"P dato",repeat_ends:"Slutter",month_for_recurring:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],day_for_recurring:["Sondag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"]}},v_={date:{month_full:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],month_short:["Jan","Feb","mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"],day_short:["Zo","Ma","Di","Wo","Do","Vr","Za"]},labels:{dhx_cal_today_button:"Vandaag",day_tab:"Dag",week_tab:"Week",month_tab:"Maand",new_event:"Nieuw item",icon_save:"Opslaan",icon_cancel:"Annuleren",icon_details:"Details",icon_edit:"Bewerken",icon_delete:"Verwijderen",confirm_closing:"",confirm_deleting:"Item zal permanent worden verwijderd, doorgaan?",section_description:"Beschrijving",section_time:"Tijd periode",full_day:"Hele dag",confirm_recurring:"Wilt u alle terugkerende items bijwerken?",section_recurring:"Item herhalen",button_recurring:"Uit",button_recurring_open:"Aan",button_edit_series:"Bewerk de serie",button_edit_occurrence:"Bewerk een kopie",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Datum",description:"Omschrijving",year_tab:"Jaar",week_agenda_tab:"Agenda",grid_tab:"Tabel",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Dagelijks",repeat_radio_week:"Wekelijks",repeat_radio_month:"Maandelijks",repeat_radio_year:"Jaarlijks",repeat_radio_day_type:"Elke",repeat_text_day_count:"dag(en)",repeat_radio_day_type2:"Elke werkdag",repeat_week:" Herhaal elke",repeat_text_week_count:"week op de volgende dagen:",repeat_radio_month_type:"Herhaal",repeat_radio_month_start:"Op",repeat_text_month_day:"dag iedere",repeat_text_month_count:"maanden",repeat_text_month_count2_before:"iedere",repeat_text_month_count2_after:"maanden",repeat_year_label:"Op",select_year_day2:"van",repeat_text_year_day:"dag",select_year_month:"maand",repeat_radio_end:"Geen eind datum",repeat_text_occurrences_count:"keren",repeat_radio_end3:"Eindigd per",repeat_radio_end2:"Na",repeat_never:"Nooit",repeat_daily:"Elke dag",repeat_workdays:"Elke werkdag",repeat_weekly:"Elke week",repeat_monthly:"Elke maand",repeat_yearly:"Elk jaar",repeat_custom:"Aangepast",repeat_freq_day:"Dag",repeat_freq_week:"Week",repeat_freq_month:"Maand",repeat_freq_year:"Jaar",repeat_on_date:"Op datum",repeat_ends:"Eindigt",month_for_recurring:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],day_for_recurring:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"]}},y_={date:{month_full:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],day_full:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Man","Tir","Ons","Tor","Fre","Lr"]},labels:{dhx_cal_today_button:"Idag",day_tab:"Dag",week_tab:"Uke",month_tab:"Mned",new_event:"Ny",icon_save:"Lagre",icon_cancel:"Avbryt",icon_details:"Detaljer",icon_edit:"Endre",icon_delete:"Slett",confirm_closing:"Endringer blir ikke lagret, er du sikker?",confirm_deleting:"Oppfringen vil bli slettet, er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",full_day:"Full dag",confirm_recurring:"Vil du endre hele settet med repeterende oppfringer?",section_recurring:"Repeterende oppfring",button_recurring:"Ikke aktiv",button_recurring_open:"Aktiv",button_edit_series:"Rediger serien",button_edit_occurrence:"Redigere en kopi",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Dato",description:"Beskrivelse",year_tab:"r",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daglig",repeat_radio_week:"Ukentlig",repeat_radio_month:"Mnedlig",repeat_radio_year:"rlig",repeat_radio_day_type:"Hver",repeat_text_day_count:"dag",repeat_radio_day_type2:"Hver arbeidsdag",repeat_week:" Gjenta hver",repeat_text_week_count:"uke neste dager:",repeat_radio_month_type:"Gjenta",repeat_radio_month_start:"P",repeat_text_month_day:"dag hver",repeat_text_month_count:"mned",repeat_text_month_count2_before:"hver",repeat_text_month_count2_after:"mned",repeat_year_label:"P",select_year_day2:"av",repeat_text_year_day:"dag",select_year_month:"mned",repeat_radio_end:"Ingen sluttdato",repeat_text_occurrences_count:"forekomster",repeat_radio_end2:"Etter",repeat_radio_end3:"Slutt innen",repeat_never:"Aldri",repeat_daily:"Hver dag",repeat_workdays:"Hver ukedag",repeat_weekly:"Hver uke",repeat_monthly:"Hver mned",repeat_yearly:"Hvert r",repeat_custom:"Tilpasset",repeat_freq_day:"Dag",repeat_freq_week:"Uke",repeat_freq_month:"Mned",repeat_freq_year:"r",repeat_on_date:"P dato",repeat_ends:"Slutter",month_for_recurring:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],day_for_recurring:["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"]}},b_={date:{month_full:["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],month_short:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],day_full:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota"],day_short:["Nie","Pon","Wto","ro","Czw","Pi","Sob"]},labels:{dhx_cal_today_button:"Dzi",day_tab:"Dzie",week_tab:"Tydzie",month_tab:"Miesic",new_event:"Nowe zdarzenie",icon_save:"Zapisz",icon_cancel:"Anuluj",icon_details:"Szczegy",icon_edit:"Edytuj",icon_delete:"Usu",confirm_closing:"",confirm_deleting:"Zdarzenie zostanie usunite na zawsze, kontynuowa?",section_description:"Opis",section_time:"Okres czasu",full_day:"Cay dzie",confirm_recurring:"Czy chcesz edytowa cay zbir powtarzajcych si zdarze?",section_recurring:"Powtrz zdarzenie",button_recurring:"Nieaktywne",button_recurring_open:"Aktywne",button_edit_series:"Edytuj seri",button_edit_occurrence:"Edytuj kopi",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Data",description:"Opis",year_tab:"Rok",week_agenda_tab:"Agenda",grid_tab:"Tabela",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Codziennie",repeat_radio_week:"Co tydzie",repeat_radio_month:"Co miesic",repeat_radio_year:"Co rok",repeat_radio_day_type:"Kadego",repeat_text_day_count:"dnia",repeat_radio_day_type2:"Kadego dnia roboczego",repeat_week:" Powtarzaj kadego",repeat_text_week_count:"tygodnia w dni:",repeat_radio_month_type:"Powtrz",repeat_radio_month_start:"W",repeat_text_month_day:"dnia kadego",repeat_text_month_count:"miesica",repeat_text_month_count2_before:"kadego",repeat_text_month_count2_after:"miesica",repeat_year_label:"W",select_year_day2:"miesica",repeat_text_year_day:"dnia miesica",select_year_month:"",repeat_radio_end:"Bez daty kocowej",repeat_text_occurrences_count:"wystpieniu/ach",repeat_radio_end3:"Zakocz w",repeat_radio_end2:"Po",repeat_never:"Nigdy",repeat_daily:"Codziennie",repeat_workdays:"Kady dzie roboczy",repeat_weekly:"Co tydzie",repeat_monthly:"Co miesic",repeat_yearly:"Co rok",repeat_custom:"Niestandardowy",repeat_freq_day:"Dzie",repeat_freq_week:"Tydzie",repeat_freq_month:"Miesic",repeat_freq_year:"Rok",repeat_on_date:"W dniu",repeat_ends:"Koczy si",month_for_recurring:["Stycznia","Lutego","Marca","Kwietnia","Maja","Czerwca","Lipca","Sierpnia","Wrzenia","Padziernka","Listopada","Grudnia"],day_for_recurring:["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota"]}},w_={date:{month_full:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],month_short:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],day_full:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],day_short:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},labels:{dhx_cal_today_button:"Hoje",day_tab:"Dia",week_tab:"Semana",month_tab:"Ms",new_event:"Novo evento",icon_save:"Salvar",icon_cancel:"Cancelar",icon_details:"Detalhes",icon_edit:"Editar",icon_delete:"Deletar",confirm_closing:"",confirm_deleting:"Tem certeza que deseja excluir?",section_description:"Descrio",section_time:"Perodo de tempo",full_day:"Dia inteiro",confirm_recurring:"Deseja editar todos esses eventos repetidos?",section_recurring:"Repetir evento",button_recurring:"Desabilitar",button_recurring_open:"Habilitar",button_edit_series:"Editar a srie",button_edit_occurrence:"Editar uma cpia",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Dia",date:"Data",description:"Descrio",year_tab:"Ano",week_agenda_tab:"Dia",grid_tab:"Grade",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Dirio",repeat_radio_week:"Semanal",repeat_radio_month:"Mensal",repeat_radio_year:"Anual",repeat_radio_day_type:"Cada",repeat_text_day_count:"dia(s)",repeat_radio_day_type2:"Cada trabalho dirio",repeat_week:" Repita cada",repeat_text_week_count:"semana:",repeat_radio_month_type:"Repetir",repeat_radio_month_start:"Em",repeat_text_month_day:"todo dia",repeat_text_month_count:"ms",repeat_text_month_count2_before:"todo",repeat_text_month_count2_after:"ms",repeat_year_label:"Em",select_year_day2:"of",repeat_text_year_day:"dia",select_year_month:"ms",repeat_radio_end:"Sem data final",repeat_text_occurrences_count:"ocorrncias",repeat_radio_end3:"Fim",repeat_radio_end2:"Depois",repeat_never:"Nunca",repeat_daily:"Todos os dias",repeat_workdays:"Todos os dias teis",repeat_weekly:"Toda semana",repeat_monthly:"Todo ms",repeat_yearly:"Todo ano",repeat_custom:"Personalizado",repeat_freq_day:"Dia",repeat_freq_week:"Semana",repeat_freq_month:"Ms",repeat_freq_year:"Ano",repeat_on_date:"Na data",repeat_ends:"Termina",month_for_recurring:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],day_for_recurring:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"]}},x_={date:{month_full:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","November","December"],month_short:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Nov","Dec"],day_full:["Duminica","Luni","Marti","Miercuri","Joi","Vineri","Sambata"],day_short:["Du","Lu","Ma","Mi","Jo","Vi","Sa"]},labels:{dhx_cal_today_button:"Astazi",day_tab:"Zi",week_tab:"Saptamana",month_tab:"Luna",new_event:"Eveniment nou",icon_save:"Salveaza",icon_cancel:"Anuleaza",icon_details:"Detalii",icon_edit:"Editeaza",icon_delete:"Sterge",confirm_closing:"Schimbarile nu vor fi salvate, esti sigur?",confirm_deleting:"Evenimentul va fi sters permanent, esti sigur?",section_description:"Descriere",section_time:"Interval",full_day:"Toata ziua",confirm_recurring:"Vrei sa editezi toata seria de evenimente repetate?",section_recurring:"Repetare",button_recurring:"Dezactivata",button_recurring_open:"Activata",button_edit_series:"Editeaza serie",button_edit_occurrence:"Editeaza doar intrare",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Agenda",date:"Data",description:"Descriere",year_tab:"An",week_agenda_tab:"Agenda",grid_tab:"Lista",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Zilnic",repeat_radio_week:"Saptamanal",repeat_radio_month:"Lunar",repeat_radio_year:"Anual",repeat_radio_day_type:"La fiecare",repeat_text_day_count:"zi(le)",repeat_radio_day_type2:"Fiecare zi lucratoare",repeat_week:" Repeta la fiecare",repeat_text_week_count:"saptamana in urmatoarele zile:",repeat_radio_month_type:"Repeta in",repeat_radio_month_start:"In a",repeat_text_month_day:"zi la fiecare",repeat_text_month_count:"luni",repeat_text_month_count2_before:"la fiecare",repeat_text_month_count2_after:"luni",repeat_year_label:"In",select_year_day2:"a lunii",repeat_text_year_day:"zi a lunii",select_year_month:"",repeat_radio_end:"Fara data de sfarsit",repeat_text_occurrences_count:"evenimente",repeat_radio_end3:"La data",repeat_radio_end2:"Dupa",repeat_never:"Niciodat",repeat_daily:"n fiecare zi",repeat_workdays:"n fiecare zi lucrtoare",repeat_weekly:"n fiecare sptmn",repeat_monthly:"n fiecare lun",repeat_yearly:"n fiecare an",repeat_custom:"Personalizat",repeat_freq_day:"Zi",repeat_freq_week:"Sptmn",repeat_freq_month:"Lun",repeat_freq_year:"An",repeat_on_date:"La data",repeat_ends:"Se termin",month_for_recurring:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],day_for_recurring:["Duminica","Luni","Marti","Miercuri","Joi","Vineri","Sambata"]}},k_={date:{month_full:["","","","","Ma","","","","","O","",""],month_short:["","","Ma","A","Ma","","","A","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"   , ?",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"      ?",section_recurring:"",button_recurring:"",button_recurring_open:"",button_edit_series:" ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"  ",repeat_week:"  ",repeat_text_week_count:" , :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:"   ",repeat_text_month_count:"",repeat_text_month_count2_before:" ",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end3:" ",repeat_radio_end2:"",repeat_never:"",repeat_daily:" ",repeat_workdays:"  ",repeat_weekly:" ",repeat_monthly:" ",repeat_yearly:" ",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","",""]}},E_={date:{month_full:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota"],day_short:["Ned","Pon","Tor","Sre","et","Pet","Sob"]},labels:{dhx_cal_today_button:"Danes",day_tab:"Dan",week_tab:"Teden",month_tab:"Mesec",new_event:"Nov dogodek",icon_save:"Shrani",icon_cancel:"Preklii",icon_details:"Podrobnosti",icon_edit:"Uredi",icon_delete:"Izbrii",confirm_closing:"",confirm_deleting:"Dogodek bo izbrisan. elite nadaljevati?",section_description:"Opis",section_time:"asovni okvir",full_day:"Ves dan",confirm_recurring:"elite urediti celoten set ponavljajoih dogodkov?",section_recurring:"Ponovi dogodek",button_recurring:"Onemogoeno",button_recurring_open:"Omogoeno",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Zadeva",date:"Datum",description:"Opis",year_tab:"Leto",week_agenda_tab:"Zadeva",grid_tab:"Miza",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Dnevno",repeat_radio_week:"Tedensko",repeat_radio_month:"Meseno",repeat_radio_year:"Letno",repeat_radio_day_type:"Vsak",repeat_text_day_count:"dan",repeat_radio_day_type2:"Vsak delovni dan",repeat_week:" Ponavljaj vsak",repeat_text_week_count:"teden na naslednje dni:",repeat_radio_month_type:"Ponavljaj",repeat_radio_month_start:"Na",repeat_text_month_day:"dan vsak",repeat_text_month_count:"mesec",repeat_text_month_count2_before:"vsak",repeat_text_month_count2_after:"mesec",repeat_year_label:"Na",select_year_day2:"od",repeat_text_year_day:"dan",select_year_month:"mesec",repeat_radio_end:"Brez konnega datuma",repeat_text_occurrences_count:"pojavitve",repeat_radio_end2:"Po",repeat_radio_end3:"Konaj do",repeat_never:"Nikoli",repeat_daily:"Vsak dan",repeat_workdays:"Vsak delovni dan",repeat_weekly:"Vsak teden",repeat_monthly:"Vsak mesec",repeat_yearly:"Vsako leto",repeat_custom:"Po meri",repeat_freq_day:"Dan",repeat_freq_week:"Teden",repeat_freq_month:"Mesec",repeat_freq_year:"Leto",repeat_on_date:"Na datum",repeat_ends:"Kona se",month_for_recurring:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],day_for_recurring:["Nedelja","Ponedeljek","Torek","Sreda","etrtek","Petek","Sobota"]}},T_={date:{month_full:["Janur","Februr","Marec","Aprl","Mj","Jn","Jl","August","September","Oktber","November","December"],month_short:["Jan","Feb","Mar","Apr","Mj","Jn","Jl","Aug","Sept","Okt","Nov","Dec"],day_full:["Nedea","Pondelok","Utorok","Streda","tvrtok","Piatok","Sobota"],day_short:["Ne","Po","Ut","St","t","Pi","So"]},labels:{dhx_cal_today_button:"Dnes",day_tab:"De",week_tab:"Tde",month_tab:"Mesiac",new_event:"Nov udalos",icon_save:"Uloi",icon_cancel:"Sp",icon_details:"Detail",icon_edit:"Edituj",icon_delete:"Zmaza",confirm_closing:"Vae zmeny nebud uloen. Skutone?",confirm_deleting:"Udalos bude natrvalo vymazan. Skutone?",section_description:"Poznmky",section_time:"Doba platnosti",confirm_recurring:"Prajete si upravi cel radu opakovanch udalost?",section_recurring:"Opakovanie udalosti",button_recurring:"Vypnut",button_recurring_open:"Zapnut",button_edit_series:"Upravi opakovania",button_edit_occurrence:"Upravi intancie",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Program",date:"Dtum",description:"Poznmka",year_tab:"Rok",full_day:"Cel de",week_agenda_tab:"Program",grid_tab:"Mrieka",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Denne",repeat_radio_week:"Tdenne",repeat_radio_month:"Mesane",repeat_radio_year:"Rone",repeat_radio_day_type:"Kad",repeat_text_day_count:"de",repeat_radio_day_type2:"Kad prac. de",repeat_week:"Opakova kad",repeat_text_week_count:"tde v doch:",repeat_radio_month_type:"Opakova",repeat_radio_month_start:"On",repeat_text_month_day:"de kad",repeat_text_month_count:"mesiac",repeat_text_month_count2_before:"kad",repeat_text_month_count2_after:"mesiac",repeat_year_label:"On",select_year_day2:"poas",repeat_text_year_day:"de",select_year_month:"mesiac",repeat_radio_end:"Bez dtumu ukonenia",repeat_text_occurrences_count:"udalostiach",repeat_radio_end3:"Ukoni",repeat_radio_end2:"Po",repeat_never:"Nikdy",repeat_daily:"Kad de",repeat_workdays:"Kad pracovn de",repeat_weekly:"Kad tde",repeat_monthly:"Kad mesiac",repeat_yearly:"Kad rok",repeat_custom:"Vlastn",repeat_freq_day:"De",repeat_freq_week:"Tde",repeat_freq_month:"Mesiac",repeat_freq_year:"Rok",repeat_on_date:"Na dtum",repeat_ends:"Koniec",month_for_recurring:["Janur","Februr","Marec","Aprl","Mj","Jn","Jl","August","September","Oktber","November","December"],day_for_recurring:["Nedea","Pondelok","Utorok","Streda","tvrtok","Piatok","Sobota"]}},A_={date:{month_full:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag"],day_short:["Sn","Mn","Tis","Ons","Tor","Fre","Lr"]},labels:{dhx_cal_today_button:"Idag",day_tab:"Dag",week_tab:"Vecka",month_tab:"Mnad",new_event:"Ny hndelse",icon_save:"Spara",icon_cancel:"ngra",icon_details:"Detaljer",icon_edit:"ndra",icon_delete:"Ta bort",confirm_closing:"",confirm_deleting:"r du sker p att du vill ta bort hndelsen permanent?",section_description:"Beskrivning",section_time:"Tid",full_day:"Hela dagen",confirm_recurring:"Vill du redigera hela serien med repeterande hndelser?",section_recurring:"Upprepa hndelse",button_recurring:"Inaktiverat",button_recurring_open:"Aktiverat",button_edit_series:"Redigera serien",button_edit_occurrence:"Redigera en kopia",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Dagordning",date:"Datum",description:"Beskrivning",year_tab:"r",week_agenda_tab:"Dagordning",grid_tab:"Galler",drag_to_create:"Dra fr att skapa ny",drag_to_move:"Dra fr att flytta",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Dagligen",repeat_radio_week:"Veckovis",repeat_radio_month:"Mnadsvis",repeat_radio_year:"rligen",repeat_radio_day_type:"Var",repeat_text_day_count:"dag",repeat_radio_day_type2:"Varje arbetsdag",repeat_week:" Upprepa var",repeat_text_week_count:"vecka dessa dagar:",repeat_radio_month_type:"Upprepa",repeat_radio_month_start:"Den",repeat_text_month_day:"dagen var",repeat_text_month_count:"mnad",repeat_text_month_count2_before:"var",repeat_text_month_count2_after:"mnad",repeat_year_label:"Den",select_year_day2:"i",repeat_text_year_day:"dag i",select_year_month:"mnad",repeat_radio_end:"Inget slutdatum",repeat_text_occurrences_count:"upprepningar",repeat_radio_end3:"Sluta efter",repeat_radio_end2:"Efter",repeat_never:"Aldrig",repeat_daily:"Varje dag",repeat_workdays:"Varje vardag",repeat_weekly:"Varje vecka",repeat_monthly:"Varje mnad",repeat_yearly:"Varje r",repeat_custom:"Anpassad",repeat_freq_day:"Dag",repeat_freq_week:"Vecka",repeat_freq_month:"Mnad",repeat_freq_year:"r",repeat_on_date:"P datum",repeat_ends:"Slutar",month_for_recurring:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],day_for_recurring:["Sndag","Mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag"]}},S_={date:{month_full:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],month_short:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],day_full:["Pazar","Pazartes,","Sal","aramba","Perembe","Cuma","Cumartesi"],day_short:["Paz","Pts","Sal","ar","Per","Cum","Cts"]},labels:{dhx_cal_today_button:"Bugn",day_tab:"Gn",week_tab:"Hafta",month_tab:"Ay",new_event:"Uygun",icon_save:"Kaydet",icon_cancel:"ptal",icon_details:"Detaylar",icon_edit:"Dzenle",icon_delete:"Sil",confirm_closing:"",confirm_deleting:"Etkinlik silinecek, devam?",section_description:"Aklama",section_time:"Zaman aral",full_day:"Tam gn",confirm_recurring:"Tm tekrar eden etkinlikler silinecek, devam?",section_recurring:"Etkinlii tekrarla",button_recurring:"Pasif",button_recurring_open:"Aktif",button_edit_series:"Dizi dzenleme",button_edit_occurrence:"Bir kopyasn dzenleyin",button_edit_occurrence_and_following:"This and following events",agenda_tab:"Ajanda",date:"Tarih",description:"Aklama",year_tab:"Yl",week_agenda_tab:"Ajanda",grid_tab:"Izgara",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Gnlk",repeat_radio_week:"Haftalk",repeat_radio_month:"Aylk",repeat_radio_year:"Yllk",repeat_radio_day_type:"Her",repeat_text_day_count:"gn",repeat_radio_day_type2:"Her i gn",repeat_week:" Tekrar her",repeat_text_week_count:"hafta u gnlerde:",repeat_radio_month_type:"Tekrar et",repeat_radio_month_start:"Tarihinde",repeat_text_month_day:"gn her",repeat_text_month_count:"ay",repeat_text_month_count2_before:"her",repeat_text_month_count2_after:"ay",repeat_year_label:"Tarihinde",select_year_day2:"ayn",repeat_text_year_day:"gn",select_year_month:"ay",repeat_radio_end:"Biti tarihi yok",repeat_text_occurrences_count:"olay",repeat_radio_end2:"Sonra",repeat_radio_end3:"Tarihinde bitir",repeat_never:"Asla",repeat_daily:"Her gn",repeat_workdays:"Her i gn",repeat_weekly:"Her hafta",repeat_monthly:"Her ay",repeat_yearly:"Her yl",repeat_custom:"zel",repeat_freq_day:"Gn",repeat_freq_week:"Hafta",repeat_freq_month:"Ay",repeat_freq_year:"Yl",repeat_on_date:"Tarihinde",repeat_ends:"Biter",month_for_recurring:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],day_for_recurring:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"]}},D_={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","'",""],day_short:["","","","","","",""]},labels:{dhx_cal_today_button:"",day_tab:"",week_tab:"",month_tab:"",new_event:" ",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"  .  ?",section_description:"",section_time:" ",full_day:" ",confirm_recurring:"     ?",section_recurring:" ",button_recurring:"",button_recurring_open:"",button_edit_series:" ",button_edit_occurrence:" ",button_edit_occurrence_and_following:"This and following events",agenda_tab:"",date:"",description:"",year_tab:"",week_agenda_tab:"",grid_tab:"",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"",repeat_radio_week:"",repeat_radio_month:"",repeat_radio_year:"",repeat_radio_day_type:"",repeat_text_day_count:"",repeat_radio_day_type2:"  ",repeat_week:"  ",repeat_text_week_count:" , :",repeat_radio_month_type:"",repeat_radio_month_start:"",repeat_text_month_day:"   ",repeat_text_month_count:"",repeat_text_month_count2_before:" ",repeat_text_month_count2_after:"",repeat_year_label:"",select_year_day2:"",repeat_text_year_day:"",select_year_month:"",repeat_radio_end:"  ",repeat_text_occurrences_count:"",repeat_radio_end3:" ",repeat_radio_end2:"",repeat_never:"",repeat_daily:"",repeat_workdays:"   ",repeat_weekly:"",repeat_monthly:"",repeat_yearly:"",repeat_custom:"",repeat_freq_day:"",repeat_freq_week:"",repeat_freq_month:"",repeat_freq_year:"",repeat_on_date:" ",repeat_ends:"",month_for_recurring:["","","","","","","","","","","",""],day_for_recurring:["","","","","","'",""]}};class C_{constructor(t,n,r={}){this.state={date:new Date,modes:["days","months","years"],currentRange:[],eventDates:[],filterDays:null,currentModeIndex:0,...r},this.container=null,this.element=null,this.onStateChangeHandlers=[],this.scheduler=t,this._domEvents=t._createDomEventScope(),this.state=this.getState(),fi(this),n&&(this.container=n,this.render(this.container)),this.onStateChange((i,a)=>{this.callEvent("onStateChange",[a,i])})}getState(){return{...this.state,mode:this.state.modes[this.state.currentModeIndex]}}setState(t){const n={...this.state};t.mode&&(t.currentModeIndex=this.state.modes.indexOf(t.mode)),this.state={...this.state,...t},this._notifyStateChange(n,this.state),this.container&&this.render(this.container)}onStateChange(t){return this.onStateChangeHandlers.push(t),()=>{const n=this.onStateChangeHandlers.indexOf(t);n!==-1&&this.onStateChangeHandlers.splice(n,1)}}_notifyStateChange(t,n){this.onStateChangeHandlers.forEach(r=>r(t,n))}_adjustDate(t){const{mode:n,date:r}=this.getState(),i=new Date(r);n==="days"?i.setMonth(r.getMonth()+t):n==="months"?i.setFullYear(r.getFullYear()+t):i.setFullYear(r.getFullYear()+10*t),this.setState({date:i})}_toggleMode(){const t=(this.state.currentModeIndex+1)%this.state.modes.length;this.setState({currentModeIndex:t})}_renderCalendarHeader(t){const{mode:n,date:r}=this.getState(),i=document.createElement("div");i.classList.add("dhx_cal_datepicker_header");const a=document.createElement("button");a.classList.add("dhx_cal_datepicker_arrow","scheduler_icon","arrow_left"),i.appendChild(a);const o=document.createElement("div");if(o.classList.add("dhx_cal_datepicker_title"),n==="days")o.innerText=r.toLocaleString("default",{month:"long"})+" "+r.getFullYear();else if(n==="months")o.innerText=r.getFullYear();else{const s=10*Math.floor(r.getFullYear()/10);o.innerText=`${s} - ${s+9}`}this._domEvents.attach(o,"click",this._toggleMode.bind(this)),i.appendChild(o);const l=document.createElement("button");l.classList.add("dhx_cal_datepicker_arrow","scheduler_icon","arrow_right"),i.appendChild(l),t.appendChild(i),this._domEvents.attach(a,"click",this._adjustDate.bind(this,-1)),this._domEvents.attach(l,"click",this._adjustDate.bind(this,1))}render(t){this._domEvents.detachAll(),this.container=t||this.container,this.container.innerHTML="",this.element||(this.element=document.createElement("div"),this.element.classList.add("dhx_cal_datepicker")),this.element.innerHTML="",this.container.appendChild(this.element),this._renderCalendarHeader(this.element);const n=document.createElement("div");n.classList.add("dhx_cal_datepicker_data"),this.element.appendChild(n);const{mode:r}=this.getState();r==="days"?this._renderDayGrid(n):r==="months"?this._renderMonthGrid(n):this._renderYearGrid(n)}_renderDayGridHeader(t){const{date:n,filterDays:r}=this.getState(),i=this.scheduler;let a=i.date.week_start(new Date(n));const o=i.date.add(i.date.week_start(new Date(n)),1,"week");t.classList.add("dhx_cal_datepicker_days");const l=i.date.date_to_str("%D");for(;a.valueOf()<o.valueOf();){if(!r||!r(a)){const s=l(a),d=document.createElement("div");d.setAttribute("data-day",a.getDay()),d.classList.add("dhx_cal_datepicker_dayname"),d.innerText=s,t.appendChild(d)}a=i.date.add(a,1,"day")}}_weeksBetween(t,n){const r=this.scheduler;let i=0,a=new Date(t);for(;a.valueOf()<n.valueOf();)i+=1,a=r.date.week_start(r.date.add(a,1,"week"));return i}_renderDayGrid(t){const{date:n,currentRange:r,eventDates:i,minWeeks:a,filterDays:o}=this.getState();let l=r[0],s=r[1];const d=i.reduce((N,I)=>(N[this.scheduler.date.day_start(new Date(I)).valueOf()]=!0,N),{}),c=document.createElement("div");this._renderDayGridHeader(c);const u=c.children.length;t.appendChild(c),u!==7&&t.style.setProperty("--dhx-scheduler-week-length",u);const f=this.scheduler,y=f.date.week_start(f.date.month_start(new Date(n))),g=f.date.month_start(new Date(n)),h=f.date.add(f.date.month_start(new Date(n)),1,"month");let p=f.date.add(f.date.month_start(new Date(n)),1,"month");const v=f.date.date_part(f._currentDate());p.getDay()!==0&&(p=f.date.add(f.date.week_start(p),1,"week"));let x=this._weeksBetween(y,p);a&&x<a&&(p=f.date.add(p,a-x,"week"));let S=y;const O=document.createElement("div");for(O.classList.add("dhx_cal_datepicker_days"),this._domEvents.attach(O,"click",N=>{const I=N.target.closest("[data-cell-date]"),A=new Date(I.getAttribute("data-cell-date"));this.callEvent("onDateClick",[A,N])});S.valueOf()<p.valueOf();){if(!o||!o(S)){const N=document.createElement("div");N.setAttribute("data-cell-date",f.templates.format_date(S)),N.setAttribute("data-day",S.getDay()),N.innerHTML=f.templates.month_day(S),S.valueOf()<g.valueOf()?N.classList.add("dhx_before"):S.valueOf()>=h.valueOf()&&N.classList.add("dhx_after"),S.getDay()!==0&&S.getDay()!==6||N.classList.add("dhx_cal_datepicker_weekend"),S.valueOf()==v.valueOf()&&N.classList.add("dhx_now"),l&&s&&S.valueOf()>=l.valueOf()&&S.valueOf()<s.valueOf()&&N.classList.add("dhx_cal_datepicker_current"),d[S.valueOf()]&&N.classList.add("dhx_cal_datepicker_event"),N.classList.add("dhx_cal_datepicker_date"),O.appendChild(N)}S=f.date.add(S,1,"day")}t.appendChild(O)}_renderMonthGrid(t){const{date:n}=this.getState(),r=document.createElement("div");r.classList.add("dhx_cal_datepicker_months");const i=[];for(let s=0;s<12;s++)i.push(new Date(n.getFullYear(),s,1));const a=this.scheduler.date.date_to_str("%M");i.forEach(s=>{const d=document.createElement("div");d.classList.add("dhx_cal_datepicker_month"),n.getMonth()===s.getMonth()&&d.classList.add("dhx_cal_datepicker_current"),d.setAttribute("data-month",s.getMonth()),d.innerHTML=a(s),this._domEvents.attach(d,"click",()=>{const c=new Date(s);this.setState({date:c,mode:"days"})}),r.appendChild(d)}),t.appendChild(r);const o=document.createElement("div");o.classList.add("dhx_cal_datepicker_done");const l=document.createElement("button");l.innerText="Done",l.classList.add("dhx_cal_datepicker_done_btn"),this._domEvents.attach(l,"click",()=>{this.setState({mode:"days"})}),o.appendChild(l),t.appendChild(o)}_renderYearGrid(t){const{date:n}=this.getState(),r=10*Math.floor(n.getFullYear()/10),i=document.createElement("div");i.classList.add("dhx_cal_datepicker_years");for(let l=r-1;l<=r+10;l++){const s=document.createElement("div");s.innerText=l,s.classList.add("dhx_cal_datepicker_year"),s.setAttribute("data-year",l),n.getFullYear()===l&&s.classList.add("dhx_cal_datepicker_current"),this._domEvents.attach(s,"click",()=>{this.setState({date:new Date(l,n.getMonth(),1),mode:"months"})}),i.appendChild(s)}t.appendChild(i);const a=document.createElement("div");a.classList.add("dhx_cal_datepicker_done");const o=document.createElement("button");o.innerText="Done",o.classList.add("dhx_cal_datepicker_done_btn"),this._domEvents.attach(o,"click",()=>{this.setState({mode:"months"})}),a.appendChild(o),t.appendChild(a)}destructor(){this.onStateChangeHandlers=[],this.element&&(this.element.innerHTML="",this.element.remove()),this._domEvents.detachAll(),this.callEvent("onDestroy",[]),this.detachAllEvents(),this.scheduler=null}}function N_(e){const t={version:"7.2.5"};t.$stateProvider=function(){const s={};return{getState:function(d){if(s[d])return s[d].method();{const c={};for(const u in s)s[u].internal||Qe.mixin(c,s[u].method(),!0);return c}},registerProvider:function(d,c,u){s[d]={method:c,internal:u}},unregisterProvider:function(d){delete s[d]}}}(),t.getState=t.$stateProvider.getState,function(s){var d={agenda:"https://docs.dhtmlx.com/scheduler/agenda_view.html",grid:"https://docs.dhtmlx.com/scheduler/grid_view.html",map:"https://docs.dhtmlx.com/scheduler/map_view.html",unit:"https://docs.dhtmlx.com/scheduler/units_view.html",timeline:"https://docs.dhtmlx.com/scheduler/timeline_view.html",week_agenda:"https://docs.dhtmlx.com/scheduler/weekagenda_view.html",year:"https://docs.dhtmlx.com/scheduler/year_view.html",anythingElse:"https://docs.dhtmlx.com/scheduler/views.html"},c={agenda:"ext/dhtmlxscheduler_agenda_view.js",grid:"ext/dhtmlxscheduler_grid_view.js",map:"ext/dhtmlxscheduler_map_view.js",unit:"ext/dhtmlxscheduler_units.js",timeline:"ext/dhtmlxscheduler_timeline.js, ext/dhtmlxscheduler_treetimeline.js, ext/dhtmlxscheduler_daytimeline.js",week_agenda:"ext/dhtmlxscheduler_week_agenda.js",year:"ext/dhtmlxscheduler_year_view.js",limit:"ext/dhtmlxscheduler_limit.js"};s._commonErrorMessages={unknownView:function(u){var f=c[u]?"You're probably missing "+c[u]+".":"";return"`"+u+"` view is not defined. \nPlease check parameters you pass to `scheduler.init` or `scheduler.setCurrentView` in your code and ensure you've imported appropriate extensions. \nRelated docs: "+(d[u]||d.anythingElse)+`
`+(f?f+`
`:"")},collapsedContainer:function(u){return`Scheduler container height is set to *100%* but the rendered height is zero and the scheduler is not visible. 
Make sure that the container has some initial height or use different units. For example:
<div id='scheduler_here' class='dhx_cal_container' style='width:100%; height:600px;'> 
`}},s.createTimelineView=function(){throw new Error("scheduler.createTimelineView is not implemented. Be sure to add the required extension: "+c.timeline+`
Related docs: `+d.timeline)},s.createUnitsView=function(){throw new Error("scheduler.createUnitsView is not implemented. Be sure to add the required extension: "+c.unit+`
Related docs: `+d.unit)},s.createGridView=function(){throw new Error("scheduler.createGridView is not implemented. Be sure to add the required extension: "+c.grid+`
Related docs: `+d.grid)},s.addMarkedTimespan=function(){throw new Error(`scheduler.addMarkedTimespan is not implemented. Be sure to add the required extension: ext/dhtmlxscheduler_limit.js
Related docs: https://docs.dhtmlx.com/scheduler/limits.html`)},s.renderCalendar=function(){throw new Error(`scheduler.renderCalendar is not implemented. Be sure to add the required extension: ext/dhtmlxscheduler_minical.js
https://docs.dhtmlx.com/scheduler/minicalendar.html`)},s.exportToPNG=function(){throw new Error(["scheduler.exportToPNG is not implemented.","This feature requires an additional module, be sure to check the related doc here https://docs.dhtmlx.com/scheduler/png.html","Licensing info: https://dhtmlx.com/docs/products/dhtmlxScheduler/export.shtml"].join(`
`))},s.exportToPDF=function(){throw new Error(["scheduler.exportToPDF is not implemented.","This feature requires an additional module, be sure to check the related doc here https://docs.dhtmlx.com/scheduler/pdf.html","Licensing info: https://dhtmlx.com/docs/products/dhtmlxScheduler/export.shtml"].join(`
`))}}(t),Hc(t),function(s){fi(s),Lc(s),s._detachDomEvent=function(h,p,v){h.removeEventListener?h.removeEventListener(p,v,!1):h.detachEvent&&h.detachEvent("on"+p,v)},s._init_once=function(){Vc(s),s._init_once=function(){}};const d={render:function(h){return s._init_nav_bar(h)}},c={render:function(h){const p=document.createElement("div");return p.className="dhx_cal_header",p}},u={render:function(h){const p=document.createElement("div");return p.className="dhx_cal_data",p}};function f(h){return!!(h.querySelector(".dhx_cal_header")&&h.querySelector(".dhx_cal_data")&&h.querySelector(".dhx_cal_navline"))}s.init=function(h,p,v){if(!this.$destroyed){if(p=p||s._currentDate(),v=v||"week",this._obj&&this.unset_actions(),this._obj=typeof h=="string"?document.getElementById(h):h,this.$container=this._obj,this.$root=this._obj,!this.$container.offsetHeight&&this.$container.offsetWidth&&this.$container.style.height==="100%"&&window.console.error(s._commonErrorMessages.collapsedContainer(),this.$container),this.config.wai_aria_attributes&&this.config.wai_aria_application_role&&this.$container.setAttribute("role","application"),this.config.header||f(this.$container)||(this.config.header=function(x){const S=["day","week","month"];if(x.matrix)for(const O in x.matrix)S.push(O);if(x._props)for(const O in x._props)S.push(O);if(x._grid&&x._grid.names)for(const O in x._grid.names)S.push(O);return["map","agenda","week_agenda","year"].forEach(function(O){x[O+"_view"]&&S.push(O)}),S.concat(["date"]).concat(["prev","today","next"])}(this),window.console.log(["Required DOM elements are missing from the scheduler container and **scheduler.config.header** is not specified.","Using a default header configuration: ","scheduler.config.header = "+JSON.stringify(this.config.header,null,2),"Check this article for the details: https://docs.dhtmlx.com/scheduler/initialization.html"].join(`
`))),this.config.header)this.$container.innerHTML="",this.$container.classList.add("dhx_cal_container"),this.config.header.height&&(this.xy.nav_height=this.config.header.height),this.$container.appendChild(d.render(this.config.header)),this.$container.appendChild(c.render()),this.$container.appendChild(u.render());else if(!f(this.$container))throw new Error(["Required DOM elements are missing from the scheduler container.","Be sure to either specify them manually in the markup: https://docs.dhtmlx.com/scheduler/initialization.html#initializingschedulerviamarkup","Or to use **scheduler.config.header** setting so they could be created automatically: https://docs.dhtmlx.com/scheduler/initialization.html#initializingschedulerviaheaderconfig"].join(`
`));this.config.rtl&&(this.$container.className+=" dhx_cal_container_rtl"),this._skin_init&&s._skin_init(),s.date.init(),this._scroll=!0,this._els=[],this.get_elements(),this.init_templates(),this.set_actions(),this._init_once(),this._init_touch_events(),this.set_sizes(),s.callEvent("onSchedulerReady",[]),s.$initialized=!0,this.setCurrentView(p,v)}},s.xy={min_event_height:20,bar_height:24,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22,event_header_height:14},s.keys={edit_save:13,edit_cancel:27},s.bind=function(h,p){return h.bind?h.bind(p):function(){return h.apply(p,arguments)}},s.set_sizes=function(){var h=this._x=this._obj.clientWidth-this.xy.margin_left,p=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,v=this.$container.querySelector(".dhx_cal_scale_placeholder");s._is_material_skin()?(v||((v=document.createElement("div")).className="dhx_cal_scale_placeholder",this.$container.insertBefore(v,this._els.dhx_cal_header[0])),v.style.display="block",this.set_xy(v,h,this.xy.scale_height+1,0,this._els.dhx_cal_header[0].offsetTop)):v&&v.parentNode.removeChild(v),this._lightbox&&(s.$container.offsetWidth<1200||this._setLbPosition(document.querySelector(".dhx_cal_light"))),this._data_width=h-p,this._els.dhx_cal_navline[0].style.width=h+"px";const x=this._els.dhx_cal_header[0];this.set_xy(x,this._data_width,this.xy.scale_height),x.style.left="",x.style.right="",this._table_view?this.config.rtl?x.style.right="-1px":x.style.left="-1px":this.config.rtl?x.style.right=`${this.xy.scale_width}px`:x.style.left=`${this.xy.scale_width}px`},s.set_xy=function(h,p,v,x,S){function O(I){let A=I;return isNaN(Number(A))||(A=Math.max(0,A)+"px"),A}var N="left";p!==void 0&&(h.style.width=O(p)),v!==void 0&&(h.style.height=O(v)),arguments.length>3&&(x!==void 0&&(this.config.rtl&&(N="right"),h.style[N]=x+"px"),S!==void 0&&(h.style.top=S+"px"))},s.get_elements=function(){const h=this._obj.getElementsByTagName("DIV");for(let p=0;p<h.length;p++){let v=s._getClassName(h[p]);const x=h[p].getAttribute("data-tab")||h[p].getAttribute("name")||"";v&&(v=v.split(" ")[0]),this._els[v]||(this._els[v]=[]),this._els[v].push(h[p]);let S=s.locale.labels[x+"_tab"]||s.locale.labels[x||v];typeof S!="string"&&x&&!h[p].innerHTML&&(S=x.split("_")[0]),S&&(this._waiAria.labelAttr(h[p],S),h[p].innerHTML=S)}};const y=s._createDomEventScope();function g(h,p){const v=new Date(h),x=(new Date(p).getTime()-v.getTime())/864e5;return Math.abs(x)}s.unset_actions=function(){y.detachAll()},s.set_actions=function(){for(const h in this._els)if(this._click[h])for(let p=0;p<this._els[h].length;p++){const v=this._els[h][p],x=this._click[h].bind(v);y.attach(v,"click",x)}y.attach(this._obj,"selectstart",function(h){return h.preventDefault(),!1}),y.attach(this._obj,"mousemove",function(h){s._temp_touch_block||s._on_mouse_move(h)}),y.attach(this._obj,"mousedown",function(h){s._ignore_next_click||s._on_mouse_down(h)}),y.attach(this._obj,"mouseup",function(h){s._ignore_next_click||s._on_mouse_up(h)}),y.attach(this._obj,"dblclick",function(h){s._on_dbl_click(h)}),y.attach(this._obj,"contextmenu",function(h){return s.checkEvent("onContextMenu")&&h.preventDefault(),s.callEvent("onContextMenu",[s._locate_event(h.target),h])})},s.select=function(h){this._select_id!=h&&(s._close_not_saved(),this.editStop(!1),this._select_id&&this.unselect(),this._select_id=h,this.updateEvent(h),this.callEvent("onEventSelected",[h]))},s.unselect=function(h){if(h&&h!=this._select_id)return;const p=this._select_id;this._select_id=null,p&&this.getEvent(p)&&this.updateEvent(p),this.callEvent("onEventUnselected",[p])},s.$stateProvider.registerProvider("global",(function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}}).bind(s)),s._click={dhx_cal_data:function(h){if(s._ignore_next_click)return h.preventDefault&&h.preventDefault(),h.cancelBubble=!0,s._ignore_next_click=!1,!1;const p=s._locate_event(h.target);if(p){if(!s.callEvent("onClick",[p,h])||s.config.readonly)return}else s.callEvent("onEmptyClick",[s.getActionData(h).date,h]);if(p&&s.config.select){s.select(p);const v=h.target.closest(".dhx_menu_icon"),x=s._getClassName(v);x.indexOf("_icon")!=-1&&s._click.buttons[x.split(" ")[1].replace("icon_","")](p)}else s._close_not_saved(),s.getState().select_id&&new Date().valueOf()-(s._new_event||0)>500&&s.unselect()},dhx_cal_prev_button:function(){s._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(h,p){let v=1;s.config.rtl&&(p=-p,v=-v),s.setCurrentView(s.date.add(s.date[s._mode+"_start"](new Date(s._date)),p||v,s._mode))},dhx_cal_today_button:function(){s.callEvent("onBeforeTodayDisplayed",[])&&s.setCurrentView(s._currentDate())},dhx_cal_tab:function(){const h=this.getAttribute("data-tab"),p=this.getAttribute("name"),v=h||p.substring(0,p.search("_tab"));s.setCurrentView(s._date,v)},buttons:{delete:function(h){const p=s.locale.labels.confirm_deleting;s._dhtmlx_confirm({message:p,title:s.locale.labels.title_confirm_deleting,callback:function(){s.deleteEvent(h)},config:{ok:s.locale.labels.icon_delete}})},edit:function(h){s.edit(h)},save:function(h){s.editStop(!0)},details:function(h){s.showLightbox(h)},form:function(h){s.showLightbox(h)},cancel:function(h){s.editStop(!1)}}},s._dhtmlx_confirm=function({message:h,title:p,callback:v,config:x}){if(!h)return v();x=x||{};const S={...x,text:h};p&&(S.title=p),v&&(S.callback=function(O){O&&v()}),s.confirm(S)},s.addEventNow=function(h,p,v){let x={};s._isObject(h)&&!s._isDate(h)&&(x=h,h=null);const S=6e4*(this.config.event_duration||this.config.time_step);h||(h=x.start_date||Math.round(s._currentDate().valueOf()/S)*S);let O=new Date(h);if(!p){let A=this.config.first_hour;A>O.getHours()&&(O.setHours(A),h=O.valueOf()),p=h.valueOf()+S}let N=new Date(p);O.valueOf()==N.valueOf()&&N.setTime(N.valueOf()+S),x.start_date=x.start_date||O,x.end_date=x.end_date||N,x.text=x.text||this.locale.labels.new_event,x.id=this._drag_id=x.id||this.uid(),this._drag_mode="new-size",this._loading=!0;const I=this.addEvent(x);return this.callEvent("onEventCreated",[this._drag_id,v]),this._loading=!1,this._drag_event={},this._on_mouse_up(v),I},s._on_dbl_click=function(h,p){if(p=p||h.target,this.config.readonly)return;const v=s._getClassName(p).split(" ")[0];switch(v){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!s.config.dblclick_create)break;this.addEventNow(this.getActionData(h).date,null,h);break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_cal_agenda_event_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":{const x=this._locate_event(p);if(!this.callEvent("onDblClick",[x,h]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(x)._timed||!this.config.select?this.showLightbox(x):this.edit(x);break}case"dhx_time_block":case"dhx_cal_container":return;default:{const x=this["dblclick_"+v];if(x)x.call(this,h);else if(p.parentNode&&p!=this)return s._on_dbl_click(h,p.parentNode);break}}},s._get_column_index=function(h){let p=0;if(this._cols){let v=0,x=0;for(;v+this._cols[x]<h&&x<this._cols.length;)v+=this._cols[x],x++;if(p=x+(this._cols[x]?(h-v)/this._cols[x]:0),this._ignores&&p>=this._cols.length)for(;p>=1&&this._ignores[Math.floor(p)];)p--}return p},s._week_indexes_from_pos=function(h){if(this._cols){const p=this._get_column_index(h.x);return h.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(p)-1)),h.y=Math.max(0,Math.ceil(60*h.y/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),h}return h},s._mouse_coords=function(h){let p;const v=document.body,x=document.documentElement;p=this.$env.isIE||!h.pageX&&!h.pageY?{x:h.clientX+(v.scrollLeft||x.scrollLeft||0)-v.clientLeft,y:h.clientY+(v.scrollTop||x.scrollTop||0)-v.clientTop}:{x:h.pageX,y:h.pageY},this.config.rtl&&this._colsS?(p.x=this.$container.querySelector(".dhx_cal_data").offsetWidth-p.x,p.x+=this.$domHelpers.getAbsoluteLeft(this._obj),this._mode!=="month"&&(p.x-=this.xy.scale_width)):p.x-=this.$domHelpers.getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width);const S=this.$container.querySelector(".dhx_cal_data");p.y-=this.$domHelpers.getAbsoluteTop(S)-this._els.dhx_cal_data[0].scrollTop,p.ev=h;const O=this["mouse_"+this._mode];if(O)p=O.call(this,p);else if(this._table_view){const N=this._get_column_index(p.x);if(!this._cols||!this._colsS)return p;let I=0;for(I=1;I<this._colsS.heights.length&&!(this._colsS.heights[I]>p.y);I++);p.y=Math.ceil(24*(Math.max(0,N)+7*Math.max(0,I-1))*60/this.config.time_step),(s._drag_mode||this._mode=="month")&&(p.y=24*(Math.max(0,Math.ceil(N)-1)+7*Math.max(0,I-1))*60/this.config.time_step),this._drag_mode=="move"&&s._ignores_detected&&s.config.preserve_length&&(p._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{x_step:1,x_unit:"day"}))),p.x=0}else p=this._week_indexes_from_pos(p);return p.timestamp=+new Date,p},s._close_not_saved=function(){if(new Date().valueOf()-(s._new_event||0)>500&&s._edit_id){const h=s.locale.labels.confirm_closing;s._dhtmlx_confirm({message:h,title:s.locale.labels.title_confirm_closing,callback:function(){s.editStop(s.config.positive_closing)}}),h&&(this._drag_id=this._drag_pos=this._drag_mode=null)}},s._correct_shift=function(h,p){return h-6e4*(new Date(s._min_date).getTimezoneOffset()-new Date(h).getTimezoneOffset())*(p?-1:1)},s._is_pos_changed=function(h,p){function v(x,S,O){return Math.abs(x-S)>O}return!h||!this._drag_pos||!!(this._drag_pos.has_moved||!this._drag_pos.timestamp||p.timestamp-this._drag_pos.timestamp>100||v(h.ev.clientX,p.ev.clientX,5)||v(h.ev.clientY,p.ev.clientY,5))},s._correct_drag_start_date=function(h){let p;s.matrix&&(p=s.matrix[s._mode]),p=p||{x_step:1,x_unit:"day"},h=new Date(h);let v=1;return(p._start_correction||p._end_correction)&&(v=60*(p.last_hour||0)-(60*h.getHours()+h.getMinutes())||1),1*h+(s._get_fictional_event_length(h,v,p)-v)},s._correct_drag_end_date=function(h,p){let v;s.matrix&&(v=s.matrix[s._mode]),v=v||{x_step:1,x_unit:"day"};const x=1*h+s._get_fictional_event_length(h,p,v);return new Date(1*x-(s._get_fictional_event_length(x,-1,v,-1)+1))},s._on_mouse_move=function(h){if(this._drag_mode){var p=this._mouse_coords(h);if(this._is_pos_changed(this._drag_pos,p)){var v,x;if(this._edit_id!=this._drag_id&&this._close_not_saved(),!this._drag_mode)return;var S=null;if(this._drag_pos&&!this._drag_pos.has_moved&&((S=this._drag_pos).has_moved=!0),this._drag_pos=p,this._drag_pos.has_moved=!0,this._drag_mode=="create"){if(S&&(p=S),this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,v=this._get_date_from_pos(p).valueOf(),!this._drag_start)return this.callEvent("onBeforeEventCreated",[h,this._drag_id])?(this._loading=!1,void(this._drag_start=v)):void(this._loading=!1);x=v,this._drag_start;var O=new Date(this._drag_start),N=new Date(x);this._mode!="day"&&this._mode!="week"||O.getHours()!=N.getHours()||O.getMinutes()!=N.getMinutes()||(N=new Date(this._drag_start+1e3)),this._drag_id=this.uid(),this.addEvent(O,N,this.locale.labels.new_event,this._drag_id,p.fields),this.callEvent("onEventCreated",[this._drag_id,h]),this._loading=!1,this._drag_mode="new-size"}var I,A=this.config.time_step,m=this.getEvent(this._drag_id);if(s.matrix&&(I=s.matrix[s._mode]),I=I||{x_step:1,x_unit:"day"},this._drag_mode=="move")v=this._min_date.valueOf()+6e4*(p.y*this.config.time_step+24*p.x*60),!p.custom&&this._table_view&&(v+=1e3*this.date.time_part(m.start_date)),!this._table_view&&this._dragEventBody&&this._drag_event._move_event_shift===void 0&&(this._drag_event._move_event_shift=v-m.start_date),this._drag_event._move_event_shift&&(v-=this._drag_event._move_event_shift),v=this._correct_shift(v),p._ignores&&this.config.preserve_length&&this._table_view&&I?(v=s._correct_drag_start_date(v),x=s._correct_drag_end_date(v,this._drag_event._event_length)):x=m.end_date.valueOf()-(m.start_date.valueOf()-v);else{if(v=m.start_date.valueOf(),x=m.end_date.valueOf(),this._table_view){var b=this._min_date.valueOf()+p.y*this.config.time_step*6e4+(p.custom?0:864e5);if(this._mode=="month")if(b=this._correct_shift(b,!1),this._drag_from_start){var k=864e5;b<=s.date.date_part(new Date(x+k-1)).valueOf()&&(v=b-k)}else x=b;else if(this.config.preserve_length){if(p.resize_from_start)v=s._correct_drag_start_date(b),I.round_position&&I.first_hour&&I.last_hour&&I.x_unit=="day"&&(v=new Date(1*v+I._start_correction));else if(x=s._correct_drag_end_date(b,0),I.round_position&&I.first_hour&&I.last_hour&&I.x_unit=="day"&&(x=s.date.date_part(new Date(x)),x=new Date(1*x-I._end_correction)),I.round_position&&s["ignore_"+s._mode]&&I.x_unit=="day"){const fe=this["ignore_"+this._mode];let Ve=s.date.add(new Date(x),-I.x_step,I.x_unit);fe(Ve)&&(x=Ve)}}else p.resize_from_start?v=b:x=b}else{var E=this.date.date_part(new Date(m.end_date.valueOf()-1)).valueOf(),D=new Date(E),C=this.config.first_hour,R=60/A*(this.config.last_hour-C);this.config.time_step=1;var P=this._mouse_coords(h);this.config.time_step=A;var F=p.y*A*6e4,q=Math.min(p.y+1,R)*A*6e4,$=6e4*P.y;x=Math.abs(F-$)>Math.abs(q-$)?E+q:E+F,x+=6e4*(new Date(x).getTimezoneOffset()-D.getTimezoneOffset()),this._els.dhx_cal_data[0].style.cursor="s-resize",this._mode!="week"&&this._mode!="day"||(x=this._correct_shift(x))}if(this._drag_mode=="new-size")if(x<=this._drag_start){var X=p.shift||(this._table_view&&!p.custom?864e5:0);v=x-(p.shift?0:X),x=this._drag_start+(X||6e4*A)}else v=this._drag_start;else x<=v&&(x=I&&I.round_position?I.x_unit=="hour"||I.x_unit=="minute"?s.date.add(v,I.x_step,I.x_unit):s.date.add(s.date.date_part(new Date(v)),1,I.x_unit):v+6e4*A)}var te=new Date(x-1),Q=new Date(v);if(this._drag_mode=="move"&&s.config.limit_drag_out&&(+Q<+s._min_date||+x>+s._max_date)){if(+m.start_date<+s._min_date||+m.end_date>+s._max_date)Q=new Date(m.start_date),x=new Date(m.end_date);else{var W=x-Q;+Q<+s._min_date?(Q=new Date(s._min_date),p._ignores&&this.config.preserve_length&&this._table_view?(Q=new Date(s._correct_drag_start_date(Q)),I._start_correction&&(Q=new Date(Q.valueOf()+I._start_correction)),x=new Date(1*Q+this._get_fictional_event_length(Q,this._drag_event._event_length,I))):x=new Date(+Q+W)):(x=new Date(s._max_date),p._ignores&&this.config.preserve_length&&this._table_view?(I._end_correction&&(x=new Date(x.valueOf()-I._end_correction)),x=new Date(1*x-this._get_fictional_event_length(x,0,I,!0)),Q=new Date(1*x-this._get_fictional_event_length(x,this._drag_event._event_length,I,!0)),this._ignores_detected&&(Q=s.date.add(Q,I.x_step,I.x_unit),x=new Date(1*x-this._get_fictional_event_length(x,0,I,!0)),x=s.date.add(x,I.x_step,I.x_unit))):Q=new Date(+x-W))}te=new Date(x-1)}if(!this._table_view&&this._dragEventBody&&!s.config.all_timed&&(!s._get_section_view()&&p.x!=this._get_event_sday({start_date:new Date(v),end_date:new Date(v)})||new Date(v).getHours()<this.config.first_hour)&&(W=x-Q,this._drag_mode=="move"&&(k=this._min_date.valueOf()+24*p.x*60*6e4,(Q=new Date(k)).setHours(this.config.first_hour),+Q<=+m.start_date?x=new Date(+Q+W):Q=new Date(+x-W))),this._table_view||s.config.all_timed||!(!s.getView()&&p.x!=this._get_event_sday({start_date:new Date(x),end_date:new Date(x)})||new Date(x).getHours()>=this.config.last_hour)||(W=x-Q,k=this._min_date.valueOf()+24*p.x*60*6e4,(x=s.date.date_part(new Date(k))).setHours(this.config.last_hour),te=new Date(x-1),this._drag_mode=="move"&&(+Q<=+m.start_date?x=new Date(+Q+W):Q=new Date(+x-W))),!this._table_view&&s.config.all_timed){let fe=this._min_date.valueOf()+24*p.x*60*6e4;new Date(s._drag_start).getDay()!=new Date(fe)&&(fe=new Date(s._drag_start));let Ve=new Date(fe).setHours(this.config.last_hour);s._drag_start&&this._drag_mode=="new-size"&&Ve<new Date(x)&&((x=s.date.date_part(new Date(fe))).setHours(this.config.last_hour),te=new Date(x-1))}if(this._table_view&&s["ignore_"+this._mode]&&(this._drag_mode=="resize"||this._drag_mode=="new-size")&&+x>+s._max_date){x=new Date(s._max_date);const fe=this["ignore_"+this._mode];for(;fe(x);)x=s.date.add(x,-I.x_step,I.x_unit);x=s.date.add(x,I.x_step,I.x_unit)}if(this._table_view||te.getDate()==Q.getDate()&&te.getHours()<this.config.last_hour||s._allow_dnd)if(m.start_date=Q,m.end_date=new Date(x),this.config.update_render){var J=s._els.dhx_cal_data[0].scrollTop;this.update_view(),s._els.dhx_cal_data[0].scrollTop=J}else this.updateEvent(this._drag_id);this._table_view&&this.for_rendered(this._drag_id,function(fe){fe.className+=" dhx_in_move dhx_cal_event_drag"}),this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,h])}}else if(s.checkEvent("onMouseMove")){var ee=this._locate_event(h.target||h.srcElement);this.callEvent("onMouseMove",[ee,h])}},s._on_mouse_down=function(h,p){if(h.button!=2&&!this.config.readonly&&!this._drag_mode){p=p||h.target||h.srcElement;var v=s._getClassName(p).split(" ")[0];switch(this.config.drag_event_body&&v=="dhx_body"&&p.parentNode&&p.parentNode.className.indexOf("dhx_cal_select_menu")===-1&&(v="dhx_event_move",this._dragEventBody=!0),v){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize",s._getClassName(p).indexOf("dhx_event_resize_end")<0?s._drag_from_start=!0:s._drag_from_start=!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(p.parentNode)return s._on_mouse_down(h,p.parentNode);break;default:if((!s.checkEvent("onMouseDown")||s.callEvent("onMouseDown",[v,h]))&&p.parentNode&&p!=this&&v!="dhx_body")return s._on_mouse_down(h,p.parentNode);this._drag_mode=null,this._drag_id=null}if(this._drag_mode){var x=this._locate_event(p);if(this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[x,this._drag_mode,h])){if(this._drag_id=x,(this._edit_id!=this._drag_id||this._edit_id&&this._drag_mode=="create")&&this._close_not_saved(),!this._drag_mode)return;this._drag_event=s._lame_clone(this.getEvent(this._drag_id)||{}),this._drag_pos=this._mouse_coords(h)}else this._drag_mode=this._drag_id=0}this._drag_start=null}},s._get_private_properties=function(h){var p={};for(var v in h)v.indexOf("_")===0&&(p[v]=!0);return p},s._clear_temporary_properties=function(h,p){var v=this._get_private_properties(h),x=this._get_private_properties(p);for(var S in x)v[S]||delete p[S]},s._on_mouse_up=function(h){if(!h||h.button!=2||!this._mobile){if(this._drag_mode&&this._drag_id){this._els.dhx_cal_data[0].style.cursor="default";var p=this._drag_id,v=this._drag_mode,x=!this._drag_pos||this._drag_pos.has_moved;delete this._drag_event._move_event_shift;var S=this.getEvent(this._drag_id);if(x&&(this._drag_event._dhx_changed||!this._drag_event.start_date||S.start_date.valueOf()!=this._drag_event.start_date.valueOf()||S.end_date.valueOf()!=this._drag_event.end_date.valueOf())){var O=this._drag_mode=="new-size";if(this.callEvent("onBeforeEventChanged",[S,h,O,this._drag_event]))if(this._drag_id=this._drag_mode=null,O&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select||!this.isOneDayEvent(this.getEvent(p)))return s.callEvent("onDragEnd",[p,v,h]),this.showLightbox(p);this._drag_pos=!0,this._select_id=this._edit_id=p}else this._new_event||this.callEvent(O?"onEventAdded":"onEventChanged",[p,this.getEvent(p)]);else O?this.deleteEvent(S.id,!0):(this._drag_event._dhx_changed=!1,this._clear_temporary_properties(S,this._drag_event),s._lame_copy(S,this._drag_event),this.updateEvent(S.id))}this._drag_pos&&(this._drag_pos.has_moved||this._drag_pos===!0)&&(this._drag_id=this._drag_mode=null,this.render_view_data()),s.callEvent("onDragEnd",[p,v,h])}this._drag_id=null,this._drag_mode=null,this._drag_pos=null,this._drag_event=null,this._drag_from_start=null}},s._trigger_dyn_loading=function(){return!(!this._load_mode||!this._load()||(this._render_wait=!0,0))},s.update_view=function(){this._reset_ignores(),this._update_nav_bar(this.config.header,this.$container.querySelector(".dhx_cal_navline"));var h=this[this._mode+"_view"];if(h?h.call(this,!0):this._reset_scale(),this._trigger_dyn_loading())return!0;this.render_view_data()},s.isViewExists=function(h){return!!(s[h+"_view"]||s.date[h+"_start"]&&s.templates[h+"_date"]&&s.templates[h+"_scale_date"])},s._set_aria_buttons_attrs=function(){for(var h=["dhx_cal_next_button","dhx_cal_prev_button","dhx_cal_tab","dhx_cal_today_button"],p=0;p<h.length;p++)for(var v=this._els[h[p]],x=0;v&&x<v.length;x++){var S=v[x].getAttribute("data-tab")||v[x].getAttribute("name"),O=this.locale.labels[h[p]];S&&(O=this.locale.labels[S+"_tab"]||this.locale.labels[S]||O),h[p]=="dhx_cal_next_button"?O=this.locale.labels.next:h[p]=="dhx_cal_prev_button"&&(O=this.locale.labels.prev),this._waiAria.headerButtonsAttributes(v[x],O||"")}},s.updateView=function(h,p){if(!this.$container)throw new Error(`The scheduler is not initialized. 
 **scheduler.updateView** or **scheduler.setCurrentView** can be called only after **scheduler.init**`);h=h||this._date,p=p||this._mode;var v="dhx_cal_data";this.locale.labels.icon_form||(this.locale.labels.icon_form=this.locale.labels.icon_edit);var x=this._obj,S="dhx_scheduler_"+this._mode,O="dhx_scheduler_"+p;this._mode&&x.className.indexOf(S)!=-1?x.className=x.className.replace(S,O):x.className+=" "+O;var N,I="dhx_multi_day",A=!(this._mode!=p||!this.config.preserve_scroll)&&this._els[v][0].scrollTop;this._els[I]&&this._els[I][0]&&(N=this._els[I][0].scrollTop),this[this._mode+"_view"]&&p&&this._mode!=p&&this[this._mode+"_view"](!1),this._close_not_saved(),this._els[I]&&(this._els[I][0].parentNode.removeChild(this._els[I][0]),this._els[I]=null),this._mode=p,this._date=h,this._table_view=this._mode=="month",this._dy_shift=0,this.update_view(),this._set_aria_buttons_attrs();var m=this._els.dhx_cal_tab;if(m)for(var b=0;b<m.length;b++){var k=m[b];k.getAttribute("data-tab")==this._mode||k.getAttribute("name")==this._mode+"_tab"?(k.classList.add("active"),this._waiAria.headerToggleState(k,!0)):(k.classList.remove("active"),this._waiAria.headerToggleState(k,!1))}typeof A=="number"&&(this._els[v][0].scrollTop=A),typeof N=="number"&&this._els[I]&&this._els[I][0]&&(this._els[I][0].scrollTop=N)},s.setCurrentView=function(h,p){this.callEvent("onBeforeViewChange",[this._mode,this._date,p||this._mode,h||this._date])&&(this.updateView(h,p),this.callEvent("onViewChange",[this._mode,this._date]))},s.render=function(h,p){s.setCurrentView(h,p)},s._render_x_header=function(h,p,v,x,S){S=S||0;var O=document.createElement("div");O.className="dhx_scale_bar",this.templates[this._mode+"_scalex_class"]&&(O.className+=" "+this.templates[this._mode+"_scalex_class"](v));var N=this._cols[h];this._mode=="month"&&h===0&&this.config.left_border&&(O.className+=" dhx_scale_bar_border",p+=1),this.set_xy(O,N,this.xy.scale_height-1,p,S);var I=this.templates[this._mode+"_scale_date"](v,this._mode);O.innerHTML=I,this._waiAria.dayHeaderAttr(O,I),x.appendChild(O)},s._get_columns_num=function(h,p){var v=7;if(!s._table_view){var x=s.date["get_"+s._mode+"_end"];x&&(p=x(h)),v=Math.round((p.valueOf()-h.valueOf())/864e5)}return v},s._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))},s._get_view_end=function(){var h=this._get_timeunit_start(),p=s.date.add(h,1,this._mode);if(!s._table_view){var v=s.date["get_"+s._mode+"_end"];v&&(p=v(h))}return p},s._calc_scale_sizes=function(h,p,v){var x=this.config.rtl,S=h,O=this._get_columns_num(p,v);this._process_ignores(p,O,"day",1);for(var N=O-this._ignores_detected,I=0;I<O;I++)this._ignores[I]?(this._cols[I]=0,N++):this._cols[I]=Math.floor(S/(N-I)),S-=this._cols[I],this._colsS[I]=(this._cols[I-1]||0)+(this._colsS[I-1]||(this._table_view?0:x?this.xy.scroll_width:this.xy.scale_width));this._colsS.col_length=O,this._colsS[O]=this._cols[O-1]+this._colsS[O-1]||0},s._set_scale_col_size=function(h,p,v){var x=this.config;this.set_xy(h,p,x.hour_size_px*(x.last_hour-x.first_hour),v+this.xy.scale_width+1,0)},s._render_scales=function(h,p){var v=new Date(s._min_date),x=new Date(s._max_date),S=this.date.date_part(s._currentDate()),O=parseInt(h.style.width,10)-1,N=new Date(this._min_date),I=this._get_columns_num(v,x);this._calc_scale_sizes(O,v,x);var A=0;h.innerHTML="";for(var m=0;m<I;m++){if(this._ignores[m]||this._render_x_header(m,A,N,h),!this._table_view){var b=document.createElement("div"),k="dhx_scale_holder";N.valueOf()==S.valueOf()&&(k+=" dhx_scale_holder_now"),b.setAttribute("data-column-index",m),this._ignores_detected&&this._ignores[m]&&(k+=" dhx_scale_ignore");for(let E=1*this.config.first_hour;E<this.config.last_hour;E++){const D=document.createElement("div");D.className="dhx_scale_time_slot dhx_scale_time_slot_hour_start",D.style.height=this.config.hour_size_px/2+"px";let C=new Date(N.getFullYear(),N.getMonth(),N.getDate(),E,0);D.setAttribute("data-slot-date",this.templates.format_date(C));let R=this.templates.time_slot_text(C);R&&(D.innerHTML=R);let P=this.templates.time_slot_class(C);P&&D.classList.add(P),b.appendChild(D);const F=document.createElement("div");F.className="dhx_scale_time_slot",C=new Date(N.getFullYear(),N.getMonth(),N.getDate(),E,30),F.setAttribute("data-slot-date",this.templates.format_date(C)),F.style.height=this.config.hour_size_px/2+"px",R=this.templates.time_slot_text(C),R&&(F.innerHTML=R),P=this.templates.time_slot_class(C),P&&F.classList.add(P),b.appendChild(F)}b.className=k+" "+this.templates.week_date_class(N,S),this._waiAria.dayColumnAttr(b,N),this._set_scale_col_size(b,this._cols[m],A),p.appendChild(b),this.callEvent("onScaleAdd",[b,N])}A+=this._cols[m],N=this.date.add(N,1,"day"),N=this.date.day_start(N)}},s._getNavDateElement=function(){return this.$container.querySelector(".dhx_cal_date")},s._reset_scale=function(){if(this.templates[this._mode+"_date"]){var h=this._els.dhx_cal_header[0],p=this._els.dhx_cal_data[0],v=this.config;h.innerHTML="",p.innerHTML="";var x,S,O=(v.readonly||!v.drag_resize?" dhx_resize_denied":"")+(v.readonly||!v.drag_move?" dhx_move_denied":"");p.className="dhx_cal_data"+O,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes();var N=this._get_timeunit_start(),I=s._get_view_end();x=S=this._table_view?s.date.week_start(N):N,this._min_date=x;var A=this.templates[this._mode+"_date"](N,I,this._mode),m=this._getNavDateElement();if(m&&(m.innerHTML=A,this._waiAria.navBarDateAttr(m,A)),this._max_date=I,s._render_scales(h,p),this._table_view)this._reset_month_scale(p,N,S);else if(this._reset_hours_scale(p,N,S),v.multi_day){var b="dhx_multi_day";this._els[b]&&(this._els[b][0].parentNode.removeChild(this._els[b][0]),this._els[b]=null);var k=document.createElement("div");k.className=b,k.style.visibility="hidden",k.style.display="none";var E=this._colsS[this._colsS.col_length],D=v.rtl?this.xy.scale_width:this.xy.scroll_width,C=Math.max(E+D,0);this.set_xy(k,C,0,0),p.parentNode.insertBefore(k,p);var R=k.cloneNode(!0);R.className=b+"_icon",R.style.visibility="hidden",R.style.display="none",this.set_xy(R,this.xy.scale_width+1,0,0),k.appendChild(R),this._els[b]=[k,R],s.event(this._els[b][0],"click",this._click.dhx_cal_data)}}},s._reset_hours_scale=function(h,p,v){var x=document.createElement("div");x.className="dhx_scale_holder";for(var S=new Date(1980,1,1,this.config.first_hour,0,0),O=1*this.config.first_hour;O<this.config.last_hour;O++){var N=document.createElement("div");N.className="dhx_scale_hour",N.style.height=this.config.hour_size_px+"px";var I=this.xy.scale_width;this.config.left_border&&(N.className+=" dhx_scale_hour_border"),N.style.width=I+"px";var A=s.templates.hour_scale(S);N.innerHTML=A,this._waiAria.hourScaleAttr(N,A),x.appendChild(N),S=this.date.add(S,1,"hour")}h.appendChild(x),this.config.scroll_hour&&(h.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))},s._currentDate=function(){return s.config.now_date?new Date(s.config.now_date):new Date},s._reset_ignores=function(){this._ignores={},this._ignores_detected=0},s._process_ignores=function(h,p,v,x,S){this._reset_ignores();var O=s["ignore_"+this._mode];if(O)for(var N=new Date(h),I=0;I<p;I++)O(N)&&(this._ignores_detected+=1,this._ignores[I]=!0,S&&p++),N=s.date.add(N,x,v),s.date[v+"_start"]&&(N=s.date[v+"_start"](N))},s._render_month_scale=function(h,p,v,x){var S=s.date.add(p,1,"month"),O=new Date(v),N=s._currentDate();N=this.date.date_part(N),v=this.date.date_part(v),x=x||Math.ceil(Math.round((S.valueOf()-v.valueOf())/864e5)/7);for(var I=[],A=0;A<=7;A++){var m=this._cols[A]||0;isNaN(Number(m))||(m+="px"),I[A]=m}function b(Q){var W=s._colsS.height;return s._colsS.heights[Q+1]!==void 0&&(W=s._colsS.heights[Q+1]-(s._colsS.heights[Q]||0)),W}var k=0;const E=document.createElement("div");for(E.classList.add("dhx_cal_month_table"),A=0;A<x;A++){var D=document.createElement("div");D.classList.add("dhx_cal_month_row"),D.style.height=b(A)+"px",E.appendChild(D);for(var C=0;C<7;C++){var R=document.createElement("div");D.appendChild(R);var P="dhx_cal_month_cell";v<p?P+=" dhx_before":v>=S?P+=" dhx_after":v.valueOf()==N.valueOf()&&(P+=" dhx_now"),this._ignores_detected&&this._ignores[C]&&(P+=" dhx_scale_ignore"),R.className=P+" "+this.templates.month_date_class(v,N),R.setAttribute("data-cell-date",s.templates.format_date(v));var F="dhx_month_body",q="dhx_month_head";if(C===0&&this.config.left_border&&(F+=" dhx_month_body_border",q+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[C])R.appendChild(document.createElement("div")),R.appendChild(document.createElement("div"));else{R.style.width=I[C],this._waiAria.monthCellAttr(R,v);var $=document.createElement("div");$.style.height=s.xy.month_head_height+"px",$.className=q,$.innerHTML=this.templates.month_day(v),R.appendChild($);var X=document.createElement("div");X.className=F,R.appendChild(X)}var te=v.getDate();(v=this.date.add(v,1,"day")).getDate()-te>1&&(v=new Date(v.getFullYear(),v.getMonth(),te+1,12,0))}s._colsS.heights[A]=k,k+=b(A)}return this._min_date=O,this._max_date=v,h.innerHTML="",h.appendChild(E),this._scales={},h.querySelectorAll("[data-cell-date]").forEach(Q=>{const W=s.templates.parse_date(Q.getAttribute("data-cell-date")),J=Q.querySelector(".dhx_month_body");this._scales[+W]=J,this.callEvent("onScaleAdd",[this._scales[+W],W])}),this._max_date},s._reset_month_scale=function(h,p,v,x){var S=s.date.add(p,1,"month");v=this.date.date_part(v),x=x||Math.ceil(Math.round((S.valueOf()-v.valueOf())/864e5)/7);var O=Math.floor(h.clientHeight/x)-this.xy.month_head_height;return this._colsS.height=O+this.xy.month_head_height,this._colsS.heights=[],s._render_month_scale(h,p,v,x)},s.getView=function(h){return h||(h=s.getState().mode),s.matrix&&s.matrix[h]?s.matrix[h]:s._props&&s._props[h]?s._props[h]:null},s.getLabel=function(h,p){for(var v=this.config.lightbox.sections,x=0;x<v.length;x++)if(v[x].map_to==h){for(var S=v[x].options,O=0;O<S.length;O++)if(S[O].key==p)return S[O].label}return""},s.updateCollection=function(h,p){var v=s.serverList(h);return!!v&&(v.splice(0,v.length),v.push.apply(v,p||[]),s.callEvent("onOptionsLoad",[]),s.resetLightbox(),s.hideCover(),!0)},s._lame_clone=function(h,p){var v,x,S;for(p=p||[],v=0;v<p.length;v+=2)if(h===p[v])return p[v+1];if(h&&typeof h=="object"){for(S=Object.create(h),x=[Array,Date,Number,String,Boolean],v=0;v<x.length;v++)h instanceof x[v]&&(S=v?new x[v](h):new x[v]);for(v in p.push(h,S),h)Object.prototype.hasOwnProperty.apply(h,[v])&&(S[v]=s._lame_clone(h[v],p))}return S||h},s._lame_copy=function(h,p){for(var v in p)p.hasOwnProperty(v)&&(h[v]=p[v]);return h},s._get_date_from_pos=function(h){var p=this._min_date.valueOf()+6e4*(h.y*this.config.time_step+24*(this._table_view?0:h.x)*60);return new Date(this._correct_shift(p))},s.getActionData=function(h){var p=this._mouse_coords(h);return{date:this._get_date_from_pos(p),section:p.section}},s._focus=function(h,p){if(h&&h.focus)if(this._mobile)window.setTimeout(function(){h.focus()},10);else try{p&&h.select&&h.offsetWidth&&h.select(),h.focus()}catch{}},s._get_real_event_length=function(h,p,v){var x,S=p-h,O=this["ignore_"+this._mode],N=0;v.render?(N=this._get_date_index(v,h),x=this._get_date_index(v,p),h.valueOf()<s.getState().min_date.valueOf()&&(N=-g(h,s.getState().min_date)),p.valueOf()>s.getState().max_date.valueOf()&&(x+=g(p,s.getState().max_date))):x=Math.round(S/60/60/1e3/24);for(var I=!0;N<x;){var A=s.date.add(p,-v.x_step,v.x_unit);if(O&&O(p)&&(!I||I&&O(A)))S-=p-A;else{let m=0;const b=new Date(Math.max(A.valueOf(),h.valueOf())),k=p,E=new Date(b.getFullYear(),b.getMonth(),b.getDate(),v.first_hour||0),D=new Date(b.getFullYear(),b.getMonth(),b.getDate(),v.last_hour||24),C=new Date(p.getFullYear(),p.getMonth(),p.getDate(),v.first_hour||0),R=new Date(p.getFullYear(),p.getMonth(),p.getDate(),v.last_hour||24);k.valueOf()>R.valueOf()&&(m+=k-R),k.valueOf()>C.valueOf()?m+=v._start_correction:m+=60*k.getHours()*60*1e3+60*k.getMinutes()*1e3,b.valueOf()<=D.valueOf()&&(m+=v._end_correction),b.valueOf()<E.valueOf()&&(m+=E.valueOf()-b.valueOf()),S-=m,I=!1}p=A,x--}return S},s._get_fictional_event_length=function(h,p,v,x){var S=new Date(h),O=x?-1:1;if(v._start_correction||v._end_correction){var N;N=x?60*S.getHours()+S.getMinutes()-60*(v.first_hour||0):60*(v.last_hour||0)-(60*S.getHours()+S.getMinutes());var I=60*(v.last_hour-v.first_hour),A=Math.ceil((p/6e4-N)/I);A<0&&(A=0),p+=A*(1440-I)*60*1e3}var m,b=new Date(1*h+p*O),k=this["ignore_"+this._mode],E=0;for(v.render?(E=this._get_date_index(v,S),m=this._get_date_index(v,b)):m=Math.round(p/60/60/1e3/24);v.x_unit==="day"?E*O<m*O:E*O<=m*O;){var D=s.date.add(S,v.x_step*O,v.x_unit);k&&k(S)&&(p+=(D-S)*O,m+=O),S=D,E+=O}return p},s._get_section_view=function(){return this.getView()},s._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null},s._is_initialized=function(){var h=this.getState();return this._obj&&h.date&&h.mode},s._is_lightbox_open=function(){var h=this.getState();return h.lightbox_id!==null&&h.lightbox_id!==void 0}}(t),function(s){(function(){var d=new RegExp(`<(?:.|
)*?>`,"gm"),c=new RegExp(" +","gm");function u(h){return(h+"").replace(d," ").replace(c," ")}var f=new RegExp("'","gm");function y(h){return(h+"").replace(f,"&#39;")}for(var g in s._waiAria={getAttributeString:function(h){var p=[" "];for(var v in h)if(typeof h[v]!="function"&&typeof h[v]!="object"){var x=y(u(h[v]));p.push(v+"='"+x+"'")}return p.push(" "),p.join(" ")},setAttributes:function(h,p){for(var v in p)h.setAttribute(v,u(p[v]));return h},labelAttr:function(h,p){return this.setAttributes(h,{"aria-label":p})},label:function(h){return s._waiAria.getAttributeString({"aria-label":h})},hourScaleAttr:function(h,p){this.labelAttr(h,p)},monthCellAttr:function(h,p){this.labelAttr(h,s.templates.day_date(p))},navBarDateAttr:function(h,p){this.labelAttr(h,p)},dayHeaderAttr:function(h,p){this.labelAttr(h,p)},dayColumnAttr:function(h,p){this.dayHeaderAttr(h,s.templates.day_date(p))},headerButtonsAttributes:function(h,p){return this.setAttributes(h,{role:"button","aria-label":p})},headerToggleState:function(h,p){return this.setAttributes(h,{"aria-pressed":p?"true":"false"})},getHeaderCellAttr:function(h){return s._waiAria.getAttributeString({"aria-label":h})},eventAttr:function(h,p){this._eventCommonAttr(h,p)},_eventCommonAttr:function(h,p){p.setAttribute("aria-label",u(s.templates.event_text(h.start_date,h.end_date,h))),s.config.readonly&&p.setAttribute("aria-readonly",!0),h.$dataprocessor_class&&p.setAttribute("aria-busy",!0),p.setAttribute("aria-selected",s.getState().select_id==h.id?"true":"false")},setEventBarAttr:function(h,p){this._eventCommonAttr(h,p)},_getAttributes:function(h,p){var v={setAttribute:function(x,S){this[x]=S}};return h.apply(this,[p,v]),v},eventBarAttrString:function(h){return this.getAttributeString(this._getAttributes(this.setEventBarAttr,h))},agendaHeadAttrString:function(){return this.getAttributeString({role:"row"})},agendaHeadDateString:function(h){return this.getAttributeString({role:"columnheader","aria-label":h})},agendaHeadDescriptionString:function(h){return this.agendaHeadDateString(h)},agendaDataAttrString:function(){return this.getAttributeString({role:"grid"})},agendaEventAttrString:function(h){var p=this._getAttributes(this._eventCommonAttr,h);return p.role="row",this.getAttributeString(p)},agendaDetailsBtnString:function(){return this.getAttributeString({role:"button","aria-label":s.locale.labels.icon_details})},gridAttrString:function(){return this.getAttributeString({role:"grid"})},gridRowAttrString:function(h){return this.agendaEventAttrString(h)},gridCellAttrString:function(h,p,v){return this.getAttributeString({role:"gridcell","aria-label":[p.label===void 0?p.id:p.label,": ",v]})},mapAttrString:function(){return this.gridAttrString()},mapRowAttrString:function(h){return this.gridRowAttrString(h)},mapDetailsBtnString:function(){return this.agendaDetailsBtnString()},minicalHeader:function(h,p){this.setAttributes(h,{id:p+"","aria-live":"assertice","aria-atomic":"true"})},minicalGrid:function(h,p){this.setAttributes(h,{"aria-labelledby":p+"",role:"grid"})},minicalRow:function(h){this.setAttributes(h,{role:"row"})},minicalDayCell:function(h,p){var v=p.valueOf()<s._max_date.valueOf()&&p.valueOf()>=s._min_date.valueOf();this.setAttributes(h,{role:"gridcell","aria-label":s.templates.day_date(p),"aria-selected":v?"true":"false"})},minicalHeadCell:function(h){this.setAttributes(h,{role:"columnheader"})},weekAgendaDayCell:function(h,p){var v=h.querySelector(".dhx_wa_scale_bar"),x=h.querySelector(".dhx_wa_day_data"),S=s.uid()+"";this.setAttributes(v,{id:S}),this.setAttributes(x,{"aria-labelledby":S})},weekAgendaEvent:function(h,p){this.eventAttr(p,h)},lightboxHiddenAttr:function(h){h.setAttribute("aria-hidden","true")},lightboxVisibleAttr:function(h){h.setAttribute("aria-hidden","false")},lightboxSectionButtonAttrString:function(h){return this.getAttributeString({role:"button","aria-label":h,tabindex:"0"})},yearHeader:function(h,p){this.setAttributes(h,{id:p+""})},yearGrid:function(h,p){this.minicalGrid(h,p)},yearHeadCell:function(h){return this.minicalHeadCell(h)},yearRow:function(h){return this.minicalRow(h)},yearDayCell:function(h){this.setAttributes(h,{role:"gridcell"})},lightboxAttr:function(h){h.setAttribute("role","dialog"),h.setAttribute("aria-hidden","true"),h.firstChild.setAttribute("role","heading")},lightboxButtonAttrString:function(h){return this.getAttributeString({role:"button","aria-label":s.locale.labels[h],tabindex:"0"})},eventMenuAttrString:function(h){return this.getAttributeString({role:"button","aria-label":s.locale.labels[h]})},lightboxHeader:function(h,p){h.setAttribute("aria-label",p)},lightboxSelectAttrString:function(h){var p="";switch(h){case"%Y":p=s.locale.labels.year;break;case"%m":p=s.locale.labels.month;break;case"%d":p=s.locale.labels.day;break;case"%H:%i":p=s.locale.labels.hour+" "+s.locale.labels.minute}return s._waiAria.getAttributeString({"aria-label":p})},messageButtonAttrString:function(h){return"tabindex='0' role='button' aria-label='"+h+"'"},messageInfoAttr:function(h){h.setAttribute("role","alert")},messageModalAttr:function(h,p){h.setAttribute("role","dialog"),p&&h.setAttribute("aria-labelledby",p)},quickInfoAttr:function(h){h.setAttribute("role","dialog")},quickInfoHeaderAttrString:function(){return" role='heading' "},quickInfoHeader:function(h,p){h.setAttribute("aria-label",p)},quickInfoButtonAttrString:function(h){return s._waiAria.getAttributeString({role:"button","aria-label":h,tabindex:"0"})},tooltipAttr:function(h){h.setAttribute("role","tooltip")},tooltipVisibleAttr:function(h){h.setAttribute("aria-hidden","false")},tooltipHiddenAttr:function(h){h.setAttribute("aria-hidden","true")}},s._waiAria)s._waiAria[g]=function(h){return function(){return s.config.wai_aria_attributes?h.apply(this,arguments):" "}}(s._waiAria[g])})()}(t),t.utils=Qe,t.$domHelpers=yt,t.utils.dom=yt,t.uid=Qe.uid,t.mixin=Qe.mixin,t.defined=Qe.defined,t.assert=function(s){return function(d,c){d||s.config.show_errors&&s.callEvent("onError",[c])!==!1&&(s.message?s.message({type:"error",text:c,expire:-1}):console.log(c))}}(t),t.copy=Qe.copy,t._createDatePicker=function(s,d){return new C_(t,s,d)},t._getFocusableNodes=yt.getFocusableNodes,t._getClassName=yt.getClassName,t._locate_css=yt.locateCss;const n=Xc(t);var r,i,a;t.utils.mixin(t,n),t.env=t.$env=Bc,t.Promise=window.Promise,function(s){s.destructor=function(){for(var d in s.callEvent("onDestroy",[]),this.clearAll(),this.$container&&(this.$container.innerHTML=""),this._eventRemoveAll&&this._eventRemoveAll(),this.resetLightbox&&this.resetLightbox(),this._dp&&this._dp.destructor&&this._dp.destructor(),this.detachAllEvents(),this)d.indexOf("$")===0&&delete this[d];s.$destroyed=!0}}(t),function(s){function d(c,u){var f={method:c};if(u.length===0)throw new Error("Arguments list of query is wrong.");if(u.length===1)return typeof u[0]=="string"?(f.url=u[0],f.async=!0):(f.url=u[0].url,f.async=u[0].async||!0,f.callback=u[0].callback,f.headers=u[0].headers),u[0].data?typeof u[0].data!="string"?f.data=Sa(u[0].data):f.data=u[0].data:f.data="",f;switch(f.url=u[0],c){case"GET":case"DELETE":f.callback=u[1],f.headers=u[2];break;case"POST":case"PUT":u[1]?typeof u[1]!="string"?f.data=Sa(u[1]):f.data=u[1]:f.data="",f.callback=u[2],f.headers=u[3]}return f}s.Promise=window.Promise,s.ajax={cache:!0,method:"get",serializeRequestParams:Sa,parse:function(c){return typeof c!="string"?c:(c=c.replace(/^[\s]+/,""),typeof DOMParser>"u"||s.$env.isIE?window.ActiveXObject!==void 0&&((u=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",u.loadXML(c)):u=new DOMParser().parseFromString(c,"text/xml"),u);var u},xmltop:function(c,u,f){if(u.status===void 0||u.status<400){var y=u.responseXML?u.responseXML||u:this.parse(u.responseText||u);if(y&&y.documentElement!==null&&!y.getElementsByTagName("parsererror").length)return y.getElementsByTagName(c)[0]}return f!==-1&&s.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],f]),document.createElement("DIV")},xpath:function(c,u){if(u.nodeName||(u=u.responseXML||u),s.$env.isIE)return u.selectNodes(c)||[];for(var f,y=[],g=(u.ownerDocument||u).evaluate(c,u,null,XPathResult.ANY_TYPE,null);f=g.iterateNext();)y.push(f);return y},query:function(c){return this._call(c.method||"GET",c.url,c.data||"",c.async||!0,c.callback,c.headers)},get:function(c,u,f){var y=d("GET",arguments);return this.query(y)},getSync:function(c,u){var f=d("GET",arguments);return f.async=!1,this.query(f)},put:function(c,u,f,y){var g=d("PUT",arguments);return this.query(g)},del:function(c,u,f){var y=d("DELETE",arguments);return this.query(y)},post:function(c,u,f,y){arguments.length==1?u="":arguments.length==2&&typeof u=="function"&&(f=u,u="");var g=d("POST",arguments);return this.query(g)},postSync:function(c,u,f){u=u===null?"":String(u);var y=d("POST",arguments);return y.async=!1,this.query(y)},_call:function(c,u,f,y,g,h){return new s.Promise((function(p,v){var x=typeof XMLHttpRequest===void 0||s.$env.isIE?new window.ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,S=navigator.userAgent.match(/AppleWebKit/)!==null&&navigator.userAgent.match(/Qt/)!==null&&navigator.userAgent.match(/Safari/)!==null;if(y&&x.addEventListener("readystatechange",function(){if(x.readyState==4||S&&x.readyState==3){if((x.status!=200||x.responseText==="")&&!s.callEvent("onAjaxError",[x]))return;setTimeout(function(){typeof g=="function"&&g.apply(window,[{xmlDoc:x,filePath:u}]),p(x),typeof g=="function"&&(g=null,x=null)},0)}}),c!="GET"||this.cache||(u+=(u.indexOf("?")>=0?"&":"?")+"dhxr"+new Date().getTime()+"=1"),x.open(c,u,y),h)for(var O in h)x.setRequestHeader(O,h[O]);else c.toUpperCase()=="POST"||c=="PUT"||c=="DELETE"?x.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):c=="GET"&&(f=null);if(x.setRequestHeader("X-Requested-With","XMLHttpRequest"),x.send(f),!y)return{xmlDoc:x,filePath:u}}).bind(this))},urlSeparator:function(c){return c.indexOf("?")!=-1?"&":"?"}},s.$ajax=s.ajax}(t),Yc(t),function(s){s.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D %j",hour_date:"%H:%i",month_day:"%d",date_format:"%Y-%m-%d %H:%i",api_date:"%d-%m-%Y %H:%i",parse_exact_format:!1,preserve_length:!0,time_step:5,displayed_event_color:"#ff4a4a",displayed_event_text_color:"#ffef80",wide_form:0,day_column_padding:8,use_select_menu_space:!0,fix_tab_position:!0,start_on_monday:!0,first_hour:0,last_hour:24,readonly:!1,drag_resize:!0,drag_move:!0,drag_create:!0,drag_event_body:!0,dblclick_create:!0,details_on_dblclick:!0,edit_on_create:!0,details_on_create:!0,header:null,hour_size_px:44,resize_month_events:!1,resize_month_timed:!1,responsive_lightbox:!1,separate_short_events:!0,rtl:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:200,drag_lightbox:!0,preserve_scroll:!0,select:!0,undo_deleted:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,touch_swipe_dates:!1,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_right:["dhx_save_btn","dhx_cancel_btn"],buttons_left:["dhx_delete_btn"],lightbox:{sections:[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1,ajax_error:"alert",delay_render:0,timeline_swap_resize:!0,wai_aria_attributes:!0,wai_aria_application_role:!0,csp:"auto",event_attribute:"data-event-id",show_errors:!0},s.config.buttons_left.$initial=s.config.buttons_left.join(),s.config.buttons_right.$initial=s.config.buttons_right.join(),s._helpers={parseDate:function(d){return(s.templates.xml_date||s.templates.parse_date)(d)},formatDate:function(d){return(s.templates.xml_format||s.templates.format_date)(d)}},s.templates={},s.init_templates=function(){var d=s.date.date_to_str,c=s.config;(function(u,f){for(var y in f)u[y]||(u[y]=f[y])})(s.templates,{day_date:d(c.default_date),month_date:d(c.month_date),week_date:function(u,f){return c.rtl?s.templates.day_date(s.date.add(f,-1,"day"))+" &ndash; "+s.templates.day_date(u):s.templates.day_date(u)+" &ndash; "+s.templates.day_date(s.date.add(f,-1,"day"))},day_scale_date:d(c.default_date),time_slot_text:function(u){return""},time_slot_class:function(u){return""},month_scale_date:d(c.week_date),week_scale_date:d(c.day_date),hour_scale:d(c.hour_date),time_picker:d(c.hour_date),event_date:d(c.hour_date),month_day:d(c.month_day),load_format:d(c.load_date),format_date:d(c.date_format,c.server_utc),parse_date:s.date.str_to_date(c.date_format,c.server_utc),api_date:s.date.str_to_date(c.api_date,!1,!1),event_header:function(u,f,y){return y._mode==="small"||y._mode==="smallest"?s.templates.event_date(u):s.templates.event_date(u)+" - "+s.templates.event_date(f)},event_text:function(u,f,y){return y.text},event_class:function(u,f,y){return""},month_date_class:function(u){return""},week_date_class:function(u){return""},event_bar_date:function(u,f,y){return s.templates.event_date(u)},event_bar_text:function(u,f,y){return y.text},month_events_link:function(u,f){return"<a>View more("+f+" events)</a>"},drag_marker_class:function(u,f,y){return""},drag_marker_content:function(u,f,y){return""},tooltip_date_format:s.date.date_to_str("%Y-%m-%d %H:%i"),tooltip_text:function(u,f,y){return"<b>Event:</b> "+y.text+"<br/><b>Start date:</b> "+s.templates.tooltip_date_format(u)+"<br/><b>End date:</b> "+s.templates.tooltip_date_format(f)},calendar_month:d("%F %Y"),calendar_scale_date:d("%D"),calendar_date:d("%d"),calendar_time:d("%d-%m-%Y")}),this.callEvent("onTemplatesReady",[])}}(t),function(s){s._events={},s.clearAll=function(){this._events={},this._loaded={},this._edit_id=null,this._select_id=null,this._drag_id=null,this._drag_mode=null,this._drag_pos=null,this._new_event=null,this.clear_view(),this.callEvent("onClearAll",[])},s.addEvent=function(d,c,u,f,y){if(!arguments.length)return this.addEventNow();var g=d;arguments.length!=1&&((g=y||{}).start_date=d,g.end_date=c,g.text=u,g.id=f),g.id=g.id||s.uid(),g.text=g.text||"",typeof g.start_date=="string"&&(g.start_date=this.templates.api_date(g.start_date)),typeof g.end_date=="string"&&(g.end_date=this.templates.api_date(g.end_date));var h=6e4*(this.config.event_duration||this.config.time_step);g.start_date.valueOf()==g.end_date.valueOf()&&g.end_date.setTime(g.end_date.valueOf()+h),g.start_date.setMilliseconds(0),g.end_date.setMilliseconds(0),g._timed=this.isOneDayEvent(g);var p=!this._events[g.id];return this._events[g.id]=g,this.event_updated(g),this._loading||this.callEvent(p?"onEventAdded":"onEventChanged",[g.id,g]),g.id},s.deleteEvent=function(d,c){var u=this._events[d];(c||this.callEvent("onBeforeEventDelete",[d,u])&&this.callEvent("onConfirmedBeforeEventDelete",[d,u]))&&(u&&(s.getState().select_id==d&&s.unselect(),delete this._events[d],this.event_updated(u),this._drag_id==u.id&&(this._drag_id=null,this._drag_mode=null,this._drag_pos=null)),this.callEvent("onEventDeleted",[d,u]))},s.getEvent=function(d){return this._events[d]},s.setEvent=function(d,c){c.id||(c.id=d),this._events[d]=c},s.for_rendered=function(d,c){for(var u=this._rendered.length-1;u>=0;u--)this._rendered[u].getAttribute(this.config.event_attribute)==d&&c(this._rendered[u],u)},s.changeEventId=function(d,c){if(d!=c){var u=this._events[d];u&&(u.id=c,this._events[c]=u,delete this._events[d]),this.for_rendered(d,function(f){f.setAttribute("event_id",c),f.setAttribute(s.config.event_attribute,c)}),this._select_id==d&&(this._select_id=c),this._edit_id==d&&(this._edit_id=c),this.callEvent("onEventIdChange",[d,c])}},function(){for(var d=["text","Text","start_date","StartDate","end_date","EndDate"],c=function(y){return function(g){return s.getEvent(g)[y]}},u=function(y){return function(g,h){var p=s.getEvent(g);p[y]=h,p._changed=!0,p._timed=this.isOneDayEvent(p),s.event_updated(p,!0)}},f=0;f<d.length;f+=2)s["getEvent"+d[f+1]]=c(d[f]),s["setEvent"+d[f+1]]=u(d[f])}(),s.event_updated=function(d,c){this.is_visible_events(d)?this.render_view_data():this.clear_event(d.id)},s.is_visible_events=function(d){if(!this._min_date||!this._max_date)return!1;if(d.start_date.valueOf()<this._max_date.valueOf()&&this._min_date.valueOf()<d.end_date.valueOf()){var c=d.start_date.getHours(),u=d.end_date.getHours()+d.end_date.getMinutes()/60,f=this.config.last_hour,y=this.config.first_hour;return!(!this._table_view&&(u>f||u<=y)&&(c>=f||c<y)&&!((d.end_date.valueOf()-d.start_date.valueOf())/36e5>24-(this.config.last_hour-this.config.first_hour)||c<f&&u>y))}return!1},s.isOneDayEvent=function(d){var c=new Date(d.end_date.valueOf()-1);return d.start_date.getFullYear()===c.getFullYear()&&d.start_date.getMonth()===c.getMonth()&&d.start_date.getDate()===c.getDate()&&d.end_date.valueOf()-d.start_date.valueOf()<864e5},s.get_visible_events=function(d){var c=[];for(var u in this._events)this.is_visible_events(this._events[u])&&(d&&!this._events[u]._timed||this.filter_event(u,this._events[u])&&c.push(this._events[u]));return c},s.filter_event=function(d,c){var u=this["filter_"+this._mode];return!u||u(d,c)},s._is_main_area_event=function(d){return!!d._timed},s.render_view_data=function(d,c){var u=!1;if(!d){if(u=!0,this._not_render)return void(this._render_wait=!0);this._render_wait=!1,this.clear_view(),d=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(var f=0,y=d.length;f<y;f++)this._recalculate_timed(d[f]);if(this.config.multi_day&&!this._table_view){var g=[],h=[];for(f=0;f<d.length;f++)this._is_main_area_event(d[f])?g.push(d[f]):h.push(d[f]);if(!this._els.dhx_multi_day){var p=s._commonErrorMessages.unknownView(this._mode);throw new Error(p)}this._rendered_location=this._els.dhx_multi_day[0],this._table_view=!0,this.render_data(h,c),this._table_view=!1,this._rendered_location=this._els.dhx_cal_data[0],this._table_view=!1,this.render_data(g,c)}else{var v=document.createDocumentFragment(),x=this._els.dhx_cal_data[0];this._rendered_location=v,this.render_data(d,c),x.appendChild(v),this._rendered_location=x}u&&this.callEvent("onDataRender",[])},s._view_month_day=function(d){var c=s.getActionData(d).date;s.callEvent("onViewMoreClick",[c])&&s.setCurrentView(c,"day")},s._render_month_link=function(d){for(var c=this._rendered_location,u=this._lame_clone(d),f=d._sday;f<d._eday;f++){u._sday=f,u._eday=f+1;var y=s.date,g=s._min_date;g=y.add(g,u._sweek,"week"),g=y.add(g,u._sday,"day");var h=s.getEvents(g,y.add(g,1,"day")).length,p=this._get_event_bar_pos(u),v=p.x2-p.x,x=document.createElement("div");s.event(x,"click",function(S){s._view_month_day(S)}),x.className="dhx_month_link",x.style.top=p.y+"px",x.style.left=p.x+"px",x.style.width=v+"px",x.innerHTML=s.templates.month_events_link(g,h),this._rendered.push(x),c.appendChild(x)}},s._recalculate_timed=function(d){var c;d&&(c=typeof d!="object"?this._events[d]:d)&&(c._timed=s.isOneDayEvent(c))},s.attachEvent("onEventChanged",s._recalculate_timed),s.attachEvent("onEventAdded",s._recalculate_timed),s.render_data=function(d,c){d=this._pre_render_events(d,c);for(var u={},f=0;f<d.length;f++)if(this._table_view)if(s._mode!="month")this.render_event_bar(d[f]);else{var y=s.config.max_month_events;y!==1*y||d[f]._sorder<y?this.render_event_bar(d[f]):y!==void 0&&d[f]._sorder==y&&s._render_month_link(d[f])}else{var g=d[f],h=s.locate_holder(g._sday);if(!h)continue;u[g._sday]||(u[g._sday]={real:h,buffer:document.createDocumentFragment(),width:h.clientWidth});var p=u[g._sday];this.render_event(g,p.buffer,p.width)}for(var f in u)(p=u[f]).real&&p.buffer&&p.real.appendChild(p.buffer)},s._get_first_visible_cell=function(d){for(var c=0;c<d.length;c++)if((d[c].className||"").indexOf("dhx_scale_ignore")==-1)return d[c];return d[0]},s._pre_render_events=function(d,c){var u=this.xy.bar_height,f=this._colsS.heights,y=this._colsS.heights=[0,0,0,0,0,0,0],g=this._els.dhx_cal_data[0];if(d=this._table_view?this._pre_render_events_table(d,c):this._pre_render_events_line(d,c),this._table_view)if(c)this._colsS.heights=f;else{var h=g.querySelectorAll(".dhx_cal_month_row");if(h.length){for(var p=0;p<h.length;p++){y[p]++;var v=h[p].querySelectorAll(".dhx_cal_month_cell"),x=this._colsS.height-this.xy.month_head_height;if(y[p]*u>x){var S=x;1*this.config.max_month_events!==this.config.max_month_events||y[p]<=this.config.max_month_events?S=y[p]*u:(this.config.max_month_events+1)*u>x&&(S=(this.config.max_month_events+1)*u),h[p].style.height=S+this.xy.month_head_height+"px"}y[p]=(y[p-1]||0)+s._get_first_visible_cell(v).offsetHeight}y.unshift(0);const D=this.$container.querySelector(".dhx_cal_data");if(D.offsetHeight<D.scrollHeight&&!s._colsS.scroll_fix&&s.xy.scroll_width){var O=s._colsS,N=O[O.col_length],I=O.heights.slice();N-=s.xy.scroll_width||0,this._calc_scale_sizes(N,this._min_date,this._max_date),s._colsS.heights=I,this.set_xy(this._els.dhx_cal_header[0],N),s._render_scales(this._els.dhx_cal_header[0]),s._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date),O.scroll_fix=!0}}else if(d.length||this._els.dhx_multi_day[0].style.visibility!="visible"||(y[0]=-1),d.length||y[0]==-1){var A=(y[0]+1)*u+4,m=A,b=A+"px";this.config.multi_day_height_limit&&(b=(m=Math.min(A,this.config.multi_day_height_limit))+"px");var k=this._els.dhx_multi_day[0];k.style.height=b,k.style.visibility=y[0]==-1?"hidden":"visible",k.style.display=y[0]==-1?"none":"";var E=this._els.dhx_multi_day[1];E.style.height=b,E.style.visibility=y[0]==-1?"hidden":"visible",E.style.display=y[0]==-1?"none":"",E.className=y[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small",this._dy_shift=(y[0]+1)*u,this.config.multi_day_height_limit&&(this._dy_shift=Math.min(this.config.multi_day_height_limit,this._dy_shift)),y[0]=0,m!=A&&(k.style.overflowY="auto",E.style.position="fixed",E.style.top="",E.style.left="")}}return d},s._get_event_sday=function(d){var c=this.date.day_start(new Date(d.start_date));return Math.round((c.valueOf()-this._min_date.valueOf())/864e5)},s._get_event_mapped_end_date=function(d){var c=d.end_date;if(this.config.separate_short_events){var u=(d.end_date-d.start_date)/6e4;u<this._min_mapped_duration&&(c=this.date.add(c,this._min_mapped_duration-u,"minute"))}return c},s._pre_render_events_line=function(d,c){d.sort(function(E,D){return E.start_date.valueOf()==D.start_date.valueOf()?E.id>D.id?1:-1:E.start_date>D.start_date?1:-1});var u=[],f=[];this._min_mapped_duration=Math.floor(60*this.xy.min_event_height/this.config.hour_size_px);for(var y=0;y<d.length;y++){var g=d[y],h=g.start_date,p=g.end_date,v=h.getHours(),x=p.getHours();if(g._sday=this._get_event_sday(g),this._ignores[g._sday])d.splice(y,1),y--;else{if(u[g._sday]||(u[g._sday]=[]),!c){g._inner=!1;for(var S=u[g._sday];S.length;){var O=S[S.length-1];if(!(this._get_event_mapped_end_date(O).valueOf()<=g.start_date.valueOf()))break;S.splice(S.length-1,1)}for(var N=S.length,I=!1,A=0;A<S.length;A++)if(O=S[A],this._get_event_mapped_end_date(O).valueOf()<=g.start_date.valueOf()){I=!0,g._sorder=O._sorder,N=A,g._inner=!0;break}if(S.length&&(S[S.length-1]._inner=!0),!I)if(S.length)if(S.length<=S[S.length-1]._sorder){if(S[S.length-1]._sorder)for(A=0;A<S.length;A++){for(var m=!1,b=0;b<S.length;b++)if(S[b]._sorder==A){m=!0;break}if(!m){g._sorder=A;break}}else g._sorder=0;g._inner=!0}else{var k=S[0]._sorder;for(A=1;A<S.length;A++)S[A]._sorder>k&&(k=S[A]._sorder);g._sorder=k+1,g._inner=!1}else g._sorder=0;S.splice(N,N==S.length?0:1,g),S.length>(S.max_count||0)?(S.max_count=S.length,g._count=S.length):g._count=g._count?g._count:1}(v<this.config.first_hour||x>=this.config.last_hour)&&(f.push(g),d[y]=g=this._copy_event(g),v<this.config.first_hour&&(g.start_date.setHours(this.config.first_hour),g.start_date.setMinutes(0)),x>=this.config.last_hour&&(g.end_date.setMinutes(0),g.end_date.setHours(this.config.last_hour)),g.start_date>g.end_date||v==this.config.last_hour)&&(d.splice(y,1),y--)}}if(!c){for(y=0;y<d.length;y++)d[y]._count=u[d[y]._sday].max_count;for(y=0;y<f.length;y++)f[y]._count=u[f[y]._sday].max_count}return d},s._time_order=function(d){d.sort(function(c,u){return c.start_date.valueOf()==u.start_date.valueOf()?c._timed&&!u._timed?1:!c._timed&&u._timed?-1:c.id>u.id?1:-1:c.start_date>u.start_date?1:-1})},s._is_any_multiday_cell_visible=function(d,c,u){var f=this._cols.length,y=!1,g=d,h=!0,p=new Date(c);for(s.date.day_start(new Date(c)).valueOf()!=c.valueOf()&&(p=s.date.day_start(p),p=s.date.add(p,1,"day"));g<p;){h=!1;var v=this.locate_holder_day(g,!1,u)%f;if(!this._ignores[v]){y=!0;break}g=s.date.add(g,1,"day")}return h||y},s._pre_render_events_table=function(d,c){this._time_order(d);for(var u,f=[],y=[[],[],[],[],[],[],[]],g=this._colsS.heights,h=this._cols.length,p={},v=0;v<d.length;v++){var x=d[v],S=x.id;p[S]||(p[S]={first_chunk:!0,last_chunk:!0});var O=p[S],N=u||x.start_date,I=x.end_date;N<this._min_date&&(O.first_chunk=!1,N=this._min_date),I>this._max_date&&(O.last_chunk=!1,I=this._max_date);var A=this.locate_holder_day(N,!1,x);if(x._sday=A%h,!this._ignores[x._sday]||!x._timed){var m=this.locate_holder_day(I,!0,x)||h;if(x._eday=m%h||h,x._length=m-A,x._sweek=Math.floor((this._correct_shift(N.valueOf(),1)-this._min_date.valueOf())/(864e5*h)),s._is_any_multiday_cell_visible(N,I,x)){var b,k=y[x._sweek];for(b=0;b<k.length&&!(k[b]._eday<=x._sday);b++);if(x._sorder&&c||(x._sorder=b),x._sday+x._length<=h)u=null,f.push(x),k[b]=x,g[x._sweek]=k.length-1,x._first_chunk=O.first_chunk,x._last_chunk=O.last_chunk;else{var E=this._copy_event(x);E.id=x.id,E._length=h-x._sday,E._eday=h,E._sday=x._sday,E._sweek=x._sweek,E._sorder=x._sorder,E.end_date=this.date.add(N,E._length,"day"),E._first_chunk=O.first_chunk,O.first_chunk&&(O.first_chunk=!1),f.push(E),k[b]=E,u=E.end_date,g[x._sweek]=k.length-1,v--}}else u=null}}return f},s._copy_dummy=function(){var d=new Date(this.start_date),c=new Date(this.end_date);this.start_date=d,this.end_date=c},s._copy_event=function(d){return this._copy_dummy.prototype=d,new this._copy_dummy},s._rendered=[],s.clear_view=function(){for(var d=0;d<this._rendered.length;d++){var c=this._rendered[d];c.parentNode&&c.parentNode.removeChild(c)}this._rendered=[]},s.updateEvent=function(d){var c=this.getEvent(d);this.clear_event(d),c&&this.is_visible_events(c)&&this.filter_event(d,c)&&(this._table_view||this.config.multi_day||c._timed)&&(this.config.update_render?this.render_view_data():this.getState().mode!="month"||this.getState().drag_id||this.isOneDayEvent(c)?this.render_view_data([c],!0):this.render_view_data())},s.clear_event=function(d){this.for_rendered(d,function(c,u){c.parentNode&&c.parentNode.removeChild(c),s._rendered.splice(u,1)})},s._y_from_date=function(d){var c=60*d.getHours()+d.getMinutes();return Math.round((60*c*1e3-60*this.config.first_hour*60*1e3)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)},s._calc_event_y=function(d,c){c=c||0;var u=60*d.start_date.getHours()+d.start_date.getMinutes(),f=60*d.end_date.getHours()+d.end_date.getMinutes()||60*s.config.last_hour;return{top:this._y_from_date(d.start_date),height:Math.max(c,(f-u)*this.config.hour_size_px/60)}},s.render_event=function(d,c,u){var f=s.xy.menu_width,y=this.config.use_select_menu_space?0:f;if(!(d._sday<0)){var g=s.locate_holder(d._sday);if(g){c=c||g;var h=this._calc_event_y(d,s.xy.min_event_height),p=h.top,v=h.height,x=d._count||1,S=d._sorder||0;u=u||g.clientWidth,this.config.day_column_padding&&(u-=this.config.day_column_padding);var O=Math.floor((u-y)/x),N=S*O+1;if(d._inner||(O*=x-S),this.config.cascade_event_display){const R=this.config.cascade_event_count,P=this.config.cascade_event_margin;let F,q=(x-S-1)%R*P,$=S%R*P;x*P<u-this.config.day_column_padding?F=d._inner?q/2:0:(F=d._inner?q/3:0,N=$/3,x*P/2>u-this.config.day_column_padding&&(F=d._inner?q/R:0,N=$/R)),O=Math.floor(u-y-N-F)}d._mode=v<30?"smallest":v<42?"small":null;var I=this._render_v_bar(d,y+N,p,O,v,d._text_style,s.templates.event_header(d.start_date,d.end_date,d),s.templates.event_text(d.start_date,d.end_date,d));if(d._mode==="smallest"?I.classList.add("dhx_cal_event--xsmall"):d._mode==="small"&&I.classList.add("dhx_cal_event--small"),this._waiAria.eventAttr(d,I),this._rendered.push(I),c.appendChild(I),N=N+parseInt(this.config.rtl?g.style.right:g.style.left,10)+y,this._edit_id==d.id){I.style.zIndex=1,O=Math.max(O,s.xy.editor_width),(I=document.createElement("div")).setAttribute("event_id",d.id),I.setAttribute(this.config.event_attribute,d.id),this._waiAria.eventAttr(d,I),I.className="dhx_cal_event dhx_cal_editor",this.config.rtl&&N++,this.set_xy(I,O,v,N,p),d.color&&I.style.setProperty("--dhx-scheduler-event-background",d.color);var A=s.templates.event_class(d.start_date,d.end_date,d);A&&(I.className+=" "+A);var m=document.createElement("div");m.style.cssText+="overflow:hidden;height:100%",I.appendChild(m),this._els.dhx_cal_data[0].appendChild(I),this._rendered.push(I),m.innerHTML="<textarea class='dhx_cal_editor'>"+d.text+"</textarea>",this._editor=m.querySelector("textarea"),s.event(this._editor,"keydown",function(R){if(R.shiftKey)return!0;var P=R.keyCode;P==s.keys.edit_save&&s.editStop(!0),P==s.keys.edit_cancel&&s.editStop(!1),P!=s.keys.edit_save&&P!=s.keys.edit_cancel||R.preventDefault&&R.preventDefault()}),s.event(this._editor,"selectstart",function(R){return R.cancelBubble=!0,!0}),s._focus(this._editor,!0),this._els.dhx_cal_data[0].scrollLeft=0}if(this.xy.menu_width!==0&&this._select_id==d.id){this.config.cascade_event_display&&this._drag_mode&&(I.style.zIndex=1);for(var b,k=this.config["icons_"+(this._edit_id==d.id?"edit":"select")],E="",D=0;D<k.length;D++){const R=k[D];b=this._waiAria.eventMenuAttrString(R),E+=`<div class='dhx_menu_icon ${R}' title='${this.locale.labels[R]}' ${b}></div>`}var C=this._render_v_bar(d,N-f-1,p,f,null,"","<div class='dhx_menu_head'></div>",E,!0);d.color&&C.style.setProperty("--dhx-scheduler-event-background",d.color),d.textColor&&C.style.setProperty("--dhx-scheduler-event-color",d.textColor),this._els.dhx_cal_data[0].appendChild(C),this._rendered.push(C)}this.config.drag_highlight&&this._drag_id==d.id&&this.highlightEventPosition(d)}}},s._render_v_bar=function(d,c,u,f,y,g,h,p,v){var x=document.createElement("div"),S=d.id,O=v?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",N=s.getState();N.drag_id==d.id&&(O+=" dhx_cal_event_drag"),N.select_id==d.id&&(O+=" dhx_cal_event_selected");var I=s.templates.event_class(d.start_date,d.end_date,d);I&&(O=O+" "+I),this.config.cascade_event_display&&(O+=" dhx_cal_event_cascade");var A=f-1,m=`<div event_id="${S}" ${this.config.event_attribute}="${S}" class="${O}"
				style="position:absolute; top:${u}px; ${this.config.rtl?"right:":"left:"}${c}px; width:${A}px; height:${y}px; ${g||""}" 
				data-bar-start="${d.start_date.valueOf()}" data-bar-end="${d.end_date.valueOf()}">
				</div>`;x.innerHTML=m;var b=x.cloneNode(!0).firstChild;if(!v&&s.renderEvent(b,d,f,y,h,p))return d.color&&b.style.setProperty("--dhx-scheduler-event-background",d.color),d.textColor&&b.style.setProperty("--dhx-scheduler-event-color",d.textColor),b;b=x.firstChild,d.color&&b.style.setProperty("--dhx-scheduler-event-background",d.color),d.textColor&&b.style.setProperty("--dhx-scheduler-event-color",d.textColor);var k='<div class="dhx_event_move dhx_header" >&nbsp;</div>';k+='<div class="dhx_event_move dhx_title">'+h+"</div>",k+='<div class="dhx_body">'+p+"</div>";var E="dhx_event_resize dhx_footer";return(v||d._drag_resize===!1)&&(E="dhx_resize_denied "+E),k+='<div class="'+E+'" style=" width:'+(v?" margin-top:-1px;":"")+'" ></div>',b.innerHTML=k,b},s.renderEvent=function(){return!1},s.locate_holder=function(d){return this._mode=="day"?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[d]},s.locate_holder_day=function(d,c){var u=Math.floor((this._correct_shift(d,1)-this._min_date)/864e5);return c&&this.date.time_part(d)&&u++,u},s._get_dnd_order=function(d,c,u){if(!this._drag_event)return d;this._drag_event._orig_sorder?d=this._drag_event._orig_sorder:this._drag_event._orig_sorder=d;for(var f=c*d;f+c>u;)d--,f-=c;return Math.max(d,0)},s._get_event_bar_pos=function(d){var c=this.config.rtl,u=this._colsS,f=u[d._sday],y=u[d._eday];c&&(f=u[u.col_length]-u[d._eday]+u[0],y=u[u.col_length]-u[d._sday]+u[0]),y==f&&(y=u[d._eday+1]);var g=this.xy.bar_height,h=d._sorder;if(d.id==this._drag_id){var p=u.heights[d._sweek+1]-u.heights[d._sweek]-this.xy.month_head_height;h=s._get_dnd_order(h,g,p)}var v=h*g;return{x:f,x2:y,y:u.heights[d._sweek]+(u.height?this.xy.month_scale_height+2:2)+v}},s.render_event_bar=function(d){var c=this._rendered_location,u=this._get_event_bar_pos(d),f=u.y,y=u.x,g=u.x2,h="";if(g){var p=s.config.resize_month_events&&this._mode=="month"&&(!d._timed||s.config.resize_month_timed),v=document.createElement("div"),x=d.hasOwnProperty("_first_chunk")&&d._first_chunk,S=d.hasOwnProperty("_last_chunk")&&d._last_chunk,O=p&&(d._timed||x),N=p&&(d._timed||S),I=!0,A="dhx_cal_event_clear";d._timed&&!p||(I=!1,A="dhx_cal_event_line"),x&&(A+=" dhx_cal_event_line_start"),S&&(A+=" dhx_cal_event_line_end"),O&&(h+="<div class='dhx_event_resize dhx_event_resize_start'></div>"),N&&(h+="<div class='dhx_event_resize dhx_event_resize_end'></div>");var m=s.templates.event_class(d.start_date,d.end_date,d);m&&(A+=" "+m);var b=d.color?"--dhx-scheduler-event-background:"+d.color+";":"",k=d.textColor?"--dhx-scheduler-event-color:"+d.textColor+";":"",E=["position:absolute","top:"+f+"px","left:"+y+"px","width:"+(g-y-(I?1:0))+"px","height:"+(this.xy.bar_height-2)+"px",k,b,d._text_style||""].join(";"),D="<div event_id='"+d.id+"' "+this.config.event_attribute+"='"+d.id+"' class='"+A+"' style='"+E+"'"+this._waiAria.eventBarAttrString(d)+">";p&&(D+=h),s.getState().mode!="month"||d._beforeEventChangedFlag||(d=s.getEvent(d.id)),d._timed&&(D+=`<span class='dhx_cal_event_clear_date'>${s.templates.event_bar_date(d.start_date,d.end_date,d)}</span>`),D+="<div class='dhx_cal_event_line_content'>",D+=s.templates.event_bar_text(d.start_date,d.end_date,d)+"</div>",D+="</div>",D+="</div>",v.innerHTML=D,this._rendered.push(v.firstChild),c.appendChild(v.firstChild)}},s._locate_event=function(d){for(var c=null;d&&!c&&d.getAttribute;)c=d.getAttribute(this.config.event_attribute),d=d.parentNode;return c},s.edit=function(d){this._edit_id!=d&&(this.editStop(!1,d),this._edit_id=d,this.updateEvent(d))},s.editStop=function(d,c){if(!c||this._edit_id!=c){var u=this.getEvent(this._edit_id);u&&(d&&(u.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(u.id),this._edit_stop_event(u,d))}},s._edit_stop_event=function(d,c){this._new_event?(c?this.callEvent("onEventAdded",[d.id,d]):d&&this.deleteEvent(d.id,!0),this._new_event=null):c&&this.callEvent("onEventChanged",[d.id,d])},s.getEvents=function(d,c){var u=[];for(var f in this._events){var y=this._events[f];y&&(!d&&!c||y.start_date<c&&y.end_date>d)&&u.push(y)}return u},s.getRenderedEvent=function(d){if(d){for(var c=s._rendered,u=0;u<c.length;u++){var f=c[u];if(f.getAttribute(s.config.event_attribute)==d)return f}return null}},s.showEvent=function(d,c){d&&typeof d=="object"&&(c=d.mode,S=d.section,d=d.section);var u=typeof d=="number"||typeof d=="string"?s.getEvent(d):d;if(c=c||s._mode,u&&(!this.checkEvent("onBeforeEventDisplay")||this.callEvent("onBeforeEventDisplay",[u,c]))){var f=s.config.scroll_hour;s.config.scroll_hour=u.start_date.getHours();var y=s.config.preserve_scroll;s.config.preserve_scroll=!1;var g=u.color,h=u.textColor;if(s.config.highlight_displayed_event&&(u.color=s.config.displayed_event_color,u.textColor=s.config.displayed_event_text_color),s.setCurrentView(new Date(u.start_date),c),s.config.scroll_hour=f,s.config.preserve_scroll=y,s.matrix&&s.matrix[c]){var p=s.getView(),v=p.y_property,x=s.getEvent(u.id);if(x){if(!S){var S=x[v];Array.isArray(S)?S=S[0]:typeof S=="string"&&s.config.section_delimiter&&S.indexOf(s.config.section_delimiter)>-1&&(S=S.split(s.config.section_delimiter)[0])}var O=p.getSectionTop(S),N=p.posFromDate(x.start_date),I=s.$container.querySelector(".dhx_timeline_data_wrapper");if(N-=(I.offsetWidth-p.dx)/2,O=O-I.offsetHeight/2+p.dy/2,p._smartRenderingEnabled())var A=p.attachEvent("onScroll",function(){m(),p.detachEvent(A)});p.scrollTo({left:N,top:O}),p._smartRenderingEnabled()||m()}}else m();s.callEvent("onAfterEventDisplay",[u,c])}function m(){u.color=g,u.textColor=h}}}(t),function(s){s._append_drag_marker=function(d){if(!d.parentNode){var c=s._els.dhx_cal_data[0].lastChild,u=s._getClassName(c);u.indexOf("dhx_scale_holder")<0&&c.previousSibling&&(c=c.previousSibling),u=s._getClassName(c),c&&u.indexOf("dhx_scale_holder")===0&&c.appendChild(d)}},s._update_marker_position=function(d,c){var u=s._calc_event_y(c,0);d.style.top=u.top+"px",d.style.height=u.height+"px"},s.highlightEventPosition=function(d){var c=document.createElement("div");c.setAttribute("event_id",d.id),c.setAttribute(this.config.event_attribute,d.id),this._rendered.push(c),this._update_marker_position(c,d);var u=this.templates.drag_marker_class(d.start_date,d.end_date,d),f=this.templates.drag_marker_content(d.start_date,d.end_date,d);c.className="dhx_drag_marker",u&&(c.className+=" "+u),f&&(c.innerHTML=f),this._append_drag_marker(c)}}(t),Wc(t),Kc(t),Gc(t),function(s){s.getRootView=function(){return{view:{render:function(){return{tag:"div",type:1,attrs:{style:"width:100%;height:100%;"},hooks:{didInsert:function(){s.setCurrentView()}},body:[{el:this.el,type:1}]}},init:function(){var d=document.createElement("DIV");d.id="scheduler_"+s.uid(),d.style.width="100%",d.style.height="100%",d.classList.add("dhx_cal_container"),d.cmp="grid",d.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button"></div><div class="dhx_cal_next_button"></div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" data-tab="day"></div><div class="dhx_cal_tab" data-tab="week"></div><div class="dhx_cal_tab" data-tab="month"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',s.init(d),this.el=d}},type:4}}}(t),Jc(t),window.jQuery&&(r=window.jQuery,i=0,a=[],r.fn.dhx_scheduler=function(s){if(typeof s!="string"){var d=[];return this.each(function(){if(this&&this.getAttribute)if(this.getAttribute("dhxscheduler"))d.push(window[this.getAttribute("dhxscheduler")]);else{var c="scheduler";i&&(c="scheduler"+(i+1),window[c]=Scheduler.getSchedulerInstance());var u=window[c];for(var f in this.setAttribute("dhxscheduler",c),s)f!="data"&&(u.config[f]=s[f]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button"></div><div class="dhx_cal_next_button"></div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab" data-tab="day" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" data-tab="week" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" data-tab="month" style="right:76px;"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',this.className+=" dhx_cal_container"),u.init(this,u.config.date,u.config.mode),s.data&&u.parse(s.data),d.push(u),i++}}),d.length===1?d[0]:d}if(a[s])return a[s].apply(this,[]);r.error("Method "+s+" does not exist on jQuery.dhx_scheduler")}),function(s){(function(){var d=s.setCurrentView,c=s.updateView,u=null,f=null,y=function(p,v){var x=this;ct.clearTimeout(f),ct.clearTimeout(u);var S=x._date,O=x._mode;h(this,p,v),f=setTimeout(function(){s.$destroyed||(x.callEvent("onBeforeViewChange",[O,S,v||x._mode,p||x._date])?(c.call(x,p,v),x.callEvent("onViewChange",[x._mode,x._date]),ct.clearTimeout(u),f=0):h(x,S,O))},s.config.delay_render)},g=function(p,v){var x=this,S=arguments;h(this,p,v),ct.clearTimeout(u),u=setTimeout(function(){s.$destroyed||f||c.apply(x,S)},s.config.delay_render)};function h(p,v,x){v&&(p._date=v),x&&(p._mode=x)}s.attachEvent("onSchedulerReady",function(){s.config.delay_render?(s.setCurrentView=y,s.updateView=g):(s.setCurrentView=d,s.updateView=c)})})()}(t),function(s){s.createDataProcessor=function(d){var c,u;d instanceof Function?c=d:d.hasOwnProperty("router")?c=d.router:d.hasOwnProperty("event")&&(c=d),u=c?"CUSTOM":d.mode||"REST-JSON";var f=new Ha(d.url);return f.init(s),f.setTransactionMode({mode:u,router:c},d.batchUpdate),f},s.DataProcessor=Ha}(t),function(s){s.attachEvent("onSchedulerReady",function(){typeof dhtmlxError<"u"&&window.dhtmlxError.catchError("LoadXML",function(d,c,u){var f=u[0].responseText;switch(s.config.ajax_error){case"alert":ct.alert(f);break;case"console":ct.console.log(f)}})})}(t);const o=new m_({en:s_,ar:Zc,be:e_,ca:t_,cn:n_,cs:r_,da:a_,de:i_,el:o_,es:l_,fi:d_,fr:c_,he:__,hu:u_,id:h_,it:f_,jp:p_,nb:g_,nl:v_,no:y_,pl:b_,pt:w_,ro:x_,ru:k_,si:E_,sk:T_,sv:A_,tr:S_,ua:D_});t.i18n={addLocale:o.addLocale,setLocale:function(s){if(typeof s=="string"){var d=o.getLocale(s);d||(d=o.getLocale("en")),t.locale=d}else if(s)if(t.locale)for(var c in s)s[c]&&typeof s[c]=="object"?(t.locale[c]||(t.locale[c]={}),t.mixin(t.locale[c],s[c],!0)):t.locale[c]=s[c];else t.locale=s;var u=t.locale.labels;u.dhx_save_btn=u.icon_save,u.dhx_cancel_btn=u.icon_cancel,u.dhx_delete_btn=u.icon_delete,t.$container&&t.get_elements()},getLocale:o.getLocale},t.i18n.setLocale("en"),t.ext={},Rc(t);const l={};return t.plugins=function(s){(function(d,c,u){const f=[];for(const y in d)if(d[y]){const g=y.toLowerCase();c[g]&&c[g].forEach(function(h){const p=h.toLowerCase();d[p]||f.push(p)}),f.push(g)}return f.sort(function(y,g){const h=u[y]||0,p=u[g]||0;return h>p?1:h<p?-1:0}),f})(s,{treetimeline:["timeline"],daytimeline:["timeline"],outerdrag:["legacy"]},{legacy:1,limit:1,timeline:2,daytimeline:3,treetimeline:3,outerdrag:6}).forEach(function(d){if(!l[d]){const c=e.getExtension(d);if(!c)throw new Error("unknown plugin "+d);c(t),l[d]=!0}})},t.plugins({all_timed:"short"}),t}class I_{constructor(t){this._extensions={};for(const n in t)this._extensions[n]=t[n]}addExtension(t,n){this._extensions[t]=n}getExtension(t){return this._extensions[t]}}typeof dhtmlx<"u"&&dhtmlx.attaches&&(dhtmlx.attaches.attachScheduler=function(e,t,n,r){n=n||'<div class="dhx_cal_tab" name="day_tab" data-tab="day" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" data-tab="week" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" data-tab="month" style="right:76px;"></div>';var i=document.createElement("DIV");return i.id="dhxSchedObj_"+this._genStr(12),i.innerHTML='<div id="'+i.id+'" class="dhx_cal_container" style="width:100%; height:100%;"><div class="dhx_cal_navline"><div class="dhx_cal_prev_button"></div><div class="dhx_cal_next_button"></div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div>'+n+'</div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div></div>',document.body.appendChild(i.firstChild),this.attachObject(i.id,!1,!0),this.vs[this.av].sched=r,this.vs[this.av].schedId=i.id,r.setSizes=r.updateView,r.destructor=function(){},r.init(i.id,e,t),this.vs[this._viewRestore()].sched});const vt=(e,t)=>{t(!1,`The ${e} extension is not included in this version of dhtmlxScheduler.<br>
		You may need a <a href="https://docs.dhtmlx.com/scheduler/editions_comparison.html" target="_blank">Professional version of the component</a>.<br>
		Contact us at <a href="https://dhtmlx.com/docs/contact.shtml" target="_blank">https://dhtmlx.com/docs/contact.shtml</a> if you have any questions.`)};function M_(e){(function(){var t=[];function n(){return!!t.length}function r(l){setTimeout(function(){if(e.$destroyed)return!0;n()||function(s,d){for(;s&&s!=d;)s=s.parentNode;return s==d}(document.activeElement,e.$container)||e.focus()},1)}function i(l){var s=(l=l||window.event).currentTarget;s==t[t.length-1]&&e.$keyboardNavigation.trapFocus(s,l)}if(e.attachEvent("onLightbox",function(){var l;l=e.getLightbox(),e.eventRemove(l,"keydown",i),e.event(l,"keydown",i),t.push(l)}),e.attachEvent("onAfterLightbox",function(){var l=t.pop();l&&e.eventRemove(l,"keydown",i),r()}),e.attachEvent("onAfterQuickInfo",function(){r()}),!e._keyNavMessagePopup){e._keyNavMessagePopup=!0;var a=null,o=null;const l=[];e.attachEvent("onMessagePopup",function(s){for(a=document.activeElement,o=a;o&&e._getClassName(o).indexOf("dhx_cal_data")<0;)o=o.parentNode;o&&(o=o.parentNode),e.eventRemove(s,"keydown",i),e.event(s,"keydown",i),l.push(s)}),e.attachEvent("onAfterMessagePopup",function(){var s=l.pop();s&&e.eventRemove(s,"keydown",i),setTimeout(function(){if(e.$destroyed)return!0;for(var d=document.activeElement;d&&e._getClassName(d).indexOf("dhx_cal_light")<0;)d=d.parentNode;d||(a&&a.parentNode?a.focus():o&&o.parentNode&&o.focus(),a=null,o=null)},1)})}e.$keyboardNavigation.isModal=n})()}function O_(e){e._temp_key_scope=function(){e.config.key_nav=!0,e.$keyboardNavigation._pasteDate=null,e.$keyboardNavigation._pasteSection=null;var t=null,n={};function r(o){o=o||window.event,n.x=o.clientX,n.y=o.clientY}function i(){for(var o,l,s=document.elementFromPoint(n.x,n.y);s&&s!=e._obj;)s=s.parentNode;return o=s==e._obj,l=e.$keyboardNavigation.dispatcher.isEnabled(),o||l}function a(o){return e._lame_copy({},o)}document.body?e.event(document.body,"mousemove",r):e.event(window,"load",function(){e.event(document.body,"mousemove",r)}),e.attachEvent("onMouseMove",function(o,l){var s=e.getState();if(s.mode&&s.min_date){var d=e.getActionData(l);e.$keyboardNavigation._pasteDate=d.date,e.$keyboardNavigation._pasteSection=d.section}}),e._make_pasted_event=function(o){var l=e.$keyboardNavigation._pasteDate,s=e.$keyboardNavigation._pasteSection,d=o.end_date-o.start_date,c=a(o);if(function(f){delete f.rec_type,delete f.rec_pattern,delete f.event_pid,delete f.event_length}(c),c.start_date=new Date(l),c.end_date=new Date(c.start_date.valueOf()+d),s){var u=e._get_section_property();e.config.multisection&&o[u]&&e.isMultisectionEvent&&e.isMultisectionEvent(o)?c[u]=o[u]:c[u]=s}return c},e._do_paste=function(o,l,s){e.callEvent("onBeforeEventPasted",[o,l,s])!==!1&&(e.addEvent(l),e.callEvent("onEventPasted",[o,l,s]))},e._is_key_nav_active=function(){return!(!this._is_initialized()||this._is_lightbox_open()||!this.config.key_nav)},e.event(document,"keydown",function(o){(o.ctrlKey||o.metaKey)&&o.keyCode==86&&e._buffer_event&&!e.$keyboardNavigation.dispatcher.isEnabled()&&(e.$keyboardNavigation.dispatcher.isActive=i())}),e._key_nav_copy_paste=function(o){if(!e._is_key_nav_active())return!0;if(o.keyCode==37||o.keyCode==39){o.cancelBubble=!0;var l=e.date.add(e._date,o.keyCode==37?-1:1,e._mode);return e.setCurrentView(l),!0}var s,d=(s=e.$keyboardNavigation.dispatcher.getActiveNode())&&s.eventId?s.eventId:e._select_id;if((o.ctrlKey||o.metaKey)&&o.keyCode==67)return d&&(e._buffer_event=a(e.getEvent(d)),t=!0,e.callEvent("onEventCopied",[e.getEvent(d)])),!0;if((o.ctrlKey||o.metaKey)&&o.keyCode==88&&d){t=!1;var c=e._buffer_event=a(e.getEvent(d));e.updateEvent(c.id),e.callEvent("onEventCut",[c])}if((o.ctrlKey||o.metaKey)&&o.keyCode==86&&i()){if(c=(c=e._buffer_event?e.getEvent(e._buffer_event.id):e._buffer_event)||e._buffer_event){var u=e._make_pasted_event(c);t?(u.id=e.uid(),e._do_paste(t,u,c)):e.callEvent("onBeforeEventChanged",[u,o,!1,c])&&(e._do_paste(t,u,c),t=!0)}return!0}}},e._temp_key_scope()}function R_(e){e.$keyboardNavigation.attachSchedulerHandlers=function(){var t,n=e.$keyboardNavigation.dispatcher,r=function(s){if(e.config.key_nav)return n.keyDownHandler(s)},i=function(){n.keepScrollPosition(function(){n.focusGlobalNode()})};e.attachEvent("onDataRender",function(){e.config.key_nav&&n.isEnabled()&&!e.getState().editor_id&&(clearTimeout(t),t=setTimeout(function(){if(e.$destroyed)return!0;n.isEnabled()||n.enable(),a()}))});var a=function(){if(n.isEnabled()){var s=n.getActiveNode();s&&(s.isValid()||(s=s.fallback()),!s||s instanceof e.$keyboardNavigation.MinicalButton||s instanceof e.$keyboardNavigation.MinicalCell||n.keepScrollPosition(function(){s.focus(!0)}))}};function o(s){if(!e.config.key_nav)return!0;const d=e.getView();let c=!1;if(e.getState().mode==="month")c=e.$keyboardNavigation.isChildOf(s.target||s.srcElement,e.$container.querySelector(".dhx_cal_month_table"));else if(d&&d.layout==="timeline")c=e.$keyboardNavigation.isChildOf(s.target||s.srcElement,e.$container.querySelector(".dhx_timeline_data_col"));else{const y=e.$container.querySelectorAll(".dhx_scale_holder");c=Array.from(y).some(g=>g===s.target.parentNode)}var u,f=e.getActionData(s);e._locate_event(s.target||s.srcElement)?u=new e.$keyboardNavigation.Event(e._locate_event(s.target||s.srcElement)):c&&(u=new e.$keyboardNavigation.TimeSlot,f.date&&c&&(u=u.nextSlot(new e.$keyboardNavigation.TimeSlot(f.date,null,f.section)))),u&&(n.isEnabled()?f.date&&c&&n.delay(function(){n.setActiveNode(u)}):n.activeNode=u)}e.attachEvent("onSchedulerReady",function(){var s=e.$container;e.eventRemove(document,"keydown",r),e.eventRemove(s,"mousedown",o),e.eventRemove(s,"focus",i),e.config.key_nav?(e.event(document,"keydown",r),e.event(s,"mousedown",o),e.event(s,"focus",i),s.setAttribute("tabindex","0")):s.removeAttribute("tabindex")});var l=e.updateEvent;e.updateEvent=function(s){var d=l.apply(this,arguments);if(e.config.key_nav&&n.isEnabled()&&e.getState().select_id==s){var c=new e.$keyboardNavigation.Event(s);e.getState().lightbox_id||function(u){if(e.config.key_nav&&n.isEnabled()){var f=u,y=new e.$keyboardNavigation.Event(f.eventId);if(!y.isValid()){var g=y.start||f.start,h=y.end||f.end,p=y.section||f.section;(y=new e.$keyboardNavigation.TimeSlot(g,h,p)).isValid()||(y=new e.$keyboardNavigation.TimeSlot)}n.setActiveNode(y);var v=n.getActiveNode();v&&v.getNode&&document.activeElement!=v.getNode()&&n.focusNode(n.getActiveNode())}}(c)}return d},e.attachEvent("onEventDeleted",function(s){return e.config.key_nav&&n.isEnabled()&&n.getActiveNode().eventId==s&&n.setActiveNode(new e.$keyboardNavigation.TimeSlot),!0}),e.attachEvent("onClearAll",function(){if(!e.config.key_nav)return!0;n.isEnabled()&&n.getActiveNode()instanceof e.$keyboardNavigation.Event&&n.setActiveNode(new e.$keyboardNavigation.TimeSlot)})}}class P_{constructor(t){this.map=null,this._markers=[],this.scheduler=t}onEventClick(t){if(this._markers&&this._markers.length>0){for(let n=0;n<this._markers.length;n++)if(t.id==this._markers[n].event.id){let r=this.settings.zoom_after_resolve||this.settings.initial_zoom;t.lat&&t.lng?(this.map.setCenter({lat:t.lat,lng:t.lng}),this.map.setZoom(r)):(this.map.setCenter({lat:this.settings.error_position.lat,lng:this.settings.error_position.lng}),this.map.setZoom(r)),google.maps.event.trigger(this._markers[n].marker,"click")}}}initialize(t,n){this.settings=n;let r=this.scheduler,i={center:{lat:n.initial_position.lat,lng:n.initial_position.lng},zoom:n.initial_zoom,mapId:t.id,scrollwheel:!0,mapTypeId:n.type};if(this.map===null)this.map=new google.maps.Map(t,i);else{let a=this.map;t.appendChild(this.map.__gm.messageOverlay),t.appendChild(this.map.__gm.outerContainer),setTimeout(function(){a.setOptions({container:t.id})},500)}google.maps.event.addListener(this.map,"dblclick",function(a){const o=new google.maps.Geocoder;if(!r.config.readonly&&r.config.dblclick_create){let l=a.latLng;o.geocode({latLng:l},function(s,d){d==google.maps.GeocoderStatus.OK?(l=s[0].geometry.location,r.addEventNow({lat:l.lat(),lng:l.lng(),event_location:s[0].formatted_address,start_date:r.getState().date,end_date:r.date.add(r.getState().date,r.config.time_step,"minute")})):console.error("Geocode was not successful for the following reason: "+d)})}})}destroy(t){for(google.maps.event.clearInstanceListeners(window),google.maps.event.clearInstanceListeners(document),google.maps.event.clearInstanceListeners(t);t.firstChild;)t.firstChild.remove();t.innerHTML=""}async addEventMarker(t){let n={title:t.text,position:{},map:{}};t.lat&&t.lng?n.position={lat:t.lat,lng:t.lng}:n.position={lat:this.settings.error_position.lat,lng:this.settings.error_position.lng};const{AdvancedMarkerElement:r}=await google.maps.importLibrary("marker");let i;this.scheduler.ext.mapView.createMarker?(n.map=this.map,i=this.scheduler.ext.mapView.createMarker(n)):(i=new r(n),i.map=this.map),i.setMap(this.map),t["!nativeeditor_status"]=="true_deleted"&&i.setMap(null),google.maps.event.addListener(i,"click",()=>{this.infoWindow&&this.infoWindow.close(),this.infoWindow=new google.maps.InfoWindow({maxWidth:this.settings.info_window_max_width}),this.infoWindow.setContent(this.scheduler.templates.map_info_content(t)),this.infoWindow.open({anchor:i,map:this.map})});let a={event:t,...n,marker:i};this._markers.push(a)}removeEventMarker(t){for(let n=0;n<this._markers.length;n++)t==this._markers[n].event.id&&(this._markers[n].marker.setVisible(!1),this._markers[n].marker.setMap(null),this._markers[n].marker.setPosition(null),this._markers[n].marker=null,this._markers.splice(n,1),n--)}updateEventMarker(t){for(let n=0;n<this._markers.length;n++)if(this._markers[n].event.id==t.id){this._markers[n].event=t,this._markers[n].position.lat=t.lat,this._markers[n].position.lng=t.lng,this._markers[n].text=t.text;let r=new google.maps.LatLng(t.lat,t.lng);this._markers[n].marker.setPosition(r)}}clearEventMarkers(){if(this._markers.length>0){for(let t=0;t<this._markers.length;t++)this._markers[t].marker.setMap(null);this._markers=[]}}setView(t,n,r){this.map.setCenter({lat:t,lng:n}),this.map.setZoom(r)}async resolveAddress(t){const n=new google.maps.Geocoder;return await new Promise(r=>{n.geocode({address:t},function(i,a){a==google.maps.GeocoderStatus.OK?r({lat:i[0].geometry.location.lat(),lng:i[0].geometry.location.lng()}):(console.error("Geocode was not successful for the following reason: "+a),r({}))})})}}class L_{constructor(t){this.map=null,this._markers=[],this.scheduler=t}onEventClick(t){if(this._markers&&this._markers.length>0)for(let n=0;n<this._markers.length;n++)t.id==this._markers[n].event.id&&(this._markers[n].marker.openPopup(),this._markers[n].marker.closeTooltip(),t.lat&&t.lng?this.setView(t.lat,t.lng,this.settings.zoom_after_resolve||this.settings.initial_zoom):this.setView(this.settings.error_position.lat,this.settings.error_position.lng,this.settings.zoom_after_resolve||this.settings.initial_zoom))}initialize(t,n){let r=this.scheduler,i=document.createElement("div");i.className="mapWrapper",i.id="mapWrapper",i.style.width=t.style.width,i.style.height=t.style.height,t.appendChild(i);let a=L.map(i,{center:L.latLng(n.initial_position.lat,n.initial_position.lng),zoom:n.initial_zoom,keyboard:!1});L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(a),a.on("dblclick",async function(o){let l=await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${o.latlng.lat}&lon=${o.latlng.lng}&format=json`,{method:"GET",headers:{"Accept-Language":"en"}}).then(s=>s.json());if(l.address){let s=l.address.country;r.addEventNow({lat:o.latlng.lat,lng:o.latlng.lng,event_location:s,start_date:r.getState().date,end_date:r.date.add(r.getState().date,r.config.time_step,"minute")})}else console.error("unable recieve a position of the event",l.error)}),this.map=a,this.settings=n}destroy(t){for(this.map.remove();t.firstChild;)t.firstChild.remove();t.innerHTML=""}addEventMarker(t){const n=L.icon({iconUrl:"https://unpkg.com/leaflet@1.0.3/dist/images/marker-icon.png",iconSize:[25,41],shadowSize:[30,65],iconAnchor:[12,41],shadowAnchor:[7,65]});let r={minWidth:180,maxWidth:this.settings.info_window_max_width};const i=L.popup(r).setContent(this.scheduler.templates.map_info_content(t)),a=L.tooltip().setContent(t.text);let o=[t.lat,t.lng];t.lat&&t.lng||(o=[this.settings.error_position.lat,this.settings.error_position.lng]);const l={event:t,marker:L.marker(o,{icon:n}).bindPopup(i).bindTooltip(a).addTo(this.map)};this._markers.push(l)}removeEventMarker(t){for(let n=0;n<this._markers.length;n++)t==this._markers[n].event.id&&(this.map.removeLayer(this._markers[n].marker),this._markers.splice(n,1),n--)}updateEventMarker(t){for(let n=0;n<this._markers.length;n++)this._markers[n].event.id==t.id&&(this._markers[n].event=t,t.lat&&t.lng?this._markers[n].marker.setLatLng([t.lat,t.lng]):this._markers[n].marker.setLatLng([this.settings.error_position.lat,this.settings.error_position.lng]))}clearEventMarkers(){if(this._markers){for(let t=0;t<this._markers.length;t++)this.map.removeLayer(this._markers[t].marker);this._markers=[]}}setView(t,n,r){this.map.setView([t,n],r)}async resolveAddress(t){let n={},r=await fetch(`https://nominatim.openstreetmap.org/search?q=${t}&format=json`,{method:"GET",headers:{"Accept-Language":"en"}}).then(i=>i.json());return r&&r.length?(n.lat=+r[0].lat,n.lng=+r[0].lon):console.error(`Unable recieve a position of the event's location: ${t}`),n}}class V_{constructor(t){this.map=null,this._markers=[],this.scheduler=t}onEventClick(t){if(this._markers&&this._markers.length>0)for(let n=0;n<this._markers.length;n++){const r=this._markers[n].marker.getPopup();r.isOpen()&&r.remove(),t.id==this._markers[n].event.id&&(this._markers[n].marker.togglePopup(),t.lat&&t.lng?this.setView(t.lat,t.lng,this.settings.zoom_after_resolve||this.settings.initial_zoom):this.setView(this.settings.error_position.lat,this.settings.error_position.lng,this.settings.zoom_after_resolve||this.settings.initial_zoom))}}initialize(t,n){let r=this.scheduler;mapboxgl.accessToken=n.accessToken;const i=new mapboxgl.Map({container:t,center:[n.initial_position.lng,n.initial_position.lat],zoom:n.initial_zoom+1});i.on("dblclick",async function(a){let o=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${a.lngLat.lng},${a.lngLat.lat}.json?access_token=${n.accessToken}`).then(l=>l.json());if(o.features){let l=o.features[0].place_name;r.addEventNow({lat:a.lngLat.lat,lng:a.lngLat.lng,event_location:l,start_date:r.getState().date,end_date:r.date.add(r.getState().date,r.config.time_step,"minute")})}else console.error("unable recieve a position of the event")}),this.map=i,this.settings=n}destroy(t){for(this.map.remove();t.firstChild;)t.firstChild.remove();t.innerHTML=""}addEventMarker(t){let n=[t.lng,t.lat];t.lat&&t.lng||(n=[this.settings.error_position.lng,this.settings.error_position.lat]);const r=new mapboxgl.Popup({offset:25,focusAfterOpen:!1}).setMaxWidth(`${this.settings.info_window_max_width}px`).setHTML(this.scheduler.templates.map_info_content(t)),i={event:t,marker:new mapboxgl.Marker().setLngLat(n).setPopup(r).addTo(this.map)};this._markers.push(i)}removeEventMarker(t){for(let n=0;n<this._markers.length;n++)t==this._markers[n].event.id&&(this._markers[n].marker.remove(),this._markers.splice(n,1),n--)}updateEventMarker(t){for(let n=0;n<this._markers.length;n++)this._markers[n].event.id==t.id&&(this._markers[n].event=t,t.lat&&t.lng?this._markers[n].marker.setLngLat([t.lng,t.lat]):this._markers[n].marker.setLngLat([this.settings.error_position.lng,this.settings.error_position.lat]))}clearEventMarkers(){for(let t=0;t<this._markers.length;t++)this._markers[t].marker.remove();this._markers=[]}setView(t,n,r){this.map.setCenter([n,t]),this.map.setZoom(r)}async resolveAddress(t){let n=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${t}.json?access_token=${this.settings.accessToken}`).then(i=>i.json()),r={};return n&&n.features.length?(r.lng=n.features[0].center[0],r.lat=n.features[0].center[1]):console.error(`Unable recieve a position of the event's location: ${t}`),r}}var Fa=["MO","TU","WE","TH","FR","SA","SU"],Fe=function(){function e(t,n){if(n===0)throw new Error("Can't create weekday with n == 0");this.weekday=t,this.n=n}return e.fromStr=function(t){return new e(Fa.indexOf(t))},e.prototype.nth=function(t){return this.n===t?this:new e(this.weekday,t)},e.prototype.equals=function(t){return this.weekday===t.weekday&&this.n===t.n},e.prototype.toString=function(){var t=Fa[this.weekday];return this.n&&(t=(this.n>0?"+":"")+String(this.n)+t),t},e.prototype.getJsWeekday=function(){return this.weekday===6?0:this.weekday+1},e}(),be=function(e){return e!=null},tt=function(e){return typeof e=="number"},es=function(e){return typeof e=="string"&&Fa.includes(e)},Be=Array.isArray,ot=function(e,t){t===void 0&&(t=e),arguments.length===1&&(t=e,e=0);for(var n=[],r=e;r<t;r++)n.push(r);return n},se=function(e,t){var n=0,r=[];if(Be(e))for(;n<t;n++)r[n]=[].concat(e);else for(;n<t;n++)r[n]=e;return r};function Gt(e,t,n){n===void 0&&(n=" ");var r=String(e);return t|=0,r.length>t?String(r):((t-=r.length)>n.length&&(n+=se(n,t/n.length)),n.slice(0,t)+String(r))}var Ke=function(e,t){var n=e%t;return n*t<0?n+t:n},Da=function(e,t){return{div:Math.floor(e/t),mod:Ke(e,t)}},rt=function(e){return!be(e)||e.length===0},ke=function(e){return!rt(e)},ce=function(e,t){return ke(e)&&e.indexOf(t)!==-1},Pt=function(e,t,n,r,i,a){return r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=0),new Date(Date.UTC(e,t-1,n,r,i,a))},$_=[31,28,31,30,31,30,31,31,30,31,30,31],Tl=864e5,Al=Pt(1970,1,1),H_=[6,0,1,2,3,4,5],Dn=function(e){return e%4==0&&e%100!=0||e%400==0},Sl=function(e){return e instanceof Date},Cn=function(e){return Sl(e)&&!isNaN(e.getTime())},Ua=function(e){return t=Al,n=e.getTime()-t.getTime(),Math.round(n/Tl);var t,n},Dl=function(e){return new Date(Al.getTime()+e*Tl)},F_=function(e){var t=e.getUTCMonth();return t===1&&Dn(e.getUTCFullYear())?29:$_[t]},en=function(e){return H_[e.getUTCDay()]},ts=function(e,t){var n=Pt(e,t+1,1);return[en(n),F_(n)]},Cl=function(e,t){return t=t||e,new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))},za=function(e){return new Date(e.getTime())},ns=function(e){for(var t=[],n=0;n<e.length;n++)t.push(za(e[n]));return t},Vn=function(e){e.sort(function(t,n){return t.getTime()-n.getTime()})},pi=function(e,t){t===void 0&&(t=!0);var n=new Date(e);return[Gt(n.getUTCFullYear().toString(),4,"0"),Gt(n.getUTCMonth()+1,2,"0"),Gt(n.getUTCDate(),2,"0"),"T",Gt(n.getUTCHours(),2,"0"),Gt(n.getUTCMinutes(),2,"0"),Gt(n.getUTCSeconds(),2,"0"),t?"Z":""].join("")},mi=function(e){var t=/^(\d{4})(\d{2})(\d{2})(T(\d{2})(\d{2})(\d{2})Z?)?$/.exec(e);if(!t)throw new Error("Invalid UNTIL value: ".concat(e));return new Date(Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[5],10)||0,parseInt(t[6],10)||0,parseInt(t[7],10)||0))},rs=function(e,t){return e.toLocaleString("sv-SE",{timeZone:t}).replace(" ","T")+"Z"},Zt=function(){function e(t,n){this.minDate=null,this.maxDate=null,this._result=[],this.total=0,this.method=t,this.args=n,t==="between"?(this.maxDate=n.inc?n.before:new Date(n.before.getTime()-1),this.minDate=n.inc?n.after:new Date(n.after.getTime()+1)):t==="before"?this.maxDate=n.inc?n.dt:new Date(n.dt.getTime()-1):t==="after"&&(this.minDate=n.inc?n.dt:new Date(n.dt.getTime()+1))}return e.prototype.accept=function(t){++this.total;var n=this.minDate&&t<this.minDate,r=this.maxDate&&t>this.maxDate;if(this.method==="between"){if(n)return!0;if(r)return!1}else if(this.method==="before"){if(r)return!1}else if(this.method==="after")return!!n||(this.add(t),!1);return this.add(t)},e.prototype.add=function(t){return this._result.push(t),!0},e.prototype.getValue=function(){var t=this._result;switch(this.method){case"all":case"between":return t;default:return t.length?t[t.length-1]:null}},e.prototype.clone=function(){return new e(this.method,this.args)},e}(),qa=function(e,t){return qa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},qa(e,t)};function gi(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}qa(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var We=function(){return We=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},We.apply(this,arguments)};function Y(e,t,n){for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var le,as=function(e){function t(n,r,i){var a=e.call(this,n,r)||this;return a.iterator=i,a}return gi(t,e),t.prototype.add=function(n){return!!this.iterator(n,this._result.length)&&(this._result.push(n),!0)},t}(Zt),Sr={dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],tokens:{SKIP:/^[ \r\n\t]+|^\.$/,number:/^[1-9][0-9]*/,numberAsText:/^(one|two|three)/i,every:/^every/i,"day(s)":/^days?/i,"weekday(s)":/^weekdays?/i,"week(s)":/^weeks?/i,"hour(s)":/^hours?/i,"minute(s)":/^minutes?/i,"month(s)":/^months?/i,"year(s)":/^years?/i,on:/^(on|in)/i,at:/^(at)/i,the:/^the/i,first:/^first/i,second:/^second/i,third:/^third/i,nth:/^([1-9][0-9]*)(\.|th|nd|rd|st)/i,last:/^last/i,for:/^for/i,"time(s)":/^times?/i,until:/^(un)?til/i,monday:/^mo(n(day)?)?/i,tuesday:/^tu(e(s(day)?)?)?/i,wednesday:/^we(d(n(esday)?)?)?/i,thursday:/^th(u(r(sday)?)?)?/i,friday:/^fr(i(day)?)?/i,saturday:/^sa(t(urday)?)?/i,sunday:/^su(n(day)?)?/i,january:/^jan(uary)?/i,february:/^feb(ruary)?/i,march:/^mar(ch)?/i,april:/^apr(il)?/i,may:/^may/i,june:/^june?/i,july:/^july?/i,august:/^aug(ust)?/i,september:/^sep(t(ember)?)?/i,october:/^oct(ober)?/i,november:/^nov(ember)?/i,december:/^dec(ember)?/i,comma:/^(,\s*|(and|or)\s*)+/i}},is=function(e,t){return e.indexOf(t)!==-1},U_=function(e){return e.toString()},z_=function(e,t,n){return"".concat(t," ").concat(n,", ").concat(e)},dt=function(){function e(t,n,r,i){if(n===void 0&&(n=U_),r===void 0&&(r=Sr),i===void 0&&(i=z_),this.text=[],this.language=r||Sr,this.gettext=n,this.dateFormatter=i,this.rrule=t,this.options=t.options,this.origOptions=t.origOptions,this.origOptions.bymonthday){var a=[].concat(this.options.bymonthday),o=[].concat(this.options.bynmonthday);a.sort(function(c,u){return c-u}),o.sort(function(c,u){return u-c}),this.bymonthday=a.concat(o),this.bymonthday.length||(this.bymonthday=null)}if(be(this.origOptions.byweekday)){var l=Be(this.origOptions.byweekday)?this.origOptions.byweekday:[this.origOptions.byweekday],s=String(l);this.byweekday={allWeeks:l.filter(function(c){return!c.n}),someWeeks:l.filter(function(c){return!!c.n}),isWeekdays:s.indexOf("MO")!==-1&&s.indexOf("TU")!==-1&&s.indexOf("WE")!==-1&&s.indexOf("TH")!==-1&&s.indexOf("FR")!==-1&&s.indexOf("SA")===-1&&s.indexOf("SU")===-1,isEveryDay:s.indexOf("MO")!==-1&&s.indexOf("TU")!==-1&&s.indexOf("WE")!==-1&&s.indexOf("TH")!==-1&&s.indexOf("FR")!==-1&&s.indexOf("SA")!==-1&&s.indexOf("SU")!==-1};var d=function(c,u){return c.weekday-u.weekday};this.byweekday.allWeeks.sort(d),this.byweekday.someWeeks.sort(d),this.byweekday.allWeeks.length||(this.byweekday.allWeeks=null),this.byweekday.someWeeks.length||(this.byweekday.someWeeks=null)}else this.byweekday=null}return e.isFullyConvertible=function(t){if(!(t.options.freq in e.IMPLEMENTED)||t.origOptions.until&&t.origOptions.count)return!1;for(var n in t.origOptions){if(is(["dtstart","tzid","wkst","freq"],n))return!0;if(!is(e.IMPLEMENTED[t.options.freq],n))return!1}return!0},e.prototype.isFullyConvertible=function(){return e.isFullyConvertible(this.rrule)},e.prototype.toString=function(){var t=this.gettext;if(!(this.options.freq in e.IMPLEMENTED))return t("RRule error: Unable to fully convert this rrule to text");if(this.text=[t("every")],this[j.FREQUENCIES[this.options.freq]](),this.options.until){this.add(t("until"));var n=this.options.until;this.add(this.dateFormatter(n.getUTCFullYear(),this.language.monthNames[n.getUTCMonth()],n.getUTCDate()))}else this.options.count&&this.add(t("for")).add(this.options.count.toString()).add(this.plural(this.options.count)?t("times"):t("time"));return this.isFullyConvertible()||this.add(t("(~ approximate)")),this.text.join("")},e.prototype.HOURLY=function(){var t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("hours"):t("hour"))},e.prototype.MINUTELY=function(){var t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("minutes"):t("minute"))},e.prototype.DAILY=function(){var t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.byweekday&&this.byweekday.isWeekdays?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(this.plural(this.options.interval)?t("days"):t("day")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday?this._byweekday():this.origOptions.byhour&&this._byhour()},e.prototype.WEEKLY=function(){var t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()).add(this.plural(this.options.interval)?t("weeks"):t("week")),this.byweekday&&this.byweekday.isWeekdays?this.options.interval===1?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(t("on")).add(t("weekdays")):this.byweekday&&this.byweekday.isEveryDay?this.add(this.plural(this.options.interval)?t("days"):t("day")):(this.options.interval===1&&this.add(t("week")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.origOptions.byhour&&this._byhour())},e.prototype.MONTHLY=function(){var t=this.gettext;this.origOptions.bymonth?(this.options.interval!==1&&(this.add(this.options.interval.toString()).add(t("months")),this.plural(this.options.interval)&&this.add(t("in"))),this._bymonth()):(this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("months"):t("month"))),this.bymonthday?this._bymonthday():this.byweekday&&this.byweekday.isWeekdays?this.add(t("on")).add(t("weekdays")):this.byweekday&&this._byweekday()},e.prototype.YEARLY=function(){var t=this.gettext;this.origOptions.bymonth?(this.options.interval!==1&&(this.add(this.options.interval.toString()),this.add(t("years"))),this._bymonth()):(this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("years"):t("year"))),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.options.byyearday&&this.add(t("on the")).add(this.list(this.options.byyearday,this.nth,t("and"))).add(t("day")),this.options.byweekno&&this.add(t("in")).add(this.plural(this.options.byweekno.length)?t("weeks"):t("week")).add(this.list(this.options.byweekno,void 0,t("and")))},e.prototype._bymonthday=function(){var t=this.gettext;this.byweekday&&this.byweekday.allWeeks?this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext,t("or"))).add(t("the")).add(this.list(this.bymonthday,this.nth,t("or"))):this.add(t("on the")).add(this.list(this.bymonthday,this.nth,t("and")))},e.prototype._byweekday=function(){var t=this.gettext;this.byweekday.allWeeks&&!this.byweekday.isWeekdays&&this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext)),this.byweekday.someWeeks&&(this.byweekday.allWeeks&&this.add(t("and")),this.add(t("on the")).add(this.list(this.byweekday.someWeeks,this.weekdaytext,t("and"))))},e.prototype._byhour=function(){var t=this.gettext;this.add(t("at")).add(this.list(this.origOptions.byhour,void 0,t("and")))},e.prototype._bymonth=function(){this.add(this.list(this.options.bymonth,this.monthtext,this.gettext("and")))},e.prototype.nth=function(t){var n;t=parseInt(t.toString(),10);var r=this.gettext;if(t===-1)return r("last");var i=Math.abs(t);switch(i){case 1:case 21:case 31:n=i+r("st");break;case 2:case 22:n=i+r("nd");break;case 3:case 23:n=i+r("rd");break;default:n=i+r("th")}return t<0?n+" "+r("last"):n},e.prototype.monthtext=function(t){return this.language.monthNames[t-1]},e.prototype.weekdaytext=function(t){var n=tt(t)?(t+1)%7:t.getJsWeekday();return(t.n?this.nth(t.n)+" ":"")+this.language.dayNames[n]},e.prototype.plural=function(t){return t%100!=1},e.prototype.add=function(t){return this.text.push(" "),this.text.push(t),this},e.prototype.list=function(t,n,r,i){var a=this;i===void 0&&(i=","),Be(t)||(t=[t]),n=n||function(l){return l.toString()};var o=function(l){return n&&n.call(a,l)};return r?function(l,s,d){for(var c="",u=0;u<l.length;u++)u!==0&&(u===l.length-1?c+=" "+d+" ":c+=s+" "),c+=l[u];return c}(t.map(o),i,r):t.map(o).join(i+" ")},e}(),q_=function(){function e(t){this.done=!0,this.rules=t}return e.prototype.start=function(t){return this.text=t,this.done=!1,this.nextSymbol()},e.prototype.isDone=function(){return this.done&&this.symbol===null},e.prototype.nextSymbol=function(){var t,n;this.symbol=null,this.value=null;do{if(this.done)return!1;for(var r in t=null,this.rules){var i=this.rules[r].exec(this.text);i&&(t===null||i[0].length>t[0].length)&&(t=i,n=r)}if(t!=null&&(this.text=this.text.substr(t[0].length),this.text===""&&(this.done=!0)),t==null)return this.done=!0,this.symbol=null,void(this.value=null)}while(n==="SKIP");return this.symbol=n,this.value=t,!0},e.prototype.accept=function(t){if(this.symbol===t){if(this.value){var n=this.value;return this.nextSymbol(),n}return this.nextSymbol(),!0}return!1},e.prototype.acceptNumber=function(){return this.accept("number")},e.prototype.expect=function(t){if(this.accept(t))return!0;throw new Error("expected "+t+" but found "+this.symbol)},e}();function Nl(e,t){t===void 0&&(t=Sr);var n={},r=new q_(t.tokens);return r.start(e)?(function(){r.expect("every");var c=r.acceptNumber();if(c&&(n.interval=parseInt(c[0],10)),r.isDone())throw new Error("Unexpected end");switch(r.symbol){case"day(s)":n.freq=j.DAILY,r.nextSymbol()&&(a(),d());break;case"weekday(s)":n.freq=j.WEEKLY,n.byweekday=[j.MO,j.TU,j.WE,j.TH,j.FR],r.nextSymbol(),a(),d();break;case"week(s)":n.freq=j.WEEKLY,r.nextSymbol()&&(i(),a(),d());break;case"hour(s)":n.freq=j.HOURLY,r.nextSymbol()&&(i(),d());break;case"minute(s)":n.freq=j.MINUTELY,r.nextSymbol()&&(i(),d());break;case"month(s)":n.freq=j.MONTHLY,r.nextSymbol()&&(i(),d());break;case"year(s)":n.freq=j.YEARLY,r.nextSymbol()&&(i(),d());break;case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":n.freq=j.WEEKLY;var u=r.symbol.substr(0,2).toUpperCase();if(n.byweekday=[j[u]],!r.nextSymbol())return;for(;r.accept("comma");){if(r.isDone())throw new Error("Unexpected end");var f=l();if(!f)throw new Error("Unexpected symbol "+r.symbol+", expected weekday");n.byweekday.push(j[f]),r.nextSymbol()}a(),function(){r.accept("on"),r.accept("the");var g=s();if(g)for(n.bymonthday=[g],r.nextSymbol();r.accept("comma");){if(!(g=s()))throw new Error("Unexpected symbol "+r.symbol+"; expected monthday");n.bymonthday.push(g),r.nextSymbol()}}(),d();break;case"january":case"february":case"march":case"april":case"may":case"june":case"july":case"august":case"september":case"october":case"november":case"december":if(n.freq=j.YEARLY,n.bymonth=[o()],!r.nextSymbol())return;for(;r.accept("comma");){if(r.isDone())throw new Error("Unexpected end");var y=o();if(!y)throw new Error("Unexpected symbol "+r.symbol+", expected month");n.bymonth.push(y),r.nextSymbol()}i(),d();break;default:throw new Error("Unknown symbol")}}(),n):null;function i(){var c=r.accept("on"),u=r.accept("the");if(c||u)do{var f=s(),y=l(),g=o();if(f)y?(r.nextSymbol(),n.byweekday||(n.byweekday=[]),n.byweekday.push(j[y].nth(f))):(n.bymonthday||(n.bymonthday=[]),n.bymonthday.push(f),r.accept("day(s)"));else if(y)r.nextSymbol(),n.byweekday||(n.byweekday=[]),n.byweekday.push(j[y]);else if(r.symbol==="weekday(s)")r.nextSymbol(),n.byweekday||(n.byweekday=[j.MO,j.TU,j.WE,j.TH,j.FR]);else if(r.symbol==="week(s)"){r.nextSymbol();var h=r.acceptNumber();if(!h)throw new Error("Unexpected symbol "+r.symbol+", expected week number");for(n.byweekno=[parseInt(h[0],10)];r.accept("comma");){if(!(h=r.acceptNumber()))throw new Error("Unexpected symbol "+r.symbol+"; expected monthday");n.byweekno.push(parseInt(h[0],10))}}else{if(!g)return;r.nextSymbol(),n.bymonth||(n.bymonth=[]),n.bymonth.push(g)}}while(r.accept("comma")||r.accept("the")||r.accept("on"))}function a(){if(r.accept("at"))do{var c=r.acceptNumber();if(!c)throw new Error("Unexpected symbol "+r.symbol+", expected hour");for(n.byhour=[parseInt(c[0],10)];r.accept("comma");){if(!(c=r.acceptNumber()))throw new Error("Unexpected symbol "+r.symbol+"; expected hour");n.byhour.push(parseInt(c[0],10))}}while(r.accept("comma")||r.accept("at"))}function o(){switch(r.symbol){case"january":return 1;case"february":return 2;case"march":return 3;case"april":return 4;case"may":return 5;case"june":return 6;case"july":return 7;case"august":return 8;case"september":return 9;case"october":return 10;case"november":return 11;case"december":return 12;default:return!1}}function l(){switch(r.symbol){case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":return r.symbol.substr(0,2).toUpperCase();default:return!1}}function s(){switch(r.symbol){case"last":return r.nextSymbol(),-1;case"first":return r.nextSymbol(),1;case"second":return r.nextSymbol(),r.accept("last")?-2:2;case"third":return r.nextSymbol(),r.accept("last")?-3:3;case"nth":var c=parseInt(r.value[1],10);if(c<-366||c>366)throw new Error("Nth out of range: "+c);return r.nextSymbol(),r.accept("last")?-c:c;default:return!1}}function d(){if(r.symbol==="until"){var c=Date.parse(r.text);if(!c)throw new Error("Cannot parse until date:"+r.text);n.until=new Date(c)}else r.accept("for")&&(n.count=parseInt(r.value[0],10),r.expect("number"))}}function Ca(e){return e<le.HOURLY}(function(e){e[e.YEARLY=0]="YEARLY",e[e.MONTHLY=1]="MONTHLY",e[e.WEEKLY=2]="WEEKLY",e[e.DAILY=3]="DAILY",e[e.HOURLY=4]="HOURLY",e[e.MINUTELY=5]="MINUTELY",e[e.SECONDLY=6]="SECONDLY"})(le||(le={}));var j_=function(e,t){return t===void 0&&(t=Sr),new j(Nl(e,t)||void 0)},Jt=["count","until","interval","byweekday","bymonthday","bymonth"];dt.IMPLEMENTED=[],dt.IMPLEMENTED[le.HOURLY]=Jt,dt.IMPLEMENTED[le.MINUTELY]=Jt,dt.IMPLEMENTED[le.DAILY]=["byhour"].concat(Jt),dt.IMPLEMENTED[le.WEEKLY]=Jt,dt.IMPLEMENTED[le.MONTHLY]=Jt,dt.IMPLEMENTED[le.YEARLY]=["byweekno","byyearday"].concat(Jt);var B_=dt.isFullyConvertible,Dr=function(){function e(t,n,r,i){this.hour=t,this.minute=n,this.second=r,this.millisecond=i||0}return e.prototype.getHours=function(){return this.hour},e.prototype.getMinutes=function(){return this.minute},e.prototype.getSeconds=function(){return this.second},e.prototype.getMilliseconds=function(){return this.millisecond},e.prototype.getTime=function(){return 1e3*(60*this.hour*60+60*this.minute+this.second)+this.millisecond},e}(),Y_=function(e){function t(n,r,i,a,o,l,s){var d=e.call(this,a,o,l,s)||this;return d.year=n,d.month=r,d.day=i,d}return gi(t,e),t.fromDate=function(n){return new this(n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.valueOf()%1e3)},t.prototype.getWeekday=function(){return en(new Date(this.getTime()))},t.prototype.getTime=function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond)).getTime()},t.prototype.getDay=function(){return this.day},t.prototype.getMonth=function(){return this.month},t.prototype.getYear=function(){return this.year},t.prototype.addYears=function(n){this.year+=n},t.prototype.addMonths=function(n){if(this.month+=n,this.month>12){var r=Math.floor(this.month/12),i=Ke(this.month,12);this.month=i,this.year+=r,this.month===0&&(this.month=12,--this.year)}},t.prototype.addWeekly=function(n,r){r>this.getWeekday()?this.day+=-(this.getWeekday()+1+(6-r))+7*n:this.day+=-(this.getWeekday()-r)+7*n,this.fixDay()},t.prototype.addDaily=function(n){this.day+=n,this.fixDay()},t.prototype.addHours=function(n,r,i){for(r&&(this.hour+=Math.floor((23-this.hour)/n)*n);;){this.hour+=n;var a=Da(this.hour,24),o=a.div,l=a.mod;if(o&&(this.hour=l,this.addDaily(o)),rt(i)||ce(i,this.hour))break}},t.prototype.addMinutes=function(n,r,i,a){for(r&&(this.minute+=Math.floor((1439-(60*this.hour+this.minute))/n)*n);;){this.minute+=n;var o=Da(this.minute,60),l=o.div,s=o.mod;if(l&&(this.minute=s,this.addHours(l,!1,i)),(rt(i)||ce(i,this.hour))&&(rt(a)||ce(a,this.minute)))break}},t.prototype.addSeconds=function(n,r,i,a,o){for(r&&(this.second+=Math.floor((86399-(3600*this.hour+60*this.minute+this.second))/n)*n);;){this.second+=n;var l=Da(this.second,60),s=l.div,d=l.mod;if(s&&(this.second=d,this.addMinutes(s,!1,i,a)),(rt(i)||ce(i,this.hour))&&(rt(a)||ce(a,this.minute))&&(rt(o)||ce(o,this.second)))break}},t.prototype.fixDay=function(){if(!(this.day<=28)){var n=ts(this.year,this.month-1)[1];if(!(this.day<=n))for(;this.day>n;){if(this.day-=n,++this.month,this.month===13&&(this.month=1,++this.year,this.year>9999))return;n=ts(this.year,this.month-1)[1]}}},t.prototype.add=function(n,r){var i=n.freq,a=n.interval,o=n.wkst,l=n.byhour,s=n.byminute,d=n.bysecond;switch(i){case le.YEARLY:return this.addYears(a);case le.MONTHLY:return this.addMonths(a);case le.WEEKLY:return this.addWeekly(a,o);case le.DAILY:return this.addDaily(a);case le.HOURLY:return this.addHours(a,r,l);case le.MINUTELY:return this.addMinutes(a,r,l,s);case le.SECONDLY:return this.addSeconds(a,r,l,s,d)}},t}(Dr);function Il(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];ce(pu,i)||t.push(i),Sl(e[i])&&!Cn(e[i])&&t.push(i)}if(t.length)throw new Error("Invalid options: "+t.join(", "));return We({},e)}function W_(e){var t=We(We({},vi),Il(e));if(be(t.byeaster)&&(t.freq=j.YEARLY),!be(t.freq)||!j.FREQUENCIES[t.freq])throw new Error("Invalid frequency: ".concat(t.freq," ").concat(e.freq));if(t.dtstart||(t.dtstart=new Date(new Date().setMilliseconds(0))),be(t.wkst)?tt(t.wkst)||(t.wkst=t.wkst.weekday):t.wkst=j.MO.weekday,be(t.bysetpos)){tt(t.bysetpos)&&(t.bysetpos=[t.bysetpos]);for(var n=0;n<t.bysetpos.length;n++)if((a=t.bysetpos[n])===0||!(a>=-366&&a<=366))throw new Error("bysetpos must be between 1 and 366, or between -366 and -1")}if(!(t.byweekno||ke(t.byweekno)||ke(t.byyearday)||t.bymonthday||ke(t.bymonthday)||be(t.byweekday)||be(t.byeaster)))switch(t.freq){case j.YEARLY:t.bymonth||(t.bymonth=t.dtstart.getUTCMonth()+1),t.bymonthday=t.dtstart.getUTCDate();break;case j.MONTHLY:t.bymonthday=t.dtstart.getUTCDate();break;case j.WEEKLY:t.byweekday=[en(t.dtstart)]}if(be(t.bymonth)&&!Be(t.bymonth)&&(t.bymonth=[t.bymonth]),be(t.byyearday)&&!Be(t.byyearday)&&tt(t.byyearday)&&(t.byyearday=[t.byyearday]),be(t.bymonthday))if(Be(t.bymonthday)){var r=[],i=[];for(n=0;n<t.bymonthday.length;n++){var a;(a=t.bymonthday[n])>0?r.push(a):a<0&&i.push(a)}t.bymonthday=r,t.bynmonthday=i}else t.bymonthday<0?(t.bynmonthday=[t.bymonthday],t.bymonthday=[]):(t.bynmonthday=[],t.bymonthday=[t.bymonthday]);else t.bymonthday=[],t.bynmonthday=[];if(be(t.byweekno)&&!Be(t.byweekno)&&(t.byweekno=[t.byweekno]),be(t.byweekday))if(tt(t.byweekday))t.byweekday=[t.byweekday],t.bynweekday=null;else if(es(t.byweekday))t.byweekday=[Fe.fromStr(t.byweekday).weekday],t.bynweekday=null;else if(t.byweekday instanceof Fe)!t.byweekday.n||t.freq>j.MONTHLY?(t.byweekday=[t.byweekday.weekday],t.bynweekday=null):(t.bynweekday=[[t.byweekday.weekday,t.byweekday.n]],t.byweekday=null);else{var o=[],l=[];for(n=0;n<t.byweekday.length;n++){var s=t.byweekday[n];tt(s)?o.push(s):es(s)?o.push(Fe.fromStr(s).weekday):!s.n||t.freq>j.MONTHLY?o.push(s.weekday):l.push([s.weekday,s.n])}t.byweekday=ke(o)?o:null,t.bynweekday=ke(l)?l:null}else t.bynweekday=null;return be(t.byhour)?tt(t.byhour)&&(t.byhour=[t.byhour]):t.byhour=t.freq<j.HOURLY?[t.dtstart.getUTCHours()]:null,be(t.byminute)?tt(t.byminute)&&(t.byminute=[t.byminute]):t.byminute=t.freq<j.MINUTELY?[t.dtstart.getUTCMinutes()]:null,be(t.bysecond)?tt(t.bysecond)&&(t.bysecond=[t.bysecond]):t.bysecond=t.freq<j.SECONDLY?[t.dtstart.getUTCSeconds()]:null,{parsedOptions:t}}function ja(e){var t=e.split(`
`).map(K_).filter(function(n){return n!==null});return We(We({},t[0]),t[1])}function Cr(e){var t={},n=/DTSTART(?:;TZID=([^:=]+?))?(?::|=)([^;\s]+)/i.exec(e);if(!n)return t;var r=n[1],i=n[2];return r&&(t.tzid=r),t.dtstart=mi(i),t}function K_(e){if(!(e=e.replace(/^\s+|\s+$/,"")).length)return null;var t=/^([A-Z]+?)[:;]/.exec(e.toUpperCase());if(!t)return os(e);var n=t[1];switch(n.toUpperCase()){case"RRULE":case"EXRULE":return os(e);case"DTSTART":return Cr(e);default:throw new Error("Unsupported RFC prop ".concat(n," in ").concat(e))}}function os(e){var t=Cr(e.replace(/^RRULE:/i,""));return e.replace(/^(?:RRULE|EXRULE):/i,"").split(";").forEach(function(n){var r=n.split("="),i=r[0],a=r[1];switch(i.toUpperCase()){case"FREQ":t.freq=le[a.toUpperCase()];break;case"WKST":t.wkst=Je[a.toUpperCase()];break;case"COUNT":case"INTERVAL":case"BYSETPOS":case"BYMONTH":case"BYMONTHDAY":case"BYYEARDAY":case"BYWEEKNO":case"BYHOUR":case"BYMINUTE":case"BYSECOND":var o=function(d){return d.indexOf(",")!==-1?d.split(",").map(ss):ss(d)}(a),l=i.toLowerCase();t[l]=o;break;case"BYWEEKDAY":case"BYDAY":t.byweekday=function(d){var c=d.split(",");return c.map(function(u){if(u.length===2)return Je[u];var f=u.match(/^([+-]?\d{1,2})([A-Z]{2})$/);if(!f||f.length<3)throw new SyntaxError("Invalid weekday string: ".concat(u));var y=Number(f[1]),g=f[2],h=Je[g].weekday;return new Fe(h,y)})}(a);break;case"DTSTART":case"TZID":var s=Cr(e);t.tzid=s.tzid,t.dtstart=s.dtstart;break;case"UNTIL":t.until=mi(a);break;case"BYEASTER":t.byeaster=Number(a);break;default:throw new Error("Unknown RRULE property '"+i+"'")}}),t}function ss(e){return/^[+-]?\d+$/.test(e)?Number(e):e}var Nr=function(){function e(t,n){if(isNaN(t.getTime()))throw new RangeError("Invalid date passed to DateWithZone");this.date=t,this.tzid=n}return Object.defineProperty(e.prototype,"isUTC",{get:function(){return!this.tzid||this.tzid.toUpperCase()==="UTC"},enumerable:!1,configurable:!0}),e.prototype.toString=function(){var t=pi(this.date.getTime(),this.isUTC);return this.isUTC?":".concat(t):";TZID=".concat(this.tzid,":").concat(t)},e.prototype.getTime=function(){return this.date.getTime()},e.prototype.rezonedDate=function(){return this.isUTC?this.date:(t=this.date,n=this.tzid,r=Intl.DateTimeFormat().resolvedOptions().timeZone,i=new Date(rs(t,r)),a=new Date(rs(t,n??"UTC")).getTime()-i.getTime(),new Date(t.getTime()-a));var t,n,r,i,a},e}();function Ba(e){for(var t,n=[],r="",i=Object.keys(e),a=Object.keys(vi),o=0;o<i.length;o++)if(i[o]!=="tzid"&&ce(a,i[o])){var l=i[o].toUpperCase(),s=e[i[o]],d="";if(be(s)&&(!Be(s)||s.length)){switch(l){case"FREQ":d=j.FREQUENCIES[e.freq];break;case"WKST":d=tt(s)?new Fe(s).toString():s.toString();break;case"BYWEEKDAY":l="BYDAY",d=(t=s,Be(t)?t:[t]).map(function(g){return g instanceof Fe?g:Be(g)?new Fe(g[0],g[1]):new Fe(g)}).toString();break;case"DTSTART":r=G_(s,e.tzid);break;case"UNTIL":d=pi(s,!e.tzid);break;default:if(Be(s)){for(var c=[],u=0;u<s.length;u++)c[u]=String(s[u]);d=c.toString()}else d=String(s)}d&&n.push([l,d])}}var f=n.map(function(g){var h=g[0],p=g[1];return"".concat(h,"=").concat(p.toString())}).join(";"),y="";return f!==""&&(y="RRULE:".concat(f)),[r,y].filter(function(g){return!!g}).join(`
`)}function G_(e,t){return e?"DTSTART"+new Nr(new Date(e),t).toString():""}function J_(e,t){return Array.isArray(e)?!!Array.isArray(t)&&e.length===t.length&&e.every(function(n,r){return n.getTime()===t[r].getTime()}):e instanceof Date?t instanceof Date&&e.getTime()===t.getTime():e===t}var Q_=function(){function e(){this.all=!1,this.before=[],this.after=[],this.between=[]}return e.prototype._cacheAdd=function(t,n,r){n&&(n=n instanceof Date?za(n):ns(n)),t==="all"?this.all=n:(r._value=n,this[t].push(r))},e.prototype._cacheGet=function(t,n){var r=!1,i=n?Object.keys(n):[],a=function(c){for(var u=0;u<i.length;u++){var f=i[u];if(!J_(n[f],c[f]))return!0}return!1},o=this[t];if(t==="all")r=this.all;else if(Be(o))for(var l=0;l<o.length;l++){var s=o[l];if(!i.length||!a(s)){r=s._value;break}}if(!r&&this.all){var d=new Zt(t,n);for(l=0;l<this.all.length&&d.accept(this.all[l]);l++);r=d.getValue(),this._cacheAdd(t,r,n)}return Be(r)?ns(r):r instanceof Date?za(r):r},e}(),X_=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],se(1,31),!0),se(2,28),!0),se(3,31),!0),se(4,30),!0),se(5,31),!0),se(6,30),!0),se(7,31),!0),se(8,31),!0),se(9,30),!0),se(10,31),!0),se(11,30),!0),se(12,31),!0),se(1,7)),Z_=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],se(1,31),!0),se(2,29),!0),se(3,31),!0),se(4,30),!0),se(5,31),!0),se(6,30),!0),se(7,31),!0),se(8,31),!0),se(9,30),!0),se(10,31),!0),se(11,30),!0),se(12,31),!0),se(1,7)),eu=ot(1,29),tu=ot(1,30),bt=ot(1,31),Oe=ot(1,32),nu=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],Oe,!0),tu,!0),Oe,!0),bt,!0),Oe,!0),bt,!0),Oe,!0),Oe,!0),bt,!0),Oe,!0),bt,!0),Oe,!0),Oe.slice(0,7)),ru=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],Oe,!0),eu,!0),Oe,!0),bt,!0),Oe,!0),bt,!0),Oe,!0),Oe,!0),bt,!0),Oe,!0),bt,!0),Oe,!0),Oe.slice(0,7)),au=ot(-28,0),iu=ot(-29,0),wt=ot(-30,0),Re=ot(-31,0),ou=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],Re,!0),iu,!0),Re,!0),wt,!0),Re,!0),wt,!0),Re,!0),Re,!0),wt,!0),Re,!0),wt,!0),Re,!0),Re.slice(0,7)),su=Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y([],Re,!0),au,!0),Re,!0),wt,!0),Re,!0),wt,!0),Re,!0),Re,!0),wt,!0),Re,!0),wt,!0),Re,!0),Re.slice(0,7)),lu=[0,31,60,91,121,152,182,213,244,274,305,335,366],du=[0,31,59,90,120,151,181,212,243,273,304,334,365],ls=function(){for(var e=[],t=0;t<55;t++)e=e.concat(ot(7));return e}();function cu(e,t){var n,r,i=Pt(e,1,1),a=Dn(e)?366:365,o=Dn(e+1)?366:365,l=Ua(i),s=en(i),d=We(We({yearlen:a,nextyearlen:o,yearordinal:l,yearweekday:s},function(A){var m=Dn(A)?366:365,b=Pt(A,1,1),k=en(b);return m===365?{mmask:X_,mdaymask:ru,nmdaymask:su,wdaymask:ls.slice(k),mrange:du}:{mmask:Z_,mdaymask:nu,nmdaymask:ou,wdaymask:ls.slice(k),mrange:lu}}(e)),{wnomask:null});if(rt(t.byweekno))return d;d.wnomask=se(0,a+7);var c=n=Ke(7-s+t.wkst,7);c>=4?(c=0,r=d.yearlen+Ke(s-t.wkst,7)):r=a-c;for(var u=Math.floor(r/7),f=Ke(r,7),y=Math.floor(u+f/4),g=0;g<t.byweekno.length;g++){var h=t.byweekno[g];if(h<0&&(h+=y+1),h>0&&h<=y){var p=void 0;h>1?(p=c+7*(h-1),c!==n&&(p-=7-n)):p=c;for(var v=0;v<7&&(d.wnomask[p]=1,p++,d.wdaymask[p]!==t.wkst);v++);}}if(ce(t.byweekno,1)&&(p=c+7*y,c!==n&&(p-=7-n),p<a))for(g=0;g<7&&(d.wnomask[p]=1,p+=1,d.wdaymask[p]!==t.wkst);g++);if(c){var x=void 0;if(ce(t.byweekno,-1))x=-1;else{var S=en(Pt(e-1,1,1)),O=Ke(7-S.valueOf()+t.wkst,7),N=Dn(e-1)?366:365,I=void 0;O>=4?(O=0,I=N+Ke(S-t.wkst,7)):I=a-c,x=Math.floor(52+Ke(I,7)/4)}if(ce(t.byweekno,x))for(p=0;p<c;p++)d.wnomask[p]=1}return d}var _u=function(){function e(t){this.options=t}return e.prototype.rebuild=function(t,n){var r=this.options;if(t!==this.lastyear&&(this.yearinfo=cu(t,r)),ke(r.bynweekday)&&(n!==this.lastmonth||t!==this.lastyear)){var i=this.yearinfo,a=i.yearlen,o=i.mrange,l=i.wdaymask;this.monthinfo=function(s,d,c,u,f,y){var g={lastyear:s,lastmonth:d,nwdaymask:[]},h=[];if(y.freq===j.YEARLY)if(rt(y.bymonth))h=[[0,c]];else for(var p=0;p<y.bymonth.length;p++)d=y.bymonth[p],h.push(u.slice(d-1,d+1));else y.freq===j.MONTHLY&&(h=[u.slice(d-1,d+1)]);if(rt(h))return g;for(g.nwdaymask=se(0,c),p=0;p<h.length;p++)for(var v=h[p],x=v[0],S=v[1]-1,O=0;O<y.bynweekday.length;O++){var N=void 0,I=y.bynweekday[O],A=I[0],m=I[1];m<0?(N=S+7*(m+1),N-=Ke(f[N]-A,7)):(N=x+7*(m-1),N+=Ke(7-f[N]+A,7)),x<=N&&N<=S&&(g.nwdaymask[N]=1)}return g}(t,n,a,o,l,r)}be(r.byeaster)&&(this.eastermask=function(s,d){d===void 0&&(d=0);var c=s%19,u=Math.floor(s/100),f=s%100,y=Math.floor(u/4),g=u%4,h=Math.floor((u+8)/25),p=Math.floor((u-h+1)/3),v=Math.floor(19*c+u-y-p+15)%30,x=Math.floor(f/4),S=f%4,O=Math.floor(32+2*g+2*x-v-S)%7,N=Math.floor((c+11*v+22*O)/451),I=Math.floor((v+O-7*N+114)/31),A=(v+O-7*N+114)%31+1,m=Date.UTC(s,I-1,A+d),b=Date.UTC(s,0,1);return[Math.ceil((m-b)/864e5)]}(t,r.byeaster))},Object.defineProperty(e.prototype,"lastyear",{get:function(){return this.monthinfo?this.monthinfo.lastyear:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastmonth",{get:function(){return this.monthinfo?this.monthinfo.lastmonth:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yearlen",{get:function(){return this.yearinfo.yearlen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yearordinal",{get:function(){return this.yearinfo.yearordinal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mrange",{get:function(){return this.yearinfo.mrange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wdaymask",{get:function(){return this.yearinfo.wdaymask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mmask",{get:function(){return this.yearinfo.mmask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wnomask",{get:function(){return this.yearinfo.wnomask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nwdaymask",{get:function(){return this.monthinfo?this.monthinfo.nwdaymask:[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextyearlen",{get:function(){return this.yearinfo.nextyearlen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mdaymask",{get:function(){return this.yearinfo.mdaymask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nmdaymask",{get:function(){return this.yearinfo.nmdaymask},enumerable:!1,configurable:!0}),e.prototype.ydayset=function(){return[ot(this.yearlen),0,this.yearlen]},e.prototype.mdayset=function(t,n){for(var r=this.mrange[n-1],i=this.mrange[n],a=se(null,this.yearlen),o=r;o<i;o++)a[o]=o;return[a,r,i]},e.prototype.wdayset=function(t,n,r){for(var i=se(null,this.yearlen+7),a=Ua(Pt(t,n,r))-this.yearordinal,o=a,l=0;l<7&&(i[a]=a,++a,this.wdaymask[a]!==this.options.wkst);l++);return[i,o,a]},e.prototype.ddayset=function(t,n,r){var i=se(null,this.yearlen),a=Ua(Pt(t,n,r))-this.yearordinal;return i[a]=a,[i,a,a+1]},e.prototype.htimeset=function(t,n,r,i){var a=this,o=[];return this.options.byminute.forEach(function(l){o=o.concat(a.mtimeset(t,l,r,i))}),Vn(o),o},e.prototype.mtimeset=function(t,n,r,i){var a=this.options.bysecond.map(function(o){return new Dr(t,n,o,i)});return Vn(a),a},e.prototype.stimeset=function(t,n,r,i){return[new Dr(t,n,r,i)]},e.prototype.getdayset=function(t){switch(t){case le.YEARLY:return this.ydayset.bind(this);case le.MONTHLY:return this.mdayset.bind(this);case le.WEEKLY:return this.wdayset.bind(this);case le.DAILY:default:return this.ddayset.bind(this)}},e.prototype.gettimeset=function(t){switch(t){case le.HOURLY:return this.htimeset.bind(this);case le.MINUTELY:return this.mtimeset.bind(this);case le.SECONDLY:return this.stimeset.bind(this)}},e}();function uu(e,t,n,r,i,a){for(var o=[],l=0;l<e.length;l++){var s=void 0,d=void 0,c=e[l];c<0?(s=Math.floor(c/t.length),d=Ke(c,t.length)):(s=Math.floor((c-1)/t.length),d=Ke(c-1,t.length));for(var u=[],f=n;f<r;f++){var y=a[f];be(y)&&u.push(y)}var g=void 0;g=s<0?u.slice(s)[0]:u[s];var h=t[d],p=Dl(i.yearordinal+g),v=Cl(p,h);ce(o,v)||o.push(v)}return Vn(o),o}function Ml(e,t){var n=t.dtstart,r=t.freq,i=t.interval,a=t.until,o=t.bysetpos,l=t.count;if(l===0||i===0)return An(e);var s=Y_.fromDate(n),d=new _u(t);d.rebuild(s.year,s.month);for(var c=function(m,b,k){var E=k.freq,D=k.byhour,C=k.byminute,R=k.bysecond;return Ca(E)?function(P){var F=P.dtstart.getTime()%1e3;if(!Ca(P.freq))return[];var q=[];return P.byhour.forEach(function($){P.byminute.forEach(function(X){P.bysecond.forEach(function(te){q.push(new Dr($,X,te,F))})})}),q}(k):E>=j.HOURLY&&ke(D)&&!ce(D,b.hour)||E>=j.MINUTELY&&ke(C)&&!ce(C,b.minute)||E>=j.SECONDLY&&ke(R)&&!ce(R,b.second)?[]:m.gettimeset(E)(b.hour,b.minute,b.second,b.millisecond)}(d,s,t);;){var u=d.getdayset(r)(s.year,s.month,s.day),f=u[0],y=u[1],g=u[2],h=fu(f,y,g,d,t);if(ke(o))for(var p=uu(o,c,y,g,d,f),v=0;v<p.length;v++){var x=p[v];if(a&&x>a)return An(e);if(x>=n){var S=ds(x,t);if(!e.accept(S)||l&&!--l)return An(e)}}else for(v=y;v<g;v++){var O=f[v];if(be(O))for(var N=Dl(d.yearordinal+O),I=0;I<c.length;I++){var A=c[I];if(x=Cl(N,A),a&&x>a||x>=n&&(S=ds(x,t),!e.accept(S)||l&&!--l))return An(e)}}if(t.interval===0||(s.add(t,h),s.year>9999))return An(e);Ca(r)||(c=d.gettimeset(r)(s.hour,s.minute,s.second,0)),d.rebuild(s.year,s.month)}}function hu(e,t,n){var r=n.bymonth,i=n.byweekno,a=n.byweekday,o=n.byeaster,l=n.bymonthday,s=n.bynmonthday,d=n.byyearday;return ke(r)&&!ce(r,e.mmask[t])||ke(i)&&!e.wnomask[t]||ke(a)&&!ce(a,e.wdaymask[t])||ke(e.nwdaymask)&&!e.nwdaymask[t]||o!==null&&!ce(e.eastermask,t)||(ke(l)||ke(s))&&!ce(l,e.mdaymask[t])&&!ce(s,e.nmdaymask[t])||ke(d)&&(t<e.yearlen&&!ce(d,t+1)&&!ce(d,-e.yearlen+t)||t>=e.yearlen&&!ce(d,t+1-e.yearlen)&&!ce(d,-e.nextyearlen+t-e.yearlen))}function ds(e,t){return new Nr(e,t.tzid).rezonedDate()}function An(e){return e.getValue()}function fu(e,t,n,r,i){for(var a=!1,o=t;o<n;o++){var l=e[o];(a=hu(r,l,i))&&(e[l]=null)}return a}var Je={MO:new Fe(0),TU:new Fe(1),WE:new Fe(2),TH:new Fe(3),FR:new Fe(4),SA:new Fe(5),SU:new Fe(6)},vi={freq:le.YEARLY,dtstart:null,interval:1,wkst:Je.MO,count:null,until:null,tzid:null,bysetpos:null,bymonth:null,bymonthday:null,bynmonthday:null,byyearday:null,byweekno:null,byweekday:null,bynweekday:null,byhour:null,byminute:null,bysecond:null,byeaster:null},pu=Object.keys(vi),j=function(){function e(t,n){t===void 0&&(t={}),n===void 0&&(n=!1),this._cache=n?null:new Q_,this.origOptions=Il(t);var r=W_(t).parsedOptions;this.options=r}return e.parseText=function(t,n){return Nl(t,n)},e.fromText=function(t,n){return j_(t,n)},e.fromString=function(t){return new e(e.parseString(t)||void 0)},e.prototype._iter=function(t){return Ml(t,this.options)},e.prototype._cacheGet=function(t,n){return!!this._cache&&this._cache._cacheGet(t,n)},e.prototype._cacheAdd=function(t,n,r){if(this._cache)return this._cache._cacheAdd(t,n,r)},e.prototype.all=function(t){if(t)return this._iter(new as("all",{},t));var n=this._cacheGet("all");return n===!1&&(n=this._iter(new Zt("all",{})),this._cacheAdd("all",n)),n},e.prototype.between=function(t,n,r,i){if(r===void 0&&(r=!1),!Cn(t)||!Cn(n))throw new Error("Invalid date passed in to RRule.between");var a={before:n,after:t,inc:r};if(i)return this._iter(new as("between",a,i));var o=this._cacheGet("between",a);return o===!1&&(o=this._iter(new Zt("between",a)),this._cacheAdd("between",o,a)),o},e.prototype.before=function(t,n){if(n===void 0&&(n=!1),!Cn(t))throw new Error("Invalid date passed in to RRule.before");var r={dt:t,inc:n},i=this._cacheGet("before",r);return i===!1&&(i=this._iter(new Zt("before",r)),this._cacheAdd("before",i,r)),i},e.prototype.after=function(t,n){if(n===void 0&&(n=!1),!Cn(t))throw new Error("Invalid date passed in to RRule.after");var r={dt:t,inc:n},i=this._cacheGet("after",r);return i===!1&&(i=this._iter(new Zt("after",r)),this._cacheAdd("after",i,r)),i},e.prototype.count=function(){return this.all().length},e.prototype.toString=function(){return Ba(this.origOptions)},e.prototype.toText=function(t,n,r){return function(i,a,o,l){return new dt(i,a,o,l).toString()}(this,t,n,r)},e.prototype.isFullyConvertibleToText=function(){return B_(this)},e.prototype.clone=function(){return new e(this.origOptions)},e.FREQUENCIES=["YEARLY","MONTHLY","WEEKLY","DAILY","HOURLY","MINUTELY","SECONDLY"],e.YEARLY=le.YEARLY,e.MONTHLY=le.MONTHLY,e.WEEKLY=le.WEEKLY,e.DAILY=le.DAILY,e.HOURLY=le.HOURLY,e.MINUTELY=le.MINUTELY,e.SECONDLY=le.SECONDLY,e.MO=Je.MO,e.TU=Je.TU,e.WE=Je.WE,e.TH=Je.TH,e.FR=Je.FR,e.SA=Je.SA,e.SU=Je.SU,e.parseString=ja,e.optionsToString=Ba,e}(),cs={dtstart:null,cache:!1,unfold:!1,forceset:!1,compatible:!1,tzid:null};function mu(e,t){var n=[],r=[],i=[],a=[],o=Cr(e),l=o.dtstart,s=o.tzid,d=function(c,u){if(u===void 0&&(u=!1),c=c&&c.trim(),!c)throw new Error("Invalid empty string");if(!u)return c.split(/\s/);for(var f=c.split(`
`),y=0;y<f.length;){var g=f[y]=f[y].replace(/\s+$/g,"");g?y>0&&g[0]===" "?(f[y-1]+=g.slice(1),f.splice(y,1)):y+=1:f.splice(y,1)}return f}(e,t.unfold);return d.forEach(function(c){var u;if(c){var f=function(v){var x=function(I){if(I.indexOf(":")===-1)return{name:"RRULE",value:I};var A=(k=I,E=":",D=1,C=k.split(E),D?C.slice(0,D).concat([C.slice(D).join(E)]):C),m=A[0],b=A[1],k,E,D,C;return{name:m,value:b}}(v),S=x.name,O=x.value,N=S.split(";");if(!N)throw new Error("empty property name");return{name:N[0].toUpperCase(),parms:N.slice(1),value:O}}(c),y=f.name,g=f.parms,h=f.value;switch(y.toUpperCase()){case"RRULE":if(g.length)throw new Error("unsupported RRULE parm: ".concat(g.join(",")));n.push(ja(c));break;case"RDATE":var p=((u=/RDATE(?:;TZID=([^:=]+))?/i.exec(c))!==null&&u!==void 0?u:[])[1];p&&!s&&(s=p),r=r.concat(_s(h,g));break;case"EXRULE":if(g.length)throw new Error("unsupported EXRULE parm: ".concat(g.join(",")));i.push(ja(h));break;case"EXDATE":a=a.concat(_s(h,g));break;case"DTSTART":break;default:throw new Error("unsupported property: "+y)}}}),{dtstart:l,tzid:s,rrulevals:n,rdatevals:r,exrulevals:i,exdatevals:a}}function In(e,t){return t===void 0&&(t={}),function(n,r){var i=mu(n,r),a=i.rrulevals,o=i.rdatevals,l=i.exrulevals,s=i.exdatevals,d=i.dtstart,c=i.tzid,u=r.cache===!1;if(r.compatible&&(r.forceset=!0,r.unfold=!0),r.forceset||a.length>1||o.length||l.length||s.length){var f=new gu(u);return f.dtstart(d),f.tzid(c||void 0),a.forEach(function(g){f.rrule(new j(Na(g,d,c),u))}),o.forEach(function(g){f.rdate(g)}),l.forEach(function(g){f.exrule(new j(Na(g,d,c),u))}),s.forEach(function(g){f.exdate(g)}),r.compatible&&r.dtstart&&f.rdate(d),f}var y=a[0]||{};return new j(Na(y,y.dtstart||r.dtstart||d,y.tzid||r.tzid||c),u)}(e,function(n){var r=[],i=Object.keys(n),a=Object.keys(cs);if(i.forEach(function(o){ce(a,o)||r.push(o)}),r.length)throw new Error("Invalid options: "+r.join(", "));return We(We({},cs),n)}(t))}function Na(e,t,n){return We(We({},e),{dtstart:t,tzid:n})}function _s(e,t){return function(n){n.forEach(function(r){if(!/(VALUE=DATE(-TIME)?)|(TZID=)/.test(r))throw new Error("unsupported RDATE/EXDATE parm: "+r)})}(t),e.split(",").map(function(n){return mi(n)})}function us(e){var t=this;return function(n){if(n!==void 0&&(t["_".concat(e)]=n),t["_".concat(e)]!==void 0)return t["_".concat(e)];for(var r=0;r<t._rrule.length;r++){var i=t._rrule[r].origOptions[e];if(i)return i}}}var gu=function(e){function t(n){n===void 0&&(n=!1);var r=e.call(this,{},n)||this;return r.dtstart=us.apply(r,["dtstart"]),r.tzid=us.apply(r,["tzid"]),r._rrule=[],r._rdate=[],r._exrule=[],r._exdate=[],r}return gi(t,e),t.prototype._iter=function(n){return function(r,i,a,o,l,s){var d={},c=r.accept;function u(h,p){a.forEach(function(v){v.between(h,p,!0).forEach(function(x){d[Number(x)]=!0})})}l.forEach(function(h){var p=new Nr(h,s).rezonedDate();d[Number(p)]=!0}),r.accept=function(h){var p=Number(h);return isNaN(p)?c.call(this,h):!(!d[p]&&(u(new Date(p-1),new Date(p+1)),!d[p]))||(d[p]=!0,c.call(this,h))},r.method==="between"&&(u(r.args.after,r.args.before),r.accept=function(h){var p=Number(h);return!!d[p]||(d[p]=!0,c.call(this,h))});for(var f=0;f<o.length;f++){var y=new Nr(o[f],s).rezonedDate();if(!r.accept(new Date(y.getTime())))break}i.forEach(function(h){Ml(r,h.options)});var g=r._result;switch(Vn(g),r.method){case"all":case"between":return g;case"before":return g.length&&g[g.length-1]||null;default:return g.length&&g[0]||null}}(n,this._rrule,this._exrule,this._rdate,this._exdate,this.tzid())},t.prototype.rrule=function(n){hs(n,this._rrule)},t.prototype.exrule=function(n){hs(n,this._exrule)},t.prototype.rdate=function(n){fs(n,this._rdate)},t.prototype.exdate=function(n){fs(n,this._exdate)},t.prototype.rrules=function(){return this._rrule.map(function(n){return In(n.toString())})},t.prototype.exrules=function(){return this._exrule.map(function(n){return In(n.toString())})},t.prototype.rdates=function(){return this._rdate.map(function(n){return new Date(n.getTime())})},t.prototype.exdates=function(){return this._exdate.map(function(n){return new Date(n.getTime())})},t.prototype.valueOf=function(){var n=[];return!this._rrule.length&&this._dtstart&&(n=n.concat(Ba({dtstart:this._dtstart}))),this._rrule.forEach(function(r){n=n.concat(r.toString().split(`
`))}),this._exrule.forEach(function(r){n=n.concat(r.toString().split(`
`).map(function(i){return i.replace(/^RRULE:/,"EXRULE:")}).filter(function(i){return!/^DTSTART/.test(i)}))}),this._rdate.length&&n.push(ps("RDATE",this._rdate,this.tzid())),this._exdate.length&&n.push(ps("EXDATE",this._exdate,this.tzid())),n},t.prototype.toString=function(){return this.valueOf().join(`
`)},t.prototype.clone=function(){var n=new t(!!this._cache);return this._rrule.forEach(function(r){return n.rrule(r.clone())}),this._exrule.forEach(function(r){return n.exrule(r.clone())}),this._rdate.forEach(function(r){return n.rdate(new Date(r.getTime()))}),this._exdate.forEach(function(r){return n.exdate(new Date(r.getTime()))}),n},t}(j);function hs(e,t){if(!(e instanceof j))throw new TypeError(String(e)+" is not RRule instance");ce(t.map(String),String(e))||t.push(e)}function fs(e,t){if(!(e instanceof Date))throw new TypeError(String(e)+" is not Date instance");ce(t.map(Number),Number(e))||(t.push(e),Vn(t))}function ps(e,t,n){var r=!n||n.toUpperCase()==="UTC",i=r?"".concat(e,":"):"".concat(e,";TZID=").concat(n,":"),a=t.map(function(o){return pi(o.valueOf(),r)}).join(",");return"".concat(i).concat(a)}class vu{constructor(t){this._scheduler=t}getNode(){const t=this._scheduler;return this._tooltipNode||(this._tooltipNode=document.createElement("div"),this._tooltipNode.className="dhtmlXTooltip scheduler_tooltip tooltip",t._waiAria.tooltipAttr(this._tooltipNode)),t.config.rtl?this._tooltipNode.classList.add("dhtmlXTooltip_rtl"):this._tooltipNode.classList.remove("dhtmlXTooltip_rtl"),this._tooltipNode}setViewport(t){return this._root=t,this}show(t,n){const r=this._scheduler,i=r.$domHelpers,a=document.body,o=this.getNode();if(i.isChildOf(o,a)||(this.hide(),a.appendChild(o)),this._isLikeMouseEvent(t)){const l=this._calculateTooltipPosition(t);n=l.top,t=l.left}return o.style.top=n+"px",o.style.left=t+"px",r._waiAria.tooltipVisibleAttr(o),this}hide(){const t=this._scheduler,n=this.getNode();return n&&n.parentNode&&n.parentNode.removeChild(n),t._waiAria.tooltipHiddenAttr(n),this}setContent(t){return this.getNode().innerHTML=t,this}_isLikeMouseEvent(t){return!(!t||typeof t!="object")&&"clientX"in t&&"clientY"in t}_getViewPort(){return this._root||document.body}_calculateTooltipPosition(t){const n=this._scheduler,r=n.$domHelpers,i=this._getViewPortSize(),a=this.getNode(),o={top:0,left:0,width:a.offsetWidth,height:a.offsetHeight,bottom:0,right:0},l=n.config.tooltip_offset_x,s=n.config.tooltip_offset_y,d=document.body,c=r.getRelativeEventPosition(t,d),u=r.getNodePosition(d);c.y+=u.y,o.top=c.y,o.left=c.x,o.top+=s,o.left+=l,o.bottom=o.top+o.height,o.right=o.left+o.width;const f=window.scrollY+d.scrollTop;return o.top<i.top-f?(o.top=i.top,o.bottom=o.top+o.height):o.bottom>i.bottom&&(o.bottom=i.bottom,o.top=o.bottom-o.height),o.left<i.left?(o.left=i.left,o.right=i.left+o.width):o.right>i.right&&(o.right=i.right,o.left=o.right-o.width),c.x>=o.left&&c.x<=o.right&&(o.left=c.x-o.width-l,o.right=o.left+o.width),c.y>=o.top&&c.y<=o.bottom&&(o.top=c.y-o.height-s,o.bottom=o.top+o.height),o.left<0&&(o.left=0),o.right<0&&(o.right=0),o}_getViewPortSize(){const t=this._scheduler,n=t.$domHelpers,r=this._getViewPort();let i,a=r,o=window.scrollY+document.body.scrollTop,l=window.scrollX+document.body.scrollLeft;return r===t.$event_data?(a=t.$event,o=0,l=0,i=n.getNodePosition(t.$event)):i=n.getNodePosition(a),{left:i.x+l,top:i.y+o,width:i.width,height:i.height,bottom:i.y+i.height+o,right:i.x+i.width+l}}}class yu{constructor(t){this._listeners={},this.tooltip=new vu(t),this._scheduler=t,this._domEvents=t._createDomEventScope(),this._initDelayedFunctions()}destructor(){this.tooltip.hide(),this._domEvents.detachAll()}hideTooltip(){this.delayHide()}attach(t){let n=document.body;const r=this._scheduler,i=r.$domHelpers;t.global||(n=r.$root);let a=null;const o=l=>{const s=i.getTargetNode(l),d=i.closest(s,t.selector);if(i.isChildOf(s,this.tooltip.getNode()))return;const c=()=>{a=d,t.onmouseenter(l,d)};r._mobile&&r.config.touch_tooltip&&(d?c():t.onmouseleave(l,d)),a?d&&d===a?t.onmousemove(l,d):(t.onmouseleave(l,a),a=null,d&&d!==a&&c()):d&&c()};this.detach(t.selector),this._domEvents.attach(n,"mousemove",o),this._listeners[t.selector]={node:n,handler:o}}detach(t){const n=this._listeners[t];n&&this._domEvents.detach(n.node,"mousemove",n.handler)}tooltipFor(t){const n=r=>{let i=r;return document.createEventObject&&!document.createEvent&&(i=document.createEventObject(r)),i};this._initDelayedFunctions(),this.attach({selector:t.selector,global:t.global,onmouseenter:(r,i)=>{const a=t.html(r,i);a&&this.delayShow(n(r),a)},onmousemove:(r,i)=>{const a=t.html(r,i);a?this.delayShow(n(r),a):(this.delayShow.$cancelTimeout(),this.delayHide())},onmouseleave:()=>{this.delayShow.$cancelTimeout(),this.delayHide()}})}_initDelayedFunctions(){const t=this._scheduler;this.delayShow&&this.delayShow.$cancelTimeout(),this.delayHide&&this.delayHide.$cancelTimeout(),this.tooltip.hide(),this.delayShow=Qe.delay((n,r)=>{t.callEvent("onBeforeTooltip",[n])===!1?this.tooltip.hide():(this.tooltip.setContent(r),this.tooltip.show(n))},t.config.tooltip_timeout||1),this.delayHide=Qe.delay(()=>{this.delayShow.$cancelTimeout(),this.tooltip.hide()},t.config.tooltip_hide_timeout||1)}}const bu={active_links:function(e){e.config.active_link_view="day",e._active_link_click=function(t){var n=t.target.getAttribute("data-link-date"),r=e.date.str_to_date(e.config.api_date,!1,!0);if(n)return e.setCurrentView(r(n),e.config.active_link_view),t&&t.preventDefault&&t.preventDefault(),!1},e.attachEvent("onTemplatesReady",function(){var t=function(r,i){i=i||r+"_scale_date",e.templates["_active_links_old_"+i]||(e.templates["_active_links_old_"+i]=e.templates[i]);var a=e.templates["_active_links_old_"+i],o=e.date.date_to_str(e.config.api_date);e.templates[i]=function(l){return"<a data-link-date='"+o(l)+"' href='#'>"+a(l)+"</a>"}};if(t("week"),t("","month_day"),this.matrix)for(var n in this.matrix)t(n);this._detachDomEvent(this._obj,"click",e._active_link_click),e.event(this._obj,"click",e._active_link_click)})},agenda_legacy:function(e){e.date.add_agenda_legacy=function(t){return e.date.add(t,1,"year")},e.templates.agenda_legacy_time=function(t,n,r){return r._timed?this.day_date(r.start_date,r.end_date,r)+" "+this.event_date(t):e.templates.day_date(t)+" &ndash; "+e.templates.day_date(n)},e.templates.agenda_legacy_text=function(t,n,r){return r.text},e.templates.agenda_legacy_date=function(){return""},e.date.agenda_legacy_start=function(){return e.date.date_part(e._currentDate())},e.attachEvent("onTemplatesReady",function(){var t=e.dblclick_dhx_cal_data;e.dblclick_dhx_cal_data=function(){if(this._mode=="agenda_legacy")!this.config.readonly&&this.config.dblclick_create&&this.addEventNow();else if(t)return t.apply(this,arguments)};var n=e.render_data;e.render_data=function(a){if(this._mode!="agenda_legacy")return n.apply(this,arguments);i()};var r=e.render_view_data;function i(){var a=e.get_visible_events();a.sort(function(v,x){return v.start_date>x.start_date?1:-1});for(var o,l="<div class='dhx_agenda_area' "+e._waiAria.agendaDataAttrString()+">",s=0;s<a.length;s++){var d=a[s],c=d.color?"--dhx-scheduler-event-background:"+d.color+";":"",u=d.textColor?"--dhx-scheduler-event-color:"+d.textColor+";":"",f=e.templates.event_class(d.start_date,d.end_date,d);o=e._waiAria.agendaEventAttrString(d);var y=e._waiAria.agendaDetailsBtnString();l+="<div "+o+" class='dhx_agenda_line"+(f?" "+f:"")+"' event_id='"+d.id+"' "+e.config.event_attribute+"='"+d.id+"' style='"+u+c+(d._text_style||"")+"'><div class='dhx_agenda_event_time'>"+(e.config.rtl?e.templates.agenda_time(d.end_date,d.start_date,d):e.templates.agenda_time(d.start_date,d.end_date,d))+"</div>",l+=`<div ${y} class='dhx_event_icon icon_details'><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path d="M15.4444 16.4H4.55556V7.6H15.4444V16.4ZM13.1111 2V3.6H6.88889V2H5.33333V3.6H4.55556C3.69222 3.6 3 4.312 3 5.2V16.4C3 16.8243 3.16389 17.2313 3.45561 17.5314C3.74733 17.8314 4.143 18 4.55556 18H15.4444C15.857 18 16.2527 17.8314 16.5444 17.5314C16.8361 17.2313 17 16.8243 17 16.4V5.2C17 4.312 16.3 3.6 15.4444 3.6H14.6667V2H13.1111ZM13.8889 10.8H10V14.8H13.8889V10.8Z" fill="#A1A4A6"/>
			</svg></div>`,l+="<span>"+e.templates.agenda_text(d.start_date,d.end_date,d)+"</span></div>"}l+="<div class='dhx_v_border'></div></div>",e._els.dhx_cal_data[0].innerHTML=l,e._els.dhx_cal_data[0].childNodes[0].scrollTop=e._agendaScrollTop||0;var g=e._els.dhx_cal_data[0].childNodes[0];g.childNodes[g.childNodes.length-1].style.height=g.offsetHeight<e._els.dhx_cal_data[0].offsetHeight?"100%":g.offsetHeight+"px";var h=e._els.dhx_cal_data[0].firstChild.childNodes,p=e._getNavDateElement();for(p&&(p.innerHTML=e.templates.agenda_date(e._min_date,e._max_date,e._mode)),e._rendered=[],s=0;s<h.length-1;s++)e._rendered[s]=h[s]}e.render_view_data=function(){return this._mode=="agenda_legacy"&&(e._agendaScrollTop=e._els.dhx_cal_data[0].childNodes[0].scrollTop,e._els.dhx_cal_data[0].childNodes[0].scrollTop=0),r.apply(this,arguments)},e.agenda_legacy_view=function(a){e._min_date=e.config.agenda_start||e.date.agenda_legacy_start(e._date),e._max_date=e.config.agenda_end||e.date.add_agenda_legacy(e._min_date,1),function(o){if(o){var l=e.locale.labels,s=e._waiAria.agendaHeadAttrString(),d=e._waiAria.agendaHeadDateString(l.date),c=e._waiAria.agendaHeadDescriptionString(l.description);e._els.dhx_cal_header[0].innerHTML="<div "+s+" class='dhx_agenda_line dhx_agenda_line_header'><div "+d+">"+l.date+"</div><span class = 'description_header' style='padding-left:25px' "+c+">"+l.description+"</span></div>",e._table_view=!0,e.set_sizes()}}(a),a?(e._cols=null,e._colsS=null,e._table_view=!0,i()):e._table_view=!1}})},agenda_view:function(e){e.date.add_agenda=function(i,a){return e.date.add(i,1*a,"month")},e.templates.agenda_time=function(i,a,o){return o._timed?`${this.event_date(i)} - ${this.event_date(a)}`:e.locale.labels.full_day},e.templates.agenda_text=function(i,a,o){return o.text};const t=e.date.date_to_str("%F %j"),n=e.date.date_to_str("%l");e.templates.agenda_day=function(i){return`<div class="dhx_agenda_day_date">${t(i)}</div>
		<div class="dhx_agenda_day_dow">${n(i)}</div>`},e.templates.agenda_date=function(i,a){return e.templates.month_date(e.getState().date)},e.date.agenda_start=function(i){return e.date.month_start(new Date(i))};let r=0;e.attachEvent("onTemplatesReady",function(){var i=e.dblclick_dhx_cal_data;e.dblclick_dhx_cal_data=function(){if(this._mode=="agenda")!this.config.readonly&&this.config.dblclick_create&&this.addEventNow();else if(i)return i.apply(this,arguments)};var a=e.render_data;e.render_data=function(d){if(this._mode!="agenda")return a.apply(this,arguments);l()};var o=e.render_view_data;function l(){const d=e.get_visible_events();d.sort(function(p,v){return p.start_date>v.start_date?1:-1});const c={};let u=e.getState().min_date;const f=e.getState().max_date;for(;u.valueOf()<f.valueOf();)c[u.valueOf()]=[],u=e.date.add(u,1,"day");let y=!1;if(d.forEach(p=>{let v=e.date.day_start(new Date(p.start_date));for(;v.valueOf()<p.end_date.valueOf();)c[v.valueOf()]&&(c[v.valueOf()].push(p),y=!0),v=e.date.day_start(e.date.add(v,1,"day"))}),y){let p="";for(let v in c)e.ignore_agenda&&e.ignore_agenda(new Date(1*v))||(p+=s(new Date(1*v),c[v]));e._els.dhx_cal_data[0].innerHTML=p}else e._els.dhx_cal_data[0].innerHTML=`<div class="dhx_cal_agenda_no_events">${e.locale.labels.agenda_tab}</div>`;e._els.dhx_cal_data[0].scrollTop=r;let g=e._els.dhx_cal_data[0].querySelectorAll(".dhx_cal_agenda_event_line");e._rendered=[];for(var h=0;h<g.length-1;h++)e._rendered[h]=g[h]}function s(d,c){if(!c.length)return"";let u=`
<div class="dhx_cal_agenda_day" data-date="${e.templates.format_date(d)}" data-day="${d.getDay()}">
	<div class="dhx_cal_agenda_day_header">${e.templates.agenda_day(d)}</div>
	<div class="dhx_cal_agenda_day_events">
`;return c.forEach(f=>{u+=function(y,g){const h=e.templates.agenda_time(g.start_date,g.end_date,g),p=e.getState().select_id,v=e.templates.event_class(g.start_date,g.end_date,g),x=e.templates.agenda_text(g.start_date,g.end_date,g);let S="";return(g.color||g.textColor)&&(S=` style="${g.color?"--dhx-scheduler-event-background:"+g.color+";":""}${g.textColor?"--dhx-scheduler-event-color:"+g.textColor+";":""}" `),`<div class="dhx_cal_agenda_event_line ${v||""} ${g.id==p?"dhx_cal_agenda_event_line_selected":""}" ${S} ${e.config.event_attribute}="${g.id}">
	<div class="dhx_cal_agenda_event_line_marker"></div>
	<div class="dhx_cal_agenda_event_line_time">${h}</div>
	<div class="dhx_cal_agenda_event_line_text">${x}</div>
</div>`}(0,f)}),u+="</div></div>",u}e.render_view_data=function(){return this._mode=="agenda"&&(r=e._els.dhx_cal_data[0].scrollTop,e._els.dhx_cal_data[0].scrollTop=0),o.apply(this,arguments)},e.agenda_view=function(d){d?(e._min_date=e.config.agenda_start||e.date.agenda_start(e._date),e._max_date=e.config.agenda_end||e.date.add_agenda(e._min_date,1),e._cols=null,e._colsS=null,e._table_view=!0,e._getNavDateElement().innerHTML=e.templates.agenda_date(e._date),l()):e._table_view=!1}})},all_timed:function(e){e.config.all_timed="short",e.config.all_timed_month=!1,e.ext.allTimed={isMainAreaEvent:function(l){return!!(l._timed||e.config.all_timed===!0||e.config.all_timed=="short"&&t(l))}};var t=function(l){return!((l.end_date-l.start_date)/36e5>=24)||e._drag_mode=="resize"&&e._drag_id==l.id};e._safe_copy=function(l){var s=null,d=e._copy_event(l);return l.event_pid&&(s=e.getEvent(l.event_pid)),s&&s.isPrototypeOf(l)&&(delete d.event_length,delete d.event_pid,delete d.rec_pattern,delete d.rec_type),d};var n=e._pre_render_events_line,r=e._pre_render_events_table,i=function(l,s){return this._table_view?r.call(this,l,s):n.call(this,l,s)};e._pre_render_events_line=e._pre_render_events_table=function(l,s){if(!this.config.all_timed||this._table_view&&this._mode!="month"||this._mode=="month"&&!this.config.all_timed_month)return i.call(this,l,s);for(var d=0;d<l.length;d++){var c=l[d];if(!c._timed)if(this.config.all_timed!="short"||t(c)){var u=this._safe_copy(c);c._virtual?u._first_chunk=!1:u._first_chunk=!0,u._drag_resize=!1,u._virtual=!0,u.start_date=new Date(u.start_date),h(c)?(u.end_date=p(u.start_date),this.config.last_hour!=24&&(u.end_date=v(u.start_date,this.config.last_hour))):u.end_date=new Date(c.end_date);var f=!1;u.start_date<this._max_date&&u.end_date>this._min_date&&u.start_date<u.end_date&&(l[d]=u,f=!0);var y=this._safe_copy(c);if(y._virtual=!0,y.end_date=new Date(y.end_date),y.start_date<this._min_date?y.start_date=v(this._min_date,this.config.first_hour):y.start_date=v(p(c.start_date),this.config.first_hour),y.start_date<this._max_date&&y.start_date<y.end_date){if(!f){l[d--]=y;continue}l.splice(d+1,0,y),y._last_chunk=!1}else u._last_chunk=!0,u._drag_resize=!0}else this._mode!="month"&&l.splice(d--,1)}var g=this._drag_mode!="move"&&s;return i.call(this,l,g);function h(x){var S=p(x.start_date);return+x.end_date>+S}function p(x){var S=e.date.add(x,1,"day");return S=e.date.date_part(S)}function v(x,S){var O=e.date.date_part(new Date(x));return O.setHours(S),O}};var a=e.get_visible_events;e.get_visible_events=function(l){return this.config.all_timed&&this.config.multi_day?a.call(this,!1):a.call(this,l)},e.attachEvent("onBeforeViewChange",function(l,s,d,c){return e._allow_dnd=d=="day"||d=="week"||e.getView(d),!0}),e._is_main_area_event=function(l){return e.ext.allTimed.isMainAreaEvent(l)};var o=e.updateEvent;e.updateEvent=function(l){var s,d,c=e.getEvent(l);c&&(s=e.config.all_timed&&!(e.isOneDayEvent(e._events[l])||e.getState().drag_id))&&(d=e.config.update_render,e.config.update_render=!0),o.apply(e,arguments),c&&s&&(e.config.update_render=d)}},collision:function(e){let t,n;function r(i){e._get_section_view()&&i&&(t=e.getEvent(i)[e._get_section_property()])}e.config.collision_limit=1,e.attachEvent("onBeforeDrag",function(i){return r(i),!0}),e.attachEvent("onBeforeLightbox",function(i){const a=e.getEvent(i);return n=[a.start_date,a.end_date],r(i),!0}),e.attachEvent("onEventChanged",function(i){if(!i||!e.getEvent(i))return!0;const a=e.getEvent(i);if(!e.checkCollision(a)){if(!n)return!1;a.start_date=n[0],a.end_date=n[1],a._timed=this.isOneDayEvent(a)}return!0}),e.attachEvent("onBeforeEventChanged",function(i,a,o){return e.checkCollision(i)}),e.attachEvent("onEventAdded",function(i,a){e.checkCollision(a)||e.deleteEvent(i)}),e.attachEvent("onEventSave",function(i,a,o){if((a=e._lame_clone(a)).id=i,!a.start_date||!a.end_date){const l=e.getEvent(i);a.start_date=new Date(l.start_date),a.end_date=new Date(l.end_date)}return(a.rrule&&!a.recurring_event_id||a.rec_type)&&e._roll_back_dates(a),e.checkCollision(a)}),e._check_sections_collision=function(i,a){const o=e._get_section_property();return i[o]==a[o]&&i.id!=a.id},e.checkCollision=function(i){let a=[];const o=e.config.collision_limit;if(i.rec_type){let c=e.getRecDates(i);for(let u=0;u<c.length;u++){let f=e.getEvents(c[u].start_date,c[u].end_date);for(let y=0;y<f.length;y++)(f[y].event_pid||f[y].id)!=i.id&&a.push(f[y])}}else if(i.rrule){let c=e.getRecDates(i);for(let u=0;u<c.length;u++){let f=e.getEvents(c[u].start_date,c[u].end_date);for(let y=0;y<f.length;y++)(String(f[y].id).split("#")[0]||f[y].id)!=i.id&&a.push(f[y])}}else{a=e.getEvents(i.start_date,i.end_date);for(let c=0;c<a.length;c++){let u=a[c];if(u.id==i.id||u.event_length&&[u.event_pid,u.event_length].join("#")==i.id){a.splice(c,1);break}if(u.recurring_event_id&&[u.recurring_event_id,u._pid_time].join("#")==i.id){a.splice(c,1);break}}}const l=e._get_section_view(),s=e._get_section_property();let d=!0;if(l){let c=0;for(let u=0;u<a.length;u++)a[u].id!=i.id&&this._check_sections_collision(a[u],i)&&c++;c>=o&&(d=!1)}else a.length>=o&&(d=!1);if(!d){let c=!e.callEvent("onEventCollision",[i,a]);return c||(i[s]=t||i[s]),c}return d}},container_autoresize:function(e){e.config.container_autoresize=!0,e.config.month_day_min_height=90,e.config.min_grid_size=25,e.config.min_map_size=400;var t=e._pre_render_events,n=!0,r=0,i=0;e._pre_render_events=function(c,u){if(!e.config.container_autoresize||!n)return t.apply(this,arguments);var f=this.xy.bar_height,y=this._colsS.heights,g=this._colsS.heights=[0,0,0,0,0,0,0],h=this._els.dhx_cal_data[0];if(c=this._table_view?this._pre_render_events_table(c,u):this._pre_render_events_line(c,u),this._table_view)if(u)this._colsS.heights=y;else{var p=h.firstChild;const A=p.querySelectorAll(".dhx_cal_month_row");if(A&&A.length){for(var v=0;v<A.length;v++){if(g[v]++,g[v]*f>this._colsS.height-this.xy.month_head_height){var x=A[v].querySelectorAll(".dhx_cal_month_cell"),S=this._colsS.height-this.xy.month_head_height;1*this.config.max_month_events!==this.config.max_month_events||g[v]<=this.config.max_month_events?S=g[v]*f:(this.config.max_month_events+1)*f>this._colsS.height-this.xy.month_head_height&&(S=(this.config.max_month_events+1)*f),A[v].style.height=S+this.xy.month_head_height+"px";for(var O=0;O<x.length;O++)x[O].childNodes[1].style.height=S+"px";g[v]=(g[v-1]||0)+x[0].offsetHeight}g[v]=(g[v-1]||0)+A[v].querySelectorAll(".dhx_cal_month_cell")[0].offsetHeight}g.unshift(0),p.parentNode.offsetHeight<p.parentNode.scrollHeight&&p._h_fix}else if(c.length||this._els.dhx_multi_day[0].style.visibility!="visible"||(g[0]=-1),c.length||g[0]==-1){var N=(g[0]+1)*f+1;i!=N+1&&(this._obj.style.height=r-i+N-1+"px"),N+="px";const m=this._els.dhx_cal_navline[0].offsetHeight,b=this._els.dhx_cal_header[0].offsetHeight;h.style.height=this._obj.offsetHeight-m-b-(this.xy.margin_top||0)+"px";var I=this._els.dhx_multi_day[0];I.style.height=N,I.style.visibility=g[0]==-1?"hidden":"visible",I.style.display=g[0]==-1?"none":"",(I=this._els.dhx_multi_day[1]).style.height=N,I.style.visibility=g[0]==-1?"hidden":"visible",I.style.display=g[0]==-1?"none":"",I.className=g[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small",this._dy_shift=(g[0]+1)*f,g[0]=0}}return c};var a=["dhx_cal_navline","dhx_cal_header","dhx_multi_day","dhx_cal_data"],o=function(c){r=0;for(var u=0;u<a.length;u++){var f=a[u],y=e._els[f]?e._els[f][0]:null,g=0;switch(f){case"dhx_cal_navline":case"dhx_cal_header":g=y.offsetHeight;break;case"dhx_multi_day":g=y?y.offsetHeight-1:0,i=g;break;case"dhx_cal_data":var h=e.getState().mode;if(y.childNodes[1]&&h!="month"){let D=0;for(let C=0;C<y.childNodes.length;C++)y.childNodes[C].offsetHeight>D&&(D=y.childNodes[C].offsetHeight);g=D}else g=Math.max(y.offsetHeight-1,y.scrollHeight);if(h=="month")e.config.month_day_min_height&&!c&&(g=y.querySelectorAll(".dhx_cal_month_row").length*e.config.month_day_min_height),c&&(y.style.height=g+"px");else if(h=="year")g=190*e.config.year_y;else if(h=="agenda"){if(g=0,y.children&&y.children.length)if(y.children.length===1&&y.children[0].classList.contains("dhx_cal_agenda_no_events"))g=300;else for(var p=0;p<y.children.length;p++)g+=y.children[p].offsetHeight;g+2<e.config.min_grid_size?g=e.config.min_grid_size:g+=2}else if(h=="week_agenda"){for(var v,x,S=e.xy.week_agenda_scale_height+e.config.min_grid_size,O=0;O<y.childNodes.length;O++)for(x=y.childNodes[O],p=0;p<x.childNodes.length;p++){for(var N=0,I=x.childNodes[p].childNodes[1],A=0;A<I.childNodes.length;A++)N+=I.childNodes[A].offsetHeight;v=N+e.xy.week_agenda_scale_height,(v=O!=1||p!=2&&p!=3?v:2*v)>S&&(S=v)}g=3*S}else if(h=="map"){g=0;var m=y.querySelectorAll(".dhx_map_line");for(p=0;p<m.length;p++)g+=m[p].offsetHeight;g+2<e.config.min_map_size?g=e.config.min_map_size:g+=2}else if(e._gridView)if(g=0,y.childNodes[1].childNodes[0].childNodes&&y.childNodes[1].childNodes[0].childNodes.length){for(m=y.childNodes[1].childNodes[0].childNodes[0].childNodes,p=0;p<m.length;p++)g+=m[p].offsetHeight;(g+=2)<e.config.min_grid_size&&(g=e.config.min_grid_size)}else g=e.config.min_grid_size;if(e.matrix&&e.matrix[h]){if(c)g+=0,y.style.height=g+"px";else{g=0;for(var b=e.matrix[h],k=b.y_unit,E=0;E<k.length;E++)g+=b.getSectionHeight(k[E].key);e.$container.clientWidth!=e.$container.scrollWidth&&(g+=d())}g-=1}(h=="day"||h=="week"||e._props&&e._props[h])&&(g+=2)}r+=g+=1}e._obj.style.height=r+"px",c||e.updateView()};function l(){n=!1,e.callEvent("onAfterSchedulerResize",[]),n=!0}var s=function(){if(!e.config.container_autoresize||!n)return!0;var c=e.getState().mode;if(!c)return!0;var u=window.requestAnimationFrame||window.setTimeout,f=document.documentElement.scrollTop;u(function(){!e.$destroyed&&e.$initialized&&o()}),e.matrix&&e.matrix[c]||c=="month"?u(function(){!e.$destroyed&&e.$initialized&&(o(!0),document.documentElement.scrollTop=f,l())},1):l()};function d(){var c=document.createElement("div");c.style.cssText="visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;",document.body.appendChild(c);var u=c.offsetWidth-c.clientWidth;return document.body.removeChild(c),u}e.attachEvent("onBeforeViewChange",function(){var c=e.config.container_autoresize;if(e.xy.$original_scroll_width||(e.xy.$original_scroll_width=e.xy.scroll_width),e.xy.scroll_width=c?0:e.xy.$original_scroll_width,e.matrix)for(var u in e.matrix){var f=e.matrix[u];f.$original_section_autoheight||(f.$original_section_autoheight=f.section_autoheight),f.section_autoheight=!c&&f.$original_section_autoheight}return!0}),e.attachEvent("onViewChange",s),e.attachEvent("onXLE",s),e.attachEvent("onEventChanged",s),e.attachEvent("onEventCreated",s),e.attachEvent("onEventAdded",s),e.attachEvent("onEventDeleted",s),e.attachEvent("onAfterSchedulerResize",s),e.attachEvent("onClearAll",s),e.attachEvent("onBeforeExpand",function(){return n=!1,!0}),e.attachEvent("onBeforeCollapse",function(){return n=!0,!0})},cookie:function(e){function t(i){return(i._obj.id||"scheduler")+"_settings"}var n=!0;e.attachEvent("onBeforeViewChange",function(i,a,o,l){if(n&&e._get_url_nav){var s=e._get_url_nav();(s.date||s.mode||s.event)&&(n=!1)}var d=t(e);if(n){n=!1;var c=function(f){var y=f+"=";if(document.cookie.length>0){var g=document.cookie.indexOf(y);if(g!=-1){g+=y.length;var h=document.cookie.indexOf(";",g);return h==-1&&(h=document.cookie.length),document.cookie.substring(g,h)}}return""}(d);if(c){e._min_date||(e._min_date=l),(c=unescape(c).split("@"))[0]=this._helpers.parseDate(c[0]);var u=this.isViewExists(c[1])?c[1]:o;return l=isNaN(+c[0])?l:c[0],window.setTimeout(function(){e.$destroyed||e.setCurrentView(l,u)},1),!1}}return!0}),e.attachEvent("onViewChange",function(i,a){var o,l,s=t(e),d=escape(this._helpers.formatDate(a)+"@"+i);l=s+"="+d+((o="expires=Sun, 31 Jan 9999 22:00:00 GMT")?"; "+o:""),document.cookie=l});var r=e._load;e._load=function(){var i=arguments;if(e._date)r.apply(this,i);else{var a=this;window.setTimeout(function(){r.apply(a,i)},1)}}},daytimeline:function(e){vt("Day Timeline",e.assert)},drag_between:function(e){vt("Drag Between",e.assert)},editors:function(e){e.form_blocks.combo={render:function(t){t.cached_options||(t.cached_options={});const n=t.height?`style='height:${t.height}px;'`:"";var r="";return r+=`<div class='${t.type}' ${n}></div>`},set_value:function(t,n,r,i){(function(){y();var f=e.attachEvent("onAfterLightbox",function(){y(),e.detachEvent(f)});function y(){if(t._combo&&t._combo.DOMParent){var g=t._combo;g.unload?g.unload():g.destructor&&g.destructor(),g.DOMParent=g.DOMelem=null}}})(),window.dhx_globalImgPath=i.image_path||"/",t._combo=new dhtmlXCombo(t,i.name,t.offsetWidth-8),i.onchange&&t._combo.attachEvent("onChange",i.onchange),i.options_height&&t._combo.setOptionHeight(i.options_height);var a=t._combo;if(a.enableFilteringMode(i.filtering,i.script_path||null,!!i.cache),i.script_path){var o=r[i.map_to];o?i.cached_options[o]?(a.addOption(o,i.cached_options[o]),a.disable(1),a.selectOption(0),a.disable(0)):e.ajax.get(i.script_path+"?id="+o+"&uid="+e.uid(),function(f){var y,g=f.xmlDoc.responseText;try{y=JSON.parse(g).options[0].text}catch{y=e.ajax.xpath("//option",f.xmlDoc)[0].childNodes[0].nodeValue}i.cached_options[o]=y,a.addOption(o,y),a.disable(1),a.selectOption(0),a.disable(0)}):a.setComboValue("")}else{for(var l=[],s=0;s<i.options.length;s++){var d=i.options[s],c=[d.key,d.label,d.css];l.push(c)}if(a.addOption(l),r[i.map_to]){var u=a.getIndexByValue(r[i.map_to]);a.selectOption(u)}}},get_value:function(t,n,r){var i=t._combo.getSelectedValue();return r.script_path&&(r.cached_options[i]=t._combo.getSelectedText()),i},focus:function(t){}},e.form_blocks.radio={render:function(t){var n="";n+=`<div class='dhx_cal_ltext dhx_cal_radio ${t.vertical?"dhx_cal_radio_vertical":""}' style='height:${t.height}px;'>`;for(var r=0;r<t.options.length;r++){var i=e.uid();n+="<label class='dhx_cal_radio_item' for='"+i+"'><input id='"+i+"' type='radio' name='"+t.name+"' value='"+t.options[r].key+"'><span> "+t.options[r].label+"</span></label>"}return n+="</div>"},set_value:function(t,n,r,i){for(var a=t.getElementsByTagName("input"),o=0;o<a.length;o++){a[o].checked=!1;var l=r[i.map_to]||n;a[o].value==l&&(a[o].checked=!0)}},get_value:function(t,n,r){for(var i=t.getElementsByTagName("input"),a=0;a<i.length;a++)if(i[a].checked)return i[a].value},focus:function(t){}},e.form_blocks.checkbox={render:function(t){return e.config.wide_form?'<div class="dhx_cal_wide_checkbox"></div>':""},set_value:function(t,n,r,i){t=e._lightbox.querySelector(`#${i.id}`),i.height&&(t.style.height=`${i.height}px`);var a=e.uid(),o=i.checked_value!==void 0?n==i.checked_value:!!n;t.className+=" dhx_cal_checkbox";var l="<input id='"+a+"' type='checkbox' value='true' name='"+i.name+"'"+(o?"checked='true'":"")+"'>",s="<label for='"+a+"'>"+(e.locale.labels["section_"+i.name]||i.name)+"</label>";if(e.config.wide_form?(t.innerHTML=s,t.nextSibling.innerHTML=l):t.innerHTML=l+s,i.handler){var d=t.getElementsByTagName("input")[0];if(d.$_eventAttached)return;d.$_eventAttached=!0,e.event(d,"click",i.handler)}},get_value:function(t,n,r){var i=(t=e._lightbox.querySelector(`#${r.id}`)).getElementsByTagName("input")[0];return i||(i=t.nextSibling.getElementsByTagName("input")[0]),i.checked?r.checked_value||!0:r.unchecked_value||!1},focus:function(t){}}},expand:function(e){e.ext.fullscreen={toggleIcon:null},e.expand=function(){if(e.callEvent("onBeforeExpand",[])){var t=e._obj;do t._position=t.style.position||"",t.style.position="static";while((t=t.parentNode)&&t.style);(t=e._obj).style.position="absolute",t._width=t.style.width,t._height=t.style.height,t.style.width=t.style.height="100%",t.style.top=t.style.left="0px";var n=document.body;n.scrollTop=0,(n=n.parentNode)&&(n.scrollTop=0),document.body._overflow=document.body.style.overflow||"",document.body.style.overflow="hidden",e._maximize(),e.callEvent("onExpand",[])}},e.collapse=function(){if(e.callEvent("onBeforeCollapse",[])){var t=e._obj;do t.style.position=t._position;while((t=t.parentNode)&&t.style);(t=e._obj).style.width=t._width,t.style.height=t._height,document.body.style.overflow=document.body._overflow,e._maximize(),e.callEvent("onCollapse",[])}},e.attachEvent("onTemplatesReady",function(){var t=document.createElement("div");t.className="dhx_expand_icon",e.ext.fullscreen.toggleIcon=t,t.innerHTML=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
	<g>
	<line x1="0.5" y1="5" x2="0.5" y2="3.0598e-08" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line y1="0.5" x2="5" y2="0.5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="0.5" y1="11" x2="0.5" y2="16" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line y1="15.5" x2="5" y2="15.5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="11" y1="0.5" x2="16" y2="0.5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="15.5" y1="2.18557e-08" x2="15.5" y2="5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="11" y1="15.5" x2="16" y2="15.5" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	<line x1="15.5" y1="16" x2="15.5" y2="11" stroke="var(--dhx-scheduler-base-colors-icons)"/>
	</g>
	</svg>
	`,e._obj.appendChild(t),e.event(t,"click",function(){e.expanded?e.collapse():e.expand()})}),e._maximize=function(){this.expanded=!this.expanded,this.expanded?this.ext.fullscreen.toggleIcon.classList.add("dhx_expand_icon--expanded"):this.ext.fullscreen.toggleIcon.classList.remove("dhx_expand_icon--expanded");for(var t=["left","top"],n=0;n<t.length;n++){var r=e["_prev_margin_"+t[n]];e.xy["margin_"+t[n]]?(e["_prev_margin_"+t[n]]=e.xy["margin_"+t[n]],e.xy["margin_"+t[n]]=0):r&&(e.xy["margin_"+t[n]]=e["_prev_margin_"+t[n]],delete e["_prev_margin_"+t[n]])}e.setCurrentView()}},export_api:function(e){(function(){function t(r,i){for(var a in i)r[a]||(r[a]=i[a]);return r}function n(r,i){var a={};return(r=i._els[r])&&r[0]?(a.x=r[0].scrollWidth,a.y=r[0].scrollHeight):(a.x=0,a.y=0),a}window.dhtmlxAjax||(window.dhtmlxAjax={post:function(r,i,a){return window.dhx4.ajax.post(r,i,a)},get:function(r,i){return window.ajax.get(r,i)}}),function(r){function i(){var a=r.getState().mode;return r.matrix&&r.matrix[a]?r.matrix[a]:null}r.exportToPDF=function(a){(a=t(a||{},{name:"calendar.pdf",format:"A4",orientation:"landscape",dpi:96,zoom:1,rtl:r.config.rtl})).html=this._export_html(a),a.mode=this.getState().mode,this._send_to_export(a,"pdf")},r.exportToPNG=function(a){(a=t(a||{},{name:"calendar.png",format:"A4",orientation:"landscape",dpi:96,zoom:1,rtl:r.config.rtl})).html=this._export_html(a),a.mode=this.getState().mode,this._send_to_export(a,"png")},r.exportToICal=function(a){a=t(a||{},{name:"calendar.ical",data:this._serialize_plain(null,a)}),this._send_to_export(a,"ical")},r.exportToExcel=function(a){a=t(a||{},{name:"calendar.xlsx",title:"Events",data:this._serialize_plain(this.templates.xml_format,a),columns:this._serialize_columns()}),this._send_to_export(a,"excel")},r._ajax_to_export=function(a,o,l){delete a.callback;var s=a.server||"https://export.dhtmlx.com/scheduler";window.dhtmlxAjax.post(s,"type="+o+"&store=1&data="+encodeURIComponent(JSON.stringify(a)),function(d){var c=null;if(!(d.xmlDoc.status>400))try{c=JSON.parse(d.xmlDoc.responseText)}catch{}l(c)})},r._plain_export_copy=function(a,o){var l={};for(var s in a)l[s]=a[s];return l.start_date=o(l.start_date),l.end_date=o(l.end_date),l.$text=this.templates.event_text(a.start_date,a.end_date,a),l},r._serialize_plain=function(a,o){var l;a=a||r.date.date_to_str("%Y%m%dT%H%i%s",!0),l=o&&o.start&&o.end?r.getEvents(o.start,o.end):r.getEvents();for(var s=[],d=0;d<l.length;d++)s[d]=this._plain_export_copy(l[d],a);return s},r._serialize_columns=function(){return[{id:"start_date",header:"Start Date",width:30},{id:"end_date",header:"End Date",width:30},{id:"$text",header:"Text",width:100}]},r._send_to_export=function(a,o){if(a.version||(a.version=r.version),a.skin||(a.skin=r.skin),a.callback)return r._ajax_to_export(a,o,a.callback);var l=this._create_hidden_form();l.firstChild.action=a.server||"https://export.dhtmlx.com/scheduler",l.firstChild.childNodes[0].value=JSON.stringify(a),l.firstChild.childNodes[1].value=o,l.firstChild.submit()},r._create_hidden_form=function(){if(!this._hidden_export_form){var a=this._hidden_export_form=document.createElement("div");a.style.display="none",a.innerHTML="<form method='POST' target='_blank'><input type='text' name='data'><input type='hidden' name='type' value=''></form>",document.body.appendChild(a)}return this._hidden_export_form},r._get_export_size=function(a,o,l,s,d,c,u){s=parseInt(s)/25.4||4;var f={A5:{x:148,y:210},A4:{x:210,y:297},A3:{x:297,y:420},A2:{x:420,y:594},A1:{x:594,y:841},A0:{x:841,y:1189}},y=n("dhx_cal_data",this).x,g={y:n("dhx_cal_data",this).y+n("dhx_cal_header",this).y+n("dhx_multi_day",this).y};return g.x=a==="full"?y:Math.floor((o==="landscape"?f[a].y:f[a].x)*s),u&&(g.x*=parseFloat(u.x)||1,g.y*=parseFloat(u.y)||1),g},r._export_html=function(a){var o,l,s,d=(o=void 0,l=void 0,(s=i())&&(l=s.scrollable,o=s.smart_rendering),{nav_height:r.xy.nav_height,scroll_width:r.xy.scroll_width,style_width:r._obj.style.width,style_height:r._obj.style.height,timeline_scrollable:l,timeline_smart_rendering:o}),c=r._get_export_size(a.format,a.orientation,a.zoom,a.dpi,a.header,a.footer,a.scales),u="";try{(function(f,y){r._obj.style.width=f.x+"px",r._obj.style.height=f.y+"px",r.xy.nav_height=0,r.xy.scroll_width=0;var g=i();(y.timeline_scrollable||y.timeline_smart_rendering)&&(g.scrollable=!1,g.smart_rendering=!1)})(c,d),r.setCurrentView(),u=r._obj.innerHTML}catch(f){console.error(f)}finally{(function(f){r.xy.scroll_width=f.scroll_width,r.xy.nav_height=f.nav_height,r._obj.style.width=f.style_width,r._obj.style.height=f.style_height;var y=i();(f.timeline_scrollable||f.timeline_smart_rendering)&&(y.scrollable=f.timeline_scrollable,y.smart_rendering=f.timeline_smart_rendering)})(d),r.setCurrentView()}return u}}(e)})()},grid_view:function(e){vt("Grid",e.assert)},html_templates:function(e){e.attachEvent("onTemplatesReady",function(){for(var t=document.body.getElementsByTagName("DIV"),n=0;n<t.length;n++){var r=t[n].className||"";if((r=r.split(":")).length==2&&r[0]=="template"){var i='return "'+(t[n].innerHTML||"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/[\n\r]+/g,"")+'";';i=unescape(i).replace(/\{event\.([a-z]+)\}/g,function(a,o){return'"+ev.'+o+'+"'}),e.templates[r[1]]=Function("start","end","ev",i),t[n].style.display="none"}}})},key_nav:function(e){function t(n){var r={minicalButton:e.$keyboardNavigation.MinicalButton,minicalDate:e.$keyboardNavigation.MinicalCell,scheduler:e.$keyboardNavigation.SchedulerNode,dataArea:e.$keyboardNavigation.DataArea,timeSlot:e.$keyboardNavigation.TimeSlot,event:e.$keyboardNavigation.Event},i={};for(var a in r)i[a.toLowerCase()]=r[a];return i[n=(n+"").toLowerCase()]||r.scheduler}e.config.key_nav=!0,e.config.key_nav_step=30,e.addShortcut=function(n,r,i){var a=t(i);a&&a.prototype.bind(n,r)},e.getShortcutHandler=function(n,r){var i=t(r);if(i){var a=e.$keyboardNavigation.shortcuts.parse(n);if(a.length)return i.prototype.findHandler(a[0])}},e.removeShortcut=function(n,r){var i=t(r);i&&i.prototype.unbind(n)},e.focus=function(){if(e.config.key_nav){var n=e.$keyboardNavigation.dispatcher;n.enable();var r=n.getActiveNode();!r||r instanceof e.$keyboardNavigation.MinicalButton||r instanceof e.$keyboardNavigation.MinicalCell?n.setDefaultNode():n.focusNode(n.getActiveNode())}},e.$keyboardNavigation={},e._compose=function(){for(var n=Array.prototype.slice.call(arguments,0),r={},i=0;i<n.length;i++){var a=n[i];for(var o in typeof a=="function"&&(a=new a),a)r[o]=a[o]}return r},function(n){n.$keyboardNavigation.shortcuts={createCommand:function(){return{modifiers:{shift:!1,alt:!1,ctrl:!1,meta:!1},keyCode:null}},parse:function(r){for(var i=[],a=this.getExpressions(this.trim(r)),o=0;o<a.length;o++){for(var l=this.getWords(a[o]),s=this.createCommand(),d=0;d<l.length;d++)this.commandKeys[l[d]]?s.modifiers[l[d]]=!0:this.specialKeys[l[d]]?s.keyCode=this.specialKeys[l[d]]:s.keyCode=l[d].charCodeAt(0);i.push(s)}return i},getCommandFromEvent:function(r){var i=this.createCommand();i.modifiers.shift=!!r.shiftKey,i.modifiers.alt=!!r.altKey,i.modifiers.ctrl=!!r.ctrlKey,i.modifiers.meta=!!r.metaKey,i.keyCode=r.which||r.keyCode,i.keyCode>=96&&i.keyCode<=105&&(i.keyCode-=48);var a=String.fromCharCode(i.keyCode);return a&&(i.keyCode=a.toLowerCase().charCodeAt(0)),i},getHashFromEvent:function(r){return this.getHash(this.getCommandFromEvent(r))},getHash:function(r){var i=[];for(var a in r.modifiers)r.modifiers[a]&&i.push(a);return i.push(r.keyCode),i.join(this.junctionChar)},getExpressions:function(r){return r.split(this.junctionChar)},getWords:function(r){return r.split(this.combinationChar)},trim:function(r){return r.replace(/\s/g,"")},junctionChar:",",combinationChar:"+",commandKeys:{shift:16,alt:18,ctrl:17,meta:!0},specialKeys:{backspace:8,tab:9,enter:13,esc:27,space:32,up:38,down:40,left:37,right:39,home:36,end:35,pageup:33,pagedown:34,delete:46,insert:45,plus:107,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123}}}(e),function(n){n.$keyboardNavigation.EventHandler={_handlers:null,findHandler:function(r){this._handlers||(this._handlers={});var i=n.$keyboardNavigation.shortcuts.getHash(r);return this._handlers[i]},doAction:function(r,i){var a=this.findHandler(r);a&&(a.call(this,i),i.preventDefault?i.preventDefault():i.returnValue=!1)},bind:function(r,i){this._handlers||(this._handlers={});for(var a=n.$keyboardNavigation.shortcuts,o=a.parse(r),l=0;l<o.length;l++)this._handlers[a.getHash(o[l])]=i},unbind:function(r){for(var i=n.$keyboardNavigation.shortcuts,a=i.parse(r),o=0;o<a.length;o++)this._handlers[i.getHash(a[o])]&&delete this._handlers[i.getHash(a[o])]},bindAll:function(r){for(var i in r)this.bind(i,r[i])},initKeys:function(){this._handlers||(this._handlers={}),this.keys&&this.bindAll(this.keys)}}}(e),function(n){n.$keyboardNavigation.getFocusableNodes=n._getFocusableNodes,n.$keyboardNavigation.trapFocus=function(r,i){if(i.keyCode!=9)return!1;for(var a,o=n.$keyboardNavigation.getFocusableNodes(r),l=document.activeElement,s=-1,d=0;d<o.length;d++)if(o[d]==l){s=d;break}if(i.shiftKey){if(a=o[s<=0?o.length-1:s-1])return a.focus(),i.preventDefault(),!0}else if(a=o[s>=o.length-1?0:s+1])return a.focus(),i.preventDefault(),!0;return!1}}(e),function(n){n.$keyboardNavigation.marker={clear:function(){for(var r=n.$container.querySelectorAll(".dhx_focus_slot"),i=0;i<r.length;i++)r[i].parentNode.removeChild(r[i])},createElement:function(){var r=document.createElement("div");return r.setAttribute("tabindex",-1),r.className="dhx_focus_slot",r},renderMultiple:function(r,i,a){for(var o=[],l=new Date(r),s=new Date(Math.min(i.valueOf(),n.date.add(n.date.day_start(new Date(r)),1,"day").valueOf()));l.valueOf()<i.valueOf();)o=o.concat(a.call(this,l,new Date(Math.min(s.valueOf(),i.valueOf())))),l=n.date.day_start(n.date.add(l,1,"day")),s=n.date.day_start(n.date.add(l,1,"day")),s=new Date(Math.min(s.valueOf(),i.valueOf()));return o},render:function(r,i,a){this.clear();var o=[],l=n.$keyboardNavigation.TimeSlot.prototype._modes;switch(n.$keyboardNavigation.TimeSlot.prototype._getMode()){case l.units:o=this.renderVerticalMarker(r,i,a);break;case l.timeline:o=this.renderTimelineMarker(r,i,a);break;case l.year:o=o.concat(this.renderMultiple(r,i,this.renderYearMarker));break;case l.month:o=this.renderMonthMarker(r,i);break;case l.weekAgenda:o=o.concat(this.renderMultiple(r,i,this.renderWeekAgendaMarker));break;case l.list:o=this.renderAgendaMarker(r,i);break;case l.dayColumns:o=o.concat(this.renderMultiple(r,i,this.renderVerticalMarker))}this.addWaiAriaLabel(o,r,i,a),this.addDataAttributes(o,r,i,a);for(var s=o.length-1;s>=0;s--)if(o[s].offsetWidth)return o[s];return null},addDataAttributes:function(r,i,a,o){for(var l=n.date.date_to_str(n.config.api_date),s=l(i),d=l(a),c=0;c<r.length;c++)r[c].setAttribute("data-start-date",s),r[c].setAttribute("data-end-date",d),o&&r[c].setAttribute("data-section",o)},addWaiAriaLabel:function(r,i,a,o){var l="",s=n.getState().mode,d=!1;if(l+=n.templates.day_date(i),n.date.day_start(new Date(i)).valueOf()!=i.valueOf()&&(l+=" "+n.templates.hour_scale(i),d=!0),n.date.day_start(new Date(i)).valueOf()!=n.date.day_start(new Date(a)).valueOf()&&(l+=" - "+n.templates.day_date(a),(d||n.date.day_start(new Date(a)).valueOf()!=a.valueOf())&&(l+=" "+n.templates.hour_scale(a))),o){if(n.matrix&&n.matrix[s]){const u=n.matrix[s],f=u.y_unit[u.order[o]];l+=", "+n.templates[s+"_scale_label"](f.key,f.label,f)}else if(n._props&&n._props[s]){const u=n._props[s],f=u.options[u.order[o]];l+=", "+n.templates[s+"_scale_text"](f.key,f.label,f)}}for(var c=0;c<r.length;c++)n._waiAria.setAttributes(r[c],{"aria-label":l,"aria-live":"polite"})},renderWeekAgendaMarker:function(r,i){for(var a=n.$container.querySelectorAll(".dhx_wa_day_cont .dhx_wa_scale_bar"),o=n.date.week_start(new Date(n.getState().min_date)),l=-1,s=n.date.day_start(new Date(r)),d=0;d<a.length&&(l++,n.date.day_start(new Date(o)).valueOf()!=s.valueOf());d++)o=n.date.add(o,1,"day");return l!=-1?this._wrapDiv(a[l]):[]},_wrapDiv:function(r){var i=this.createElement();return i.style.top=r.offsetTop+"px",i.style.left=r.offsetLeft+"px",i.style.width=r.offsetWidth+"px",i.style.height=r.offsetHeight+"px",r.appendChild(i),[i]},renderYearMarker:function(r,i){var a=n._get_year_cell(r);a.style.position="relative";var o=this.createElement();return o.style.top="0px",o.style.left="0px",o.style.width="100%",o.style.height="100%",a.appendChild(o),[o]},renderAgendaMarker:function(r,i){var a=this.createElement();return a.style.height="1px",a.style.width="100%",a.style.opacity=1,a.style.top="0px",a.style.left="0px",n.$container.querySelector(".dhx_cal_data").appendChild(a),[a]},renderTimelineMarker:function(r,i,a){var o=n._lame_copy({},n.matrix[n._mode]),l=o._scales;o.round_position=!1;var s=[],d=r?new Date(r):n._min_date,c=i?new Date(i):n._max_date;if(d.valueOf()<n._min_date.valueOf()&&(d=new Date(n._min_date)),c.valueOf()>n._max_date.valueOf()&&(c=new Date(n._max_date)),!o._trace_x)return s;for(var u=0;u<o._trace_x.length&&!n._is_column_visible(o._trace_x[u]);u++);if(u==o._trace_x.length)return s;var f=l[a];if(!(d<i&&c>r))return s;var y=this.createElement();let g,h;function p(N,I){I.setDate(1),I.setFullYear(N.getFullYear()),I.setMonth(N.getMonth()),I.setDate(N.getDate())}if(n.getView().days){const N=new Date(r);p(n._min_date,N);const I=new Date(i);p(n._min_date,I),g=n._timeline_getX({start_date:N},!1,o),h=n._timeline_getX({start_date:I},!1,o)}else g=n._timeline_getX({start_date:r},!1,o),h=n._timeline_getX({start_date:i},!1,o);var v=o._section_height[a]-1||o.dy-1,x=0;n._isRender("cell")&&(x=f.offsetTop,g+=o.dx,h+=o.dx,f=n.$container.querySelector(".dhx_cal_data"));var S=Math.max(1,h-g-1);let O="left";return n.config.rtl&&(O="right"),y.style.cssText=`height:${v}px; ${O}:${g}px; width:${S}px; top:${x}px;`,f&&(f.appendChild(y),s.push(y)),s},renderMonthCell:function(r){for(var i=n.$container.querySelectorAll(".dhx_month_head"),a=[],o=0;o<i.length;o++)a.push(i[o].parentNode);var l=-1,s=0,d=-1,c=n.date.week_start(new Date(n.getState().min_date)),u=n.date.day_start(new Date(r));for(o=0;o<a.length&&(l++,d==6?(s++,d=0):d++,n.date.day_start(new Date(c)).valueOf()!=u.valueOf());o++)c=n.date.add(c,1,"day");if(l==-1)return[];var f=n._colsS[d],y=n._colsS.heights[s],g=this.createElement();g.style.top=y+"px",g.style.left=f+"px",g.style.width=n._cols[d]+"px",g.style.height=(n._colsS.heights[s+1]-y||n._colsS.height)+"px";var h=n.$container.querySelector(".dhx_cal_data"),p=h.querySelector(".dhx_cal_month_table");return p.nextSibling?h.insertBefore(g,p.nextSibling):h.appendChild(g),g},renderMonthMarker:function(r,i){for(var a=[],o=r;o.valueOf()<i.valueOf();)a.push(this.renderMonthCell(o)),o=n.date.add(o,1,"day");return a},renderVerticalMarker:function(r,i,a){var o=n.locate_holder_day(r),l=[],s=null,d=n.config;if(n._ignores[o])return l;if(n._props&&n._props[n._mode]&&a){var c=n._props[n._mode];o=c.order[a];var u=c.order[a];c.days>1?o=n.locate_holder_day(r)+u:(o=u,c.size&&o>c.position+c.size&&(o=0))}if(!(s=n.locate_holder(o))||s.querySelector(".dhx_scale_hour"))return document.createElement("div");var f=Math.max(60*r.getHours()+r.getMinutes(),60*d.first_hour),y=Math.min(60*i.getHours()+i.getMinutes(),60*d.last_hour);if(!y&&n.date.day_start(new Date(i)).valueOf()>n.date.day_start(new Date(r)).valueOf()&&(y=60*d.last_hour),y<=f)return[];var g=this.createElement(),h=n.config.hour_size_px*d.last_hour+1,p=36e5;return g.style.top=Math.round((60*f*1e3-n.config.first_hour*p)*n.config.hour_size_px/p)%h+"px",g.style.lineHeight=g.style.height=Math.max(Math.round(60*(y-f)*1e3*n.config.hour_size_px/p)%h,1)+"px",g.style.width="100%",s.appendChild(g),l.push(g),l[0]}}}(e),function(n){n.$keyboardNavigation.SchedulerNode=function(){},n.$keyboardNavigation.SchedulerNode.prototype=n._compose(n.$keyboardNavigation.EventHandler,{getDefaultNode:function(){var r=new n.$keyboardNavigation.TimeSlot;return r.isValid()||(r=r.fallback()),r},_modes:{month:"month",year:"year",dayColumns:"dayColumns",timeline:"timeline",units:"units",weekAgenda:"weekAgenda",list:"list"},getMode:function(){var r=n.getState().mode;return n.matrix&&n.matrix[r]?this._modes.timeline:n._props&&n._props[r]?this._modes.units:r=="month"?this._modes.month:r=="year"?this._modes.year:r=="week_agenda"?this._modes.weekAgenda:r=="map"||r=="agenda"||n._grid&&n["grid_"+r]?this._modes.list:this._modes.dayColumns},focus:function(){n.focus()},blur:function(){},disable:function(){n.$container.setAttribute("tabindex","0")},enable:function(){n.$container&&n.$container.removeAttribute("tabindex")},isEnabled:function(){return n.$container.hasAttribute("tabindex")},_compareEvents:function(r,i){return r.start_date.valueOf()==i.start_date.valueOf()?r.id>i.id?1:-1:r.start_date.valueOf()>i.start_date.valueOf()?1:-1},_pickEvent:function(r,i,a,o){var l=n.getState();r=new Date(Math.max(l.min_date.valueOf(),r.valueOf())),i=new Date(Math.min(l.max_date.valueOf(),i.valueOf()));var s=n.getEvents(r,i);s.sort(this._compareEvents),o&&(s=s.reverse());for(var d=!!a,c=0;c<s.length&&d;c++)s[c].id==a&&(d=!1),s.splice(c,1),c--;for(c=0;c<s.length;c++)if(new n.$keyboardNavigation.Event(s[c].id).getNode())return s[c];return null},nextEventHandler:function(r){var i=n.$keyboardNavigation.dispatcher.activeNode,a=r||i&&i.eventId,o=null;if(a&&n.getEvent(a)){var l=n.getEvent(a);o=n.$keyboardNavigation.SchedulerNode.prototype._pickEvent(l.start_date,n.date.add(l.start_date,1,"year"),l.id,!1)}if(!o&&!r){var s=n.getState();o=n.$keyboardNavigation.SchedulerNode.prototype._pickEvent(s.min_date,n.date.add(s.min_date,1,"year"),null,!1)}if(o){var d=new n.$keyboardNavigation.Event(o.id);d.isValid()?(i&&i.blur(),n.$keyboardNavigation.dispatcher.setActiveNode(d)):this.nextEventHandler(o.id)}},prevEventHandler:function(r){var i=n.$keyboardNavigation.dispatcher.activeNode,a=r||i&&i.eventId,o=null;if(a&&n.getEvent(a)){var l=n.getEvent(a);o=n.$keyboardNavigation.SchedulerNode.prototype._pickEvent(n.date.add(l.end_date,-1,"year"),l.end_date,l.id,!0)}if(!o&&!r){var s=n.getState();o=n.$keyboardNavigation.SchedulerNode.prototype._pickEvent(n.date.add(s.max_date,-1,"year"),s.max_date,null,!0)}if(o){var d=new n.$keyboardNavigation.Event(o.id);d.isValid()?(i&&i.blur(),n.$keyboardNavigation.dispatcher.setActiveNode(d)):this.prevEventHandler(o.id)}},keys:{"alt+1, alt+2, alt+3, alt+4, alt+5, alt+6, alt+7, alt+8, alt+9":function(r){var i=n.$keyboardNavigation.HeaderCell.prototype.getNodes(".dhx_cal_navline .dhx_cal_tab"),a=r.key;a===void 0&&(a=r.keyCode-48),i[1*a-1]&&i[1*a-1].click()},"ctrl+left,meta+left":function(r){n._click.dhx_cal_prev_button()},"ctrl+right,meta+right":function(r){n._click.dhx_cal_next_button()},"ctrl+up,meta+up":function(r){n.$container.querySelector(".dhx_cal_data").scrollTop-=20},"ctrl+down,meta+down":function(r){n.$container.querySelector(".dhx_cal_data").scrollTop+=20},e:function(){this.nextEventHandler()},home:function(){n.setCurrentView(new Date)},"shift+e":function(){this.prevEventHandler()},"ctrl+enter,meta+enter":function(){n.addEventNow({start_date:new Date(n.getState().date)})},"ctrl+c,meta+c":function(r){n._key_nav_copy_paste(r)},"ctrl+v,meta+v":function(r){n._key_nav_copy_paste(r)},"ctrl+x,meta+x":function(r){n._key_nav_copy_paste(r)}}}),n.$keyboardNavigation.SchedulerNode.prototype.bindAll(n.$keyboardNavigation.SchedulerNode.prototype.keys)}(e),function(n){n.$keyboardNavigation.KeyNavNode=function(){},n.$keyboardNavigation.KeyNavNode.prototype=n._compose(n.$keyboardNavigation.EventHandler,{isValid:function(){return!0},fallback:function(){return null},moveTo:function(r){n.$keyboardNavigation.dispatcher.setActiveNode(r)},compareTo:function(r){if(!r)return!1;for(var i in this){if(!!this[i]!=!!r[i])return!1;var a=!(!this[i]||!this[i].toString),o=!(!r[i]||!r[i].toString);if(o!=a)return!1;if(o&&a){if(r[i].toString()!=this[i].toString())return!1}else if(r[i]!=this[i])return!1}return!0},getNode:function(){},focus:function(){var r=this.getNode();r&&(r.setAttribute("tabindex","-1"),r.focus&&r.focus())},blur:function(){var r=this.getNode();r&&r.setAttribute("tabindex","-1")}})}(e),function(n){n.$keyboardNavigation.HeaderCell=function(r){this.index=r||0},n.$keyboardNavigation.HeaderCell.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{getNode:function(r){r=r||this.index||0;var i=this.getNodes();if(i[r])return i[r]},getNodes:function(r){r=r||[".dhx_cal_navline .dhx_cal_prev_button",".dhx_cal_navline .dhx_cal_next_button",".dhx_cal_navline .dhx_cal_today_button",".dhx_cal_navline .dhx_cal_tab"].join(", ");var i=Array.prototype.slice.call(n.$container.querySelectorAll(r));return i.sort(function(a,o){return a.offsetLeft-o.offsetLeft}),i},_handlers:null,isValid:function(){return!!this.getNode(this.index)},fallback:function(){var r=this.getNode(0);return r||(r=new n.$keyboardNavigation.TimeSlot),r},keys:{left:function(){var r=this.index-1;r<0&&(r=this.getNodes().length-1),this.moveTo(new n.$keyboardNavigation.HeaderCell(r))},right:function(){var r=this.index+1;r>=this.getNodes().length&&(r=0),this.moveTo(new n.$keyboardNavigation.HeaderCell(r))},down:function(){this.moveTo(new n.$keyboardNavigation.TimeSlot)},enter:function(){var r=this.getNode();r&&r.click()}}}),n.$keyboardNavigation.HeaderCell.prototype.bindAll(n.$keyboardNavigation.HeaderCell.prototype.keys)}(e),function(n){n.$keyboardNavigation.Event=function(r){if(this.eventId=null,n.getEvent(r)){var i=n.getEvent(r);this.start=new Date(i.start_date),this.end=new Date(i.end_date),this.section=this._getSection(i),this.eventId=r}},n.$keyboardNavigation.Event.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{_getNodes:function(){return Array.prototype.slice.call(n.$container.querySelectorAll("["+n.config.event_attribute+"]"))},_modes:n.$keyboardNavigation.SchedulerNode.prototype._modes,getMode:n.$keyboardNavigation.SchedulerNode.prototype.getMode,_handlers:null,isValid:function(){return!(!n.getEvent(this.eventId)||!this.getNode())},fallback:function(){var r=this._getNodes()[0],i=null;if(r&&n._locate_event(r)){var a=n._locate_event(r);i=new n.$keyboardNavigation.Event(a)}else i=new n.$keyboardNavigation.TimeSlot;return i},isScrolledIntoView:function(r){var i=r.getBoundingClientRect(),a=n.$container.querySelector(".dhx_cal_data").getBoundingClientRect();return!(i.bottom<a.top||i.top>a.bottom)},getNode:function(){var r="["+n.config.event_attribute+"='"+this.eventId+"']",i=n.$keyboardNavigation.dispatcher.getInlineEditor(this.eventId);if(i)return i;if(n.isMultisectionEvent&&n.isMultisectionEvent(n.getEvent(this.eventId))){for(var a=n.$container.querySelectorAll(r),o=0;o<a.length;o++)if(this.isScrolledIntoView(a[o]))return a[o];return a[0]}return n.$container.querySelector(r)},focus:function(){var r=n.getEvent(this.eventId),i=n.getState();(r.start_date.valueOf()>i.max_date.valueOf()||r.end_date.valueOf()<=i.min_date.valueOf())&&n.setCurrentView(r.start_date);var a=this.getNode();this.isScrolledIntoView(a)?n.$keyboardNavigation.dispatcher.keepScrollPosition((function(){n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this)}).bind(this)):n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this)},blur:function(){n.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this)},_getSection:function(r){var i=null,a=n.getState().mode;return n.matrix&&n.matrix[a]?i=r[n.matrix[n.getState().mode].y_property]:n._props&&n._props[a]&&(i=r[n._props[a].map_to]),i},_moveToSlot:function(r){var i=n.getEvent(this.eventId);if(i){var a=this._getSection(i),o=new n.$keyboardNavigation.TimeSlot(i.start_date,null,a);this.moveTo(o.nextSlot(o,r))}else this.moveTo(new n.$keyboardNavigation.TimeSlot)},keys:{left:function(){this._moveToSlot("left")},right:function(){this._moveToSlot("right")},down:function(){this.getMode()==this._modes.list?n.$keyboardNavigation.SchedulerNode.prototype.nextEventHandler():this._moveToSlot("down")},space:function(){var r=this.getNode();r&&r.click?r.click():this.moveTo(new n.$keyboardNavigation.TimeSlot)},up:function(){this.getMode()==this._modes.list?n.$keyboardNavigation.SchedulerNode.prototype.prevEventHandler():this._moveToSlot("up")},delete:function(){n.getEvent(this.eventId)?n._click.buttons.delete(this.eventId):this.moveTo(new n.$keyboardNavigation.TimeSlot)},enter:function(){n.getEvent(this.eventId)?n.showLightbox(this.eventId):this.moveTo(new n.$keyboardNavigation.TimeSlot)}}}),n.$keyboardNavigation.Event.prototype.bindAll(n.$keyboardNavigation.Event.prototype.keys)}(e),function(n){n.$keyboardNavigation.TimeSlot=function(r,i,a,o){var l=n.getState(),s=n.matrix&&n.matrix[l.mode];r||(r=this.getDefaultDate()),i||(i=s?n.date.add(r,s.x_step,s.x_unit):n.date.add(r,n.config.key_nav_step,"minute")),this.section=a||this._getDefaultSection(),this.start_date=new Date(r),this.end_date=new Date(i),this.movingDate=o||null},n.$keyboardNavigation.TimeSlot.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{_handlers:null,getDefaultDate:function(){var r,i=n.getState(),a=new Date(i.date);a.setSeconds(0),a.setMilliseconds(0);var o=new Date;o.setSeconds(0),o.setMilliseconds(0);var l=n.matrix&&n.matrix[i.mode],s=!1;if(a.valueOf()===o.valueOf()&&(s=!0),l)s?(l.x_unit==="day"?(o.setHours(0),o.setMinutes(0)):l.x_unit==="hour"&&o.setMinutes(0),r=o):r=n.date[l.name+"_start"](new Date(i.date)),r=this.findVisibleColumn(r);else if(r=new Date(n.getState().min_date),s&&(r=o),r=this.findVisibleColumn(r),s||r.setHours(n.config.first_hour),!n._table_view){var d=n.$container.querySelector(".dhx_cal_data");d.scrollTop&&r.setHours(n.config.first_hour+Math.ceil(d.scrollTop/n.config.hour_size_px))}return r},clone:function(r){return new n.$keyboardNavigation.TimeSlot(r.start_date,r.end_date,r.section,r.movingDate)},_getMultisectionView:function(){var r,i=n.getState();return n._props&&n._props[i.mode]?r=n._props[i.mode]:n.matrix&&n.matrix[i.mode]&&(r=n.matrix[i.mode]),r},_getDefaultSection:function(){var r=null;return this._getMultisectionView()&&!r&&(r=this._getNextSection()),r},_getNextSection:function(r,i){var a=this._getMultisectionView(),o=a.order[r],l=o;(l=o!==void 0?o+i:a.size&&a.position?a.position:0)<0&&(l=0);var s=a.options||a.y_unit;return l>=s.length&&(l=s.length-1),s[l]?s[l].key:null},isValid:function(){var r=n.getState();if(this.start_date.valueOf()<r.min_date.valueOf()||this.start_date.valueOf()>=r.max_date.valueOf()||!this.isVisible(this.start_date,this.end_date))return!1;var i=this._getMultisectionView();return!i||i.order[this.section]!==void 0},fallback:function(){var r=new n.$keyboardNavigation.TimeSlot;return r.isValid()?r:new n.$keyboardNavigation.DataArea},getNodes:function(){return Array.prototype.slice.call(n.$container.querySelectorAll(".dhx_focus_slot"))},getNode:function(){return this.getNodes()[0]},focus:function(){this.section&&n.getView()&&n.getView().smart_rendering&&n.getView().scrollTo&&!n.$container.querySelector(`[data-section-id="${this.section}"]`)&&n.getView().scrollTo({section:this.section}),n.$keyboardNavigation.marker.render(this.start_date,this.end_date,this.section),n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this),n.$keyboardNavigation._pasteDate=this.start_date,n.$keyboardNavigation._pasteSection=this.section},blur:function(){n.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this),n.$keyboardNavigation.marker.clear()},_modes:n.$keyboardNavigation.SchedulerNode.prototype._modes,_getMode:n.$keyboardNavigation.SchedulerNode.prototype.getMode,addMonthDate:function(r,i,a){var o;switch(i){case"up":o=n.date.add(r,-1,"week");break;case"down":o=n.date.add(r,1,"week");break;case"left":o=n.date.day_start(n.date.add(r,-1,"day")),o=this.findVisibleColumn(o,-1);break;case"right":o=n.date.day_start(n.date.add(r,1,"day")),o=this.findVisibleColumn(o,1);break;default:o=n.date.day_start(new Date(r))}var l=n.getState();return(r.valueOf()<l.min_date.valueOf()||!a&&r.valueOf()>=l.max_date.valueOf())&&(o=new Date(l.min_date)),o},nextMonthSlot:function(r,i,a){var o,l;return(o=this.addMonthDate(r.start_date,i,a)).setHours(n.config.first_hour),(l=new Date(o)).setHours(n.config.last_hour),{start_date:o,end_date:l}},_alignTimeSlot:function(r,i,a,o){for(var l=new Date(i);l.valueOf()<r.valueOf();)l=n.date.add(l,o,a);return l.valueOf()>r.valueOf()&&(l=n.date.add(l,-o,a)),l},nextTimelineSlot:function(r,i,a){var o=n.getState(),l=n.matrix[o.mode],s=this._alignTimeSlot(r.start_date,n.date[l.name+"_start"](new Date(r.start_date)),l.x_unit,l.x_step),d=this._alignTimeSlot(r.end_date,n.date[l.name+"_start"](new Date(r.end_date)),l.x_unit,l.x_step);d.valueOf()<=s.valueOf()&&(d=n.date.add(s,l.x_step,l.x_unit));var c=this.clone(r);switch(c.start_date=s,c.end_date=d,c.section=r.section||this._getNextSection(),i){case"up":c.section=this._getNextSection(r.section,-1);break;case"down":c.section=this._getNextSection(r.section,1);break;case"left":c.start_date=this.findVisibleColumn(n.date.add(c.start_date,-l.x_step,l.x_unit),-1),c.end_date=n.date.add(c.start_date,l.x_step,l.x_unit);break;case"right":c.start_date=this.findVisibleColumn(n.date.add(c.start_date,l.x_step,l.x_unit),1),c.end_date=n.date.add(c.start_date,l.x_step,l.x_unit)}return(c.start_date.valueOf()<o.min_date.valueOf()||c.start_date.valueOf()>=o.max_date.valueOf())&&(a&&c.start_date.valueOf()>=o.max_date.valueOf()?c.start_date=new Date(o.max_date):(c.start_date=n.date[o.mode+"_start"](n.date.add(o.date,i=="left"?-1:1,o.mode)),c.end_date=n.date.add(c.start_date,l.x_step,l.x_unit))),c},nextUnitsSlot:function(r,i,a){var o=this.clone(r);o.section=r.section||this._getNextSection();var l=r.section||this._getNextSection(),s=n.getState(),d=n._props[s.mode];switch(i){case"left":l=this._getNextSection(r.section,-1);var c=d.size?d.size-1:d.options.length;d.days>1&&d.order[l]==c-1&&n.date.add(r.start_date,-1,"day").valueOf()>=s.min_date.valueOf()&&(o=this.nextDaySlot(r,i,a));break;case"right":l=this._getNextSection(r.section,1),d.days>1&&!d.order[l]&&n.date.add(r.start_date,1,"day").valueOf()<s.max_date.valueOf()&&(o=this.nextDaySlot(r,i,a));break;default:o=this.nextDaySlot(r,i,a),l=r.section}return o.section=l,o},_moveDate:function(r,i){var a=this.findVisibleColumn(n.date.add(r,i,"day"),i);return a.setHours(r.getHours()),a.setMinutes(r.getMinutes()),a},isBeforeLastHour:function(r,i){var a=r.getMinutes(),o=r.getHours(),l=n.config.last_hour;return o<l||!i&&(l==24||o==l)&&!a},isAfterFirstHour:function(r,i){var a=r.getMinutes(),o=r.getHours(),l=n.config.first_hour,s=n.config.last_hour;return o>=l||!i&&!a&&(!o&&s==24||o==s)},isInVisibleDayTime:function(r,i){return this.isBeforeLastHour(r,i)&&this.isAfterFirstHour(r,i)},nextDaySlot:function(r,i,a){var o,l,s=n.config.key_nav_step,d=this._alignTimeSlot(r.start_date,n.date.day_start(new Date(r.start_date)),"minute",s),c=r.start_date;switch(i){case"up":if(o=n.date.add(d,-s,"minute"),!this.isInVisibleDayTime(o,!0)&&(!a||this.isInVisibleDayTime(c,!0))){var u=!0;a&&n.date.date_part(new Date(o)).valueOf()!=n.date.date_part(new Date(c)).valueOf()&&(u=!1),u&&(o=this.findVisibleColumn(n.date.add(r.start_date,-1,"day"),-1)),o.setHours(n.config.last_hour),o.setMinutes(0),o=n.date.add(o,-s,"minute")}l=n.date.add(o,s,"minute");break;case"down":o=n.date.add(d,s,"minute");var f=a?o:n.date.add(o,s,"minute");this.isInVisibleDayTime(f,!1)||a&&!this.isInVisibleDayTime(c,!1)||(a?(u=!0,n.date.date_part(new Date(c)).valueOf()==c.valueOf()&&(u=!1),u&&(o=this.findVisibleColumn(n.date.add(r.start_date,1,"day"),1)),o.setHours(n.config.first_hour),o.setMinutes(0),o=n.date.add(o,s,"minute")):((o=this.findVisibleColumn(n.date.add(r.start_date,1,"day"),1)).setHours(n.config.first_hour),o.setMinutes(0))),l=n.date.add(o,s,"minute");break;case"left":o=this._moveDate(r.start_date,-1),l=this._moveDate(r.end_date,-1);break;case"right":o=this._moveDate(r.start_date,1),l=this._moveDate(r.end_date,1);break;default:o=d,l=n.date.add(o,s,"minute")}return{start_date:o,end_date:l}},nextWeekAgendaSlot:function(r,i){var a,o,l=n.getState();switch(i){case"down":case"left":a=n.date.day_start(n.date.add(r.start_date,-1,"day")),a=this.findVisibleColumn(a,-1);break;case"up":case"right":a=n.date.day_start(n.date.add(r.start_date,1,"day")),a=this.findVisibleColumn(a,1);break;default:a=n.date.day_start(r.start_date)}return(r.start_date.valueOf()<l.min_date.valueOf()||r.start_date.valueOf()>=l.max_date.valueOf())&&(a=new Date(l.min_date)),(o=new Date(a)).setHours(n.config.last_hour),{start_date:a,end_date:o}},nextAgendaSlot:function(r,i){return{start_date:r.start_date,end_date:r.end_date}},isDateVisible:function(r){if(!n._ignores_detected)return!0;var i,a=n.matrix&&n.matrix[n.getState().mode];return i=a?n._get_date_index(a,r):n.locate_holder_day(r),!n._ignores[i]},findVisibleColumn:function(r,i){var a=r;i=i||1;for(var o=n.getState();!this.isDateVisible(a)&&(i>0&&a.valueOf()<=o.max_date.valueOf()||i<0&&a.valueOf()>=o.min_date.valueOf());)a=this.nextDateColumn(a,i);return a},nextDateColumn:function(r,i){i=i||1;var a=n.matrix&&n.matrix[n.getState().mode];return a?n.date.add(r,i*a.x_step,a.x_unit):n.date.day_start(n.date.add(r,i,"day"))},isVisible:function(r,i){if(!n._ignores_detected)return!0;for(var a=new Date(r);a.valueOf()<i.valueOf();){if(this.isDateVisible(a))return!0;a=this.nextDateColumn(a)}return!1},nextSlot:function(r,i,a,o){var l;a=a||this._getMode();var s=n.$keyboardNavigation.TimeSlot.prototype.clone(r);switch(a){case this._modes.units:l=this.nextUnitsSlot(s,i,o);break;case this._modes.timeline:l=this.nextTimelineSlot(s,i,o);break;case this._modes.year:case this._modes.month:l=this.nextMonthSlot(s,i,o);break;case this._modes.weekAgenda:l=this.nextWeekAgendaSlot(s,i,o);break;case this._modes.list:l=this.nextAgendaSlot(s,i,o);break;case this._modes.dayColumns:l=this.nextDaySlot(s,i,o)}return l.start_date.valueOf()>=l.end_date.valueOf()&&(l=this.nextSlot(l,i,a)),n.$keyboardNavigation.TimeSlot.prototype.clone(l)},extendSlot:function(r,i){var a;switch(this._getMode()){case this._modes.units:a=i=="left"||i=="right"?this.nextUnitsSlot(r,i):this.extendUnitsSlot(r,i);break;case this._modes.timeline:a=i=="down"||i=="up"?this.nextTimelineSlot(r,i):this.extendTimelineSlot(r,i);break;case this._modes.year:case this._modes.month:a=this.extendMonthSlot(r,i);break;case this._modes.dayColumns:a=this.extendDaySlot(r,i);break;case this._modes.weekAgenda:a=this.extendWeekAgendaSlot(r,i);break;default:a=r}var o=n.getState();return a.start_date.valueOf()<o.min_date.valueOf()&&(a.start_date=this.findVisibleColumn(o.min_date),a.start_date.setHours(n.config.first_hour)),a.end_date.valueOf()>o.max_date.valueOf()&&(a.end_date=this.findVisibleColumn(o.max_date,-1)),n.$keyboardNavigation.TimeSlot.prototype.clone(a)},extendTimelineSlot:function(r,i){return this.extendGenericSlot({left:"start_date",right:"end_date"},r,i,"timeline")},extendWeekAgendaSlot:function(r,i){return this.extendGenericSlot({left:"start_date",right:"end_date"},r,i,"weekAgenda")},extendGenericSlot:function(r,i,a,o){var l,s=i.movingDate;if(s||(s=r[a]),!s||!r[a])return i;if(!a)return n.$keyboardNavigation.TimeSlot.prototype.clone(i);(l=this.nextSlot({start_date:i[s],section:i.section},a,o,!0)).start_date.valueOf()==i.start_date.valueOf()&&(l=this.nextSlot({start_date:l.start_date,section:l.section},a,o,!0)),l.movingDate=s;var d=this.extendSlotDates(i,l,l.movingDate);return d.end_date.valueOf()<=d.start_date.valueOf()&&(l.movingDate=l.movingDate=="end_date"?"start_date":"end_date"),d=this.extendSlotDates(i,l,l.movingDate),l.start_date=d.start_date,l.end_date=d.end_date,l},extendSlotDates:function(r,i,a){var o={start_date:null,end_date:null};return a=="start_date"?(o.start_date=i.start_date,o.end_date=r.end_date):(o.start_date=r.start_date,o.end_date=i.start_date),o},extendMonthSlot:function(r,i){return(r=this.extendGenericSlot({up:"start_date",down:"end_date",left:"start_date",right:"end_date"},r,i,"month")).start_date.setHours(n.config.first_hour),r.end_date=n.date.add(r.end_date,-1,"day"),r.end_date.setHours(n.config.last_hour),r},extendUnitsSlot:function(r,i){var a;switch(i){case"down":case"up":a=this.extendDaySlot(r,i);break;default:a=r}return a.section=r.section,a},extendDaySlot:function(r,i){return this.extendGenericSlot({up:"start_date",down:"end_date",left:"start_date",right:"end_date"},r,i,"dayColumns")},scrollSlot:function(r){var i=n.getState(),a=this.nextSlot(this,r);(a.start_date.valueOf()<i.min_date.valueOf()||a.start_date.valueOf()>=i.max_date.valueOf())&&n.setCurrentView(new Date(a.start_date)),this.moveTo(a)},keys:{left:function(){this.scrollSlot("left")},right:function(){this.scrollSlot("right")},down:function(){this._getMode()==this._modes.list?n.$keyboardNavigation.SchedulerNode.prototype.nextEventHandler():this.scrollSlot("down")},up:function(){this._getMode()==this._modes.list?n.$keyboardNavigation.SchedulerNode.prototype.prevEventHandler():this.scrollSlot("up")},"shift+down":function(){this.moveTo(this.extendSlot(this,"down"))},"shift+up":function(){this.moveTo(this.extendSlot(this,"up"))},"shift+right":function(){this.moveTo(this.extendSlot(this,"right"))},"shift+left":function(){this.moveTo(this.extendSlot(this,"left"))},enter:function(){var r={start_date:new Date(this.start_date),end_date:new Date(this.end_date)},i=n.getState().mode;n.matrix&&n.matrix[i]?r[n.matrix[n.getState().mode].y_property]=this.section:n._props&&n._props[i]&&(r[n._props[i].map_to]=this.section),n.addEventNow(r)}}}),n.$keyboardNavigation.TimeSlot.prototype.bindAll(n.$keyboardNavigation.TimeSlot.prototype.keys)}(e),function(n){n.$keyboardNavigation.MinicalButton=function(r,i){this.container=r,this.index=i||0},n.$keyboardNavigation.MinicalButton.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{isValid:function(){return!!this.container.offsetWidth},fallback:function(){var r=new n.$keyboardNavigation.TimeSlot;return r.isValid()?r:new n.$keyboardNavigation.DataArea},focus:function(){n.$keyboardNavigation.dispatcher.globalNode.disable(),this.container.removeAttribute("tabindex"),n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this)},blur:function(){this.container.setAttribute("tabindex","0"),n.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this)},getNode:function(){return this.index?this.container.querySelector(".dhx_cal_next_button"):this.container.querySelector(".dhx_cal_prev_button")},keys:{right:function(r){this.moveTo(new n.$keyboardNavigation.MinicalButton(this.container,this.index?0:1))},left:function(r){this.moveTo(new n.$keyboardNavigation.MinicalButton(this.container,this.index?0:1))},down:function(){var r=new n.$keyboardNavigation.MinicalCell(this.container,0,0);r&&!r.isValid()&&(r=r.fallback()),this.moveTo(r)},enter:function(r){this.getNode().click()}}}),n.$keyboardNavigation.MinicalButton.prototype.bindAll(n.$keyboardNavigation.MinicalButton.prototype.keys)}(e),function(n){n.$keyboardNavigation.MinicalCell=function(r,i,a){this.container=r,this.row=i||0,this.col=a||0},n.$keyboardNavigation.MinicalCell.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{isValid:function(){var r=this._getGrid();return!(!r[this.row]||!r[this.row][this.col])},fallback:function(){var r=this.row,i=this.col,a=this._getGrid();a[r]||(r=0);var o=!0;if(r>a.length/2&&(o=!1),!a[r]){var l=new n.$keyboardNavigation.TimeSlot;return l.isValid()?l:new n.$keyboardNavigation.DataArea}if(o){for(var s=i;a[r]&&s<a[r].length;s++)if(a[r][s]||s!=a[r].length-1||(r++,i=0),a[r][s])return new n.$keyboardNavigation.MinicalCell(this.container,r,s)}else for(s=i;a[r]&&s<a[r].length;s--)if(a[r][s]||s||(i=a[--r].length-1),a[r][s])return new n.$keyboardNavigation.MinicalCell(this.container,r,s);return new n.$keyboardNavigation.MinicalButton(this.container,0)},focus:function(){n.$keyboardNavigation.dispatcher.globalNode.disable(),this.container.removeAttribute("tabindex"),n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this)},blur:function(){this.container.setAttribute("tabindex","0"),n.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this)},_getNode:function(r,i){return this.container.querySelector(".dhx_year_body tr:nth-child("+(r+1)+") td:nth-child("+(i+1)+")")},getNode:function(){return this._getNode(this.row,this.col)},_getGrid:function(){for(var r=this.container.querySelectorAll(".dhx_year_body tr"),i=[],a=0;a<r.length;a++){i[a]=[];for(var o=r[a].querySelectorAll("td"),l=0;l<o.length;l++){var s=o[l],d=!0,c=n._getClassName(s);(c.indexOf("dhx_after")>-1||c.indexOf("dhx_before")>-1||c.indexOf("dhx_scale_ignore")>-1)&&(d=!1),i[a][l]=d}}return i},keys:{right:function(r){var i=this._getGrid(),a=this.row,o=this.col+1;i[a]&&i[a][o]||(i[a+1]?(a+=1,o=0):o=this.col);var l=new n.$keyboardNavigation.MinicalCell(this.container,a,o);l.isValid()||(l=l.fallback()),this.moveTo(l)},left:function(r){var i=this._getGrid(),a=this.row,o=this.col-1;i[a]&&i[a][o]||(o=i[a-1]?i[a-=1].length-1:this.col);var l=new n.$keyboardNavigation.MinicalCell(this.container,a,o);l.isValid()||(l=l.fallback()),this.moveTo(l)},down:function(){var r=this._getGrid(),i=this.row+1,a=this.col;r[i]&&r[i][a]||(i=this.row);var o=new n.$keyboardNavigation.MinicalCell(this.container,i,a);o.isValid()||(o=o.fallback()),this.moveTo(o)},up:function(){var r=this._getGrid(),i=this.row-1,a=this.col;if(r[i]&&r[i][a]){var o=new n.$keyboardNavigation.MinicalCell(this.container,i,a);o.isValid()||(o=o.fallback()),this.moveTo(o)}else{var l=0;this.col>r[this.row].length/2&&(l=1),this.moveTo(new n.$keyboardNavigation.MinicalButton(this.container,l))}},enter:function(r){this.getNode().querySelector(".dhx_month_head").click()}}}),n.$keyboardNavigation.MinicalCell.prototype.bindAll(n.$keyboardNavigation.MinicalCell.prototype.keys)}(e),function(n){n.$keyboardNavigation.DataArea=function(r){this.index=r||0},n.$keyboardNavigation.DataArea.prototype=n._compose(n.$keyboardNavigation.KeyNavNode,{getNode:function(r){return n.$container.querySelector(".dhx_cal_data")},_handlers:null,isValid:function(){return!0},fallback:function(){return this},keys:{"up,down,right,left":function(){this.moveTo(new n.$keyboardNavigation.TimeSlot)}}}),n.$keyboardNavigation.DataArea.prototype.bindAll(n.$keyboardNavigation.DataArea.prototype.keys)}(e),M_(e),function(n){n.$keyboardNavigation.dispatcher={isActive:!1,activeNode:null,globalNode:new n.$keyboardNavigation.SchedulerNode,keepScrollPosition:function(r){var i,a,o=n.$container.querySelector(".dhx_timeline_scrollable_data");o||(o=n.$container.querySelector(".dhx_cal_data")),o&&(i=o.scrollTop,a=o.scrollLeft),r(),o&&(o.scrollTop=i,o.scrollLeft=a)},enable:function(){if(n.$container){this.isActive=!0;var r=this;this.keepScrollPosition(function(){r.globalNode.enable(),r.setActiveNode(r.getActiveNode())})}},disable:function(){this.isActive=!1,this.globalNode.disable()},isEnabled:function(){return!!this.isActive},getDefaultNode:function(){return this.globalNode.getDefaultNode()},setDefaultNode:function(){this.setActiveNode(this.getDefaultNode())},getActiveNode:function(){var r=this.activeNode;return r&&!r.isValid()&&(r=r.fallback()),r},focusGlobalNode:function(){this.blurNode(this.globalNode),this.focusNode(this.globalNode)},setActiveNode:function(r){r&&r.isValid()&&(this.activeNode&&this.activeNode.compareTo(r)||this.isEnabled()&&(this.blurNode(this.activeNode),this.activeNode=r,this.focusNode(this.activeNode)))},focusNode:function(r){r&&r.focus&&(r.focus(),r.getNode&&document.activeElement!=r.getNode()&&this.setActiveNode(new n.$keyboardNavigation.DataArea))},blurNode:function(r){r&&r.blur&&r.blur()},getInlineEditor:function(r){var i=n.$container.querySelector(".dhx_cal_editor["+n.config.event_attribute+"='"+r+"'] textarea");return i&&i.offsetWidth?i:null},keyDownHandler:function(r){if(!r.defaultPrevented){var i=this.getActiveNode();if((!n.$keyboardNavigation.isModal()||i&&i.container&&n.utils.dom.locateCss({target:i.container},"dhx_minical_popup",!1))&&(!n.getState().editor_id||!this.getInlineEditor(n.getState().editor_id))&&this.isEnabled()){r=r||window.event;var a=this.globalNode,o=n.$keyboardNavigation.shortcuts.getCommandFromEvent(r);i?i.findHandler(o)?i.doAction(o,r):a.findHandler(o)&&a.doAction(o,r):this.setDefaultNode()}}},_timeout:null,delay:function(r,i){clearTimeout(this._timeout),this._timeout=setTimeout(r,i||1)}}}(e),O_(e),function(){R_(e),function(l){l.$keyboardNavigation._minicalendars=[],l.$keyboardNavigation.isMinical=function(s){for(var d=l.$keyboardNavigation._minicalendars,c=0;c<d.length;c++)if(this.isChildOf(s,d[c]))return!0;return!1},l.$keyboardNavigation.isChildOf=function(s,d){for(;s&&s!==d;)s=s.parentNode;return s===d},l.$keyboardNavigation.patchMinicalendar=function(){var s=l.$keyboardNavigation.dispatcher;function d(y){var g=y.target;s.enable(),s.setActiveNode(new l.$keyboardNavigation.MinicalButton(g,0))}function c(y){var g=y.target||y.srcElement,h=l.utils.dom.locateCss(y,"dhx_cal_prev_button",!1),p=l.utils.dom.locateCss(y,"dhx_cal_next_button",!1),v=l.utils.dom.locateCss(y,"dhx_year_body",!1),x=0,S=0;if(v){for(var O,N,I=g;I&&I.tagName.toLowerCase()!="td";)I=I.parentNode;if(I&&(O=(N=I).parentNode),O&&N){for(var A=O.parentNode.querySelectorAll("tr"),m=0;m<A.length;m++)if(A[m]==O){x=m;break}var b=O.querySelectorAll("td");for(m=0;m<b.length;m++)if(b[m]==N){S=m;break}}}var k=y.currentTarget;s.delay(function(){var E;(h||p||v)&&(h?(E=new l.$keyboardNavigation.MinicalButton(k,0),s.setActiveNode(new l.$keyboardNavigation.MinicalButton(k,0))):p?E=new l.$keyboardNavigation.MinicalButton(k,1):v&&(E=new l.$keyboardNavigation.MinicalCell(k,x,S)),E&&(s.enable(),E.isValid()&&(s.activeNode=null,s.setActiveNode(E))))})}if(l.renderCalendar){var u=l.renderCalendar;l.renderCalendar=function(){var y=u.apply(this,arguments),g=l.$keyboardNavigation._minicalendars;l.eventRemove(y,"click",c),l.event(y,"click",c),l.eventRemove(y,"focus",d),l.event(y,"focus",d);for(var h=!1,p=0;p<g.length;p++)if(g[p]==y){h=!0;break}if(h||g.push(y),s.isEnabled()){var v=s.getActiveNode();v&&v.container==y?s.focusNode(v):y.setAttribute("tabindex","0")}else y.setAttribute("tabindex","0");return y}}if(l.destroyCalendar){var f=l.destroyCalendar;l.destroyCalendar=function(y,g){y=y||(l._def_count?l._def_count.firstChild:null);var h=f.apply(this,arguments);if(!y||!y.parentNode)for(var p=l.$keyboardNavigation._minicalendars,v=0;v<p.length;v++)p[v]==y&&(l.eventRemove(p[v],"focus",d),p.splice(v,1),v--);return h}}}}(e);var n=e.$keyboardNavigation.dispatcher;if(e.$keyboardNavigation.attachSchedulerHandlers(),e.renderCalendar)e.$keyboardNavigation.patchMinicalendar();else var r=e.attachEvent("onSchedulerReady",function(){e.detachEvent(r),e.$keyboardNavigation.patchMinicalendar()});function i(){if(e.config.key_nav){var l=document.activeElement;return!(!l||e.utils.dom.locateCss(l,"dhx_cal_quick_info",!1))&&(e.$keyboardNavigation.isChildOf(l,e.$container)||e.$keyboardNavigation.isMinical(l))}}function a(l){l&&!n.isEnabled()?n.enable():!l&&n.isEnabled()&&n.disable()}const o=setInterval(function(){if(e.$container&&e.$keyboardNavigation.isChildOf(e.$container,document.body)){var l=i();l?a(l):!l&&n.isEnabled()&&setTimeout(function(){e.$destroyed||(e.config.key_nav?a(i()):e.$container.removeAttribute("tabindex"))},100)}},500);e.attachEvent("onDestroy",function(){clearInterval(o)})}()},layer:function(e){e.attachEvent("onTemplatesReady",function(){this.layers.sort(function(n,r){return n.zIndex-r.zIndex}),e._dp_init=function(n){n._methods=["_set_event_text_style","","changeEventId","deleteEvent"],this.attachEvent("onEventAdded",function(r){!this._loading&&this.validId(r)&&this.getEvent(r)&&this.getEvent(r).layer==n.layer&&n.setUpdated(r,!0,"inserted")}),this.attachEvent("onBeforeEventDelete",function(r){if(this.getEvent(r)&&this.getEvent(r).layer==n.layer){if(!this.validId(r))return;var i=n.getState(r);return i=="inserted"||this._new_event?(n.setUpdated(r,!1),!0):i!="deleted"&&(i=="true_deleted"||(n.setUpdated(r,!0,"deleted"),!1))}return!0}),this.attachEvent("onEventChanged",function(r){!this._loading&&this.validId(r)&&this.getEvent(r)&&this.getEvent(r).layer==n.layer&&n.setUpdated(r,!0,"updated")}),n._getRowData=function(r,i){var a=this.obj.getEvent(r),o={};for(var l in a)l.indexOf("_")!==0&&(a[l]&&a[l].getUTCFullYear?o[l]=this.obj._helpers.formatDate(a[l]):o[l]=a[l]);return o},n._clearUpdateFlag=function(){},n.attachEvent("insertCallback",e._update_callback),n.attachEvent("updateCallback",e._update_callback),n.attachEvent("deleteCallback",function(r,i){this.obj.setUserData(i,this.action_param,"true_deleted"),this.obj.deleteEvent(i)})},function(){var n=function(a){if(a===null||typeof a!="object")return a;var o=new a.constructor;for(var l in a)o[l]=n(a[l]);return o};e._dataprocessors=[],e._layers_zindex={};for(var r=0;r<e.layers.length;r++){if(e.config["lightbox_"+e.layers[r].name]={},e.config["lightbox_"+e.layers[r].name].sections=n(e.config.lightbox.sections),e._layers_zindex[e.layers[r].name]=e.config.initial_layer_zindex||5+3*r,e.layers[r].url){var i=e.createDataProcessor({url:e.layers[r].url});i.layer=e.layers[r].name,e._dataprocessors.push(i),e._dataprocessors[r].init(e)}e.layers[r].isDefault&&(e.defaultLayer=e.layers[r].name)}}(),e.showLayer=function(n){this.toggleLayer(n,!0)},e.hideLayer=function(n){this.toggleLayer(n,!1)},e.toggleLayer=function(n,r){var i=this.getLayer(n);i.visible=r!==void 0?!!r:!i.visible,this.setCurrentView(this._date,this._mode)},e.getLayer=function(n){var r,i;typeof n=="string"&&(i=n),typeof n=="object"&&(i=n.layer);for(var a=0;a<e.layers.length;a++)e.layers[a].name==i&&(r=e.layers[a]);return r},e.attachEvent("onBeforeLightbox",function(n){var r=this.getEvent(n);return this.config.lightbox.sections=this.config["lightbox_"+r.layer].sections,e.resetLightbox(),!0}),e.attachEvent("onClick",function(n,r){var i=e.getEvent(n);return!e.getLayer(i.layer).noMenu}),e.attachEvent("onEventCollision",function(n,r){var i=this.getLayer(n);if(!i.checkCollision)return!1;for(var a=0,o=0;o<r.length;o++)r[o].layer==i.name&&r[o].id!=n.id&&a++;return a>=e.config.collision_limit}),e.addEvent=function(n,r,i,a,o){var l=n;arguments.length!=1&&((l=o||{}).start_date=n,l.end_date=r,l.text=i,l.id=a,l.layer=this.defaultLayer),l.id=l.id||e.uid(),l.text=l.text||"",typeof l.start_date=="string"&&(l.start_date=this.templates.api_date(l.start_date)),typeof l.end_date=="string"&&(l.end_date=this.templates.api_date(l.end_date)),l._timed=this.isOneDayEvent(l);var s=!this._events[l.id];this._events[l.id]=l,this.event_updated(l),this._loading||this.callEvent(s?"onEventAdded":"onEventChanged",[l.id,l])},this._evs_layer={};for(var t=0;t<this.layers.length;t++)this._evs_layer[this.layers[t].name]=[];e.addEventNow=function(n,r,i){var a={};typeof n=="object"&&(a=n,n=null);var o=6e4*(this.config.event_duration||this.config.time_step);n||(n=Math.round(e._currentDate().valueOf()/o)*o);var l=new Date(n);if(!r){var s=this.config.first_hour;s>l.getHours()&&(l.setHours(s),n=l.valueOf()),r=n+o}a.start_date=a.start_date||l,a.end_date=a.end_date||new Date(r),a.text=a.text||this.locale.labels.new_event,a.id=this._drag_id=this.uid(),a.layer=this.defaultLayer,this._drag_mode="new-size",this._loading=!0,this.addEvent(a),this.callEvent("onEventCreated",[this._drag_id,i]),this._loading=!1,this._drag_event={},this._on_mouse_up(i)},e._t_render_view_data=function(n){if(this.config.multi_day&&!this._table_view){for(var r=[],i=[],a=0;a<n.length;a++)n[a]._timed?r.push(n[a]):i.push(n[a]);this._table_view=!0,this.render_data(i),this._table_view=!1,this.render_data(r)}else this.render_data(n)},e.render_view_data=function(){if(this._not_render)this._render_wait=!0;else{this._render_wait=!1,this.clear_view(),this._evs_layer={};for(var n=0;n<this.layers.length;n++)this._evs_layer[this.layers[n].name]=[];var r=this.get_visible_events();for(n=0;n<r.length;n++)this._evs_layer[r[n].layer]&&this._evs_layer[r[n].layer].push(r[n]);if(this._mode=="month"){var i=[];for(n=0;n<this.layers.length;n++)this.layers[n].visible&&(i=i.concat(this._evs_layer[this.layers[n].name]));this._t_render_view_data(i)}else for(n=0;n<this.layers.length;n++)if(this.layers[n].visible){var a=this._evs_layer[this.layers[n].name];this._t_render_view_data(a)}}},e._render_v_bar=function(n,r,i,a,o,l,s,d,c){var u=n.id;s.indexOf("<div class=")==-1&&(s=e.templates["event_header_"+n.layer]?e.templates["event_header_"+n.layer](n.start_date,n.end_date,n):s),d.indexOf("<div class=")==-1&&(d=e.templates["event_text_"+n.layer]?e.templates["event_text_"+n.layer](n.start_date,n.end_date,n):d);var f=document.createElement("div"),y="dhx_cal_event",g=e.templates["event_class_"+n.layer]?e.templates["event_class_"+n.layer](n.start_date,n.end_date,n):e.templates.event_class(n.start_date,n.end_date,n);g&&(y=y+" "+g);var h=e._border_box_events(),p=a-2,v=h?p:a-4,x=h?p:a-6,S=h?p:a-14,O=h?p-2:a-8,N=h?o-this.xy.event_header_height:o-30+1,I='<div event_id="'+u+'" '+e.config.event_attribute+'="'+u+'" class="'+y+'" style="position:absolute; top:'+i+"px; left:"+r+"px; width:"+v+"px; height:"+o+"px;"+(l||"")+'">';return I+='<div class="dhx_header" style=" width:'+x+'px;" >&nbsp;</div>',I+='<div class="dhx_title">'+s+"</div>",I+='<div class="dhx_body" style=" width:'+S+"px; height:"+N+'px;">'+d+"</div>",I+='<div class="dhx_footer" style=" width:'+O+"px;"+(c?" margin-top:-1px;":"")+'" ></div></div>',f.innerHTML=I,f.style.zIndex=100,f.firstChild},e.render_event_bar=function(n){var r=this._els.dhx_cal_data[0],i=this._colsS[n._sday],a=this._colsS[n._eday];a==i&&(a=this._colsS[n._eday+1]);var o=this.xy.bar_height,l=this._colsS.heights[n._sweek]+(this._colsS.height?this.xy.month_scale_height+2:2)+n._sorder*o,s=document.createElement("div"),d=n._timed?"dhx_cal_event_clear":"dhx_cal_event_line",c=e.templates["event_class_"+n.layer]?e.templates["event_class_"+n.layer](n.start_date,n.end_date,n):e.templates.event_class(n.start_date,n.end_date,n);c&&(d=d+" "+c);var u='<div event_id="'+n.id+'" '+this.config.event_attribute+'="'+n.id+'" class="'+d+'" style="position:absolute; top:'+l+"px; left:"+i+"px; width:"+(a-i-15)+"px;"+(n._text_style||"")+'">';n._timed&&(u+=e.templates["event_bar_date_"+n.layer]?e.templates["event_bar_date_"+n.layer](n.start_date,n.end_date,n):e.templates.event_bar_date(n.start_date,n.end_date,n)),u+=e.templates["event_bar_text_"+n.layer]?e.templates["event_bar_text_"+n.layer](n.start_date,n.end_date,n):e.templates.event_bar_text(n.start_date,n.end_date,n)+"</div>)",u+="</div>",s.innerHTML=u,this._rendered.push(s.firstChild),r.appendChild(s.firstChild)},e.render_event=function(n){var r=e.xy.menu_width;if(e.getLayer(n.layer).noMenu&&(r=0),!(n._sday<0)){var i=e.locate_holder(n._sday);if(i){var a=60*n.start_date.getHours()+n.start_date.getMinutes(),o=60*n.end_date.getHours()+n.end_date.getMinutes()||60*e.config.last_hour,l=Math.round((60*a*1e3-60*this.config.first_hour*60*1e3)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)+1,s=Math.max(e.xy.min_event_height,(o-a)*this.config.hour_size_px/60)+1,d=Math.floor((i.clientWidth-r)/n._count),c=n._sorder*d+1;n._inner||(d*=n._count-n._sorder);var u=this._render_v_bar(n.id,r+c,l,d,s,n._text_style,e.templates.event_header(n.start_date,n.end_date,n),e.templates.event_text(n.start_date,n.end_date,n));if(this._rendered.push(u),i.appendChild(u),c=c+parseInt(i.style.left,10)+r,l+=this._dy_shift,u.style.zIndex=this._layers_zindex[n.layer],this._edit_id==n.id){u.style.zIndex=parseInt(u.style.zIndex)+1;var f=u.style.zIndex;d=Math.max(d-4,e.xy.editor_width),(u=document.createElement("div")).setAttribute("event_id",n.id),u.setAttribute(this.config.event_attribute,n.id),this.set_xy(u,d,s-20,c,l+14),u.className="dhx_cal_editor",u.style.zIndex=f;var y=document.createElement("div");this.set_xy(y,d-6,s-26),y.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",y.style.zIndex=f,u.appendChild(y),this._els.dhx_cal_data[0].appendChild(u),this._rendered.push(u),y.innerHTML="<textarea class='dhx_cal_editor'>"+n.text+"</textarea>",this._editor=y.firstChild,this._editor.addEventListener("keypress",function(x){if(x.shiftKey)return!0;var S=x.keyCode;S==e.keys.edit_save&&e.editStop(!0),S==e.keys.edit_cancel&&e.editStop(!1)}),this._editor.addEventListener("selectstart",function(x){return x.cancelBubble=!0,!0}),y.firstChild.focus(),this._els.dhx_cal_data[0].scrollLeft=0,y.firstChild.select()}if(this._select_id==n.id){u.style.zIndex=parseInt(u.style.zIndex)+1;for(var g=this.config["icons_"+(this._edit_id==n.id?"edit":"select")],h="",p=0;p<g.length;p++)h+="<div class='dhx_menu_icon "+g[p]+"' title='"+this.locale.labels[g[p]]+"'></div>";var v=this._render_v_bar(n.id,c-r+1,l,r,20*g.length+26,"","<div class='dhx_menu_head'></div>",h,!0);v.style.left=c-r+1,v.style.zIndex=u.style.zIndex,this._els.dhx_cal_data[0].appendChild(v),this._rendered.push(v)}}}},e.filter_agenda=function(n,r){var i=e.getLayer(r.layer);return i&&i.visible}})},limit:function(e){e.config.limit_start=null,e.config.limit_end=null,e.config.limit_view=!1,e.config.check_limits=!0,e._temp_limit_scope=function(){var t=null;e.attachEvent("onBeforeViewChange",function(n,r,i,a){function o(l,s){var d=e.config.limit_start,c=e.config.limit_end,u=e.date.add(l,1,s);return l.valueOf()>c.valueOf()||u<=d.valueOf()}return!e.config.limit_view||!o(a=a||r,i=i||n)||r.valueOf()==a.valueOf()||(setTimeout(function(){if(e.$destroyed)return!0;var l=o(r,i)?e.config.limit_start:r;e.setCurrentView(o(l,i)?null:l,i)},1),!1)}),e.attachEvent("onMouseDown",function(n){return n!="dhx_time_block"}),e.attachEvent("onBeforeDrag",function(n){return!n||e.checkLimitViolation(e.getEvent(n))}),e.attachEvent("onClick",function(n,r){return e.checkLimitViolation(e.getEvent(n))}),e.attachEvent("onBeforeLightbox",function(n){var r=e.getEvent(n);return t=[r.start_date,r.end_date],e.checkLimitViolation(r)}),e.attachEvent("onEventSave",function(n,r,i){if(!r.start_date||!r.end_date){var a=e.getEvent(n);r.start_date=new Date(a.start_date),r.end_date=new Date(a.end_date)}if(r.rec_type){var o=e._lame_clone(r);return e._roll_back_dates(o),e.checkLimitViolation(o)}return e.checkLimitViolation(r)}),e.attachEvent("onEventAdded",function(n){if(!n)return!0;var r=e.getEvent(n);return!e.checkLimitViolation(r)&&e.config.limit_start&&e.config.limit_end&&(r.start_date<e.config.limit_start&&(r.start_date=new Date(e.config.limit_start)),r.start_date.valueOf()>=e.config.limit_end.valueOf()&&(r.start_date=this.date.add(e.config.limit_end,-1,"day")),r.end_date<e.config.limit_start&&(r.end_date=new Date(e.config.limit_start)),r.end_date.valueOf()>=e.config.limit_end.valueOf()&&(r.end_date=this.date.add(e.config.limit_end,-1,"day")),r.start_date.valueOf()>=r.end_date.valueOf()&&(r.end_date=this.date.add(r.start_date,this.config.event_duration||this.config.time_step,"minute")),r._timed=this.isOneDayEvent(r)),!0}),e.attachEvent("onEventChanged",function(n){if(!n)return!0;var r=e.getEvent(n);if(!e.checkLimitViolation(r)){if(!t)return!1;r.start_date=t[0],r.end_date=t[1],r._timed=this.isOneDayEvent(r)}return!0}),e.attachEvent("onBeforeEventChanged",function(n,r,i){return e.checkLimitViolation(n)}),e.attachEvent("onBeforeEventCreated",function(n){var r=e.getActionData(n).date,i={_timed:!0,start_date:r,end_date:e.date.add(r,e.config.time_step,"minute")};return e.checkLimitViolation(i)}),e.attachEvent("onViewChange",function(){e._mark_now()}),e.attachEvent("onAfterSchedulerResize",function(){return window.setTimeout(function(){if(e.$destroyed)return!0;e._mark_now()},1),!0}),e.attachEvent("onTemplatesReady",function(){e._mark_now_timer=window.setInterval(function(){e._is_initialized()&&e._mark_now()},6e4)}),e.attachEvent("onDestroy",function(){clearInterval(e._mark_now_timer)})},e._temp_limit_scope()},map_view:function(e){let t=null,n=[];const r={googleMap:new P_(e),openStreetMaps:new L_(e),mapbox:new V_(e)};function i(o){t=o.ext.mapView.createAdapter(),n.push(e.attachEvent("onEventSave",function(l,s,d){let c=e.getEvent(l);return c&&c.event_location!=s.event_location&&(e._eventLocationChanged=!0),!0}),e.attachEvent("onEventChanged",(l,s)=>{const{start_date:d,end_date:c}=s,{min_date:u,max_date:f}=e.getState();return d.valueOf()<f.valueOf()&&c.valueOf()>u.valueOf()&&t&&(e.config.map_settings.resolve_event_location&&s.event_location&&!e._latLngUpdate?a(s,t):t.updateEventMarker(s)),e._latLngUpdate=!1,!0}),e.attachEvent("onEventIdChange",function(l,s){let d=e.getEvent(s);t==null||t.removeEventMarker(l),t==null||t.addEventMarker(d)}),e.attachEvent("onEventAdded",(l,s)=>{const{start_date:d,end_date:c}=s,{min_date:u,max_date:f}=e.getState();d.valueOf()<f.valueOf()&&c.valueOf()>u.valueOf()&&t&&(e.config.map_settings.resolve_event_location&&s.event_location&&e._eventLocationChanged?(a(s,t),e._eventLocationChanged=!1):(t.addEventMarker(s),t.onEventClick(s)))}),e.attachEvent("onClick",function(l,s){const d=e.getEvent(l);return t&&d&&t.onEventClick(d),!1}),e.attachEvent("onBeforeEventDelete",(l,s)=>(t&&t.removeEventMarker(l),!0)))}async function a(o,l){let s=await l.resolveAddress(o.event_location);return o.lat=s.lat,o.lng=s.lng,l.removeEventMarker(String(o.id)),l.addEventMarker(o),o}e.ext||(e.ext={}),e.ext.mapView={createAdapter:function(){return r[e.config.map_view_provider]},createMarker:function(o){return new google.maps.Marker(o)},currentAdapter:null,adapters:r},e._latLngUpdate=!1,e._eventLocationChanged=!1,e.config.map_view_provider="googleMap",e.config.map_settings={initial_position:{lat:48.724,lng:8.215},error_position:{lat:15,lng:15},initial_zoom:1,zoom_after_resolve:15,info_window_max_width:300,resolve_user_location:!0,resolve_event_location:!0,view_provider:"googleMap"},e.config.map_initial_position&&(e.config.map_settings.initial_position={lat:e.config.map_initial_position.lat(),lng:e.config.map_initial_position.lng()}),e.config.map_error_position&&(e.config.map_settings.error_position={lat:e.config.map_error_position.lat(),lng:e.config.map_error_position.lng()}),e.xy.map_date_width=188,e.xy.map_icon_width=25,e.xy.map_description_width=400,e.date.add_map=function(o,l,s){return new Date(o.valueOf())},e.templates.map_date=function(o,l,s){return""},e.templates.map_time=function(o,l,s){return e.config.rtl&&!s._timed?e.templates.day_date(l)+" &ndash; "+e.templates.day_date(o):s._timed?this.day_date(s.start_date,s.end_date,s)+" "+this.event_date(o):e.templates.day_date(o)+" &ndash; "+e.templates.day_date(l)},e.templates.map_text=function(o,l,s){return s.text},e.templates.map_info_content=function(o){return`<div><b>Event's text:</b> ${o.text}
				<div><b>Location:</b> ${o.event_location}</div>
				<div><b>Starts:</b> ${e.templates.tooltip_date_format(o.start_date)}</div>
				<div><b>Ends:</b> ${e.templates.tooltip_date_format(o.end_date)}</div>
			</div>`},e.date.map_start=function(o){return o},e.dblclick_dhx_map_area=function(o){let l=o.target.closest(`[${e.config.event_attribute}]`);if(l){let s=l.getAttribute(`${e.config.event_attribute}`);e.showLightbox(s)}this.config.readonly||!this.config.dblclick_create||l||this.addEventNow({start_date:e.config.map_start,end_date:e.date.add(e.config.map_start,e.config.time_step,"minute")})},e.attachEvent("onSchedulerReady",function(){e.config.map_initial_zoom!==void 0&&(e.config.map_settings.initial_zoom=e.config.map_initial_zoom),e.config.map_zoom_after_resolve!==void 0&&(e.config.map_settings.zoom_after_resolve=e.config.map_zoom_after_resolve),e.config.map_infowindow_max_width!==void 0&&(e.config.map_settings.info_window_max_width=e.config.map_infowindow_max_width),e.config.map_resolve_user_location!==void 0&&(e.config.map_settings.resolve_user_location=e.config.map_resolve_user_location),e.config.map_view_provider!==void 0&&(e.config.map_settings.view_provider=e.config.map_view_provider),e.config.map_type!==void 0&&(e.config.map_settings.type=e.config.map_type),e.config.map_resolve_event_location!==void 0&&(e.config.map_settings.resolve_event_location=e.config.map_resolve_event_location),e.ext.mapView.currentAdapter=e.config.map_view_provider;let o=document.createElement("div");o.className="mapContainer",o.id="mapContainer",o.style.display="none",o.style.zIndex="1",e._obj.appendChild(o);const l=e.render_data;function s(){let c=e.get_visible_events();c.sort(function(g,h){return g.start_date.valueOf()==h.start_date.valueOf()?g.id>h.id?1:-1:g.start_date>h.start_date?1:-1});let u="<div "+e._waiAria.mapAttrString()+" class='dhx_map_area'>";for(let g=0;g<c.length;g++){let h=c[g],p=h.id==e._selected_event_id?"dhx_map_line highlight":"dhx_map_line",v=h.color?"--dhx-scheduler-event-background:"+h.color+";":"",x=h.textColor?"--dhx-scheduler-event-color:"+h.textColor+";":"",S=e._waiAria.mapRowAttrString(h),O=e._waiAria.mapDetailsBtnString();u+="<div "+S+" class='"+p+"' event_id='"+h.id+"' "+e.config.event_attribute+"='"+h.id+"' style='"+v+x+(h._text_style||"")+" width: "+(e.xy.map_date_width+e.xy.map_description_width+2)+"px;'><div class='dhx_map_event_time' style='width: "+e.xy.map_date_width+"px;' >"+e.templates.map_time(h.start_date,h.end_date,h)+"</div>",u+=`<div ${O} class='dhx_event_icon icon_details'><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path d="M15.4444 16.4H4.55556V7.6H15.4444V16.4ZM13.1111 2V3.6H6.88889V2H5.33333V3.6H4.55556C3.69222 3.6 3 4.312 3 5.2V16.4C3 16.8243 3.16389 17.2313 3.45561 17.5314C3.74733 17.8314 4.143 18 4.55556 18H15.4444C15.857 18 16.2527 17.8314 16.5444 17.5314C16.8361 17.2313 17 16.8243 17 16.4V5.2C17 4.312 16.3 3.6 15.4444 3.6H14.6667V2H13.1111ZM13.8889 10.8H10V14.8H13.8889V10.8Z" fill="#A1A4A6"/>
			</svg></div>`,u+="<div class='line_description' style='width:"+(e.xy.map_description_width-e.xy.map_icon_width)+"px;'>"+e.templates.map_text(h.start_date,h.end_date,h)+"</div></div>"}u+="<div class='dhx_v_border' style="+(e.config.rtl?"'right: ":"'left: ")+(e.xy.map_date_width-1)+"px;'></div><div class='dhx_v_border_description'></div></div>",e._els.dhx_cal_data[0].scrollTop=0,e._els.dhx_cal_data[0].innerHTML=u;let f=e._els.dhx_cal_data[0].firstChild.childNodes,y=e._getNavDateElement();y&&(y.innerHTML=e.templates[e._mode+"_date"](e._min_date,e._max_date,e._mode)),e._rendered=[];for(let g=0;g<f.length-2;g++)e._rendered[g]=f[g]}e.render_data=function(c,u){if(this._mode!="map")return l.apply(this,arguments);{s();let f=e.get_visible_events();t&&(t.clearEventMarkers(),f.forEach(y=>t==null?void 0:t.addEventMarker(y)))}},e.map_view=function(c){e._els.dhx_cal_data[0].style.width=e.xy.map_date_width+e.xy.map_description_width+1+"px",e._min_date=e.config.map_start||e._currentDate(),e._max_date=e.config.map_end||e.date.add(e._currentDate(),1,"year"),e._table_view=!0,function(g){if(g){const h=e.locale.labels;e._els.dhx_cal_header[0].innerHTML="<div class='dhx_map_head' style='width: "+(e.xy.map_date_width+e.xy.map_description_width+2)+"px;' ><div class='headline_date' style='width: "+e.xy.map_date_width+"px;'>"+h.date+"</div><div class='headline_description' style='width: "+e.xy.map_description_width+"px;'>"+h.description+"</div></div>",e._table_view=!0,e.set_sizes()}}(c);let u=document.getElementById("mapContainer");var f,y;(function(g){let h=document.getElementById(g);if(h){const p=e.$container.querySelector(".dhx_cal_navline").offsetHeight;let v=e.$container.querySelector(".dhx_cal_data").offsetHeight+e.$container.querySelector(".dhx_cal_header").offsetHeight;v<0&&(v=0);let x=e._x-e.xy.map_date_width-e.xy.map_description_width-1;x<0&&(x=0),h.style.height=v+"px",h.style.width=x+"px",h.style.position="absolute",h.style.top=p+"px",e.config.rtl?h.style.marginRight=e.xy.map_date_width+e.xy.map_description_width+1+"px":h.style.marginLeft=e.xy.map_date_width+e.xy.map_description_width+1+"px",h.style.marginTop=e.xy.nav_height+2+"px"}})("mapContainer"),c&&u?(o.style.display="block",s(),e.config.map_view_provider==e.ext.mapView.currentAdapter?(t==null||t.destroy(u),i(e),t==null||t.initialize(u,e.config.map_settings)):(t==null||t.destroy(u),i(e),t==null||t.initialize(u,e.config.map_settings),e.ext.mapView.currentAdapter=e.config.map_view_provider),t&&(f=e.config.map_settings,y=t,f.resolve_user_location?navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(g){y.setView(g.coords.latitude,g.coords.longitude,f.zoom_after_resolve||f.initial_zoom)}):y.setView(f.initial_position.lat,f.initial_position.lng,f.initial_zoom))):(o.style.display="none",e._els.dhx_cal_data[0].style.width="100%",t&&u&&(t.destroy(u),t=null,e.ext.mapView.currentAdapter=e.config.map_view_provider),n.forEach(g=>e.detachEvent(g)),n=[])},e.attachEvent("onLocationError",function(c){return alert("Location can't be found"),google.maps.LatLng(51.47784,-.001492)});let d=async function(c){if(t){const u=await t.resolveAddress(c.event_location);u.lat&&u.lng?(c.lat=+u.lat,c.lng=+u.lng):(e.callEvent("onLocationError",[c.id]),c.lng=e.config.map_settings.error_position.lng,c.lat=e.config.map_settings.error_position.lat),e._latLngUpdate=!0,e.callEvent("onEventChanged",[c.id,c])}};e._event_resolve_delay=1500,e.attachEvent("onEventLoading",function(c){return c.lat&&c.lng&&(c.lat=+c.lat,c.lng=+c.lng),e.config.map_settings.resolve_event_location&&c.event_location&&!c.lat&&!c.lng&&(e._event_resolve_delay+=1500,function(u,f,y,g){setTimeout(function(){if(e.$destroyed)return!0;let h=u.apply(f,y);return u=f=y=null,h},g||1)}(d,this,[c],e._event_resolve_delay)),!0})})},minical:function(e){const t=e._createDomEventScope();e.config.minicalendar={mark_events:!0},e._synced_minicalendars=[],e.renderCalendar=function(n,r,i){var a=null,o=n.date||e._currentDate();if(typeof o=="string"&&(o=this.templates.api_date(o)),r)a=this._render_calendar(r.parentNode,o,n,r),e.unmarkCalendar(a);else{var l=n.container,s=n.position;if(typeof l=="string"&&(l=document.getElementById(l)),typeof s=="string"&&(s=document.getElementById(s)),s&&s.left===void 0&&s.right===void 0){var d=e.$domHelpers.getOffset(s);s={top:d.top+s.offsetHeight,left:d.left}}l||(l=e._get_def_cont(s)),(a=this._render_calendar(l,o,n)).$_eventAttached||(a.$_eventAttached=!0,t.attach(a,"click",(function(x){var S=x.target||x.srcElement,O=e.$domHelpers;if(O.closest(S,".dhx_month_head")&&!O.closest(S,".dhx_after")&&!O.closest(S,".dhx_before")){var N=O.closest(S,"[data-cell-date]").getAttribute("data-cell-date"),I=e.templates.parse_date(N);e.unmarkCalendar(this),e.markCalendar(this,I,"dhx_calendar_click"),this._last_date=I,this.conf.events&&this.conf.events.onDateClick&&this.conf.events.onDateClick.call(this,I,x),this.conf.handler&&this.conf.handler.call(e,I,this)}}).bind(a)),t.attach(a,"mouseover",(function(x){const S=x.target;if(S.classList.contains("dhx_cal_month_cell")){var O=S.getAttribute("data-cell-date"),N=e.templates.parse_date(O);this.conf.events&&this.conf.events.onDateMouseOver&&this.conf.events.onDateMouseOver.call(this,N,x)}}).bind(a)))}if(e.config.minicalendar.mark_events)for(var c=e.date.month_start(o),u=e.date.add(c,1,"month"),f=this.getEvents(c,u),y=this["filter_"+this._mode],g={},h=0;h<f.length;h++){var p=f[h];if(!y||y(p.id,p)){var v=p.start_date;for(v.valueOf()<c.valueOf()&&(v=c),v=e.date.date_part(new Date(v.valueOf()));v<p.end_date&&(g[+v]||(g[+v]=!0,this.markCalendar(a,v,"dhx_year_event")),!((v=this.date.add(v,1,"day")).valueOf()>=u.valueOf())););}}return this._markCalendarCurrentDate(a),a.conf=n,n.sync&&!i&&this._synced_minicalendars.push(a),a.conf._on_xle_handler||(a.conf._on_xle_handler=e.attachEvent("onXLE",function(){e.updateCalendar(a,a.conf.date)})),this.config.wai_aria_attributes&&this.config.wai_aria_application_role&&a.setAttribute("role","application"),a},e._get_def_cont=function(n){return this._def_count||(this._def_count=document.createElement("div"),this._def_count.className="dhx_minical_popup",e.event(this._def_count,"click",function(r){r.cancelBubble=!0}),document.body.appendChild(this._def_count)),n.left&&(this._def_count.style.left=n.left+"px"),n.right&&(this._def_count.style.right=n.right+"px"),n.top&&(this._def_count.style.top=n.top+"px"),n.bottom&&(this._def_count.style.bottom=n.bottom+"px"),this._def_count._created=new Date,this._def_count},e._locateCalendar=function(n,r){if(typeof r=="string"&&(r=e.templates.api_date(r)),+r>+n._max_date||+r<+n._min_date)return null;for(var i=n.querySelector(".dhx_year_body").childNodes[0],a=0,o=new Date(n._min_date);+this.date.add(o,1,"week")<=+r;)o=this.date.add(o,1,"week"),a++;var l=e.config.start_on_monday,s=(r.getDay()||(l?7:0))-(l?1:0);const d=i.querySelector(`.dhx_cal_month_row:nth-child(${a+1}) .dhx_cal_month_cell:nth-child(${s+1})`);return d?d.firstChild:null},e.markCalendar=function(n,r,i){var a=this._locateCalendar(n,r);a&&(a.className+=" "+i)},e.unmarkCalendar=function(n,r,i){if(i=i||"dhx_calendar_click",r=r||n._last_date){var a=this._locateCalendar(n,r);a&&(a.className=(a.className||"").replace(RegExp(i,"g")))}},e._week_template=function(n){for(var r=n||250,i=0,a=document.createElement("div"),o=this.date.week_start(e._currentDate()),l=0;l<7;l++)this._cols[l]=Math.floor(r/(7-l)),this._render_x_header(l,i,o,a),o=this.date.add(o,1,"day"),r-=this._cols[l],i+=this._cols[l];return a.lastChild.className+=" dhx_scale_bar_last",a},e.updateCalendar=function(n,r){if(n.conf.date&&n.conf.events&&n.conf.events.onBeforeMonthChange&&n.conf.events.onBeforeMonthChange.call(n,n.conf.date,r,n)===!1)return;const i=n.conf.date;n.conf.date=r,this.renderCalendar(n.conf,n,!0),n.conf.events&&n.conf.events.onMonthChange&&n.conf.events.onMonthChange.call(n,i,r)},e._mini_cal_arrows=["&nbsp;","&nbsp;"],e._render_calendar=function(n,r,i,a){var o=e.templates,l=this._cols;this._cols=[];var s=this._mode;this._mode="calendar";var d=this._colsS;this._colsS={height:0};var c=new Date(this._min_date),u=new Date(this._max_date),f=new Date(e._date),y=o.month_day,g=this._ignores_detected;this._ignores_detected=0,o.month_day=o.calendar_date,r=this.date.month_start(r);var h,p=this._week_template(n.offsetWidth-1-this.config.minicalendar.padding);a?h=a:((h=document.createElement("div")).className="dhx_cal_container dhx_mini_calendar",this.config.rtl&&(h.className+=" dhx_cal_container_rtl")),h.setAttribute("date",this._helpers.formatDate(r)),h.innerHTML="<div class='dhx_year_month'></div><div class='dhx_year_grid"+(e.config.rtl?" dhx_grid_rtl'>":"'>")+"<div class='dhx_year_week'>"+(p?p.innerHTML:"")+"</div><div class='dhx_year_body'></div></div>";var v=h.querySelector(".dhx_year_month"),x=h.querySelector(".dhx_year_week"),S=h.querySelector(".dhx_year_body");if(v.innerHTML=this.templates.calendar_month(r),i.navigation)for(var O=function($,X){var te=e.date.add($._date,X,"month");e.updateCalendar($,te),e._date.getMonth()==$._date.getMonth()&&e._date.getFullYear()==$._date.getFullYear()&&e._markCalendarCurrentDate($)},N=["dhx_cal_prev_button","dhx_cal_next_button"],I=["left:1px;top:4px;position:absolute;","left:auto; right:1px;top:4px;position:absolute;"],A=[-1,1],m=function($){return function(){if(i.sync)for(var X=e._synced_minicalendars,te=0;te<X.length;te++)O(X[te],$);else e.config.rtl&&($=-$),O(h,$)}},b=[e.locale.labels.prev,e.locale.labels.next],k=0;k<2;k++){var E=document.createElement("div");E.className=N[k],e._waiAria.headerButtonsAttributes(E,b[k]),E.style.cssText=I[k],E.innerHTML=this._mini_cal_arrows[k],v.appendChild(E),t.attach(E,"click",m(A[k]))}h._date=new Date(r),h.week_start=(r.getDay()-(this.config.start_on_monday?1:0)+7)%7;var D=h._min_date=this.date.week_start(r);h._max_date=this.date.add(h._min_date,6,"week"),this._reset_month_scale(S,r,D,6),a||n.appendChild(h),x.style.height=x.childNodes[0].offsetHeight-1+"px";var C=e.uid();e._waiAria.minicalHeader(v,C),e._waiAria.minicalGrid(h.querySelector(".dhx_year_grid"),C),e._waiAria.minicalRow(x);for(var R=x.querySelectorAll(".dhx_scale_bar"),P=0;P<R.length;P++)e._waiAria.minicalHeadCell(R[P]);var F=S.querySelectorAll(".dhx_cal_month_cell"),q=new Date(D);for(P=0;P<F.length;P++)e._waiAria.minicalDayCell(F[P],new Date(q)),q=e.date.add(q,1,"day");return e._waiAria.minicalHeader(v,C),this._cols=l,this._mode=s,this._colsS=d,this._min_date=c,this._max_date=u,e._date=f,o.month_day=y,this._ignores_detected=g,h},e.destroyCalendar=function(n,r){!n&&this._def_count&&this._def_count.firstChild&&(r||new Date().valueOf()-this._def_count._created.valueOf()>500)&&(n=this._def_count.firstChild),n&&(t.detachAll(),n.innerHTML="",n.parentNode&&n.parentNode.removeChild(n),this._def_count&&(this._def_count.style.top="-1000px"),n.conf&&n.conf._on_xle_handler&&e.detachEvent(n.conf._on_xle_handler))},e.isCalendarVisible=function(){return!!(this._def_count&&parseInt(this._def_count.style.top,10)>0)&&this._def_count},e.attachEvent("onTemplatesReady",function(){e.event(document.body,"click",function(){e.destroyCalendar()})},{once:!0}),e.form_blocks.calendar_time={render:function(n){var r="<span class='dhx_minical_input_wrapper'><input class='dhx_readonly dhx_minical_input' type='text' readonly='true'></span>",i=e.config,a=this.date.date_part(e._currentDate()),o=1440,l=0;i.limit_time_select&&(l=60*i.first_hour,o=60*i.last_hour+1),a.setHours(l/60),n._time_values=[],r+=" <select class='dhx_lightbox_time_select'>";for(var s=l;s<o;s+=1*this.config.time_step)r+="<option value='"+s+"'>"+this.templates.time_picker(a)+"</option>",n._time_values.push(s),a=this.date.add(a,this.config.time_step,"minute");return"<div class='dhx_section_time dhx_lightbox_minical'>"+(r+="</select>")+"<span class='dhx_lightbox_minical_spacer'> &nbsp;&ndash;&nbsp; </span>"+r+"</div>"},set_value:function(n,r,i,a){var o,l,s=n.getElementsByTagName("input"),d=n.getElementsByTagName("select"),c=function(v,x,S){e.event(v,"click",function(){e.destroyCalendar(null,!0),e.renderCalendar({position:v,date:new Date(this._date),navigation:!0,handler:function(O){v.value=e.templates.calendar_time(O),v._date=new Date(O),e.destroyCalendar(),e.config.event_duration&&e.config.auto_end_date&&S===0&&g()}})})};if(e.config.full_day){if(!n._full_day){var u="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+e.locale.labels.full_day+"&nbsp;</label></input>";e.config.wide_form||(u=n.previousSibling.innerHTML+u),n.previousSibling.innerHTML=u,n._full_day=!0}var f=n.previousSibling.getElementsByTagName("input")[0],y=e.date.time_part(i.start_date)===0&&e.date.time_part(i.end_date)===0;f.checked=y,d[0].disabled=f.checked,d[1].disabled=f.checked,f.$_eventAttached||(f.$_eventAttached=!0,e.event(f,"click",function(){if(f.checked===!0){var v={};e.form_blocks.calendar_time.get_value(n,v),o=e.date.date_part(v.start_date),(+(l=e.date.date_part(v.end_date))==+o||+l>=+o&&(i.end_date.getHours()!==0||i.end_date.getMinutes()!==0))&&(l=e.date.add(l,1,"day"))}else o=null,l=null;var x=o||i.start_date,S=l||i.end_date;h(s[0],x),h(s[1],S),d[0].value=60*x.getHours()+x.getMinutes(),d[1].value=60*S.getHours()+S.getMinutes(),d[0].disabled=f.checked,d[1].disabled=f.checked}))}if(e.config.event_duration&&e.config.auto_end_date){var g=function(){e.config.auto_end_date&&e.config.event_duration&&(o=e.date.add(s[0]._date,d[0].value,"minute"),l=new Date(o.getTime()+60*e.config.event_duration*1e3),s[1].value=e.templates.calendar_time(l),s[1]._date=e.date.date_part(new Date(l)),d[1].value=60*l.getHours()+l.getMinutes())};d[0].$_eventAttached||d[0].addEventListener("change",g)}function h(v,x,S){c(v,x,S),v.value=e.templates.calendar_time(x),v._date=e.date.date_part(new Date(x))}function p(v){for(var x=a._time_values,S=60*v.getHours()+v.getMinutes(),O=S,N=!1,I=0;I<x.length;I++){var A=x[I];if(A===S){N=!0;break}A<S&&(O=A)}return N||O?N?S:O:-1}h(s[0],i.start_date,0),h(s[1],i.end_date,1),c=function(){},d[0].value=p(i.start_date),d[1].value=p(i.end_date)},get_value:function(n,r){var i=n.getElementsByTagName("input"),a=n.getElementsByTagName("select");return r.start_date=e.date.add(i[0]._date,a[0].value,"minute"),r.end_date=e.date.add(i[1]._date,a[1].value,"minute"),r.end_date<=r.start_date&&(r.end_date=e.date.add(r.start_date,e.config.time_step,"minute")),{start_date:new Date(r.start_date),end_date:new Date(r.end_date)}},focus:function(n){}},e.linkCalendar=function(n,r){var i=function(){var a=e._date,o=new Date(a.valueOf());return r&&(o=r(o)),o.setDate(1),e.updateCalendar(n,o),!0};e.attachEvent("onViewChange",i),e.attachEvent("onXLE",i),e.attachEvent("onEventAdded",i),e.attachEvent("onEventChanged",i),e.attachEvent("onEventDeleted",i),i()},e._markCalendarCurrentDate=function(n){var r=e.getState(),i=r.min_date,a=r.max_date,o=r.mode,l=e.date.month_start(new Date(n._date)),s=e.date.add(l,1,"month");if(!({month:!0,year:!0,agenda:!0,grid:!0}[o]||i.valueOf()<=l.valueOf()&&a.valueOf()>=s.valueOf()))for(var d=i;d.valueOf()<a.valueOf();)l.valueOf()<=d.valueOf()&&s>d&&e.markCalendar(n,d,"dhx_calendar_click"),d=e.date.add(d,1,"day")},e.attachEvent("onEventCancel",function(){e.destroyCalendar(null,!0)}),e.attachEvent("onDestroy",function(){e.destroyCalendar()})},monthheight:function(e){e.attachEvent("onTemplatesReady",function(){e.xy.scroll_width=0;var t=e.render_view_data;e.render_view_data=function(){var r=this._els.dhx_cal_data[0];r.firstChild._h_fix=!0,t.apply(e,arguments);var i=parseInt(r.style.height);r.style.height="1px",r.style.height=r.scrollHeight+"px",this._obj.style.height=this._obj.clientHeight+r.scrollHeight-i+"px"};var n=e._reset_month_scale;e._reset_month_scale=function(r,i,a,o){var l={clientHeight:100};n.apply(e,[l,i,a,o]),r.innerHTML=l.innerHTML}})},multisection:function(e){vt("Multisection",e.assert)},multiselect:function(e){e.form_blocks.multiselect={render:function(t){var n="dhx_multi_select_control dhx_multi_select_"+t.name;t.vertical&&(n+=" dhx_multi_select_control_vertical");for(var r="<div class='"+n+"' style='overflow: auto; height: "+t.height+"px; position: relative;' >",i=0;i<t.options.length;i++)r+="<label><input type='checkbox' value='"+t.options[i].key+"'/>"+t.options[i].label+"</label>";return r+="</div>"},set_value:function(t,n,r,i){for(var a=t.getElementsByTagName("input"),o=0;o<a.length;o++)a[o].checked=!1;function l(f){for(var y=t.getElementsByTagName("input"),g=0;g<y.length;g++)y[g].checked=!!f[y[g].value]}var s={};if(r[i.map_to]){var d=(r[i.map_to]+"").split(i.delimiter||e.config.section_delimiter||",");for(o=0;o<d.length;o++)s[d[o]]=!0;l(s)}else{if(e._new_event||!i.script_url)return;var c=document.createElement("div");c.className="dhx_loading",c.style.cssText="position: absolute; top: 40%; left: 40%;",t.appendChild(c);var u=[i.script_url,i.script_url.indexOf("?")==-1?"?":"&","dhx_crosslink_"+i.map_to+"="+r.id+"&uid="+e.uid()].join("");e.ajax.get(u,function(f){var y=function(g){try{for(var h=JSON.parse(g.xmlDoc.responseText),p={},v=0;v<h.length;v++){var x=h[v];p[x.value||x.key||x.id]=!0}return p}catch{return null}}(f);y||(y=function(g,h){for(var p=e.ajax.xpath("//data/item",g.xmlDoc),v={},x=0;x<p.length;x++)v[p[x].getAttribute(h.map_to)]=!0;return v}(f,i)),l(y),t.removeChild(c)})}},get_value:function(t,n,r){for(var i=[],a=t.getElementsByTagName("input"),o=0;o<a.length;o++)a[o].checked&&i.push(a[o].value);return i.join(r.delimiter||e.config.section_delimiter||",")},focus:function(t){}}},multisource:function(e){var t=e._load;e._load=function(n,r){if(typeof(n=n||this._load_url)=="object")for(var i=function(o){var l=function(){};return l.prototype=o,l}(this._loaded),a=0;a<n.length;a++)this._loaded=new i,t.call(this,n[a],r);else t.apply(this,arguments)}},mvc:function(e){var t,n={use_id:!1};function r(o){var l={};for(var s in o)s.indexOf("_")!==0&&(l[s]=o[s]);return n.use_id||delete l.id,l}function i(o){o._not_render=!1,o._render_wait&&o.render_view_data(),o._loading=!1,o.callEvent("onXLE",[])}function a(o){return n.use_id?o.id:o.cid}e.backbone=function(o,l){l&&(n=l),o.bind("change",function(c,u){var f=a(c),y=e._events[f]=c.toJSON();y.id=f,e._init_event(y),clearTimeout(t),t=setTimeout(function(){if(e.$destroyed)return!0;e.updateView()},1)}),o.bind("remove",function(c,u){var f=a(c);e._events[f]&&e.deleteEvent(f)});var s=[];function d(){if(e.$destroyed)return!0;s.length&&(e.parse(s,"json"),s=[])}o.bind("add",function(c,u){var f=a(c);if(!e._events[f]){var y=c.toJSON();y.id=f,e._init_event(y),s.push(y),s.length==1&&setTimeout(d,1)}}),o.bind("request",function(c){var u;c instanceof Backbone.Collection&&((u=e)._loading=!0,u._not_render=!0,u.callEvent("onXLS",[]))}),o.bind("sync",function(c){c instanceof Backbone.Collection&&i(e)}),o.bind("error",function(c){c instanceof Backbone.Collection&&i(e)}),e.attachEvent("onEventCreated",function(c){var u=new o.model(e.getEvent(c));return e._events[c]=u.toJSON(),e._events[c].id=c,!0}),e.attachEvent("onEventAdded",function(c){if(!o.get(c)){var u=r(e.getEvent(c)),f=new o.model(u),y=a(f);y!=c&&this.changeEventId(c,y),o.add(f),o.trigger("scheduler:add",f)}return!0}),e.attachEvent("onEventChanged",function(c){var u=o.get(c),f=r(e.getEvent(c));return u.set(f),o.trigger("scheduler:change",u),!0}),e.attachEvent("onEventDeleted",function(c){var u=o.get(c);return u&&(o.trigger("scheduler:remove",u),o.remove(c)),!0})}},outerdrag:function(e){e.attachEvent("onTemplatesReady",function(){var t,n=new dhtmlDragAndDropObject,r=n.stopDrag;function i(a,o,l,s){if(!e.checkEvent("onBeforeExternalDragIn")||e.callEvent("onBeforeExternalDragIn",[a,o,l,s,t])){var d=e.attachEvent("onEventCreated",function(g){e.callEvent("onExternalDragIn",[g,a,t])||(this._drag_mode=this._drag_id=null,this.deleteEvent(g))}),c=e.getActionData(t),u={start_date:new Date(c.date)};if(e.matrix&&e.matrix[e._mode]){var f=e.matrix[e._mode];u[f.y_property]=c.section;var y=e._locate_cell_timeline(t);u.start_date=f._trace_x[y.x],u.end_date=e.date.add(u.start_date,f.x_step,f.x_unit)}e._props&&e._props[e._mode]&&(u[e._props[e._mode].map_to]=c.section),e.addEventNow(u),e.detachEvent(d)}}n.stopDrag=function(a){return t=a,r.apply(this,arguments)},n.addDragLanding(e._els.dhx_cal_data[0],{_drag:function(a,o,l,s){i(a,o,l,s)},_dragIn:function(a,o){return a},_dragOut:function(a){return this}}),dhtmlx.DragControl&&dhtmlx.DragControl.addDrop(e._els.dhx_cal_data[0],{onDrop:function(a,o,l,s){var d=dhtmlx.DragControl.getMaster(a);t=s,i(a,d,o,s.target||s.srcElement)},onDragIn:function(a,o,l){return o}},!0)})},pdf:function(e){var t,n,r=new RegExp("<[^>]*>","g"),i=new RegExp("<br[^>]*>","g");function a(N){return N.replace(i,`
`).replace(r,"")}function o(N,I){N=parseFloat(N),I=parseFloat(I),isNaN(I)||(N-=I);var A=s(N);return N=N-A.width+A.cols*t,isNaN(N)?"auto":100*N/t}function l(N,I,A){N=parseFloat(N),I=parseFloat(I),!isNaN(I)&&A&&(N-=I);var m=s(N);return N=N-m.width+m.cols*t,isNaN(N)?"auto":100*N/(t-(isNaN(I)?0:I))}function s(N){for(var I=0,A=e._els.dhx_cal_header[0].childNodes,m=A[1]?A[1].childNodes:A[0].childNodes,b=0;b<m.length;b++){var k=m[b].style?m[b]:m[b].parentNode,E=parseFloat(k.style.width);if(!(N>E))break;N-=E+1,I+=E+1}return{width:I,cols:b}}function d(N){return N=parseFloat(N),isNaN(N)?"auto":100*N/n}function c(N,I){return(window.getComputedStyle?window.getComputedStyle(N,null)[I]:N.currentStyle?N.currentStyle[I]:null)||""}function u(N,I){for(var A=parseInt(N.style.left,10),m=0;m<e._cols.length;m++)if((A-=e._cols[m])<0)return m;return I}function f(N,I){for(var A=parseInt(N.style.top,10),m=0;m<e._colsS.heights.length;m++)if(e._colsS.heights[m]>A)return m;return I}function y(N){return N?"</"+N+">":""}function g(N,I,A,m){var b="<"+N+" profile='"+I+"'";return A&&(b+=" header='"+A+"'"),m&&(b+=" footer='"+m+"'"),b+=">"}function h(){var N="",I=e._mode;if(e.matrix&&e.matrix[e._mode]&&(I=e.matrix[e._mode].render=="cell"?"matrix":"timeline"),N+="<scale mode='"+I+"' today='"+e._els.dhx_cal_date[0].innerHTML+"'>",e._mode=="week_agenda")for(var A=e._els.dhx_cal_data[0].getElementsByTagName("DIV"),m=0;m<A.length;m++)A[m].className=="dhx_wa_scale_bar"&&(N+="<column>"+a(A[m].innerHTML)+"</column>");else if(e._mode=="agenda"||e._mode=="map")N+="<column>"+a((A=e._els.dhx_cal_header[0].childNodes[0].childNodes)[0].innerHTML)+"</column><column>"+a(A[1].innerHTML)+"</column>";else if(e._mode=="year")for(A=e._els.dhx_cal_data[0].childNodes,m=0;m<A.length;m++)N+="<month label='"+a(A[m].querySelector(".dhx_year_month").innerHTML)+"'>",N+=v(A[m].querySelector(".dhx_year_week").childNodes),N+=p(A[m].querySelector(".dhx_year_body")),N+="</month>";else{N+="<x>",N+=v(A=e._els.dhx_cal_header[0].childNodes),N+="</x>";var b=e._els.dhx_cal_data[0];if(e.matrix&&e.matrix[e._mode]){for(N+="<y>",m=0;m<b.firstChild.rows.length;m++)N+="<row><![CDATA["+a(b.firstChild.rows[m].cells[0].innerHTML)+"]]></row>";N+="</y>",n=b.firstChild.rows[0].cells[0].offsetHeight}else if(b.firstChild.tagName=="TABLE")N+=p(b);else{for(b=b.childNodes[b.childNodes.length-1];b.className.indexOf("dhx_scale_holder")==-1;)b=b.previousSibling;for(b=b.childNodes,N+="<y>",m=0;m<b.length;m++)N+=`
<row><![CDATA[`+a(b[m].innerHTML)+"]]></row>";N+="</y>",n=b[0].offsetHeight}}return N+="</scale>"}function p(N){for(var I="",A=N.querySelectorAll("tr"),m=0;m<A.length;m++){for(var b=[],k=A[m].querySelectorAll("td"),E=0;E<k.length;E++)b.push(k[E].querySelector(".dhx_month_head").innerHTML);I+=`
<row height='`+k[0].offsetHeight+"'><![CDATA["+a(b.join("|"))+"]]></row>",n=k[0].offsetHeight}return I}function v(N){var I,A="";e.matrix&&e.matrix[e._mode]&&(e.matrix[e._mode].second_scale&&(I=N[1].childNodes),N=N[0].childNodes);for(var m=0;m<N.length;m++)A+=`
<column><![CDATA[`+a(N[m].innerHTML)+"]]></column>";if(t=N[0].offsetWidth,I){var b=0,k=N[0].offsetWidth,E=1;for(m=0;m<I.length;m++)A+=`
<column second_scale='`+E+"'><![CDATA["+a(I[m].innerHTML)+"]]></column>",(b+=I[m].offsetWidth)>=k&&(k+=N[E]?N[E].offsetWidth:0,E++),t=I[0].offsetWidth}return A}function x(N){var I="",A=e._rendered,m=e.matrix&&e.matrix[e._mode];if(e._mode=="agenda"||e._mode=="map")for(var b=0;b<A.length;b++)I+="<event><head><![CDATA["+a(A[b].childNodes[0].innerHTML)+"]]></head><body><![CDATA["+a(A[b].childNodes[2].innerHTML)+"]]></body></event>";else if(e._mode=="week_agenda")for(b=0;b<A.length;b++)I+="<event day='"+A[b].parentNode.getAttribute("day")+"'><body>"+a(A[b].innerHTML)+"</body></event>";else if(e._mode=="year")for(A=e.get_visible_events(),b=0;b<A.length;b++){var k=A[b].start_date;for(k.valueOf()<e._min_date.valueOf()&&(k=e._min_date);k<A[b].end_date;){var E=k.getMonth()+12*(k.getFullYear()-e._min_date.getFullYear())-e.week_starts._month,D=e.week_starts[E]+k.getDate()-1,C=N?c(e._get_year_cell(k),"color"):"",R=N?c(e._get_year_cell(k),"backgroundColor"):"";if(I+="<event day='"+D%7+"' week='"+Math.floor(D/7)+"' month='"+E+"' backgroundColor='"+R+"' color='"+C+"'></event>",(k=e.date.add(k,1,"day")).valueOf()>=e._max_date.valueOf())break}}else if(m&&m.render=="cell")for(A=e._els.dhx_cal_data[0].getElementsByTagName("TD"),b=0;b<A.length;b++)C=N?c(A[b],"color"):"",I+=`
<event><body backgroundColor='`+(R=N?c(A[b],"backgroundColor"):"")+"' color='"+C+"'><![CDATA["+a(A[b].innerHTML)+"]]></body></event>";else for(b=0;b<A.length;b++){var P,F;if(e.matrix&&e.matrix[e._mode])P=o(A[b].style.left),F=o(A[b].offsetWidth)-1;else{var q=e.config.use_select_menu_space?0:26;P=l(A[b].style.left,q,!0),F=l(A[b].style.width,q)-1}if(!isNaN(1*F)){var $=d(A[b].style.top),X=d(A[b].style.height),te=A[b].className.split(" ")[0].replace("dhx_cal_","");if(te!=="dhx_tooltip_line"){var Q=e.getEvent(A[b].getAttribute(e.config.event_attribute));if(Q){D=Q._sday;var W=Q._sweek,J=Q._length||0;if(e._mode=="month")X=parseInt(A[b].offsetHeight,10),$=parseInt(A[b].style.top,10)-e.xy.month_head_height,D=u(A[b],D),W=f(A[b],W);else if(e.matrix&&e.matrix[e._mode]){D=0,W=A[b].parentNode.parentNode.parentNode.rowIndex;var ee=n;n=A[b].parentNode.offsetHeight,$=d(A[b].style.top),$-=.2*$,n=ee}else{if(A[b].parentNode==e._els.dhx_cal_data[0])continue;var fe=e._els.dhx_cal_data[0].childNodes[0],Ve=parseFloat(fe.className.indexOf("dhx_scale_holder")!=-1?fe.style.left:0);P+=o(A[b].parentNode.style.left,Ve)}I+=`
<event week='`+W+"' day='"+D+"' type='"+te+"' x='"+P+"' y='"+$+"' width='"+F+"' height='"+X+"' len='"+J+"'>",te=="event"?(I+="<header><![CDATA["+a(A[b].childNodes[1].innerHTML)+"]]></header>",C=N?c(A[b].childNodes[2],"color"):"",I+="<body backgroundColor='"+(R=N?c(A[b].childNodes[2],"backgroundColor"):"")+"' color='"+C+"'><![CDATA["+a(A[b].childNodes[2].innerHTML)+"]]></body>"):(C=N?c(A[b],"color"):"",I+="<body backgroundColor='"+(R=N?c(A[b],"backgroundColor"):"")+"' color='"+C+"'><![CDATA["+a(A[b].innerHTML)+"]]></body>"),I+="</event>"}}}}return I}function S(N,I,A,m,b,k){var E=!1;m=="fullcolor"&&(E=!0,m="color"),m=m||"color";var D,C="";if(N){var R=e._date,P=e._mode;I=e.date[A+"_start"](I),I=e.date["get_"+A+"_end"]?e.date["get_"+A+"_end"](I):e.date.add(I,1,A),C=g("pages",m,b,k);for(var F=new Date(N);+F<+I;F=this.date.add(F,1,A))this.setCurrentView(F,A),C+=((D="page")?"<"+D+">":"")+h().replace("","-")+x(E)+y("page");C+=y("pages"),this.setCurrentView(R,P)}else C=g("data",m,b,k)+h().replace("","-")+x(E)+y("data");return C}function O(N,I,A,m,b,k,E){(function(D,C){var R=e.uid(),P=document.createElement("div");P.style.display="none",document.body.appendChild(P),P.innerHTML='<form id="'+R+'" method="post" target="_blank" action="'+C+'" accept-charset="utf-8" enctype="application/x-www-form-urlencoded"><input type="hidden" name="mycoolxmlbody"/> </form>',document.getElementById(R).firstChild.value=encodeURIComponent(D),document.getElementById(R).submit(),P.parentNode.removeChild(P)})(typeof b=="object"?function(D){for(var C="<data>",R=0;R<D.length;R++)C+=D[R].source.getPDFData(D[R].start,D[R].end,D[R].view,D[R].mode,D[R].header,D[R].footer);return C+="</data>",C}(b):S.apply(this,[N,I,A,b,k,E]),m)}e.getPDFData=S,e.toPDF=function(N,I,A,m){return O.apply(this,[null,null,null,N,I,A,m])},e.toPDFRange=function(N,I,A,m,b,k,E){return typeof N=="string"&&(N=e.templates.api_date(N),I=e.templates.api_date(I)),O.apply(this,arguments)}},quick_info:function(e){e.config.icons_select=["icon_form","icon_delete"],e.config.details_on_create=!0,e.config.show_quick_info=!0,e.xy.menu_width=0;let t=null;function n(i){const a=i.getBoundingClientRect(),o=e.$container.getBoundingClientRect().bottom-a.bottom;o<0&&(i.style.top=`${parseFloat(i.style.top)+o}px`)}function r(i){let a=0,o=0,l=i;for(;l&&l!=e._obj;)a+=l.offsetLeft,o+=l.offsetTop-l.scrollTop,l=l.offsetParent;return l?{left:a,top:o,dx:a+i.offsetWidth/2>e._x/2?1:0,dy:o+i.offsetHeight/2>e._y/2?1:0,width:i.offsetWidth,height:i.offsetHeight}:0}e.attachEvent("onSchedulerReady",function(){const i=e.$container;i._$quickInfoHandler||(i._$quickInfoHandler=!0,e.event(i,"mousedown",function(a){const o=a.target.closest(`[${e.config.event_attribute}]`);o&&(t={id:o.getAttribute(e.config.event_attribute),position:r(o)})}),e.attachEvent("onDestroy",()=>{delete i._$quickInfoHandler}))}),e.attachEvent("onClick",function(i){if(e.config.show_quick_info)return e.showQuickInfo(i),!0}),function(){for(var i=["onEmptyClick","onViewChange","onLightbox","onBeforeEventDelete","onBeforeDrag"],a=function(){return e.hideQuickInfo(!0),!0},o=0;o<i.length;o++)e.attachEvent(i[o],a)}(),e.templates.quick_info_title=function(i,a,o){return o.text.substr(0,50)},e.templates.quick_info_content=function(i,a,o){return o.details||""},e.templates.quick_info_date=function(i,a,o){return e.isOneDayEvent(o)&&e.config.rtl?e.templates.day_date(i,a,o)+" "+e.templates.event_header(a,i,o):e.isOneDayEvent(o)?e.templates.day_date(i,a,o)+" "+e.templates.event_header(i,a,o):e.config.rtl?e.templates.week_date(a,i,o):e.templates.week_date(i,a,o)},e.showQuickInfo=function(i){if(i==this._quick_info_box_id||(this.hideQuickInfo(!0),this.callEvent("onBeforeQuickInfo",[i])===!1))return;let a;a=t&&t.id==i?t.position:this._get_event_counter_part(i),a&&(this._quick_info_box=this._init_quick_info(a),this._fill_quick_data(i),this._show_quick_info(a),this.callEvent("onQuickInfo",[i]))},function(){function i(a){a=a||"";var o,l=parseFloat(a),s=a.match(/m?s/);switch(s&&(s=s[0]),s){case"s":o=1e3*l;break;case"ms":o=l;break;default:o=0}return o}e.hideQuickInfo=function(a){var o=this._quick_info_box,l=this._quick_info_box_id;if(this._quick_info_box_id=0,o&&o.parentNode){var s=o.offsetWidth;if(e.config.quick_info_detached)return this.callEvent("onAfterQuickInfo",[l]),o.parentNode.removeChild(o);if(o.style.right=="auto"?o.style.left=-s+"px":o.style.right=-s+"px",a)o.parentNode.removeChild(o);else{var d;window.getComputedStyle?d=window.getComputedStyle(o,null):o.currentStyle&&(d=o.currentStyle);var c=i(d["transition-delay"])+i(d["transition-duration"]);setTimeout(function(){o.parentNode&&o.parentNode.removeChild(o)},c)}this.callEvent("onAfterQuickInfo",[l])}}}(),e.event(window,"keydown",function(i){i.keyCode==27&&e.hideQuickInfo()}),e._show_quick_info=function(i){var a=e._quick_info_box;e._obj.appendChild(a);var o=a.offsetWidth,l=a.offsetHeight;if(e.config.quick_info_detached){var s=i.left-i.dx*(o-i.width);e.getView()&&e.getView()._x_scroll&&(e.config.rtl?s+=e.getView()._x_scroll:s-=e.getView()._x_scroll),s+o>window.innerWidth&&(s=window.innerWidth-o),s=Math.max(0,s),a.style.left=s+"px",a.style.top=i.top-(i.dy?l:-i.height)+"px"}else{const d=e.$container.querySelector(".dhx_cal_data").offsetTop;a.style.top=d+20+"px",i.dx==1?(a.style.right="auto",a.style.left=-o+"px",setTimeout(function(){a.style.left="-10px"},1)):(a.style.left="auto",a.style.right=-o+"px",setTimeout(function(){a.style.right="-10px"},1)),a.className=a.className.replace(" dhx_qi_left","").replace(" dhx_qi_right","")+" dhx_qi_"+(i.dx==1?"left":"right")}a.ontransitionend=()=>{n(a),a.ontransitionend=null},setTimeout(()=>{n(a)},1)},e.attachEvent("onTemplatesReady",function(){if(e.hideQuickInfo(),this._quick_info_box){var i=this._quick_info_box;i.parentNode&&i.parentNode.removeChild(i),this._quick_info_box=null}}),e._quick_info_onscroll_handler=function(i){e.hideQuickInfo()},e._init_quick_info=function(){if(!this._quick_info_box){var i=this._quick_info_box=document.createElement("div");this._waiAria.quickInfoAttr(i),i.className="dhx_cal_quick_info",e.$testmode&&(i.className+=" dhx_no_animate"),e.config.rtl&&(i.className+=" dhx_quick_info_rtl");var a=`
		<div class="dhx_cal_qi_tcontrols">
			<a class="dhx_cal_qi_close_btn scheduler_icon close"></a>
		</div>
		<div class="dhx_cal_qi_title" ${this._waiAria.quickInfoHeaderAttrString()}>
				
				<div class="dhx_cal_qi_tcontent"></div>
				<div class="dhx_cal_qi_tdate"></div>
			</div>
			<div class="dhx_cal_qi_content"></div>`;a+='<div class="dhx_cal_qi_controls">';for(var o=e.config.icons_select,l=0;l<o.length;l++)a+=`<div ${this._waiAria.quickInfoButtonAttrString(this.locale.labels[o[l]])} class="dhx_qi_big_icon ${o[l]}" title="${e.locale.labels[o[l]]}">
				<div class='dhx_menu_icon ${o[l]}'></div><div>${e.locale.labels[o[l]]}</div></div>`;a+="</div>",i.innerHTML=a,e.event(i,"click",function(s){e._qi_button_click(s.target||s.srcElement)}),e.config.quick_info_detached&&(e._detachDomEvent(e._els.dhx_cal_data[0],"scroll",e._quick_info_onscroll_handler),e.event(e._els.dhx_cal_data[0],"scroll",e._quick_info_onscroll_handler))}return this._quick_info_box},e._qi_button_click=function(i){var a=e._quick_info_box;if(i&&i!=a)if(i.closest(".dhx_cal_qi_close_btn"))e.hideQuickInfo();else{var o=e._getClassName(i);if(o.indexOf("_icon")!=-1){var l=e._quick_info_box_id;e._click.buttons[o.split(" ")[1].replace("icon_","")](l)}else e._qi_button_click(i.parentNode)}},e._get_event_counter_part=function(i){return r(e.getRenderedEvent(i))},e._fill_quick_data=function(i){var a=e.getEvent(i),o=e._quick_info_box;e._quick_info_box_id=i;var l={content:e.templates.quick_info_title(a.start_date,a.end_date,a),date:e.templates.quick_info_date(a.start_date,a.end_date,a)};o.querySelector(".dhx_cal_qi_tcontent").innerHTML=`<span>${l.content}</span>`,o.querySelector(".dhx_cal_qi_tdate").innerHTML=l.date,e._waiAria.quickInfoHeader(o,[l.content,l.date].join(" "));var s=o.querySelector(".dhx_cal_qi_content");const d=e.templates.quick_info_content(a.start_date,a.end_date,a);d?(s.classList.remove("dhx_hidden"),s.innerHTML=d):s.classList.add("dhx_hidden")}},readonly:function(e){e.attachEvent("onTemplatesReady",function(){var t;e.form_blocks.recurring&&(t=e.form_blocks.recurring.set_value);var n=e.config.buttons_left.slice(),r=e.config.buttons_right.slice();function i(l,s,d,c){for(var u=s.getElementsByTagName(l),f=d.getElementsByTagName(l),y=f.length-1;y>=0;y--)if(d=f[y],c){var g=document.createElement("span");g.className="dhx_text_disabled",g.innerHTML=c(u[y]),d.parentNode.insertBefore(g,d),d.parentNode.removeChild(d)}else d.disabled=!0,s.checked&&(d.checked=!0)}e.attachEvent("onBeforeLightbox",function(l){if(this.config.readonly_form||this.getEvent(l).readonly?this.config.readonly_active=!0:(this.config.readonly_active=!1,e.config.buttons_left=n.slice(),e.config.buttons_right=r.slice(),e.form_blocks.recurring&&(e.form_blocks.recurring.set_value=t)),this.config.readonly_active)for(var s=["dhx_delete_btn","dhx_save_btn"],d=[e.config.buttons_left,e.config.buttons_right],c=0;c<s.length;c++)for(var u=s[c],f=0;f<d.length;f++){for(var y=d[f],g=-1,h=0;h<y.length;h++)if(y[h]==u){g=h;break}g!=-1&&y.splice(g,1)}return this.resetLightbox(),!0});var a=e._fill_lightbox;e._fill_lightbox=function(){var l=this.getLightbox();this.config.readonly_active&&(l.style.visibility="hidden",l.style.display="block");var s=a.apply(this,arguments);if(this.config.readonly_active&&(l.style.visibility="",l.style.display="none"),this.config.readonly_active){var d=this.getLightbox(),c=this._lightbox_r=d.cloneNode(!0);c.id=e.uid(),c.className+=" dhx_cal_light_readonly",i("textarea",d,c,function(u){return u.value}),i("input",d,c,!1),i("select",d,c,function(u){return u.options.length?u.options[Math.max(u.selectedIndex||0,0)].text:""}),d.parentNode.insertBefore(c,d),this.showCover(c),e._lightbox&&e._lightbox.parentNode.removeChild(e._lightbox),this._lightbox=c,e.config.drag_lightbox&&e.event(c.firstChild,"mousedown",e._ready_to_dnd),e._init_lightbox_events(),this.setLightboxSize()}return s};var o=e.hide_lightbox;e.hide_lightbox=function(){return this._lightbox_r&&(this._lightbox_r.parentNode.removeChild(this._lightbox_r),this._lightbox_r=this._lightbox=null),o.apply(this,arguments)}})},recurring:function(e){function t(m){return new Date(m.getFullYear(),m.getMonth(),m.getDate(),m.getHours(),m.getMinutes(),m.getSeconds(),0)}function n(m){return!!m.rrule&&!m.recurring_event_id}function r(m){return new Date(Date.UTC(m.getFullYear(),m.getMonth(),m.getDate(),m.getHours(),m.getMinutes(),m.getSeconds()))}function i(m){m.rrule.includes(";UNTIL=")&&(m.rrule=m.rrule.split(";UNTIL=")[0]);let b=In(`RRULE:${m.rrule};UNTIL=${h(m._end_date||m.end_date)}`,{dtstart:m.start_date}),k=new j(b.origOptions).toString().replace("RRULE:","");k=k.split(`
`)[1],m.rrule=k}function a(m,b){b||(b=e.getEvent(m));let k=b.rrule.split(";"),E=[];for(let D=0;D<k.length;D++){let C=k[D].split("="),R=C[0],P=C[1];(R!=="BYDAY"||b.rrule.includes("WEEKLY")&&P.length>3)&&(E.push(R),E.push("="),E.push(P),E.push(";"))}E.pop(),b.rrule=E.join("")}var o;function l(m,b){m._end_date=m.end_date,e._isExceptionFirstOccurrence(b)?(m.start_date=b.start_date,m.end_date=new Date(b.start_date.valueOf()+1e3*m.duration),m._start_date=b.original_start,m._modified=!0):(m.end_date=new Date(b.start_date.valueOf()+1e3*m.duration),m.start_date=b.start_date,m._firstOccurrence=!0),m._thisAndFollowing=b.id}function s(m,b,k,E){const D=k._modified?E.id:m;e._events[D]={...E,text:b.text,duration:b.duration,start_date:b.start_date,rrule:b.rrule,end_date:E._end_date,_start_date:E.start_date,_thisAndFollowing:null,_end_date:null},k._modified&&delete e._events[m],e.callEvent("onEventChanged",[e._events[D].id,e._events[D]])}function d(m){for(const b in e._events)e._events[b].id==m.id&&delete e._events[b]}function c(m,b){for(let k in e._events){let E=e._events[k];(E.recurring_event_id==m||e._is_virtual_event(E.id)&&E.id.split("#")[0]==m)&&(E.text=b.text,e.updateEvent(E.id))}}function u(m,b){let k=m,E=new Date(b.original_start).valueOf();m=String(k).split("#")||b._pid_time||E;let D=e.uid(),C=m[1]?m[1]:b._pid_time||E,R=e._copy_event(b);R.id=D,R.recurring_event_id=b.recurring_event_id||m[0],R.original_start=new Date(Number(C)),R.deleted=!0,e.addEvent(R)}function f(){for(const m in e._events)m==="$dnd_recurring_placeholder"&&delete e._events[m];e.render()}function y(m,b){const k=e.locale;m.find(D=>D.checked)||(m[0].checked=!0);const E=m.reduce((D,C)=>(D[C.value]=C.callback,D),{});e.modalbox({text:`<div class="dhx_edit_recurrence_options">
				${m.map(D=>`<label class="dhx_styled_radio">
					<input type="radio" value="${D.value}" name="option" ${D.checked?"checked":""}>
					${D.label}
				</label>`).join("")}
			</div>`,type:"recurring_mode",title:k.labels.confirm_recurring,width:"auto",position:"middle",buttons:[{label:k.labels.message_ok,value:"ok",css:"rec_ok"},{label:k.labels.message_cancel,value:"cancel"}],callback:function(D,C){if(b&&b(D,C),D==="cancel")return;const R=C.target.closest(".scheduler_modal_box").querySelector("input[type='radio']:checked");let P;R&&(P=R.value),P&&E[P]()}})}function g(){const m={};for(const b in e._events){const k=e._events[b];k.recurring_event_id&&k.original_start&&(m[k.recurring_event_id]||(m[k.recurring_event_id]={}),m[k.recurring_event_id][k.original_start.valueOf()]=k)}return m}e._isFollowing=function(m){let b=e.getEvent(m);return!(!b||!b._thisAndFollowing)},e._isFirstOccurrence=function(m){if(e._is_virtual_event(m.id)){let b=m.id.split("#")[0];return e.getEvent(b).start_date.valueOf()===m.start_date.valueOf()}},e._isExceptionFirstOccurrence=function(m){if(e._is_modified_occurrence(m)){let b=m.recurring_event_id,k=e.getEvent(b);return!(!m.original_start||!m.original_start.valueOf()||m.original_start.valueOf()!==k.start_date.valueOf())}},e._rec_temp=[],e._rec_markers_pull={},e._rec_markers={},e._add_rec_marker=function(m,b){m._pid_time=b,this._rec_markers[m.id]=m,this._rec_markers_pull[m.event_pid]||(this._rec_markers_pull[m.event_pid]={}),this._rec_markers_pull[m.event_pid][b]=m},e._get_rec_marker=function(m,b){let k=this._rec_markers_pull[b];return k?k[m]:null},e._get_rec_markers=function(m){return this._rec_markers_pull[m]||[]},o=e.addEvent,e.addEvent=function(m,b,k,E,D){var C=o.apply(this,arguments);if(C&&e.getEvent(C)){var R=e.getEvent(C);R.start_date&&(R.start_date=t(R.start_date)),R.end_date&&(R.end_date=t(R.end_date))}return C},e.attachEvent("onEventLoading",function(m){return m.original_start&&!m.original_start.getFullYear&&(m.original_start=e.templates.parse_date(m.original_start)),!0}),e.attachEvent("onEventIdChange",function(m,b){if(!this._ignore_call){this._ignore_call=!0,e._rec_markers[m]&&(e._rec_markers[b]=e._rec_markers[m],delete e._rec_markers[m]),e._rec_markers_pull[m]&&(e._rec_markers_pull[b]=e._rec_markers_pull[m],delete e._rec_markers_pull[m]);for(var k=0;k<this._rec_temp.length;k++){var E=this._rec_temp[k];this._is_virtual_event(E.id)&&E.id.split("#")[0]==m&&(E.recurring_event_id=b,this.changeEventId(E.id,b+"#"+E.id.split("#")[1]))}for(var k in this._rec_markers)(E=this._rec_markers[k]).recurring_event_id==m&&(E.recurring_event_id=b,E._pid_changed=!0);var D=e._rec_markers[b];D&&D._pid_changed&&(delete D._pid_changed,setTimeout(function(){if(e.$destroyed)return!0;e.callEvent("onEventChanged",[b,e.getEvent(b)])},1)),delete this._ignore_call}}),e.attachEvent("onConfirmedBeforeEventDelete",function(m){var b=this.getEvent(m);if(this._is_virtual_event(m)||this._is_modified_occurrence(b)&&!function(D){return!!D.deleted}(b))u(m,b);else{n(b)&&this._lightbox_id&&this._roll_back_dates(b);var k=this._get_rec_markers(m);for(var E in k)k.hasOwnProperty(E)&&(m=k[E].id,this.getEvent(m)&&this.deleteEvent(m,!0))}return!0}),e.attachEvent("onEventDeleted",function(m,b){!this._is_virtual_event(m)&&this._is_modified_occurrence(b)&&(e._events[m]||(b.deleted=!0,this.setEvent(m,b),e.render()))}),e.attachEvent("onBeforeEventChanged",function(m,b,k,E){return!(!k&&m&&(e._is_virtual_event(m.id)||e._is_modified_occurrence(m))&&(E.start_date.getDate()!==m.start_date.getDate()?m._beforeEventChangedFlag="edit":m._beforeEventChangedFlag="ask",!e.config.collision_limit||e.checkCollision(m)))||(e._events.$dnd_recurring_placeholder=e._lame_clone(m),e._showRequiredModalBox(m.id,m._beforeEventChangedFlag),!1)}),e.attachEvent("onEventChanged",function(m,b){if(this._loading)return!0;let k=this.getEvent(m);if(this._is_virtual_event(m))(function(P){let F=P.id.split("#"),q=e.uid();e._not_render=!0;let $=e._copy_event(P);$.id=q,$.recurring_event_id=F[0];let X=F[1];$.original_start=new Date(Number(X)),e._add_rec_marker($,X),e.addEvent($),e._not_render=!1})(k);else{k.start_date&&(k.start_date=t(k.start_date)),k.end_date&&(k.end_date=t(k.end_date)),n(k)&&this._lightbox_id&&(k._removeFollowing||this._isFollowing(m)?k._removeFollowing=null:this._roll_back_dates(k));var E=this._get_rec_markers(m);for(var D in E)E.hasOwnProperty(D)&&(delete this._rec_markers[E[D].id],this.deleteEvent(E[D].id,!0));delete this._rec_markers_pull[m];for(var C=!1,R=0;R<this._rendered.length;R++)this._rendered[R].getAttribute(this.config.event_attribute)==m&&(C=!0);C||(this._select_id=null)}return f(),!0}),e.attachEvent("onEventAdded",function(m){if(!this._loading){var b=this.getEvent(m);n(b)&&this._roll_back_dates(b)}return!0}),e.attachEvent("onEventSave",function(m,b,k){let E=this.getEvent(m),D=e._lame_clone(E),C=b.rrule;if(E&&n(E)&&!k&&this._isFollowing(m)){if(E._removeFollowing){if(e.getEvent(E._thisAndFollowing)&&(E._firstOccurrence||E._modified))return e.hideLightbox(),e.deleteEvent(E.id),!1;if(E.end_date=new Date(E.start_date.valueOf()-1e3),E._end_date=E._shorten_end_date,E.start_date=E._start_date,E._shorten=!0,i(E),e.callEvent("onEventChanged",[E.id,E]),e.getEvent(E._thisAndFollowing))for(const R in e._events){let P=e._events[R];P.recurring_event_id===m&&P.start_date.valueOf()>D.start_date.valueOf()&&u(P.id,P)}return e.hideLightbox(),!1}{let R=e.getEvent(E._thisAndFollowing);if(R&&E._firstOccurrence)for(const P in e._events)e._events[P].id==E.id&&s(P,b,E,D);else if(R&&E._modified)for(const P in e._events){let F=e._events[P];F.recurring_event_id==m&&F.id==D._thisAndFollowing&&s(P,b,E,D)}else{e._is_modified_occurrence(R)&&d(R),E.end_date=E._shorten_end_date,E._end_date=E._shorten_end_date,E.start_date=E._start_date,E._shorten=!0,i(E),e.callEvent("onEventChanged",[E.id,E]);let P={...D};P.text=b.text,P.duration=b.duration,P.rrule=C,P._start_date=null,P.id=e.uid(),e.addEvent(P.start_date,P.end_date,P.text,P.id,P)}return k||c(m,b),e.hideLightbox(),!1}}return k||c(m,b),D._ocr&&D._beforeEventChangedFlag?(E.start_date=D.start_date,E.end_date=D.end_date,E._start_date=D._start_date,E._end_date=D._end_date,e.updateEvent(E.id),!0):(this._select_id=null,f(),!0)}),e.attachEvent("onEventCreated",function(m){var b=this.getEvent(m);return n(b)||function(k){k.rrule="",k.original_start=null,k.recurring_event_id=null,k.duration=null,k.deleted=null}(b),!0}),e.attachEvent("onEventCancel",function(m){var b=this.getEvent(m);n(b)&&(this._roll_back_dates(b),this.render_view_data()),f()}),e._roll_back_dates=function(m){m.start_date&&(m.start_date=t(m.start_date)),m.end_date&&(m.end_date=t(m.end_date)),m._end_date&&(m._shorten||(m.duration=Math.round((m.end_date.valueOf()-m.start_date.valueOf())/1e3)),m.end_date=m._end_date),m._start_date&&(m.start_date.setMonth(0),m.start_date.setDate(m._start_date.getDate()),m.start_date.setMonth(m._start_date.getMonth()),m.start_date.setFullYear(m._start_date.getFullYear()),this._isFollowing(m.id)&&(m.start_date.setHours(m._start_date.getHours()),m.start_date.setMinutes(m._start_date.getMinutes()),m.start_date.setSeconds(m._start_date.getSeconds()))),m._thisAndFollowing=null,m._shorten_end_date&&(m._shorten_end_date=null),m._removeFollowing&&(m._removeFollowing=null),m._firstOccurrence&&(m._firstOccurrence=null),m._modified&&(m._modified=null)},e._is_virtual_event=function(m){return m.toString().indexOf("#")!=-1},e._is_modified_occurrence=function(m){return m.recurring_event_id&&m.recurring_event_id!="0"},e.showLightbox_rec=e.showLightbox,e.showLightbox=function(m){const b=this.locale;let k=e.config.lightbox_recurring,E=this.getEvent(m),D=E.recurring_event_id,C=this._is_virtual_event(m);C&&(D=m.split("#")[0]);const R=function(P,F){const q=e.getEvent(P),$=e.getEvent(D),X=e.getView();if(X&&q[X.y_property]&&($[X.y_property]=q[X.y_property]),X&&q[X.property]&&($[X.property]=q[X.property]),F==="Occurrence")return e.showLightbox_rec(P);if(F==="Following"){if(e._isExceptionFirstOccurrence(q)||e._isFirstOccurrence(q))return l($,q),e.showLightbox_rec(D);{$._end_date=$.end_date;const te=q.original_start||q.start_date;return $._shorten_end_date=new Date(te.valueOf()-1e3),$.end_date=new Date(q.start_date.valueOf()+1e3*$.duration),$._start_date=$.start_date,$.start_date=q.start_date,$._thisAndFollowing=q.id,E._beforeEventChangedFlag&&($._beforeEventChangedFlag=E._beforeEventChangedFlag,$._shorten_end_date=new Date(te.valueOf()-1e3)),e.showLightbox_rec(D)}}if(F==="AllEvents"){if(e._isExceptionFirstOccurrence(q)||e._isFirstOccurrence(q))return l($,q),e.showLightbox_rec(D);const te=new Date($.start_date);return $._end_date=$.end_date,$._start_date=te,$.start_date.setHours(q.start_date.getHours()),$.start_date.setMinutes(q.start_date.getMinutes()),$.start_date.setSeconds(q.start_date.getSeconds()),$.end_date=new Date($.start_date.valueOf()+1e3*$.duration),$._thisAndFollowing=null,e.showLightbox_rec(D)}};if((D||1*D==0)&&n(E))return R(m,"AllEvents");if(!D||D==="0"||!b.labels.confirm_recurring||k=="instance"||k=="series"&&!C)return this.showLightbox_rec(m);if(k==="ask"){const P=e.locale;y([{value:"Occurrence",label:P.labels.button_edit_occurrence,checked:!0,callback:()=>R(m,"Occurrence")},{value:"Following",label:P.labels.button_edit_occurrence_and_following,callback:()=>R(m,"Following")},{value:"AllEvents",label:P.labels.button_edit_series,callback:()=>R(m,"AllEvents")}])}},e._showRequiredModalBox=function(m,b){let k;const E=e.locale;let D=e.getEvent(m),C=D.recurring_event_id;e._is_virtual_event(D.id)&&(C=D.id.split("#")[0]);let R=e.getEvent(C);const P=e.getView();let F,q,$=e._lame_clone(R);P&&D[P.y_property]&&($[P.y_property]=D[P.y_property]),P&&D[P.property]&&($[P.property]=D[P.property]),D&&D._beforeEventChangedFlag&&(F=D.start_date,q=D.end_date);const X={value:"AllEvents",label:E.labels.button_edit_series,callback:()=>function(W){let J=e._lame_clone(W);if(e._isExceptionFirstOccurrence(J)&&d(J),q&&F&&($.start_date.setHours(F.getHours()),$.start_date.setMinutes(F.getMinutes()),$.start_date.setSeconds(F.getSeconds()),$.duration=(+q-+F)/1e3),$._beforeEventChangedFlag=W._beforeEventChangedFlag,$._thisAndFollowing=null,!e.config.collision_limit||e.checkCollision($))for(const ee in e._events)e._events[ee].id==$.id&&(e._events[ee]={...$},e.callEvent("onEventChanged",[e._events[ee].id,e._events[ee]]))}(D)},te={value:"Following",label:E.labels.button_edit_occurrence_and_following,callback:()=>function(W){let J=e._lame_clone(W);if(q&&F&&(W._start_date=W.start_date,W.start_date=F,W.end_date=q),e._isFirstOccurrence(J)||e._isExceptionFirstOccurrence(J)){if(e._isExceptionFirstOccurrence(J)&&d(J),$._start_date=R.start_date,$.start_date=W.start_date,$.duration=(+W.end_date-+W.start_date)/1e3,$._beforeEventChangedFlag=W._beforeEventChangedFlag,$.rrule&&a($.id,$),!e.config.collision_limit||e.checkCollision($))for(const ee in e._events)e._events[ee].id==$.id&&(e._events[ee]={...$},e.callEvent("onEventChanged",[e._events[ee].id,e._events[ee]]))}else{$._end_date=R.end_date;const ee=W.original_start||e.date.date_part(new Date(W._start_date));$._shorten_end_date=new Date(ee.valueOf()-1e3),$.end_date=W.end_date,$._start_date=R.start_date,$.start_date=W.start_date,$._thisAndFollowing=W.id,$.rrule&&a($.id,$);let fe=$.end_date;if($.end_date=$._end_date,!e.config.collision_limit||e.checkCollision($)){$.end_date=fe;for(const Ve in e._events)e._events[Ve].id==$.id&&(e._events[Ve]={...$},e.callEvent("onEventSave",[e._events[Ve].id,e._events[Ve],e._new_event]),e.callEvent("onEventChanged",[e._events[Ve].id,e._events[Ve]]))}}}(D)},Q={value:"Occurrence",label:E.labels.button_edit_occurrence,callback:()=>function(W){let J={...R,...e.getEvent("$dnd_recurring_placeholder")};if(q&&F&&(J.start_date=F,J.end_date=q,J._beforeEventChangedFlag=W._beforeEventChangedFlag,J._ocr=!0),!e.config.collision_limit||e.checkCollision(J))for(const ee in e._events){let fe=e._events[ee];ee!=="$dnd_recurring_placeholder"&&fe.id==J.id&&(e._events[ee]={...J},e.callEvent("onEventChanged",[e._events[ee].id,e._events[ee]]))}}(D),checked:!0};k=b==="ask"?[Q,te,X]:[Q,te],y(k,W=>{W==="cancel"&&f()})},e.get_visible_events_rec=e.get_visible_events,e.get_visible_events=function(m){for(var b=0;b<this._rec_temp.length;b++)delete this._events[this._rec_temp[b].id];this._rec_temp=[];const k=g();var E=this.get_visible_events_rec(m),D=[];for(b=0;b<E.length;b++)E[b].deleted||E[b].recurring_event_id||(n(E[b])?this.repeat_date(E[b],D,void 0,void 0,void 0,void 0,k):D.push(E[b]));return function(C){const R={};return C.forEach(P=>{const F=R[P.id];(!F||F._beforeEventChangedFlag||P._beforeEventChangedFlag)&&(R[P.id]=P)}),Object.values(R)}(D)},function(){var m=e.isOneDayEvent;e.isOneDayEvent=function(k){return!!n(k)||m.call(this,k)};var b=e.updateEvent;e.updateEvent=function(k){var E=e.getEvent(k);E&&n(E)&&!this._is_virtual_event(k)?e.update_view():b.call(this,k)}}();const h=e.date.date_to_str("%Y%m%dT%H%i%s");function p(m){const b=m.getDay(),k=m.getDate();return{dayOfWeek:b,dayNumber:Math.ceil(k/7)}}e.repeat_date=function(m,b,k,E,D,C,R){if(!m.rrule)return;let P=R?R[m.id]:g()[m.id];P||(P={}),E=r(E||new Date(e._min_date.valueOf()-6048e5)),D=r(D||new Date(e._max_date.valueOf()-1e3));const F=r(m.start_date);let q;q=In(C?`RRULE:${m.rrule};UNTIL=${h(m.end_date)};COUNT=${C}`:`RRULE:${m.rrule};UNTIL=${h(m.end_date)}`,{dtstart:F});const $=q.between(E,D,!0).map(Q=>{const W=(J=Q,new Date(J.getUTCFullYear(),J.getUTCMonth(),J.getUTCDate(),J.getUTCHours(),J.getUTCMinutes(),J.getUTCSeconds()));var J;return W.setHours(m.start_date.getHours()),W.setMinutes(m.start_date.getMinutes()),W.setSeconds(m.start_date.getSeconds()),W});let X=0;const te=m.duration;for(let Q=0;Q<$.length&&!(C&&X>=C);Q++){const W=$[Q];let J=P[W.valueOf()];if(J){if(J.deleted||J.end_date.valueOf()<e._min_date.valueOf()||!e.filter_event(J.id,J))continue;X++,b.push(J)}else{const ee=e._copy_event(m);if(ee.text=m.text,ee.start_date=W,ee.id=m.id+"#"+Math.ceil(W.valueOf()),ee.end_date=new Date(W.valueOf()+1e3*te),ee.end_date.valueOf()<e._min_date.valueOf()||(ee.end_date=e._fix_daylight_saving_date(ee.start_date,ee.end_date,m,W,ee.end_date),ee._timed=e.isOneDayEvent(ee),!ee._timed&&!e._table_view&&!e.config.multi_day))continue;b.push(ee),k||(e._events[ee.id]=ee,e._rec_temp.push(ee)),X++}}if(P&&$.length==0)for(let Q in P){let W=P[Q];if(W){if(W.deleted||W.end_date.valueOf()<e._min_date.valueOf()||!e.filter_event(W.id,W))continue;E&&D&&W.start_date<D&&W.end_date>E&&b.push(W)}}},e._fix_daylight_saving_date=function(m,b,k,E,D){var C=m.getTimezoneOffset()-b.getTimezoneOffset();return C?C>0?new Date(E.valueOf()+1e3*k.duration-60*C*1e3):new Date(b.valueOf()-60*C*1e3):new Date(D.valueOf())},e.getRecDates=function(m,b){var k=typeof m=="object"?m:e.getEvent(m),E=[];if(b=b||100,!n(k))return[{start_date:k.start_date,end_date:k.end_date}];if(k.deleted)return[];e.repeat_date(k,E,!0,k.start_date,k.end_date,b);for(var D=[],C=0;C<E.length;C++)E[C].deleted||D.push({start_date:E[C].start_date,end_date:E[C].end_date});return D},e.getEvents=function(m,b){var k=[];const E=g();for(var D in this._events){var C=this._events[D];if(!C.recurring_event_id)if(m&&b&&C.start_date<b&&C.end_date>m)if(n(C)){var R=[];this.repeat_date(C,R,!0,m,b,void 0,E),R.forEach(function(P){P.start_date<b&&P.end_date>m&&k.push(P)})}else this._is_virtual_event(C.id)||k.push(C);else m||b||this._is_virtual_event(C.id)||k.push(C)}return k},e._copy_dummy=function(m){var b=new Date(this.start_date),k=new Date(this.end_date);this.start_date=b,this.end_date=k,this.duration=this.rrule=null},e.config.include_end_by=!1,e.config.lightbox_recurring="ask",e.config.recurring_workdays=[j.MO.weekday,j.TU.weekday,j.WE.weekday,j.TH.weekday,j.FR.weekday],e.config.repeat_date="%m.%d.%Y",e.config.lightbox.sections=[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"recurring",type:"recurring",map_to:"rrule"},{name:"time",height:72,type:"time",map_to:"auto"}],e.attachEvent("onClearAll",function(){e._rec_markers={},e._rec_markers_pull={},e._rec_temp=[]});const v={0:"SU",1:"MO",2:"TU",3:"WE",4:"TH",5:"FR",6:"SA"},x={0:1,1:2,2:3,3:4,4:5,5:6,6:0};function S(m,b){const k=m.querySelector("[name='repeat_interval_value']");k&&(k.value=(b?b.interval:1)||1)}function O(m){switch(m){case 1:case 31:return`${m}st`;case 2:return`${m}nd`;case 3:return`${m}rd`;default:return`${m}th`}}e.templates.repeat_monthly_date=function(m,b){return`Every ${O(m.getDate())}`},e.templates.repeat_monthly_weekday=function(m,b){const k=p(m);return`Every ${O(k.dayNumber)} ${e.locale.date.day_full[k.dayOfWeek]}`},e.templates.repeat_yearly_month_date=function(m,b){const k=m.getDate(),E=e.locale.date.month_full[m.getMonth()];return`Every ${O(k)} day of ${E}`},e.templates.repeat_yearly_month_weekday=function(m,b){const k=p(m),E=e.locale.date.month_full[m.getMonth()];return`Every ${O(k.dayNumber)} ${e.locale.date.day_full[k.dayOfWeek]} of ${E}`};const N={MONTHLY:function(m){return{rrule:{freq:j.MONTHLY,interval:1,bymonthday:m.start.getDate()},until:new Date(9999,1,1)}},WEEKLY:function(m){let b=m.start.getDay()-1;return b==-1&&(b=6),{rrule:{freq:j.WEEKLY,interval:1,byweekday:[b]},until:new Date(9999,1,1)}},DAILY:function(m){return{rrule:{freq:j.DAILY,interval:1},until:new Date(9999,1,1)}},YEARLY:function(m){return{rrule:{freq:j.YEARLY,bymonth:m.start.getMonth()+1,interval:1,bymonthday:m.start.getDate()},until:new Date(9999,1,1)}},WORKDAYS:function(m){return{rrule:{freq:j.WEEKLY,interval:1,byweekday:e.config.recurring_workdays},until:new Date(9999,1,1)}},CUSTOM:function(m,b){const k={},E=b.querySelector('[name="repeat_interval_unit"]').value,D=Math.max(1,b.querySelector('[name="repeat_interval_value"]').value),C=b.querySelector('[name="dhx_custom_month_option"]')?b.querySelector('[name="dhx_custom_month_option"]').value:null,R=b.querySelector('[name="dhx_custom_year_option"]')?b.querySelector('[name="dhx_custom_year_option"]').value:null;let P,F;switch(k.interval=D,E){case"DAILY":k.freq=j.DAILY;break;case"WEEKLY":k.freq=j.WEEKLY,P=[],b.querySelectorAll('.dhx_form_repeat_custom_week [name="week_day"]').forEach(te=>{te.checked&&P.push(te.value)}),k.byweekday=P.map(te=>{switch(te){case"MO":return j.MO.weekday;case"TU":return j.TU.weekday;case"WE":return j.WE.weekday;case"TH":return j.TH.weekday;case"FR":return j.FR.weekday;case"SA":return j.SA.weekday;case"SU":return j.SU.weekday}});break;case"MONTHLY":k.freq=j.MONTHLY,C==="month_date"?k.bymonthday=m.start.getDate():(F=m.start.getDay()-1,F==-1&&(F=6),k.byweekday=[F],k.bysetpos=p(m.start).dayNumber);break;case"YEARLY":k.freq=j.YEARLY,k.bymonth=m.start.getMonth()+1,R=="month_date"?k.bymonthday=m.start.getDate():(F=m.start.getDay()-1,F==-1&&(F=6),k.byweekday=[F],k.bysetpos=p(m.start).dayNumber)}const q=e.date.str_to_date("%Y-%m-%d");let $=new Date(9999,1,1);const X=b.querySelector('[name="dhx_custom_repeat_ends"]');return X&&X.value==="ON"?($=q(b.querySelector('[name="dhx_form_repeat_ends_ondate"]').value),k.until=new Date($)):X&&X.value==="AFTER"&&(k.count=Math.max(1,b.querySelector('[name="dhx_form_repeat_ends_after"]').value)),{rrule:k,until:$}},NEVER:function(){}};function I(m,b,k){(function(E,D){S(E,D)})(m,b),function(E,D,C){if(S(E,D),E.querySelectorAll(".dhx_form_repeat_custom_week input").forEach(R=>R.checked=!1),D&&D.byweekday)D.byweekday.forEach(R=>{const P=x[R.weekday],F=v[P],q=E.querySelector(`.dhx_form_repeat_custom_week input[value="${F}"]`);q&&(q.checked=!0)});else{const R=v[C.start_date.getDay()],P=E.querySelector(`.dhx_form_repeat_custom_week input[value="${R}"]`);P&&(P.checked=!0)}}(m,b,k),function(E,D,C){S(E,D);const R=E.querySelector('.dhx_form_repeat_custom_month [value="month_date"]'),P=E.querySelector('.dhx_form_repeat_custom_month [value="month_nth_weekday"]');if(R&&P){R.innerText=e.templates.repeat_monthly_date(C.start_date,C),P.innerText=e.templates.repeat_monthly_weekday(C.start_date,C);const F=E.querySelector('[name="dhx_custom_month_option"]');F&&(F.value=!D||!D.bysetpos||D.byweekday&&D.byweekday.length?"month_nth_weekday":"month_date")}}(m,b,k),function(E,D,C){const R=E.querySelector('.dhx_form_repeat_custom_year [value="month_date"]'),P=E.querySelector('.dhx_form_repeat_custom_year [value="month_nth_weekday"]');R&&P&&(R.innerText=e.templates.repeat_yearly_month_date(C.start_date,C),P.innerText=e.templates.repeat_yearly_month_weekday(C.start_date,C),D&&(!D.bysetpos||D.byweekday&&D.byweekday.length)?E.querySelector('[name="dhx_custom_year_option"]').value="month_nth_weekday":E.querySelector('[name="dhx_custom_year_option"]').value="month_date")}(m,b,k),function(E,D,C){const R=E.querySelector('.dhx_form_repeat_ends_extra [name="dhx_form_repeat_ends_after"]'),P=E.querySelector('.dhx_form_repeat_ends_extra [name="dhx_form_repeat_ends_ondate"]'),F=E.querySelector("[name='dhx_custom_repeat_ends']");if(R&&P&&F){R.value=1;let q=e.date.date_to_str("%Y-%m-%d");e.config.repeat_date_of_end||(e.config.repeat_date_of_end=q(e.date.add(e._currentDate(),30,"day"))),P.value=e.config.repeat_date_of_end,D&&D.count?(F.value="AFTER",R.value=D.count):C._end_date&&C._end_date.getFullYear()!==9999?(F.value="ON",P.value=q(C._end_date)):F.value="NEVER",F.dispatchEvent(new Event("change"))}}(m,b,k)}function A(m){for(let b=0;b<e.config.lightbox.sections.length;b++){let k=e.config.lightbox.sections[b];if(k.type===m)return e.formSection(k.name)}return null}e.form_blocks.recurring={_get_node:function(m){if(typeof m=="string"){let b=e._lightbox.querySelector(`#${m}`);b||(b=document.getElementById(m)),m=b}return m.style.display=="none"&&(m.style.display=""),m},_outer_html:function(m){return m.outerHTML||(b=m,(E=document.createElement("div")).appendChild(b.cloneNode(!0)),k=E.innerHTML,E=null,k);var b,k,E},render:function(m){if(m.form){let k=e.form_blocks.recurring,E=k._get_node(m.form),D=k._outer_html(E);return E.style.display="none",D}let b=e.locale.labels;return`<div class="dhx_form_rrule">
		<div class="dhx_form_repeat_pattern">
			<select>
				<option value="NEVER">${b.repeat_never}</option>
				<option value="DAILY">${b.repeat_daily}</option>
				<option value="WEEKLY">${b.repeat_weekly}</option>
				<option value="MONTHLY">${b.repeat_monthly}</option>
				<option value="YEARLY">${b.repeat_yearly}</option>
				<option value="WORKDAYS">${b.repeat_workdays}</option>
				<option value="CUSTOM">${b.repeat_custom}</option>
			</select>
		</div>
		<div class="dhx_form_repeat_custom dhx_hidden">
			<div class="dhx_form_repeat_custom_interval">
				<input name="repeat_interval_value" type="number" min="1">
				<select name="repeat_interval_unit">
					<option value="DAILY">${b.repeat_freq_day}</option>
					<option value="WEEKLY">${b.repeat_freq_week}</option>
					<option value="MONTHLY">${b.repeat_freq_month}</option>
					<option value="YEARLY">${b.repeat_freq_year}</option>
				</select>
			</div>

			<div class="dhx_form_repeat_custom_additional">
				<div class="dhx_form_repeat_custom_week dhx_hidden">
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="MO" />${b.day_for_recurring[1]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="TU" />${b.day_for_recurring[2]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="WE" />${b.day_for_recurring[3]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="TH" />${b.day_for_recurring[4]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="FR" />${b.day_for_recurring[5]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="SA" />${b.day_for_recurring[6]}</label>
					<label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="SU" />${b.day_for_recurring[0]}</label>
				</div>

				<div class="dhx_form_repeat_custom_month dhx_hidden">
					<select name="dhx_custom_month_option">
						<option value="month_date"></option>
						<option value="month_nth_weekday"></option>
					</select>
				</div>

				<div class="dhx_form_repeat_custom_year dhx_hidden">
					<select name="dhx_custom_year_option">
						<option value="month_date"></option>
						<option value="month_nth_weekday"></option>
					</select>
				</div>
			</div>

			<div class="dhx_form_repeat_ends">
				<div>${b.repeat_ends}</div>
				<div class="dhx_form_repeat_ends_options">
					<select name="dhx_custom_repeat_ends">
						<option value="NEVER">${b.repeat_never}</option>
						<option value="AFTER">${b.repeat_radio_end2}</option>
						<option value="ON">${b.repeat_on_date}</option>
					</select>
					<div class="dhx_form_repeat_ends_extra">
						<div class="dhx_form_repeat_ends_after dhx_hidden">
							<label><input type="number" min="1" name="dhx_form_repeat_ends_after">${b.repeat_text_occurrences_count}</label>
						</div>
						<div class="dhx_form_repeat_ends_on dhx_hidden">
							<input type="date" name="dhx_form_repeat_ends_ondate">
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>`},_init_set_value:function(m,b,k){function E(F){F&&F.classList.add("dhx_hidden")}function D(F){F&&F.classList.remove("dhx_hidden")}e.form_blocks.recurring._ds={start:k.start_date,end:k.end_date};const C=m.querySelector(".dhx_form_repeat_pattern select");C&&C.addEventListener("change",function(){(function(F){const q=m.querySelector(".dhx_form_repeat_custom");F==="CUSTOM"?D(q):E(q)})(this.value)});const R=m.querySelector(".dhx_form_repeat_custom_interval [name='repeat_interval_unit']");R&&R.addEventListener("change",function(){(function(F){const q={weekly:m.querySelector(".dhx_form_repeat_custom_week"),monthly:m.querySelector(".dhx_form_repeat_custom_month"),yearly:m.querySelector(".dhx_form_repeat_custom_year")};switch(F){case"DAILY":E(q.weekly),E(q.monthly),E(q.yearly);break;case"WEEKLY":D(q.weekly),E(q.monthly),E(q.yearly);break;case"MONTHLY":E(q.weekly),D(q.monthly),E(q.yearly);break;case"YEARLY":E(q.weekly),E(q.monthly),D(q.yearly)}})(this.value)});const P=m.querySelector(".dhx_form_repeat_ends [name='dhx_custom_repeat_ends']");P&&P.addEventListener("change",function(){(function(F){const q={after:m.querySelector(".dhx_form_repeat_ends_extra .dhx_form_repeat_ends_after"),on:m.querySelector(".dhx_form_repeat_ends_extra .dhx_form_repeat_ends_on")};switch(F){case"NEVER":E(q.after),E(q.on);break;case"AFTER":D(q.after),E(q.on);break;case"ON":E(q.after),D(q.on)}})(this.value)}),e._lightbox._rec_init_done=!0},button_click:function(){},set_value:function(m,b,k){let E=e.form_blocks.recurring;e._lightbox._rec_init_done||E._init_set_value(m,b,k),m.open=!k.rrule,m.blocked=this._is_modified_occurrence(k);let D=E._ds;if(D.start=k.start_date,D.end=k._end_date,k.rrule){const R=In(k.rrule);I(m,R.origOptions,k);const P=function(F,q){const $=F.options,X=$.until||q;return $.count||X&&X.getFullYear()!==9999?"CUSTOM":$.freq!==j.DAILY||$.interval!==1||$.byweekday?$.freq!==j.WEEKLY||$.interval!==1||$.byweekday?$.freq!==j.MONTHLY||$.interval!==1||$.bysetpos?$.freq!==j.YEARLY||$.interval!==1||$.bysetpos?$.freq===j.DAILY&&$.byweekday&&$.byweekday.length===e.config.recurring_workdays.length&&$.byweekday.includes(j.MO)&&$.byweekday.includes(j.TU)&&$.byweekday.includes(j.WE)&&$.byweekday.includes(j.TH)&&$.byweekday.includes(j.FR)?"WORKDAYS":"CUSTOM":"YEARLY":"MONTHLY":"WEEKLY":"DAILY"}(R,k._end_date);if(m.querySelector(".dhx_form_repeat_pattern select").value=P,P==="CUSTOM"){let F;switch(R.origOptions.freq){case j.DAILY:F="DAILY";break;case j.WEEKLY:F="WEEKLY";break;case j.MONTHLY:F="MONTHLY";break;case j.YEARLY:F="YEARLY"}F&&(m.querySelector('[name="repeat_interval_unit"]').value=F,m.querySelector('[name="repeat_interval_unit"]').dispatchEvent(new Event("change")))}}else{I(m,null,k);const R=m.querySelector(".dhx_form_repeat_pattern select");R&&(R.value="NEVER")}const C=m.querySelector(".dhx_form_repeat_pattern select");C&&C.dispatchEvent(new Event("change"))},get_value:function(m,b){const k=m.querySelector(".dhx_form_repeat_pattern select");if(m.blocked||k&&k.value==="NEVER")b.rrule=b.rrule="",b._end_date=b.end_date;else{let E=e.form_blocks.recurring._ds,D={};(function(){let P=e.formSection("time");if(P||(P=A("time")),P||(P=A("calendar_time")),!P)throw new Error(["Can't calculate the recurring rule, the Recurring form block can't find the Time control. Make sure you have the time control in 'scheduler.config.lightbox.sections' config.","You can use either the default time control https://docs.dhtmlx.com/scheduler/time.html, or the datepicker https://docs.dhtmlx.com/scheduler/minicalendar.html, or a custom control. ",'In the latter case, make sure the control is named "time":',"","scheduler.config.lightbox.sections = [",'{name:"time", height:72, type:"YOU CONTROL", map_to:"auto" }];'].join(`
`));return P})().getValue(D),E.start=D.start_date;const C=k?k.value:"CUSTOM",R=N[C](E,m);b.rrule=new j(R.rrule).toString().replace("RRULE:",""),E.end=R.until,b.duration=Math.floor((D.end_date-D.start_date)/1e3),E._start?(b.start_date=new Date(E.start),b._start_date=new Date(E.start),E._start=!1):b._start_date=null,b._end_date=E.end}return b.rrule},focus:function(m){}}},recurring_legacy:function(e){function t(){var a=e.formSection("recurring");if(a||(a=n("recurring")),!a)throw new Error(["Can't locate the Recurring form section.","Make sure that you have the recurring control on the lightbox configuration https://docs.dhtmlx.com/scheduler/recurring_events.html#recurringlightbox ",'and that the recurring control has name "recurring":',"","scheduler.config.lightbox.sections = [",'	{name:"recurring", ... }',"];"].join(`
`));return a}function n(a){for(var o=0;o<e.config.lightbox.sections.length;o++){var l=e.config.lightbox.sections[o];if(l.type===a)return e.formSection(l.name)}return null}function r(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),0)}var i;e.config.occurrence_timestamp_in_utc=!1,e.config.recurring_workdays=[1,2,3,4,5],e.form_blocks.recurring={_get_node:function(a){if(typeof a=="string"){let o=e._lightbox.querySelector(`#${a}`);o||(o=document.getElementById(a)),a=o}return a.style.display=="none"&&(a.style.display=""),a},_outer_html:function(a){return a.outerHTML||(o=a,(s=document.createElement("div")).appendChild(o.cloneNode(!0)),l=s.innerHTML,s=null,l);var o,l,s},render:function(a){if(a.form){var o=e.form_blocks.recurring,l=o._get_node(a.form),s=o._outer_html(l);return l.style.display="none",s}var d=e.locale.labels;return'<div class="dhx_form_repeat"> <form> <div class="dhx_repeat_left"> <div><label><input class="dhx_repeat_radio" type="radio" name="repeat" value="day" />'+d.repeat_radio_day+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="repeat" value="week"/>'+d.repeat_radio_week+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="repeat" value="month" checked />'+d.repeat_radio_month+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="repeat" value="year" />'+d.repeat_radio_year+'</label></div> </div> <div class="dhx_repeat_divider"></div> <div class="dhx_repeat_center"> <div style="display:none;" id="dhx_repeat_day"> <div><label><input class="dhx_repeat_radio" type="radio" name="day_type" value="d"/>'+d.repeat_radio_day_type+'</label><label><input class="dhx_repeat_text" type="text" name="day_count" value="1" />'+d.repeat_text_day_count+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="day_type" checked value="w"/>'+d.repeat_radio_day_type2+'</label></div> </div> <div style="display:none;" id="dhx_repeat_week"><div><label>'+d.repeat_week+'<input class="dhx_repeat_text" type="text" name="week_count" value="1" /></label><span>'+d.repeat_text_week_count+'</span></div>  <table class="dhx_repeat_days"> <tr> <td><div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="1" />'+d.day_for_recurring[1]+'</label></div> <div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="4" />'+d.day_for_recurring[4]+'</label></div></td> <td><div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="2" />'+d.day_for_recurring[2]+'</label></div> <div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="5" />'+d.day_for_recurring[5]+'</label></div></td> <td><div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="3" />'+d.day_for_recurring[3]+'</label></div> <div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="6" />'+d.day_for_recurring[6]+'</label></div></td> <td><div><label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="0" />'+d.day_for_recurring[0]+'</label></div> </td> </tr> </table> </div> <div id="dhx_repeat_month"> <div><label class = "dhx_repeat_month_label"><input class="dhx_repeat_radio" type="radio" name="month_type" value="d"/>'+d.repeat_radio_month_type+'</label><label><input class="dhx_repeat_text" type="text" name="month_day" value="1" />'+d.repeat_text_month_day+'</label><label><input class="dhx_repeat_text" type="text" name="month_count" value="1" />'+d.repeat_text_month_count+'</label></div> <div><label class = "dhx_repeat_month_label"><input class="dhx_repeat_radio" type="radio" name="month_type" checked value="w"/>'+d.repeat_radio_month_start+'</label><input class="dhx_repeat_text" type="text" name="month_week2" value="1" /><label><select name="month_day2">	<option value="1" selected >'+e.locale.date.day_full[1]+'<option value="2">'+e.locale.date.day_full[2]+'<option value="3">'+e.locale.date.day_full[3]+'<option value="4">'+e.locale.date.day_full[4]+'<option value="5">'+e.locale.date.day_full[5]+'<option value="6">'+e.locale.date.day_full[6]+'<option value="0">'+e.locale.date.day_full[0]+"</select>"+d.repeat_text_month_count2_before+'</label><label><input class="dhx_repeat_text" type="text" name="month_count2" value="1" />'+d.repeat_text_month_count2_after+'</label></div> </div> <div style="display:none;" id="dhx_repeat_year"> <div><label class = "dhx_repeat_year_label"><input class="dhx_repeat_radio" type="radio" name="year_type" value="d"/>'+d.repeat_radio_day_type+'</label><label><input class="dhx_repeat_text" type="text" name="year_day" value="1" />'+d.repeat_text_year_day+'</label><label><select name="year_month"><option value="0" selected >'+d.month_for_recurring[0]+'<option value="1">'+d.month_for_recurring[1]+'<option value="2">'+d.month_for_recurring[2]+'<option value="3">'+d.month_for_recurring[3]+'<option value="4">'+d.month_for_recurring[4]+'<option value="5">'+d.month_for_recurring[5]+'<option value="6">'+d.month_for_recurring[6]+'<option value="7">'+d.month_for_recurring[7]+'<option value="8">'+d.month_for_recurring[8]+'<option value="9">'+d.month_for_recurring[9]+'<option value="10">'+d.month_for_recurring[10]+'<option value="11">'+d.month_for_recurring[11]+"</select>"+d.select_year_month+'</label></div> <div><label class = "dhx_repeat_year_label"><input class="dhx_repeat_radio" type="radio" name="year_type" checked value="w"/>'+d.repeat_year_label+'</label><input class="dhx_repeat_text" type="text" name="year_week2" value="1" /><select name="year_day2"><option value="1" selected >'+e.locale.date.day_full[1]+'<option value="2">'+e.locale.date.day_full[2]+'<option value="3">'+e.locale.date.day_full[3]+'<option value="4">'+e.locale.date.day_full[4]+'<option value="5">'+e.locale.date.day_full[5]+'<option value="6">'+e.locale.date.day_full[6]+'<option value="7">'+e.locale.date.day_full[0]+"</select>"+d.select_year_day2+'<select name="year_month2"><option value="0" selected >'+d.month_for_recurring[0]+'<option value="1">'+d.month_for_recurring[1]+'<option value="2">'+d.month_for_recurring[2]+'<option value="3">'+d.month_for_recurring[3]+'<option value="4">'+d.month_for_recurring[4]+'<option value="5">'+d.month_for_recurring[5]+'<option value="6">'+d.month_for_recurring[6]+'<option value="7">'+d.month_for_recurring[7]+'<option value="8">'+d.month_for_recurring[8]+'<option value="9">'+d.month_for_recurring[9]+'<option value="10">'+d.month_for_recurring[10]+'<option value="11">'+d.month_for_recurring[11]+'</select></div> </div> </div> <div class="dhx_repeat_divider"></div> <div class="dhx_repeat_right"> <div><label><input class="dhx_repeat_radio" type="radio" name="end" checked/>'+d.repeat_radio_end+'</label></div> <div><label><input class="dhx_repeat_radio" type="radio" name="end" />'+d.repeat_radio_end2+'</label><input class="dhx_repeat_text" type="text" name="occurences_count" value="1" />'+d.repeat_text_occurences_count+'</div> <div><label><input class="dhx_repeat_radio" type="radio" name="end" />'+d.repeat_radio_end3+'</label><input class="dhx_repeat_date" type="text" name="date_of_end" value="'+e.config.repeat_date_of_end+'" /></div> </div> </form> </div> </div>'},_ds:{},_get_form_node:function(a,o,l){var s=a[o];if(!s)return null;if(s.nodeName)return s;if(s.length){for(var d=0;d<s.length;d++)if(s[d].value==l)return s[d]}},_get_node_value:function(a,o,l){var s=a[o];if(!s)return"";if(s.length){if(l){for(var d=[],c=0;c<s.length;c++)s[c].checked&&d.push(s[c].value);return d}for(c=0;c<s.length;c++)if(s[c].checked)return s[c].value}return s.value?l?[s.value]:s.value:void 0},_get_node_numeric_value:function(a,o){return 1*e.form_blocks.recurring._get_node_value(a,o)||0},_set_node_value:function(a,o,l){var s=a[o];if(s){if(s.name==o)s.value=l;else if(s.length)for(var d=typeof l=="object",c=0;c<s.length;c++)(d||s[c].value==l)&&(s[c].checked=d?!!l[s[c].value]:!!l)}},_init_set_value:function(a,o,l){var s=e.form_blocks.recurring,d=s._get_node_value,c=s._set_node_value;e.form_blocks.recurring._ds={start:l.start_date,end:l._end_date};var u=e.date.str_to_date(e.config.repeat_date,!1,!0),f=e.date.date_to_str(e.config.repeat_date),y=a.getElementsByTagName("FORM")[0],g={};function h(m){for(var b=0;b<m.length;b++){var k=m[b];if(k.name)if(g[k.name])if(g[k.name].nodeType){var E=g[k.name];g[k.name]=[E,k]}else g[k.name].push(k);else g[k.name]=k}}if(h(y.getElementsByTagName("INPUT")),h(y.getElementsByTagName("SELECT")),!e.config.repeat_date_of_end){var p=e.date.date_to_str(e.config.repeat_date);e.config.repeat_date_of_end=p(e.date.add(e._currentDate(),30,"day"))}c(g,"date_of_end",e.config.repeat_date_of_end);var v=function(m){return e._lightbox.querySelector(`#${m}`)||{style:{}}};function x(){v("dhx_repeat_day").style.display="none",v("dhx_repeat_week").style.display="none",v("dhx_repeat_month").style.display="none",v("dhx_repeat_year").style.display="none",v("dhx_repeat_"+this.value).style.display="",e.setLightboxSize()}function S(m,b){var k=m.end;if(k.length)if(k[0].value&&k[0].value!="on")for(var E=0;E<k.length;E++)k[E].value==b&&(k[E].checked=!0);else{var D=0;switch(b){case"no":D=0;break;case"date_of_end":D=2;break;default:D=1}k[D].checked=!0}else k.value=b}e.form_blocks.recurring._get_repeat_code=function(m){var b=[d(g,"repeat")];for(O[b[0]](b,m);b.length<5;)b.push("");var k="",E=function(D){var C=D.end;if(C.length){for(var R=0;R<C.length;R++)if(C[R].checked)return C[R].value&&C[R].value!="on"?C[R].value:R?R==2?"date_of_end":"occurences_count":"no"}else if(C.value)return C.value;return"no"}(g);return E=="no"?(m.end=new Date(9999,1,1),k="no"):E=="date_of_end"?m.end=function(D){var C=u(D);return e.config.include_end_by&&(C=e.date.add(C,1,"day")),C}(d(g,"date_of_end")):(e.transpose_type(b.join("_")),k=Math.max(1,d(g,"occurences_count")),m.end=e.date["add_"+b.join("_")](new Date(m.start),k+0,{start_date:m.start})||m.start),b.join("_")+"#"+k};var O={month:function(m,b){var k=e.form_blocks.recurring._get_node_value,E=e.form_blocks.recurring._get_node_numeric_value;k(g,"month_type")=="d"?(m.push(Math.max(1,E(g,"month_count"))),b.start.setDate(k(g,"month_day"))):(m.push(Math.max(1,E(g,"month_count2"))),m.push(k(g,"month_day2")),m.push(Math.max(1,E(g,"month_week2"))),e.config.repeat_precise||b.start.setDate(1)),b._start=!0},week:function(m,b){var k=e.form_blocks.recurring._get_node_value,E=e.form_blocks.recurring._get_node_numeric_value;m.push(Math.max(1,E(g,"week_count"))),m.push(""),m.push("");for(var D=[],C=k(g,"week_day",!0),R=b.start.getDay(),P=!1,F=0;F<C.length;F++)D.push(C[F]),P=P||C[F]==R;D.length||(D.push(R),P=!0),D.sort(),e.config.repeat_precise?P||(e.transpose_day_week(b.start,D,1,7),b._start=!0):(b.start=e.date.week_start(b.start),b._start=!0),m.push(D.join(","))},day:function(m){var b=e.form_blocks.recurring._get_node_value,k=e.form_blocks.recurring._get_node_numeric_value;b(g,"day_type")=="d"?m.push(Math.max(1,k(g,"day_count"))):(m.push("week"),m.push(1),m.push(""),m.push(""),m.push(e.config.recurring_workdays.join(",")),m.splice(0,1))},year:function(m,b){var k=e.form_blocks.recurring._get_node_value;k(g,"year_type")=="d"?(m.push("1"),b.start.setMonth(0),b.start.setDate(k(g,"year_day")),b.start.setMonth(k(g,"year_month"))):(m.push("1"),m.push(k(g,"year_day2")),m.push(k(g,"year_week2")),b.start.setDate(1),b.start.setMonth(k(g,"year_month2"))),b._start=!0}},N={week:function(m,b){var k=e.form_blocks.recurring._set_node_value;k(g,"week_count",m[1]);for(var E=m[4].split(","),D={},C=0;C<E.length;C++)D[E[C]]=!0;k(g,"week_day",D)},month:function(m,b){var k=e.form_blocks.recurring._set_node_value;m[2]===""?(k(g,"month_type","d"),k(g,"month_count",m[1]),k(g,"month_day",b.start.getDate())):(k(g,"month_type","w"),k(g,"month_count2",m[1]),k(g,"month_week2",m[3]),k(g,"month_day2",m[2]))},day:function(m,b){var k=e.form_blocks.recurring._set_node_value;k(g,"day_type","d"),k(g,"day_count",m[1])},year:function(m,b){var k=e.form_blocks.recurring._set_node_value;m[2]===""?(k(g,"year_type","d"),k(g,"year_day",b.start.getDate()),k(g,"year_month",b.start.getMonth())):(k(g,"year_type","w"),k(g,"year_week2",m[3]),k(g,"year_day2",m[2]),k(g,"year_month2",b.start.getMonth()))}};e.form_blocks.recurring._set_repeat_code=function(m,b){var k=e.form_blocks.recurring._set_node_value,E=m.split("#");switch(m=E[0].split("_"),N[m[0]](m,b),E[1]){case"no":S(g,"no");break;case"":S(g,"date_of_end");var D=b.end;e.config.include_end_by&&(D=e.date.add(D,-1,"day")),k(g,"date_of_end",f(D));break;default:S(g,"occurences_count"),k(g,"occurences_count",E[1])}k(g,"repeat",m[0]);var C=e.form_blocks.recurring._get_form_node(g,"repeat",m[0]);C.nodeName=="SELECT"?(C.dispatchEvent(new Event("change")),C.dispatchEvent(new MouseEvent("click"))):C.dispatchEvent(new MouseEvent("click"))};for(var I=0;I<y.elements.length;I++){var A=y.elements[I];A.name==="repeat"&&(A.nodeName!="SELECT"||A.$_eventAttached?A.$_eventAttached||(A.$_eventAttached=!0,A.addEventListener("click",x)):(A.$_eventAttached=!0,A.addEventListener("change",x)))}e._lightbox._rec_init_done=!0},set_value:function(a,o,l){var s=e.form_blocks.recurring;e._lightbox._rec_init_done||s._init_set_value(a,o,l),a.open=!l.rec_type,a.blocked=this._is_modified_occurence(l);var d=s._ds;d.start=l.start_date,d.end=l._end_date,s._toggle_block(),o&&s._set_repeat_code(o,d)},get_value:function(a,o){if(a.open){var l=e.form_blocks.recurring._ds,s={};(function(){var d=e.formSection("time");if(d||(d=n("time")),d||(d=n("calendar_time")),!d)throw new Error(["Can't calculate the recurring rule, the Recurring form block can't find the Time control. Make sure you have the time control in 'scheduler.config.lightbox.sections' config.","You can use either the default time control https://docs.dhtmlx.com/scheduler/time.html, or the datepicker https://docs.dhtmlx.com/scheduler/minicalendar.html, or a custom control. ",'In the latter case, make sure the control is named "time":',"","scheduler.config.lightbox.sections = [",'{name:"time", height:72, type:"YOU CONTROL", map_to:"auto" }];'].join(`
`));return d})().getValue(s),l.start=s.start_date,o.rec_type=e.form_blocks.recurring._get_repeat_code(l),l._start?(o.start_date=new Date(l.start),o._start_date=new Date(l.start),l._start=!1):o._start_date=null,o._end_date=l.end,o.rec_pattern=o.rec_type.split("#")[0]}else o.rec_type=o.rec_pattern="",o._end_date=o.end_date;return o.rec_type},_get_button:function(){return t().header.firstChild.firstChild},_get_form:function(){return t().node},open:function(){var a=e.form_blocks.recurring;a._get_form().open||a._toggle_block()},close:function(){var a=e.form_blocks.recurring;a._get_form().open&&a._toggle_block()},_toggle_block:function(){var a=e.form_blocks.recurring,o=a._get_form(),l=a._get_button();o.open||o.blocked?(o.style.height="0px",l&&(l.style.backgroundPosition="-5px 20px",l.nextSibling.innerHTML=e.locale.labels.button_recurring)):(o.style.height="auto",l&&(l.style.backgroundPosition="-5px 0px",l.nextSibling.innerHTML=e.locale.labels.button_recurring_open)),o.open=!o.open,e.setLightboxSize()},focus:function(a){},button_click:function(a,o,l){e.form_blocks.recurring._get_form().blocked||e.form_blocks.recurring._toggle_block()}},e._rec_markers={},e._rec_markers_pull={},e._add_rec_marker=function(a,o){a._pid_time=o,this._rec_markers[a.id]=a,this._rec_markers_pull[a.event_pid]||(this._rec_markers_pull[a.event_pid]={}),this._rec_markers_pull[a.event_pid][o]=a},e._get_rec_marker=function(a,o){var l=this._rec_markers_pull[o];return l?l[a]:null},e._get_rec_markers=function(a){return this._rec_markers_pull[a]||[]},e._rec_temp=[],i=e.addEvent,e.addEvent=function(a,o,l,s,d){var c=i.apply(this,arguments);if(c&&e.getEvent(c)){var u=e.getEvent(c);u.start_date&&(u.start_date=r(u.start_date)),u.end_date&&(u.end_date=r(u.end_date)),this._is_modified_occurence(u)&&e._add_rec_marker(u,1e3*u.event_length),u.rec_type&&(u.rec_pattern=u.rec_type.split("#")[0])}return c},e.attachEvent("onEventIdChange",function(a,o){if(!this._ignore_call){this._ignore_call=!0,e._rec_markers[a]&&(e._rec_markers[o]=e._rec_markers[a],delete e._rec_markers[a]),e._rec_markers_pull[a]&&(e._rec_markers_pull[o]=e._rec_markers_pull[a],delete e._rec_markers_pull[a]);for(var l=0;l<this._rec_temp.length;l++)(s=this._rec_temp[l]).event_pid==a&&(s.event_pid=o,this.changeEventId(s.id,o+"#"+s.id.split("#")[1]));for(var l in this._rec_markers){var s;(s=this._rec_markers[l]).event_pid==a&&(s.event_pid=o,s._pid_changed=!0)}var d=e._rec_markers[o];d&&d._pid_changed&&(delete d._pid_changed,setTimeout(function(){if(e.$destroyed)return!0;e.callEvent("onEventChanged",[o,e.getEvent(o)])},1)),delete this._ignore_call}}),e.attachEvent("onConfirmedBeforeEventDelete",function(a){var o=this.getEvent(a);if(this._is_virtual_event(a)||this._is_modified_occurence(o)&&o.rec_type&&o.rec_type!="none"){a=a.split("#");var l=this.uid(),s=a[1]?a[1]:Math.round(o._pid_time/1e3),d=this._copy_event(o);d.id=l,d.event_pid=o.event_pid||a[0];var c=s;d.event_length=c,d.rec_type=d.rec_pattern="none",this.addEvent(d),this._add_rec_marker(d,1e3*c)}else{o.rec_type&&this._lightbox_id&&this._roll_back_dates(o);var u=this._get_rec_markers(a);for(var f in u)u.hasOwnProperty(f)&&(a=u[f].id,this.getEvent(a)&&this.deleteEvent(a,!0))}return!0}),e.attachEvent("onEventDeleted",function(a,o){!this._is_virtual_event(a)&&this._is_modified_occurence(o)&&(e._events[a]||(o.rec_type=o.rec_pattern="none",this.setEvent(a,o)))}),e.attachEvent("onEventChanged",function(a,o){if(this._loading)return!0;var l=this.getEvent(a);if(this._is_virtual_event(a)){a=a.split("#");var s=this.uid();this._not_render=!0;var d=this._copy_event(o);d.id=s,d.event_pid=a[0];var c=a[1];d.event_length=c,d.rec_type=d.rec_pattern="",this._add_rec_marker(d,1e3*c),this.addEvent(d),this._not_render=!1}else{l.start_date&&(l.start_date=r(l.start_date)),l.end_date&&(l.end_date=r(l.end_date)),l.rec_type&&this._lightbox_id&&this._roll_back_dates(l);var u=this._get_rec_markers(a);for(var f in u)u.hasOwnProperty(f)&&(delete this._rec_markers[u[f].id],this.deleteEvent(u[f].id,!0));delete this._rec_markers_pull[a];for(var y=!1,g=0;g<this._rendered.length;g++)this._rendered[g].getAttribute(this.config.event_attribute)==a&&(y=!0);y||(this._select_id=null)}return!0}),e.attachEvent("onEventAdded",function(a){if(!this._loading){var o=this.getEvent(a);o.rec_type&&!o.event_length&&this._roll_back_dates(o)}return!0}),e.attachEvent("onEventSave",function(a,o,l){return this.getEvent(a).rec_type||!o.rec_type||this._is_virtual_event(a)||(this._select_id=null),!0}),e.attachEvent("onEventCreated",function(a){var o=this.getEvent(a);return o.rec_type||(o.rec_type=o.rec_pattern=o.event_length=o.event_pid=""),!0}),e.attachEvent("onEventCancel",function(a){var o=this.getEvent(a);o.rec_type&&(this._roll_back_dates(o),this.render_view_data())}),e._roll_back_dates=function(a){a.start_date&&(a.start_date=r(a.start_date)),a.end_date&&(a.end_date=r(a.end_date)),a.event_length=Math.round((a.end_date.valueOf()-a.start_date.valueOf())/1e3),a.end_date=a._end_date,a._start_date&&(a.start_date.setMonth(0),a.start_date.setDate(a._start_date.getDate()),a.start_date.setMonth(a._start_date.getMonth()),a.start_date.setFullYear(a._start_date.getFullYear()))},e._is_virtual_event=function(a){return a.toString().indexOf("#")!=-1},e._is_modified_occurence=function(a){return a.event_pid&&a.event_pid!="0"},e.showLightbox_rec=e.showLightbox,e.showLightbox=function(a){var o=this.locale,l=e.config.lightbox_recurring,s=this.getEvent(a),d=s.event_pid,c=this._is_virtual_event(a);c&&(d=a.split("#")[0]);var u=function(y){var g=e.getEvent(y);return g._end_date=g.end_date,g.end_date=new Date(g.start_date.valueOf()+1e3*g.event_length),e.showLightbox_rec(y)};if((d||1*d==0)&&s.rec_type)return u(a);if(!d||d==="0"||!o.labels.confirm_recurring||l=="instance"||l=="series"&&!c)return this.showLightbox_rec(a);if(l=="ask"){var f=this;e.modalbox({text:o.labels.confirm_recurring,title:o.labels.title_confirm_recurring,width:"500px",position:"middle",buttons:[o.labels.button_edit_series,o.labels.button_edit_occurrence,o.labels.icon_cancel],callback:function(y){switch(+y){case 0:return u(d);case 1:return f.showLightbox_rec(a);case 2:return}}})}else u(d)},e.get_visible_events_rec=e.get_visible_events,e.get_visible_events=function(a){for(var o=0;o<this._rec_temp.length;o++)delete this._events[this._rec_temp[o].id];this._rec_temp=[];var l=this.get_visible_events_rec(a),s=[];for(o=0;o<l.length;o++)l[o].rec_type?l[o].rec_pattern!="none"&&this.repeat_date(l[o],s):s.push(l[o]);return s},function(){var a=e.isOneDayEvent;e.isOneDayEvent=function(l){return!!l.rec_type||a.call(this,l)};var o=e.updateEvent;e.updateEvent=function(l){var s=e.getEvent(l);s&&s.rec_type&&(s.rec_pattern=(s.rec_type||"").split("#")[0]),s&&s.rec_type&&!this._is_virtual_event(l)?e.update_view():o.call(this,l)}}(),e.transponse_size={day:1,week:7,month:1,year:12},e.date.day_week=function(a,o,l){a.setDate(1);var s=e.date.month_start(new Date(a)),d=1*o+(l=7*(l-1))-a.getDay()+1;a.setDate(d<=l?d+7:d);var c=e.date.month_start(new Date(a));return s.valueOf()===c.valueOf()},e.transpose_day_week=function(a,o,l,s,d){for(var c=(a.getDay()||(e.config.start_on_monday?7:0))-l,u=0;u<o.length;u++)if(o[u]>c)return a.setDate(a.getDate()+1*o[u]-c-(s?l:d));this.transpose_day_week(a,o,l+s,null,l)},e.transpose_type=function(a){var o="transpose_"+a;if(!this.date[o]){var l=a.split("_"),s="add_"+a,d=this.transponse_size[l[0]]*l[1];if(l[0]=="day"||l[0]=="week"){var c=null;if(l[4]&&(c=l[4].split(","),e.config.start_on_monday)){for(var u=0;u<c.length;u++)c[u]=1*c[u]||7;c.sort()}this.date[o]=function(f,y){var g=Math.floor((y.valueOf()-f.valueOf())/(864e5*d));return g>0&&f.setDate(f.getDate()+g*d),c&&e.transpose_day_week(f,c,1,d),f},this.date[s]=function(f,y){var g=new Date(f.valueOf());if(c)for(var h=0;h<y;h++)e.transpose_day_week(g,c,0,d);else g.setDate(g.getDate()+y*d);return g}}else l[0]!="month"&&l[0]!="year"||(this.date[o]=function(f,y,g){var h=Math.ceil((12*y.getFullYear()+1*y.getMonth()+1-(12*f.getFullYear()+1*f.getMonth()+1))/d-1);return h>=0&&(f.setDate(1),f.setMonth(f.getMonth()+h*d)),e.date[s](f,0,g)},this.date[s]=function(f,y,g,h){if(h?h++:h=1,h>12)return null;var p=new Date(f.valueOf());p.setDate(1),p.setMonth(p.getMonth()+y*d);var v=p.getMonth(),x=p.getFullYear();p.setDate(g.start_date.getDate()),l[3]&&e.date.day_week(p,l[2],l[3]);var S=e.config.recurring_overflow_instances;return p.getMonth()!=v&&S!="none"&&(p=S==="lastDay"?new Date(x,v+1,0,p.getHours(),p.getMinutes(),p.getSeconds(),p.getMilliseconds()):e.date[s](new Date(x,v+1,0),y||1,g,h)),p})}},e.repeat_date=function(a,o,l,s,d,c){s=s||this._min_date,d=d||this._max_date;var u=c||-1,f=new Date(a.start_date.valueOf()),y=f.getHours(),g=0;for(!a.rec_pattern&&a.rec_type&&(a.rec_pattern=a.rec_type.split("#")[0]),this.transpose_type(a.rec_pattern),f=e.date["transpose_"+a.rec_pattern](f,s,a);f&&(f<a.start_date||e._fix_daylight_saving_date(f,s,a,f,new Date(f.valueOf()+1e3*a.event_length)).valueOf()<=s.valueOf()||f.valueOf()+1e3*a.event_length<=s.valueOf());)f=this.date["add_"+a.rec_pattern](f,1,a);for(;f&&f<d&&f<a.end_date&&(u<0||g<u);){f.setHours(y);var h=e.config.occurrence_timestamp_in_utc?Date.UTC(f.getFullYear(),f.getMonth(),f.getDate(),f.getHours(),f.getMinutes(),f.getSeconds()):f.valueOf(),p=this._get_rec_marker(h,a.id);if(p)l&&(p.rec_type!="none"&&g++,o.push(p));else{var v=new Date(f.valueOf()+1e3*a.event_length),x=this._copy_event(a);if(x.text=a.text,x.start_date=f,x.event_pid=a.id,x.id=a.id+"#"+Math.round(h/1e3),x.end_date=v,x.end_date=e._fix_daylight_saving_date(x.start_date,x.end_date,a,f,x.end_date),x._timed=this.isOneDayEvent(x),!x._timed&&!this._table_view&&!this.config.multi_day)return;o.push(x),l||(this._events[x.id]=x,this._rec_temp.push(x)),g++}f=this.date["add_"+a.rec_pattern](f,1,a)}},e._fix_daylight_saving_date=function(a,o,l,s,d){var c=a.getTimezoneOffset()-o.getTimezoneOffset();return c?c>0?new Date(s.valueOf()+1e3*l.event_length-60*c*1e3):new Date(o.valueOf()-60*c*1e3):new Date(d.valueOf())},e.getRecDates=function(a,o){var l=typeof a=="object"?a:e.getEvent(a),s=[];if(o=o||100,!l.rec_type)return[{start_date:l.start_date,end_date:l.end_date}];if(l.rec_type=="none")return[];e.repeat_date(l,s,!0,l.start_date,l.end_date,o);for(var d=[],c=0;c<s.length;c++)s[c].rec_type!="none"&&d.push({start_date:s[c].start_date,end_date:s[c].end_date});return d},e.getEvents=function(a,o){var l=[];for(var s in this._events){var d=this._events[s];if(d&&d.start_date<o&&d.end_date>a)if(d.rec_pattern){if(d.rec_pattern=="none")continue;var c=[];this.repeat_date(d,c,!0,a,o);for(var u=0;u<c.length;u++)!c[u].rec_pattern&&c[u].start_date<o&&c[u].end_date>a&&!this._rec_markers[c[u].id]&&l.push(c[u])}else this._is_virtual_event(d.id)||l.push(d)}return l},e.config.repeat_date="%m.%d.%Y",e.config.lightbox.sections=[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"recurring",type:"recurring",map_to:"rec_type",button:"recurring"},{name:"time",height:72,type:"time",map_to:"auto"}],e._copy_dummy=function(a){var o=new Date(this.start_date),l=new Date(this.end_date);this.start_date=o,this.end_date=l,this.event_length=this.event_pid=this.rec_pattern=this.rec_type=null},e.config.include_end_by=!1,e.config.lightbox_recurring="ask",e.attachEvent("onClearAll",function(){e._rec_markers={},e._rec_markers_pull={},e._rec_temp=[]})},serialize:function(e){const t=El(e);e.data_attributes=function(){var n=[],r=e._helpers.formatDate,i=t();for(var a in i){var o=i[a];for(var l in o)l.substr(0,1)!="_"&&n.push([l,l=="start_date"||l=="end_date"?r:null]);break}return n},e.toXML=function(n){var r=[],i=this.data_attributes(),a=t();for(var o in a){var l=a[o];r.push("<event>");for(var s=0;s<i.length;s++)r.push("<"+i[s][0]+"><![CDATA["+(i[s][1]?i[s][1](l[i[s][0]]):l[i[s][0]])+"]]></"+i[s][0]+">");r.push("</event>")}return(n||"")+"<data>"+r.join(`
`)+"</data>"},e._serialize_json_value=function(n){return n===null||typeof n=="boolean"?n=""+n:(n||n===0||(n=""),n='"'+n.toString().replace(/\n/g,"").replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'),n},e.toJSON=function(){return JSON.stringify(this.serialize())},e.toICal=function(n){var r=e.date.date_to_str("%Y%m%dT%H%i%s"),i=e.date.date_to_str("%Y%m%d"),a=[],o=t();for(var l in o){var s=o[l];a.push("BEGIN:VEVENT"),s._timed&&(s.start_date.getHours()||s.start_date.getMinutes())?a.push("DTSTART:"+r(s.start_date)):a.push("DTSTART:"+i(s.start_date)),s._timed&&(s.end_date.getHours()||s.end_date.getMinutes())?a.push("DTEND:"+r(s.end_date)):a.push("DTEND:"+i(s.end_date)),a.push("SUMMARY:"+s.text),a.push("END:VEVENT")}return`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//dhtmlXScheduler//NONSGML v2.2//EN
DESCRIPTION:`+(n||"")+`
`+a.join(`
`)+`
END:VCALENDAR`}},timeline:function(e){vt("Timeline",e.assert)},tooltip:function(e){e.config.tooltip_timeout=30,e.config.tooltip_offset_y=20,e.config.tooltip_offset_x=10,e.config.tooltip_hide_timeout=30;const t=new yu(e);e.ext.tooltips=t,e.attachEvent("onSchedulerReady",function(){t.tooltipFor({selector:"["+e.config.event_attribute+"]",html:n=>{if(e._mobile&&!e.config.touch_tooltip)return;const r=e._locate_event(n.target);if(e.getEvent(r)){const i=e.getEvent(r);return e.templates.tooltip_text(i.start_date,i.end_date,i)}return null},global:!1})}),e.attachEvent("onDestroy",function(){t.destructor()}),e.attachEvent("onLightbox",function(){t.hideTooltip()}),e.attachEvent("onBeforeDrag",function(){return e._mobile&&e.config.touch_tooltip||t.hideTooltip(),!0}),e.attachEvent("onEventDeleted",function(){return t.hideTooltip(),!0})},treetimeline:function(e){vt("Tree Timeline",e.assert)},units:function(e){vt("Units",e.assert)},url:function(e){e._get_url_nav=function(){for(var t={},n=(document.location.hash||"").replace("#","").split(","),r=0;r<n.length;r++){var i=n[r].split("=");i.length==2&&(t[i[0]]=i[1])}return t},e.attachEvent("onTemplatesReady",function(){var t=!0,n=e.date.str_to_date("%Y-%m-%d"),r=e.date.date_to_str("%Y-%m-%d"),i=e._get_url_nav().event||null;function a(o){if(e.$destroyed)return!0;i=o,e.getEvent(o)&&e.showEvent(o)}e.attachEvent("onAfterEventDisplay",function(o){return i=null,!0}),e.attachEvent("onBeforeViewChange",function(o,l,s,d){if(t){t=!1;var c=e._get_url_nav();if(c.event)try{if(e.getEvent(c.event))return setTimeout(function(){a(c.event)}),!1;var u=e.attachEvent("onXLE",function(){setTimeout(function(){a(c.event)}),e.detachEvent(u)})}catch{}if(c.date||c.mode){try{this.setCurrentView(c.date?n(c.date):null,c.mode||null)}catch{this.setCurrentView(c.date?n(c.date):null,s)}return!1}}var f=["date="+r(d||l),"mode="+(s||o)];i&&f.push("event="+i);var y="#"+f.join(",");return document.location.hash=y,!0})})},week_agenda:function(e){vt("Week Agenda",e.assert)},wp:function(e){e.attachEvent("onLightBox",function(){if(this._cover)try{this._cover.style.height=this.expanded?"100%":(document.body.parentNode||document.body).scrollHeight+"px"}catch{}}),e.form_blocks.select.set_value=function(t,n,r){n!==void 0&&n!==""||(n=(t.firstChild.options[0]||{}).value),t.firstChild.value=n||""}},year_view:function(e){e.templates.year_date=function(l){return e.date.date_to_str(e.locale.labels.year_tab+" %Y")(l)},e.templates.year_month=e.date.date_to_str("%F"),e.templates.year_scale_date=e.date.date_to_str("%D"),e.templates.year_tooltip=function(l,s,d){return d.text};const t=function(){return e._mode=="year"},n=function(l){var s=e.$domHelpers.closest(l,"[data-cell-date]");return s&&s.hasAttribute("data-cell-date")?e.templates.parse_date(s.getAttribute("data-cell-date")):null};e.dblclick_dhx_year_grid=function(l){if(t()){const s=l.target;if(e.$domHelpers.closest(s,".dhx_before")||e.$domHelpers.closest(s,".dhx_after"))return!1;const d=n(s);if(d){const c=d,u=this.date.add(c,1,"day");!this.config.readonly&&this.config.dblclick_create&&this.addEventNow(c.valueOf(),u.valueOf(),l)}}},e.attachEvent("onEventIdChange",function(){t()&&this.year_view(!0)});var r=e.render_data;e.render_data=function(l){if(!t())return r.apply(this,arguments);for(var s=0;s<l.length;s++)this._year_render_event(l[s])};var i=e.clear_view;e.clear_view=function(){if(!t())return i.apply(this,arguments);var l=e._year_marked_cells;for(var s in l)l.hasOwnProperty(s)&&l[s].classList.remove("dhx_year_event","dhx_cal_datepicker_event");e._year_marked_cells={}},e._hideToolTip=function(){this._tooltip&&(this._tooltip.style.display="none",this._tooltip.date=new Date(9999,1,1))},e._showToolTip=function(l,s,d,c){if(this._tooltip){if(this._tooltip.date.valueOf()==l.valueOf())return;this._tooltip.innerHTML=""}else{var u=this._tooltip=document.createElement("div");u.className="dhx_year_tooltip",this.config.rtl&&(u.className+=" dhx_tooltip_rtl"),document.body.appendChild(u),u.addEventListener("click",e._click.dhx_cal_data),u.addEventListener("click",function(x){if(x.target.closest(`[${e.config.event_attribute}]`)){const S=x.target.closest(`[${e.config.event_attribute}]`).getAttribute(e.config.event_attribute);e.showLightbox(S)}})}for(var f=this.getEvents(l,this.date.add(l,1,"day")),y="",g=0;g<f.length;g++){var h=f[g];if(this.filter_event(h.id,h)){var p=h.color?"--dhx-scheduler-event-background:"+h.color+";":"",v=h.textColor?"--dhx-scheduler-event-color:"+h.textColor+";":"";y+="<div class='dhx_tooltip_line' style='"+p+v+"' event_id='"+f[g].id+"' "+this.config.event_attribute+"='"+f[g].id+"'>",y+="<div class='dhx_tooltip_date' style='"+p+v+"'>"+(f[g]._timed?this.templates.event_date(f[g].start_date):"")+"</div>",y+="<div class='dhx_event_icon icon_details'>&nbsp;</div>",y+=this.templates.year_tooltip(f[g].start_date,f[g].end_date,f[g])+"</div>"}}this._tooltip.style.display="",this._tooltip.style.top="0px",document.body.offsetWidth-s.left-this._tooltip.offsetWidth<0?this._tooltip.style.left=s.left-this._tooltip.offsetWidth+"px":this._tooltip.style.left=s.left+c.offsetWidth+"px",this._tooltip.date=l,this._tooltip.innerHTML=y,document.body.offsetHeight-s.top-this._tooltip.offsetHeight<0?this._tooltip.style.top=s.top-this._tooltip.offsetHeight+c.offsetHeight+"px":this._tooltip.style.top=s.top+"px"},e._year_view_tooltip_handler=function(l){if(t()){var s=l.target||l.srcElement;s.tagName.toLowerCase()=="a"&&(s=s.parentNode),e._getClassName(s).indexOf("dhx_year_event")!=-1?e._showToolTip(e.templates.parse_date(s.getAttribute("data-year-date")),e.$domHelpers.getOffset(s),l,s):e._hideToolTip()}},e._init_year_tooltip=function(){e._detachDomEvent(e._els.dhx_cal_data[0],"mouseover",e._year_view_tooltip_handler),e.event(e._els.dhx_cal_data[0],"mouseover",e._year_view_tooltip_handler)},e._get_year_cell=function(l){for(var s=e.templates.format_date(l),d=this.$root.querySelectorAll(`.dhx_cal_data .dhx_cal_datepicker_date[data-cell-date="${s}"]`),c=0;c<d.length;c++)if(!e.$domHelpers.closest(d[c],".dhx_after, .dhx_before"))return d[c];return null},e._year_marked_cells={},e._mark_year_date=function(l,s){var d=e.templates.format_date(l),c=this._get_year_cell(l);if(c){var u=this.templates.event_class(s.start_date,s.end_date,s);e._year_marked_cells[d]||(c.classList.add("dhx_year_event","dhx_cal_datepicker_event"),c.setAttribute("data-year-date",d),c.setAttribute("date",d),e._year_marked_cells[d]=c),u&&c.classList.add(u)}},e._unmark_year_date=function(l){var s=this._get_year_cell(l);s&&s.classList.remove("dhx_year_event","dhx_cal_datepicker_event")},e._year_render_event=function(l){var s=l.start_date;for(s=s.valueOf()<this._min_date.valueOf()?this._min_date:this.date.date_part(new Date(s));s<l.end_date;)if(this._mark_year_date(s,l),(s=this.date.add(s,1,"day")).valueOf()>=this._max_date.valueOf())return},e.year_view=function(l){if(e.set_sizes(),e._table_view=l,!this._load_mode||!this._load())if(l){if(e._init_year_tooltip(),e._reset_year_scale(),e._load_mode&&e._load())return void(e._render_wait=!0);e.render_view_data()}else e._hideToolTip()},e._reset_year_scale=function(){var l=this._els.dhx_cal_data[0];l.scrollTop=0,l.innerHTML="";let s=this.date.year_start(new Date(this._date));this._min_date=this.date.week_start(new Date(s));const d=document.createElement("div");d.classList.add("dhx_year_wrapper");let c=s;for(let y=0;y<12;y++){let g=document.createElement("div");g.className="dhx_year_box",g.setAttribute("date",this._helpers.formatDate(c)),g.setAttribute("data-month-date",this._helpers.formatDate(c)),g.innerHTML=`<div class='dhx_year_month'>${this.templates.year_month(c)}</div>
			<div class='dhx_year_grid'></div>`;const h=g.querySelector(".dhx_year_grid"),p=e._createDatePicker(null,{date:c,filterDays:e.ignore_year,minWeeks:6});p._renderDayGrid(h),p.destructor(),d.appendChild(g),c=this.date.add(c,1,"month")}l.appendChild(d);let u=this.date.add(s,1,"year");u.valueOf()!=this.date.week_start(new Date(u)).valueOf()&&(u=this.date.week_start(new Date(u)),u=this.date.add(u,1,"week")),this._max_date=u;var f=this._getNavDateElement();f&&(f.innerHTML=this.templates[this._mode+"_date"](s,u,this._mode))};var a=e.getActionData;e.getActionData=function(l){return t()?{date:n(l.target),section:null}:a.apply(e,arguments)};var o=e._locate_event;e._locate_event=function(l){var s=o.apply(e,arguments);if(!s){var d=n(l);if(!d)return null;var c=e.getEvents(d,e.date.add(d,1,"day"));if(!c.length)return null;s=c[0].id}return s},e.attachEvent("onDestroy",function(){e._hideToolTip()})}},Ya=new class{constructor(e){this._seed=0,this._schedulerPlugins=[],this._bundledExtensions=e,this._extensionsManager=new I_(e)}plugin(e){this._schedulerPlugins.push(e),ct.scheduler&&e(ct.scheduler)}getSchedulerInstance(e){for(var t=N_(this._extensionsManager),n=0;n<this._schedulerPlugins.length;n++)this._schedulerPlugins[n](t);return t._internal_id=this._seed++,this.$syncFactory&&this.$syncFactory(t),e&&this._initFromConfig(t,e),t}_initFromConfig(e,t){if(t.plugins&&e.plugins(t.plugins),t.config&&e.mixin(e.config,t.config,!0),t.templates&&e.attachEvent("onTemplatesReady",function(){e.mixin(e.templates,t.templates,!0)},{once:!0}),t.events)for(const n in t.events)e.attachEvent(n,t.events[n]);t.locale&&e.i18n.setLocale(t.locale),Array.isArray(t.calendars)&&t.calendars.forEach(function(n){e.addCalendar(n)}),t.container?e.init(t.container):e.init(),t.data&&(typeof t.data=="string"?e.load(t.data):e.parse(t.data))}}(bu),$t=Ya.getSchedulerInstance(),ms={plugin:$t.bind(Ya.plugin,Ya)};window.scheduler=$t,window.Scheduler=ms,window.$dhx||(window.$dhx={}),window.$dhx.scheduler=$t,window.$dhx.Scheduler=ms;const wu=()=>{};var gs={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},xu=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=e[n++];t[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=e[n++],o=e[n++],l=e[n++],s=((i&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(s&1023))}else{const a=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return t.join("")},Rl={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const a=e[i],o=i+1<e.length,l=o?e[i+1]:0,s=i+2<e.length,d=s?e[i+2]:0,c=a>>2,u=(a&3)<<4|l>>4;let f=(l&15)<<2|d>>6,y=d&63;s||(y=64,o||(f=64)),r.push(n[c],n[u],n[f],n[y])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Ol(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):xu(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const a=n[e.charAt(i++)],l=i<e.length?n[e.charAt(i)]:0;++i;const d=i<e.length?n[e.charAt(i)]:64;++i;const u=i<e.length?n[e.charAt(i)]:64;if(++i,a==null||l==null||d==null||u==null)throw new ku;const f=a<<2|l>>4;if(r.push(f),d!==64){const y=l<<4&240|d>>2;if(r.push(y),u!==64){const g=d<<6&192|u;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class ku extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Eu=function(e){const t=Ol(e);return Rl.encodeByteArray(t,!0)},Ir=function(e){return Eu(e).replace(/\./g,"")},Tu=function(e){try{return Rl.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=()=>Au().__FIREBASE_DEFAULTS__,Du=()=>{if(typeof process>"u"||typeof gs>"u")return;const e=gs.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Cu=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Tu(e[1]);return t&&JSON.parse(t)},yi=()=>{try{return wu()||Su()||Du()||Cu()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Nu=e=>{var t,n;return(n=(t=yi())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},Iu=e=>{const t=Nu(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Pl=()=>{var e;return(e=yi())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(e){return e.endsWith(".cloudworkstations.dev")}async function Ou(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ir(JSON.stringify(n)),Ir(JSON.stringify(o)),""].join(".")}const Mn={};function Pu(){const e={prod:[],emulator:[]};for(const t of Object.keys(Mn))Mn[t]?e.emulator.push(t):e.prod.push(t);return e}function Lu(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let vs=!1;function Vu(e,t){if(typeof window>"u"||typeof document>"u"||!bi(window.location.host)||Mn[e]===t||Mn[e]||vs)return;Mn[e]=t;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",a=Pu().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function s(f,y){f.setAttribute("width","24"),f.setAttribute("id",y),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function d(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{vs=!0,o()},f}function c(f,y){f.setAttribute("id",y),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function u(){const f=Lu(r),y=n("text"),g=document.getElementById(y)||document.createElement("span"),h=n("learnmore"),p=document.getElementById(h)||document.createElement("a"),v=n("preprendIcon"),x=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const S=f.element;l(S),c(p,h);const O=d();s(x,v),S.append(x,g,p,O),document.body.appendChild(S)}a?(g.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",u):u()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Hu(){var e;const t=(e=yi())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Fu(){return!Hu()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Uu(){try{return typeof indexedDB=="object"}catch{return!1}}function zu(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var a;t(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qu="FirebaseError";class dn extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=qu,Object.setPrototypeOf(this,dn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ll.prototype.create)}}class Ll{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,a=this.errors[t],o=a?ju(a,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new dn(i,l,r)}}function ju(e,t){return e.replace(Bu,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const Bu=/\{\$([^}]+)}/g;function Mr(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const a=e[i],o=t[i];if(ys(a)&&ys(o)){if(!Mr(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function ys(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(e){return e&&e._delegate?e._delegate:e}class $n{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ot="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new Mu;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Ku(t))try{this.getOrInitializeService({instanceIdentifier:Ot})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(t=Ot){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ot){return this.instances.has(t)}getOptions(t=Ot){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);r===l&&o.resolve(i)}return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),a=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;a.add(t),this.onInitCallbacks.set(i,a);const o=this.instances.get(i);return o&&t(o,i),()=>{a.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Wu(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=Ot){return this.component?this.component.multipleInstances?t:Ot:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Wu(e){return e===Ot?void 0:e}function Ku(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new Yu(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ae;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(ae||(ae={}));const Ju={debug:ae.DEBUG,verbose:ae.VERBOSE,info:ae.INFO,warn:ae.WARN,error:ae.ERROR,silent:ae.SILENT},Qu=ae.INFO,Xu={[ae.DEBUG]:"log",[ae.VERBOSE]:"log",[ae.INFO]:"info",[ae.WARN]:"warn",[ae.ERROR]:"error"},Zu=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=Xu[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Vl{constructor(t){this.name=t,this._logLevel=Qu,this._logHandler=Zu,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ae))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Ju[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ae.DEBUG,...t),this._logHandler(this,ae.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ae.VERBOSE,...t),this._logHandler(this,ae.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ae.INFO,...t),this._logHandler(this,ae.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ae.WARN,...t),this._logHandler(this,ae.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ae.ERROR,...t),this._logHandler(this,ae.ERROR,...t)}}const eh=(e,t)=>t.some(n=>e instanceof n);let bs,ws;function th(){return bs||(bs=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nh(){return ws||(ws=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $l=new WeakMap,Wa=new WeakMap,Hl=new WeakMap,Ia=new WeakMap,wi=new WeakMap;function rh(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",a),e.removeEventListener("error",o)},a=()=>{n(xt(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",a),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&$l.set(n,e)}).catch(()=>{}),wi.set(t,e),t}function ah(e){if(Wa.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",o),e.removeEventListener("abort",o)},a=()=>{n(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",a),e.addEventListener("error",o),e.addEventListener("abort",o)});Wa.set(e,t)}let Ka={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Wa.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Hl.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xt(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function ih(e){Ka=e(Ka)}function oh(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(Ma(this),t,...n);return Hl.set(r,t.sort?t.sort():[t]),xt(r)}:nh().includes(e)?function(...t){return e.apply(Ma(this),t),xt($l.get(this))}:function(...t){return xt(e.apply(Ma(this),t))}}function sh(e){return typeof e=="function"?oh(e):(e instanceof IDBTransaction&&ah(e),eh(e,th())?new Proxy(e,Ka):e)}function xt(e){if(e instanceof IDBRequest)return rh(e);if(Ia.has(e))return Ia.get(e);const t=sh(e);return t!==e&&(Ia.set(e,t),wi.set(t,e)),t}const Ma=e=>wi.get(e);function lh(e,t,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(e,t),l=xt(o);return r&&o.addEventListener("upgradeneeded",s=>{r(xt(o.result),s.oldVersion,s.newVersion,xt(o.transaction),s)}),n&&o.addEventListener("blocked",s=>n(s.oldVersion,s.newVersion,s)),l.then(s=>{a&&s.addEventListener("close",()=>a()),i&&s.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const dh=["get","getKey","getAll","getAllKeys","count"],ch=["put","add","delete","clear"],Oa=new Map;function xs(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Oa.get(t))return Oa.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ch.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||dh.includes(n)))return;const a=async function(o,...l){const s=this.transaction(o,i?"readwrite":"readonly");let d=s.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),i&&s.done]))[0]};return Oa.set(t,a),a}ih(e=>({...e,get:(t,n,r)=>xs(t,n)||e.get(t,n,r),has:(t,n)=>!!xs(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uh(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function uh(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Ga="@firebase/app",ks="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ut=new Vl("@firebase/app"),hh="@firebase/app-compat",fh="@firebase/analytics-compat",ph="@firebase/analytics",mh="@firebase/app-check-compat",gh="@firebase/app-check",vh="@firebase/auth",yh="@firebase/auth-compat",bh="@firebase/database",wh="@firebase/data-connect",xh="@firebase/database-compat",kh="@firebase/functions",Eh="@firebase/functions-compat",Th="@firebase/installations",Ah="@firebase/installations-compat",Sh="@firebase/messaging",Dh="@firebase/messaging-compat",Ch="@firebase/performance",Nh="@firebase/performance-compat",Ih="@firebase/remote-config",Mh="@firebase/remote-config-compat",Oh="@firebase/storage",Rh="@firebase/storage-compat",Ph="@firebase/firestore",Lh="@firebase/ai",Vh="@firebase/firestore-compat",$h="firebase",Hh="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja="[DEFAULT]",Fh={[Ga]:"fire-core",[hh]:"fire-core-compat",[ph]:"fire-analytics",[fh]:"fire-analytics-compat",[gh]:"fire-app-check",[mh]:"fire-app-check-compat",[vh]:"fire-auth",[yh]:"fire-auth-compat",[bh]:"fire-rtdb",[wh]:"fire-data-connect",[xh]:"fire-rtdb-compat",[kh]:"fire-fn",[Eh]:"fire-fn-compat",[Th]:"fire-iid",[Ah]:"fire-iid-compat",[Sh]:"fire-fcm",[Dh]:"fire-fcm-compat",[Ch]:"fire-perf",[Nh]:"fire-perf-compat",[Ih]:"fire-rc",[Mh]:"fire-rc-compat",[Oh]:"fire-gcs",[Rh]:"fire-gcs-compat",[Ph]:"fire-fst",[Vh]:"fire-fst-compat",[Lh]:"fire-vertex","fire-js":"fire-js",[$h]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or=new Map,Uh=new Map,Qa=new Map;function Es(e,t){try{e.container.addComponent(t)}catch(n){ut.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Rr(e){const t=e.name;if(Qa.has(t))return ut.debug(`There were multiple attempts to register component ${t}.`),!1;Qa.set(t,e);for(const n of Or.values())Es(n,e);for(const n of Uh.values())Es(n,e);return!0}function zh(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function qh(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},kt=new Ll("app","Firebase",jh);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw kt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh=Hh;function Fl(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Ja,automaticDataCollectionEnabled:!0},t),i=r.name;if(typeof i!="string"||!i)throw kt.create("bad-app-name",{appName:String(i)});if(n||(n=Pl()),!n)throw kt.create("no-options");const a=Or.get(i);if(a){if(Mr(n,a.options)&&Mr(r,a.config))return a;throw kt.create("duplicate-app",{appName:i})}const o=new Gu(i);for(const s of Qa.values())o.addComponent(s);const l=new Bh(n,r,o);return Or.set(i,l),l}function Wh(e=Ja){const t=Or.get(e);if(!t&&e===Ja&&Pl())return Fl();if(!t)throw kt.create("no-app",{appName:e});return t}function tn(e,t,n){var r;let i=(r=Fh[e])!==null&&r!==void 0?r:e;n&&(i+=`-${n}`);const a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){const l=[`Unable to register library "${i}" with version "${t}":`];a&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ut.warn(l.join(" "));return}Rr(new $n(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh="firebase-heartbeat-database",Gh=1,Hn="firebase-heartbeat-store";let Ra=null;function Ul(){return Ra||(Ra=lh(Kh,Gh,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Hn)}catch(n){console.warn(n)}}}}).catch(e=>{throw kt.create("idb-open",{originalErrorMessage:e.message})})),Ra}async function Jh(e){try{const n=(await Ul()).transaction(Hn),r=await n.objectStore(Hn).get(zl(e));return await n.done,r}catch(t){if(t instanceof dn)ut.warn(t.message);else{const n=kt.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});ut.warn(n.message)}}}async function Ts(e,t){try{const r=(await Ul()).transaction(Hn,"readwrite");await r.objectStore(Hn).put(t,zl(e)),await r.done}catch(n){if(n instanceof dn)ut.warn(n.message);else{const r=kt.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ut.warn(r.message)}}}function zl(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh=1024,Xh=30;class Zh{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tf(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=As();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>Xh){const o=nf(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ut.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=As(),{heartbeatsToSend:r,unsentEntries:i}=ef(this._heartbeatsCache.heartbeats),a=Ir(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(n){return ut.warn(n),""}}}function As(){return new Date().toISOString().substring(0,10)}function ef(e,t=Qh){const n=[];let r=e.slice();for(const i of e){const a=n.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),Ss(n)>t){a.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ss(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tf{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Uu()?zu().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Jh(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Ts(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Ts(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Ss(e){return Ir(JSON.stringify({version:2,heartbeats:e})).length}function nf(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(e){Rr(new $n("platform-logger",t=>new _h(t),"PRIVATE")),Rr(new $n("heartbeat",t=>new Zh(t),"PRIVATE")),tn(Ga,ks,e),tn(Ga,ks,"esm2017"),tn("fire-js","")}rf("");var af="firebase",of="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tn(af,of,"app");var Ds=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xi;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(A,m){function b(){}b.prototype=m.prototype,A.D=m.prototype,A.prototype=new b,A.prototype.constructor=A,A.C=function(k,E,D){for(var C=Array(arguments.length-2),R=2;R<arguments.length;R++)C[R-2]=arguments[R];return m.prototype[E].apply(k,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,m,b){b||(b=0);var k=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)k[E]=m.charCodeAt(b++)|m.charCodeAt(b++)<<8|m.charCodeAt(b++)<<16|m.charCodeAt(b++)<<24;else for(E=0;16>E;++E)k[E]=m[b++]|m[b++]<<8|m[b++]<<16|m[b++]<<24;m=A.g[0],b=A.g[1],E=A.g[2];var D=A.g[3],C=m+(D^b&(E^D))+k[0]+3614090360&4294967295;m=b+(C<<7&4294967295|C>>>25),C=D+(E^m&(b^E))+k[1]+3905402710&4294967295,D=m+(C<<12&4294967295|C>>>20),C=E+(b^D&(m^b))+k[2]+606105819&4294967295,E=D+(C<<17&4294967295|C>>>15),C=b+(m^E&(D^m))+k[3]+3250441966&4294967295,b=E+(C<<22&4294967295|C>>>10),C=m+(D^b&(E^D))+k[4]+4118548399&4294967295,m=b+(C<<7&4294967295|C>>>25),C=D+(E^m&(b^E))+k[5]+1200080426&4294967295,D=m+(C<<12&4294967295|C>>>20),C=E+(b^D&(m^b))+k[6]+2821735955&4294967295,E=D+(C<<17&4294967295|C>>>15),C=b+(m^E&(D^m))+k[7]+4249261313&4294967295,b=E+(C<<22&4294967295|C>>>10),C=m+(D^b&(E^D))+k[8]+1770035416&4294967295,m=b+(C<<7&4294967295|C>>>25),C=D+(E^m&(b^E))+k[9]+2336552879&4294967295,D=m+(C<<12&4294967295|C>>>20),C=E+(b^D&(m^b))+k[10]+4294925233&4294967295,E=D+(C<<17&4294967295|C>>>15),C=b+(m^E&(D^m))+k[11]+2304563134&4294967295,b=E+(C<<22&4294967295|C>>>10),C=m+(D^b&(E^D))+k[12]+1804603682&4294967295,m=b+(C<<7&4294967295|C>>>25),C=D+(E^m&(b^E))+k[13]+4254626195&4294967295,D=m+(C<<12&4294967295|C>>>20),C=E+(b^D&(m^b))+k[14]+2792965006&4294967295,E=D+(C<<17&4294967295|C>>>15),C=b+(m^E&(D^m))+k[15]+1236535329&4294967295,b=E+(C<<22&4294967295|C>>>10),C=m+(E^D&(b^E))+k[1]+4129170786&4294967295,m=b+(C<<5&4294967295|C>>>27),C=D+(b^E&(m^b))+k[6]+3225465664&4294967295,D=m+(C<<9&4294967295|C>>>23),C=E+(m^b&(D^m))+k[11]+643717713&4294967295,E=D+(C<<14&4294967295|C>>>18),C=b+(D^m&(E^D))+k[0]+3921069994&4294967295,b=E+(C<<20&4294967295|C>>>12),C=m+(E^D&(b^E))+k[5]+3593408605&4294967295,m=b+(C<<5&4294967295|C>>>27),C=D+(b^E&(m^b))+k[10]+38016083&4294967295,D=m+(C<<9&4294967295|C>>>23),C=E+(m^b&(D^m))+k[15]+3634488961&4294967295,E=D+(C<<14&4294967295|C>>>18),C=b+(D^m&(E^D))+k[4]+3889429448&4294967295,b=E+(C<<20&4294967295|C>>>12),C=m+(E^D&(b^E))+k[9]+568446438&4294967295,m=b+(C<<5&4294967295|C>>>27),C=D+(b^E&(m^b))+k[14]+3275163606&4294967295,D=m+(C<<9&4294967295|C>>>23),C=E+(m^b&(D^m))+k[3]+4107603335&4294967295,E=D+(C<<14&4294967295|C>>>18),C=b+(D^m&(E^D))+k[8]+1163531501&4294967295,b=E+(C<<20&4294967295|C>>>12),C=m+(E^D&(b^E))+k[13]+2850285829&4294967295,m=b+(C<<5&4294967295|C>>>27),C=D+(b^E&(m^b))+k[2]+4243563512&4294967295,D=m+(C<<9&4294967295|C>>>23),C=E+(m^b&(D^m))+k[7]+1735328473&4294967295,E=D+(C<<14&4294967295|C>>>18),C=b+(D^m&(E^D))+k[12]+2368359562&4294967295,b=E+(C<<20&4294967295|C>>>12),C=m+(b^E^D)+k[5]+4294588738&4294967295,m=b+(C<<4&4294967295|C>>>28),C=D+(m^b^E)+k[8]+2272392833&4294967295,D=m+(C<<11&4294967295|C>>>21),C=E+(D^m^b)+k[11]+1839030562&4294967295,E=D+(C<<16&4294967295|C>>>16),C=b+(E^D^m)+k[14]+4259657740&4294967295,b=E+(C<<23&4294967295|C>>>9),C=m+(b^E^D)+k[1]+2763975236&4294967295,m=b+(C<<4&4294967295|C>>>28),C=D+(m^b^E)+k[4]+1272893353&4294967295,D=m+(C<<11&4294967295|C>>>21),C=E+(D^m^b)+k[7]+4139469664&4294967295,E=D+(C<<16&4294967295|C>>>16),C=b+(E^D^m)+k[10]+3200236656&4294967295,b=E+(C<<23&4294967295|C>>>9),C=m+(b^E^D)+k[13]+681279174&4294967295,m=b+(C<<4&4294967295|C>>>28),C=D+(m^b^E)+k[0]+3936430074&4294967295,D=m+(C<<11&4294967295|C>>>21),C=E+(D^m^b)+k[3]+3572445317&4294967295,E=D+(C<<16&4294967295|C>>>16),C=b+(E^D^m)+k[6]+76029189&4294967295,b=E+(C<<23&4294967295|C>>>9),C=m+(b^E^D)+k[9]+3654602809&4294967295,m=b+(C<<4&4294967295|C>>>28),C=D+(m^b^E)+k[12]+3873151461&4294967295,D=m+(C<<11&4294967295|C>>>21),C=E+(D^m^b)+k[15]+530742520&4294967295,E=D+(C<<16&4294967295|C>>>16),C=b+(E^D^m)+k[2]+3299628645&4294967295,b=E+(C<<23&4294967295|C>>>9),C=m+(E^(b|~D))+k[0]+4096336452&4294967295,m=b+(C<<6&4294967295|C>>>26),C=D+(b^(m|~E))+k[7]+1126891415&4294967295,D=m+(C<<10&4294967295|C>>>22),C=E+(m^(D|~b))+k[14]+2878612391&4294967295,E=D+(C<<15&4294967295|C>>>17),C=b+(D^(E|~m))+k[5]+4237533241&4294967295,b=E+(C<<21&4294967295|C>>>11),C=m+(E^(b|~D))+k[12]+1700485571&4294967295,m=b+(C<<6&4294967295|C>>>26),C=D+(b^(m|~E))+k[3]+2399980690&4294967295,D=m+(C<<10&4294967295|C>>>22),C=E+(m^(D|~b))+k[10]+4293915773&4294967295,E=D+(C<<15&4294967295|C>>>17),C=b+(D^(E|~m))+k[1]+2240044497&4294967295,b=E+(C<<21&4294967295|C>>>11),C=m+(E^(b|~D))+k[8]+1873313359&4294967295,m=b+(C<<6&4294967295|C>>>26),C=D+(b^(m|~E))+k[15]+4264355552&4294967295,D=m+(C<<10&4294967295|C>>>22),C=E+(m^(D|~b))+k[6]+2734768916&4294967295,E=D+(C<<15&4294967295|C>>>17),C=b+(D^(E|~m))+k[13]+1309151649&4294967295,b=E+(C<<21&4294967295|C>>>11),C=m+(E^(b|~D))+k[4]+4149444226&4294967295,m=b+(C<<6&4294967295|C>>>26),C=D+(b^(m|~E))+k[11]+3174756917&4294967295,D=m+(C<<10&4294967295|C>>>22),C=E+(m^(D|~b))+k[2]+718787259&4294967295,E=D+(C<<15&4294967295|C>>>17),C=b+(D^(E|~m))+k[9]+3951481745&4294967295,A.g[0]=A.g[0]+m&4294967295,A.g[1]=A.g[1]+(E+(C<<21&4294967295|C>>>11))&4294967295,A.g[2]=A.g[2]+E&4294967295,A.g[3]=A.g[3]+D&4294967295}r.prototype.u=function(A,m){m===void 0&&(m=A.length);for(var b=m-this.blockSize,k=this.B,E=this.h,D=0;D<m;){if(E==0)for(;D<=b;)i(this,A,D),D+=this.blockSize;if(typeof A=="string"){for(;D<m;)if(k[E++]=A.charCodeAt(D++),E==this.blockSize){i(this,k),E=0;break}}else for(;D<m;)if(k[E++]=A[D++],E==this.blockSize){i(this,k),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var m=1;m<A.length-8;++m)A[m]=0;var b=8*this.o;for(m=A.length-8;m<A.length;++m)A[m]=b&255,b/=256;for(this.u(A),A=Array(16),m=b=0;4>m;++m)for(var k=0;32>k;k+=8)A[b++]=this.g[m]>>>k&255;return A};function a(A,m){var b=l;return Object.prototype.hasOwnProperty.call(b,A)?b[A]:b[A]=m(A)}function o(A,m){this.h=m;for(var b=[],k=!0,E=A.length-1;0<=E;E--){var D=A[E]|0;k&&D==m||(b[E]=D,k=!1)}this.g=b}var l={};function s(A){return-128<=A&&128>A?a(A,function(m){return new o([m|0],0>m?-1:0)}):new o([A|0],0>A?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return u;if(0>A)return p(d(-A));for(var m=[],b=1,k=0;A>=b;k++)m[k]=A/b|0,b*=4294967296;return new o(m,0)}function c(A,m){if(A.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(A.charAt(0)=="-")return p(c(A.substring(1),m));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=d(Math.pow(m,8)),k=u,E=0;E<A.length;E+=8){var D=Math.min(8,A.length-E),C=parseInt(A.substring(E,E+D),m);8>D?(D=d(Math.pow(m,D)),k=k.j(D).add(d(C))):(k=k.j(b),k=k.add(d(C)))}return k}var u=s(0),f=s(1),y=s(16777216);e=o.prototype,e.m=function(){if(h(this))return-p(this).m();for(var A=0,m=1,b=0;b<this.g.length;b++){var k=this.i(b);A+=(0<=k?k:4294967296+k)*m,m*=4294967296}return A},e.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(g(this))return"0";if(h(this))return"-"+p(this).toString(A);for(var m=d(Math.pow(A,6)),b=this,k="";;){var E=O(b,m).g;b=v(b,E.j(m));var D=((0<b.g.length?b.g[0]:b.h)>>>0).toString(A);if(b=E,g(b))return D+k;for(;6>D.length;)D="0"+D;k=D+k}},e.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function g(A){if(A.h!=0)return!1;for(var m=0;m<A.g.length;m++)if(A.g[m]!=0)return!1;return!0}function h(A){return A.h==-1}e.l=function(A){return A=v(this,A),h(A)?-1:g(A)?0:1};function p(A){for(var m=A.g.length,b=[],k=0;k<m;k++)b[k]=~A.g[k];return new o(b,~A.h).add(f)}e.abs=function(){return h(this)?p(this):this},e.add=function(A){for(var m=Math.max(this.g.length,A.g.length),b=[],k=0,E=0;E<=m;E++){var D=k+(this.i(E)&65535)+(A.i(E)&65535),C=(D>>>16)+(this.i(E)>>>16)+(A.i(E)>>>16);k=C>>>16,D&=65535,C&=65535,b[E]=C<<16|D}return new o(b,b[b.length-1]&-2147483648?-1:0)};function v(A,m){return A.add(p(m))}e.j=function(A){if(g(this)||g(A))return u;if(h(this))return h(A)?p(this).j(p(A)):p(p(this).j(A));if(h(A))return p(this.j(p(A)));if(0>this.l(y)&&0>A.l(y))return d(this.m()*A.m());for(var m=this.g.length+A.g.length,b=[],k=0;k<2*m;k++)b[k]=0;for(k=0;k<this.g.length;k++)for(var E=0;E<A.g.length;E++){var D=this.i(k)>>>16,C=this.i(k)&65535,R=A.i(E)>>>16,P=A.i(E)&65535;b[2*k+2*E]+=C*P,x(b,2*k+2*E),b[2*k+2*E+1]+=D*P,x(b,2*k+2*E+1),b[2*k+2*E+1]+=C*R,x(b,2*k+2*E+1),b[2*k+2*E+2]+=D*R,x(b,2*k+2*E+2)}for(k=0;k<m;k++)b[k]=b[2*k+1]<<16|b[2*k];for(k=m;k<2*m;k++)b[k]=0;return new o(b,0)};function x(A,m){for(;(A[m]&65535)!=A[m];)A[m+1]+=A[m]>>>16,A[m]&=65535,m++}function S(A,m){this.g=A,this.h=m}function O(A,m){if(g(m))throw Error("division by zero");if(g(A))return new S(u,u);if(h(A))return m=O(p(A),m),new S(p(m.g),p(m.h));if(h(m))return m=O(A,p(m)),new S(p(m.g),m.h);if(30<A.g.length){if(h(A)||h(m))throw Error("slowDivide_ only works with positive integers.");for(var b=f,k=m;0>=k.l(A);)b=N(b),k=N(k);var E=I(b,1),D=I(k,1);for(k=I(k,2),b=I(b,2);!g(k);){var C=D.add(k);0>=C.l(A)&&(E=E.add(b),D=C),k=I(k,1),b=I(b,1)}return m=v(A,E.j(m)),new S(E,m)}for(E=u;0<=A.l(m);){for(b=Math.max(1,Math.floor(A.m()/m.m())),k=Math.ceil(Math.log(b)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),D=d(b),C=D.j(m);h(C)||0<C.l(A);)b-=k,D=d(b),C=D.j(m);g(D)&&(D=f),E=E.add(D),A=v(A,C)}return new S(E,A)}e.A=function(A){return O(this,A).h},e.and=function(A){for(var m=Math.max(this.g.length,A.g.length),b=[],k=0;k<m;k++)b[k]=this.i(k)&A.i(k);return new o(b,this.h&A.h)},e.or=function(A){for(var m=Math.max(this.g.length,A.g.length),b=[],k=0;k<m;k++)b[k]=this.i(k)|A.i(k);return new o(b,this.h|A.h)},e.xor=function(A){for(var m=Math.max(this.g.length,A.g.length),b=[],k=0;k<m;k++)b[k]=this.i(k)^A.i(k);return new o(b,this.h^A.h)};function N(A){for(var m=A.g.length+1,b=[],k=0;k<m;k++)b[k]=A.i(k)<<1|A.i(k-1)>>>31;return new o(b,A.h)}function I(A,m){var b=m>>5;m%=32;for(var k=A.g.length-b,E=[],D=0;D<k;D++)E[D]=0<m?A.i(D+b)>>>m|A.i(D+b+1)<<32-m:A.i(D+b);return new o(E,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=c,xi=o}).apply(typeof Ds<"u"?Ds:typeof self<"u"?self:typeof window<"u"?window:{});var vr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ql,Nn,jl,kr,Xa,Bl,Yl,Wl;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,w,T){return _==Array.prototype||_==Object.prototype||(_[w]=T.value),_};function n(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof vr=="object"&&vr];for(var w=0;w<_.length;++w){var T=_[w];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var r=n(this);function i(_,w){if(w)e:{var T=r;_=_.split(".");for(var M=0;M<_.length-1;M++){var V=_[M];if(!(V in T))break e;T=T[V]}_=_[_.length-1],M=T[_],w=w(M),w!=M&&w!=null&&t(T,_,{configurable:!0,writable:!0,value:w})}}function a(_,w){_ instanceof String&&(_+="");var T=0,M=!1,V={next:function(){if(!M&&T<_.length){var H=T++;return{value:w(H,_[H]),done:!1}}return M=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(_){return _||function(){return a(this,function(w,T){return T})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function s(_){var w=typeof _;return w=w!="object"?w:_?Array.isArray(_)?"array":w:"null",w=="array"||w=="object"&&typeof _.length=="number"}function d(_){var w=typeof _;return w=="object"&&_!=null||w=="function"}function c(_,w,T){return _.call.apply(_.bind,arguments)}function u(_,w,T){if(!_)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,M),_.apply(w,V)}}return function(){return _.apply(w,arguments)}}function f(_,w,T){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?c:u,f.apply(null,arguments)}function y(_,w){var T=Array.prototype.slice.call(arguments,1);return function(){var M=T.slice();return M.push.apply(M,arguments),_.apply(this,M)}}function g(_,w){function T(){}T.prototype=w.prototype,_.aa=w.prototype,_.prototype=new T,_.prototype.constructor=_,_.Qb=function(M,V,H){for(var B=Array(arguments.length-2),de=2;de<arguments.length;de++)B[de-2]=arguments[de];return w.prototype[V].apply(M,B)}}function h(_){const w=_.length;if(0<w){const T=Array(w);for(let M=0;M<w;M++)T[M]=_[M];return T}return[]}function p(_,w){for(let T=1;T<arguments.length;T++){const M=arguments[T];if(s(M)){const V=_.length||0,H=M.length||0;_.length=V+H;for(let B=0;B<H;B++)_[V+B]=M[B]}else _.push(M)}}class v{constructor(w,T){this.i=w,this.j=T,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function x(_){return/^[\s\xa0]*$/.test(_)}function S(){var _=l.navigator;return _&&(_=_.userAgent)?_:""}function O(_){return O[" "](_),_}O[" "]=function(){};var N=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function I(_,w,T){for(const M in _)w.call(T,_[M],M,_)}function A(_,w){for(const T in _)w.call(void 0,_[T],T,_)}function m(_){const w={};for(const T in _)w[T]=_[T];return w}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(_,w){let T,M;for(let V=1;V<arguments.length;V++){M=arguments[V];for(T in M)_[T]=M[T];for(let H=0;H<b.length;H++)T=b[H],Object.prototype.hasOwnProperty.call(M,T)&&(_[T]=M[T])}}function E(_){var w=1;_=_.split(":");const T=[];for(;0<w&&_.length;)T.push(_.shift()),w--;return _.length&&T.push(_.join(":")),T}function D(_){l.setTimeout(()=>{throw _},0)}function C(){var _=X;let w=null;return _.g&&(w=_.g,_.g=_.g.next,_.g||(_.h=null),w.next=null),w}class R{constructor(){this.h=this.g=null}add(w,T){const M=P.get();M.set(w,T),this.h?this.h.next=M:this.g=M,this.h=M}}var P=new v(()=>new F,_=>_.reset());class F{constructor(){this.next=this.g=this.h=null}set(w,T){this.h=w,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let q,$=!1,X=new R,te=()=>{const _=l.Promise.resolve(void 0);q=()=>{_.then(Q)}};var Q=()=>{for(var _;_=C();){try{_.h.call(_.g)}catch(T){D(T)}var w=P;w.j(_),100>w.h&&(w.h++,_.next=w.g,w.g=_)}$=!1};function W(){this.s=this.s,this.C=this.C}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(_,w){this.type=_,this.g=this.target=w,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var ee=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var _=!1,w=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const T=()=>{};l.addEventListener("test",T,w),l.removeEventListener("test",T,w)}catch{}return _}();function fe(_,w){if(J.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_){var T=this.type=_.type,M=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;if(this.target=_.target||_.srcElement,this.g=w,w=_.relatedTarget){if(N){e:{try{O(w.nodeName);var V=!0;break e}catch{}V=!1}V||(w=null)}}else T=="mouseover"?w=_.fromElement:T=="mouseout"&&(w=_.toElement);this.relatedTarget=w,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=typeof _.pointerType=="string"?_.pointerType:Ve[_.pointerType]||"",this.state=_.state,this.i=_,_.defaultPrevented&&fe.aa.h.call(this)}}g(fe,J);var Ve={2:"touch",3:"pen",4:"mouse"};fe.prototype.h=function(){fe.aa.h.call(this);var _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var Zn="closure_listenable_"+(1e6*Math.random()|0),Qd=0;function Xd(_,w,T,M,V){this.listener=_,this.proxy=null,this.src=w,this.type=T,this.capture=!!M,this.ha=V,this.key=++Qd,this.da=this.fa=!1}function er(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function tr(_){this.src=_,this.g={},this.h=0}tr.prototype.add=function(_,w,T,M,V){var H=_.toString();_=this.g[H],_||(_=this.g[H]=[],this.h++);var B=aa(_,w,M,V);return-1<B?(w=_[B],T||(w.fa=!1)):(w=new Xd(w,this.src,H,!!M,V),w.fa=T,_.push(w)),w};function ra(_,w){var T=w.type;if(T in _.g){var M=_.g[T],V=Array.prototype.indexOf.call(M,w,void 0),H;(H=0<=V)&&Array.prototype.splice.call(M,V,1),H&&(er(w),_.g[T].length==0&&(delete _.g[T],_.h--))}}function aa(_,w,T,M){for(var V=0;V<_.length;++V){var H=_[V];if(!H.da&&H.listener==w&&H.capture==!!T&&H.ha==M)return V}return-1}var ia="closure_lm_"+(1e6*Math.random()|0),oa={};function Xi(_,w,T,M,V){if(Array.isArray(w)){for(var H=0;H<w.length;H++)Xi(_,w[H],T,M,V);return null}return T=to(T),_&&_[Zn]?_.K(w,T,d(M)?!!M.capture:!1,V):Zd(_,w,T,!1,M,V)}function Zd(_,w,T,M,V,H){if(!w)throw Error("Invalid event type");var B=d(V)?!!V.capture:!!V,de=la(_);if(de||(_[ia]=de=new tr(_)),T=de.add(w,T,M,B,H),T.proxy)return T;if(M=ec(),T.proxy=M,M.src=_,M.listener=T,_.addEventListener)ee||(V=B),V===void 0&&(V=!1),_.addEventListener(w.toString(),M,V);else if(_.attachEvent)_.attachEvent(eo(w.toString()),M);else if(_.addListener&&_.removeListener)_.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return T}function ec(){function _(T){return w.call(_.src,_.listener,T)}const w=tc;return _}function Zi(_,w,T,M,V){if(Array.isArray(w))for(var H=0;H<w.length;H++)Zi(_,w[H],T,M,V);else M=d(M)?!!M.capture:!!M,T=to(T),_&&_[Zn]?(_=_.i,w=String(w).toString(),w in _.g&&(H=_.g[w],T=aa(H,T,M,V),-1<T&&(er(H[T]),Array.prototype.splice.call(H,T,1),H.length==0&&(delete _.g[w],_.h--)))):_&&(_=la(_))&&(w=_.g[w.toString()],_=-1,w&&(_=aa(w,T,M,V)),(T=-1<_?w[_]:null)&&sa(T))}function sa(_){if(typeof _!="number"&&_&&!_.da){var w=_.src;if(w&&w[Zn])ra(w.i,_);else{var T=_.type,M=_.proxy;w.removeEventListener?w.removeEventListener(T,M,_.capture):w.detachEvent?w.detachEvent(eo(T),M):w.addListener&&w.removeListener&&w.removeListener(M),(T=la(w))?(ra(T,_),T.h==0&&(T.src=null,w[ia]=null)):er(_)}}}function eo(_){return _ in oa?oa[_]:oa[_]="on"+_}function tc(_,w){if(_.da)_=!0;else{w=new fe(w,this);var T=_.listener,M=_.ha||_.src;_.fa&&sa(_),_=T.call(M,w)}return _}function la(_){return _=_[ia],_ instanceof tr?_:null}var da="__closure_events_fn_"+(1e9*Math.random()>>>0);function to(_){return typeof _=="function"?_:(_[da]||(_[da]=function(w){return _.handleEvent(w)}),_[da])}function Ce(){W.call(this),this.i=new tr(this),this.M=this,this.F=null}g(Ce,W),Ce.prototype[Zn]=!0,Ce.prototype.removeEventListener=function(_,w,T,M){Zi(this,_,w,T,M)};function $e(_,w){var T,M=_.F;if(M)for(T=[];M;M=M.F)T.push(M);if(_=_.M,M=w.type||w,typeof w=="string")w=new J(w,_);else if(w instanceof J)w.target=w.target||_;else{var V=w;w=new J(M,_),k(w,V)}if(V=!0,T)for(var H=T.length-1;0<=H;H--){var B=w.g=T[H];V=nr(B,M,!0,w)&&V}if(B=w.g=_,V=nr(B,M,!0,w)&&V,V=nr(B,M,!1,w)&&V,T)for(H=0;H<T.length;H++)B=w.g=T[H],V=nr(B,M,!1,w)&&V}Ce.prototype.N=function(){if(Ce.aa.N.call(this),this.i){var _=this.i,w;for(w in _.g){for(var T=_.g[w],M=0;M<T.length;M++)er(T[M]);delete _.g[w],_.h--}}this.F=null},Ce.prototype.K=function(_,w,T,M){return this.i.add(String(_),w,!1,T,M)},Ce.prototype.L=function(_,w,T,M){return this.i.add(String(_),w,!0,T,M)};function nr(_,w,T,M){if(w=_.i.g[String(w)],!w)return!0;w=w.concat();for(var V=!0,H=0;H<w.length;++H){var B=w[H];if(B&&!B.da&&B.capture==T){var de=B.listener,Ee=B.ha||B.src;B.fa&&ra(_.i,B),V=de.call(Ee,M)!==!1&&V}}return V&&!M.defaultPrevented}function no(_,w,T){if(typeof _=="function")T&&(_=f(_,T));else if(_&&typeof _.handleEvent=="function")_=f(_.handleEvent,_);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:l.setTimeout(_,w||0)}function ro(_){_.g=no(()=>{_.g=null,_.i&&(_.i=!1,ro(_))},_.l);const w=_.h;_.h=null,_.m.apply(null,w)}class nc extends W{constructor(w,T){super(),this.m=w,this.l=T,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:ro(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hn(_){W.call(this),this.h=_,this.g={}}g(hn,W);var ao=[];function io(_){I(_.g,function(w,T){this.g.hasOwnProperty(T)&&sa(w)},_),_.g={}}hn.prototype.N=function(){hn.aa.N.call(this),io(this)},hn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ca=l.JSON.stringify,rc=l.JSON.parse,ac=class{stringify(_){return l.JSON.stringify(_,void 0)}parse(_){return l.JSON.parse(_,void 0)}};function _a(){}_a.prototype.h=null;function oo(_){return _.h||(_.h=_.i())}function so(){}var fn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ua(){J.call(this,"d")}g(ua,J);function ha(){J.call(this,"c")}g(ha,J);var Ct={},lo=null;function rr(){return lo=lo||new Ce}Ct.La="serverreachability";function co(_){J.call(this,Ct.La,_)}g(co,J);function pn(_){const w=rr();$e(w,new co(w))}Ct.STAT_EVENT="statevent";function _o(_,w){J.call(this,Ct.STAT_EVENT,_),this.stat=w}g(_o,J);function He(_){const w=rr();$e(w,new _o(w,_))}Ct.Ma="timingevent";function uo(_,w){J.call(this,Ct.Ma,_),this.size=w}g(uo,J);function mn(_,w){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){_()},w)}function gn(){this.g=!0}gn.prototype.xa=function(){this.g=!1};function ic(_,w,T,M,V,H){_.info(function(){if(_.g)if(H)for(var B="",de=H.split("&"),Ee=0;Ee<de.length;Ee++){var oe=de[Ee].split("=");if(1<oe.length){var Ne=oe[0];oe=oe[1];var Ie=Ne.split("_");B=2<=Ie.length&&Ie[1]=="type"?B+(Ne+"="+oe+"&"):B+(Ne+"=redacted&")}}else B=null;else B=H;return"XMLHTTP REQ ("+M+") [attempt "+V+"]: "+w+`
`+T+`
`+B})}function oc(_,w,T,M,V,H,B){_.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+V+"]: "+w+`
`+T+`
`+H+" "+B})}function Bt(_,w,T,M){_.info(function(){return"XMLHTTP TEXT ("+w+"): "+lc(_,T)+(M?" "+M:"")})}function sc(_,w){_.info(function(){return"TIMEOUT: "+w})}gn.prototype.info=function(){};function lc(_,w){if(!_.g)return w;if(!w)return null;try{var T=JSON.parse(w);if(T){for(_=0;_<T.length;_++)if(Array.isArray(T[_])){var M=T[_];if(!(2>M.length)){var V=M[1];if(Array.isArray(V)&&!(1>V.length)){var H=V[0];if(H!="noop"&&H!="stop"&&H!="close")for(var B=1;B<V.length;B++)V[B]=""}}}}return ca(T)}catch{return w}}var ar={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ho={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},fa;function ir(){}g(ir,_a),ir.prototype.g=function(){return new XMLHttpRequest},ir.prototype.i=function(){return{}},fa=new ir;function ft(_,w,T,M){this.j=_,this.i=w,this.l=T,this.R=M||1,this.U=new hn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new fo}function fo(){this.i=null,this.g="",this.h=!1}var po={},pa={};function ma(_,w,T){_.L=1,_.v=dr(st(w)),_.m=T,_.P=!0,mo(_,null)}function mo(_,w){_.F=Date.now(),or(_),_.A=st(_.v);var T=_.A,M=_.R;Array.isArray(M)||(M=[String(M)]),No(T.i,"t",M),_.C=0,T=_.j.J,_.h=new fo,_.g=Ko(_.j,T?w:null,!_.m),0<_.O&&(_.M=new nc(f(_.Y,_,_.g),_.O)),w=_.U,T=_.g,M=_.ca;var V="readystatechange";Array.isArray(V)||(V&&(ao[0]=V.toString()),V=ao);for(var H=0;H<V.length;H++){var B=Xi(T,V[H],M||w.handleEvent,!1,w.h||w);if(!B)break;w.g[B.key]=B}w=_.H?m(_.H):{},_.m?(_.u||(_.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.A,_.u,_.m,w)):(_.u="GET",_.g.ea(_.A,_.u,null,w)),pn(),ic(_.i,_.u,_.A,_.l,_.R,_.m)}ft.prototype.ca=function(_){_=_.target;const w=this.M;w&&lt(_)==3?w.j():this.Y(_)},ft.prototype.Y=function(_){try{if(_==this.g)e:{const Ie=lt(this.g);var w=this.g.Ba();const Kt=this.g.Z();if(!(3>Ie)&&(Ie!=3||this.g&&(this.h.h||this.g.oa()||Vo(this.g)))){this.J||Ie!=4||w==7||(w==8||0>=Kt?pn(3):pn(2)),ga(this);var T=this.g.Z();this.X=T;t:if(go(this)){var M=Vo(this.g);_="";var V=M.length,H=lt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Nt(this),vn(this);var B="";break t}this.h.i=new l.TextDecoder}for(w=0;w<V;w++)this.h.h=!0,_+=this.h.i.decode(M[w],{stream:!(H&&w==V-1)});M.length=0,this.h.g+=_,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=T==200,oc(this.i,this.u,this.A,this.l,this.R,Ie,T),this.o){if(this.T&&!this.K){t:{if(this.g){var de,Ee=this.g;if((de=Ee.g?Ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(de)){var oe=de;break t}}oe=null}if(T=oe)Bt(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,va(this,T);else{this.o=!1,this.s=3,He(12),Nt(this),vn(this);break e}}if(this.P){T=!0;let Ge;for(;!this.J&&this.C<B.length;)if(Ge=dc(this,B),Ge==pa){Ie==4&&(this.s=4,He(14),T=!1),Bt(this.i,this.l,null,"[Incomplete Response]");break}else if(Ge==po){this.s=4,He(15),Bt(this.i,this.l,B,"[Invalid Chunk]"),T=!1;break}else Bt(this.i,this.l,Ge,null),va(this,Ge);if(go(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ie!=4||B.length!=0||this.h.h||(this.s=1,He(16),T=!1),this.o=this.o&&T,!T)Bt(this.i,this.l,B,"[Invalid Chunked Response]"),Nt(this),vn(this);else if(0<B.length&&!this.W){this.W=!0;var Ne=this.j;Ne.g==this&&Ne.ba&&!Ne.M&&(Ne.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),Ea(Ne),Ne.M=!0,He(11))}}else Bt(this.i,this.l,B,null),va(this,B);Ie==4&&Nt(this),this.o&&!this.J&&(Ie==4?jo(this.j,this):(this.o=!1,or(this)))}else Ac(this.g),T==400&&0<B.indexOf("Unknown SID")?(this.s=3,He(12)):(this.s=0,He(13)),Nt(this),vn(this)}}}catch{}finally{}};function go(_){return _.g?_.u=="GET"&&_.L!=2&&_.j.Ca:!1}function dc(_,w){var T=_.C,M=w.indexOf(`
`,T);return M==-1?pa:(T=Number(w.substring(T,M)),isNaN(T)?po:(M+=1,M+T>w.length?pa:(w=w.slice(M,M+T),_.C=M+T,w)))}ft.prototype.cancel=function(){this.J=!0,Nt(this)};function or(_){_.S=Date.now()+_.I,vo(_,_.I)}function vo(_,w){if(_.B!=null)throw Error("WatchDog timer not null");_.B=mn(f(_.ba,_),w)}function ga(_){_.B&&(l.clearTimeout(_.B),_.B=null)}ft.prototype.ba=function(){this.B=null;const _=Date.now();0<=_-this.S?(sc(this.i,this.A),this.L!=2&&(pn(),He(17)),Nt(this),this.s=2,vn(this)):vo(this,this.S-_)};function vn(_){_.j.G==0||_.J||jo(_.j,_)}function Nt(_){ga(_);var w=_.M;w&&typeof w.ma=="function"&&w.ma(),_.M=null,io(_.U),_.g&&(w=_.g,_.g=null,w.abort(),w.ma())}function va(_,w){try{var T=_.j;if(T.G!=0&&(T.g==_||ya(T.h,_))){if(!_.K&&ya(T.h,_)&&T.G==3){try{var M=T.Da.g.parse(w)}catch{M=null}if(Array.isArray(M)&&M.length==3){var V=M;if(V[0]==0){e:if(!T.u){if(T.g)if(T.g.F+3e3<_.F)pr(T),hr(T);else break e;ka(T),He(18)}}else T.za=V[1],0<T.za-T.T&&37500>V[2]&&T.F&&T.v==0&&!T.C&&(T.C=mn(f(T.Za,T),6e3));if(1>=wo(T.h)&&T.ca){try{T.ca()}catch{}T.ca=void 0}}else Mt(T,11)}else if((_.K||T.g==_)&&pr(T),!x(w))for(V=T.Da.g.parse(w),w=0;w<V.length;w++){let oe=V[w];if(T.T=oe[0],oe=oe[1],T.G==2)if(oe[0]=="c"){T.K=oe[1],T.ia=oe[2];const Ne=oe[3];Ne!=null&&(T.la=Ne,T.j.info("VER="+T.la));const Ie=oe[4];Ie!=null&&(T.Aa=Ie,T.j.info("SVER="+T.Aa));const Kt=oe[5];Kt!=null&&typeof Kt=="number"&&0<Kt&&(M=1.5*Kt,T.L=M,T.j.info("backChannelRequestTimeoutMs_="+M)),M=T;const Ge=_.g;if(Ge){const gr=Ge.g?Ge.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gr){var H=M.h;H.g||gr.indexOf("spdy")==-1&&gr.indexOf("quic")==-1&&gr.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(ba(H,H.h),H.h=null))}if(M.D){const Ta=Ge.g?Ge.g.getResponseHeader("X-HTTP-Session-Id"):null;Ta&&(M.ya=Ta,ue(M.I,M.D,Ta))}}T.G=3,T.l&&T.l.ua(),T.ba&&(T.R=Date.now()-_.F,T.j.info("Handshake RTT: "+T.R+"ms")),M=T;var B=_;if(M.qa=Wo(M,M.J?M.ia:null,M.W),B.K){xo(M.h,B);var de=B,Ee=M.L;Ee&&(de.I=Ee),de.B&&(ga(de),or(de)),M.g=B}else zo(M);0<T.i.length&&fr(T)}else oe[0]!="stop"&&oe[0]!="close"||Mt(T,7);else T.G==3&&(oe[0]=="stop"||oe[0]=="close"?oe[0]=="stop"?Mt(T,7):xa(T):oe[0]!="noop"&&T.l&&T.l.ta(oe),T.v=0)}}pn(4)}catch{}}var cc=class{constructor(_,w){this.g=_,this.map=w}};function yo(_){this.l=_||10,l.PerformanceNavigationTiming?(_=l.performance.getEntriesByType("navigation"),_=0<_.length&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bo(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function wo(_){return _.h?1:_.g?_.g.size:0}function ya(_,w){return _.h?_.h==w:_.g?_.g.has(w):!1}function ba(_,w){_.g?_.g.add(w):_.h=w}function xo(_,w){_.h&&_.h==w?_.h=null:_.g&&_.g.has(w)&&_.g.delete(w)}yo.prototype.cancel=function(){if(this.i=ko(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function ko(_){if(_.h!=null)return _.i.concat(_.h.D);if(_.g!=null&&_.g.size!==0){let w=_.i;for(const T of _.g.values())w=w.concat(T.D);return w}return h(_.i)}function _c(_){if(_.V&&typeof _.V=="function")return _.V();if(typeof Map<"u"&&_ instanceof Map||typeof Set<"u"&&_ instanceof Set)return Array.from(_.values());if(typeof _=="string")return _.split("");if(s(_)){for(var w=[],T=_.length,M=0;M<T;M++)w.push(_[M]);return w}w=[],T=0;for(M in _)w[T++]=_[M];return w}function uc(_){if(_.na&&typeof _.na=="function")return _.na();if(!_.V||typeof _.V!="function"){if(typeof Map<"u"&&_ instanceof Map)return Array.from(_.keys());if(!(typeof Set<"u"&&_ instanceof Set)){if(s(_)||typeof _=="string"){var w=[];_=_.length;for(var T=0;T<_;T++)w.push(T);return w}w=[],T=0;for(const M in _)w[T++]=M;return w}}}function Eo(_,w){if(_.forEach&&typeof _.forEach=="function")_.forEach(w,void 0);else if(s(_)||typeof _=="string")Array.prototype.forEach.call(_,w,void 0);else for(var T=uc(_),M=_c(_),V=M.length,H=0;H<V;H++)w.call(void 0,M[H],T&&T[H],_)}var To=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hc(_,w){if(_){_=_.split("&");for(var T=0;T<_.length;T++){var M=_[T].indexOf("="),V=null;if(0<=M){var H=_[T].substring(0,M);V=_[T].substring(M+1)}else H=_[T];w(H,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function It(_){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,_ instanceof It){this.h=_.h,sr(this,_.j),this.o=_.o,this.g=_.g,lr(this,_.s),this.l=_.l;var w=_.i,T=new wn;T.i=w.i,w.g&&(T.g=new Map(w.g),T.h=w.h),Ao(this,T),this.m=_.m}else _&&(w=String(_).match(To))?(this.h=!1,sr(this,w[1]||"",!0),this.o=yn(w[2]||""),this.g=yn(w[3]||"",!0),lr(this,w[4]),this.l=yn(w[5]||"",!0),Ao(this,w[6]||"",!0),this.m=yn(w[7]||"")):(this.h=!1,this.i=new wn(null,this.h))}It.prototype.toString=function(){var _=[],w=this.j;w&&_.push(bn(w,So,!0),":");var T=this.g;return(T||w=="file")&&(_.push("//"),(w=this.o)&&_.push(bn(w,So,!0),"@"),_.push(encodeURIComponent(String(T)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.s,T!=null&&_.push(":",String(T))),(T=this.l)&&(this.g&&T.charAt(0)!="/"&&_.push("/"),_.push(bn(T,T.charAt(0)=="/"?mc:pc,!0))),(T=this.i.toString())&&_.push("?",T),(T=this.m)&&_.push("#",bn(T,vc)),_.join("")};function st(_){return new It(_)}function sr(_,w,T){_.j=T?yn(w,!0):w,_.j&&(_.j=_.j.replace(/:$/,""))}function lr(_,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);_.s=w}else _.s=null}function Ao(_,w,T){w instanceof wn?(_.i=w,yc(_.i,_.h)):(T||(w=bn(w,gc)),_.i=new wn(w,_.h))}function ue(_,w,T){_.i.set(w,T)}function dr(_){return ue(_,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),_}function yn(_,w){return _?w?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function bn(_,w,T){return typeof _=="string"?(_=encodeURI(_).replace(w,fc),T&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function fc(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var So=/[#\/\?@]/g,pc=/[#\?:]/g,mc=/[#\?]/g,gc=/[#\?@]/g,vc=/#/g;function wn(_,w){this.h=this.g=null,this.i=_||null,this.j=!!w}function pt(_){_.g||(_.g=new Map,_.h=0,_.i&&hc(_.i,function(w,T){_.add(decodeURIComponent(w.replace(/\+/g," ")),T)}))}e=wn.prototype,e.add=function(_,w){pt(this),this.i=null,_=Yt(this,_);var T=this.g.get(_);return T||this.g.set(_,T=[]),T.push(w),this.h+=1,this};function Do(_,w){pt(_),w=Yt(_,w),_.g.has(w)&&(_.i=null,_.h-=_.g.get(w).length,_.g.delete(w))}function Co(_,w){return pt(_),w=Yt(_,w),_.g.has(w)}e.forEach=function(_,w){pt(this),this.g.forEach(function(T,M){T.forEach(function(V){_.call(w,V,M,this)},this)},this)},e.na=function(){pt(this);const _=Array.from(this.g.values()),w=Array.from(this.g.keys()),T=[];for(let M=0;M<w.length;M++){const V=_[M];for(let H=0;H<V.length;H++)T.push(w[M])}return T},e.V=function(_){pt(this);let w=[];if(typeof _=="string")Co(this,_)&&(w=w.concat(this.g.get(Yt(this,_))));else{_=Array.from(this.g.values());for(let T=0;T<_.length;T++)w=w.concat(_[T])}return w},e.set=function(_,w){return pt(this),this.i=null,_=Yt(this,_),Co(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[w]),this.h+=1,this},e.get=function(_,w){return _?(_=this.V(_),0<_.length?String(_[0]):w):w};function No(_,w,T){Do(_,w),0<T.length&&(_.i=null,_.g.set(Yt(_,w),h(T)),_.h+=T.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],w=Array.from(this.g.keys());for(var T=0;T<w.length;T++){var M=w[T];const H=encodeURIComponent(String(M)),B=this.V(M);for(M=0;M<B.length;M++){var V=H;B[M]!==""&&(V+="="+encodeURIComponent(String(B[M]))),_.push(V)}}return this.i=_.join("&")};function Yt(_,w){return w=String(w),_.j&&(w=w.toLowerCase()),w}function yc(_,w){w&&!_.j&&(pt(_),_.i=null,_.g.forEach(function(T,M){var V=M.toLowerCase();M!=V&&(Do(this,M),No(this,V,T))},_)),_.j=w}function bc(_,w){const T=new gn;if(l.Image){const M=new Image;M.onload=y(mt,T,"TestLoadImage: loaded",!0,w,M),M.onerror=y(mt,T,"TestLoadImage: error",!1,w,M),M.onabort=y(mt,T,"TestLoadImage: abort",!1,w,M),M.ontimeout=y(mt,T,"TestLoadImage: timeout",!1,w,M),l.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=_}else w(!1)}function wc(_,w){const T=new gn,M=new AbortController,V=setTimeout(()=>{M.abort(),mt(T,"TestPingServer: timeout",!1,w)},1e4);fetch(_,{signal:M.signal}).then(H=>{clearTimeout(V),H.ok?mt(T,"TestPingServer: ok",!0,w):mt(T,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(V),mt(T,"TestPingServer: error",!1,w)})}function mt(_,w,T,M,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),M(T)}catch{}}function xc(){this.g=new ac}function kc(_,w,T){const M=T||"";try{Eo(_,function(V,H){let B=V;d(V)&&(B=ca(V)),w.push(M+H+"="+encodeURIComponent(B))})}catch(V){throw w.push(M+"type="+encodeURIComponent("_badmap")),V}}function cr(_){this.l=_.Ub||null,this.j=_.eb||!1}g(cr,_a),cr.prototype.g=function(){return new _r(this.l,this.j)},cr.prototype.i=function(_){return function(){return _}}({});function _r(_,w){Ce.call(this),this.D=_,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(_r,Ce),e=_r.prototype,e.open=function(_,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=_,this.A=w,this.readyState=1,kn(this)},e.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};_&&(w.body=_),(this.D||l).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xn(this)),this.readyState=0},e.Sa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,kn(this)),this.g&&(this.readyState=3,kn(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Io(this)}else _.text().then(this.Ra.bind(this),this.ga.bind(this))};function Io(_){_.j.read().then(_.Pa.bind(_)).catch(_.ga.bind(_))}e.Pa=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var w=_.value?_.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!_.done}))&&(this.response=this.responseText+=w)}_.done?xn(this):kn(this),this.readyState==3&&Io(this)}},e.Ra=function(_){this.g&&(this.response=this.responseText=_,xn(this))},e.Qa=function(_){this.g&&(this.response=_,xn(this))},e.ga=function(){this.g&&xn(this)};function xn(_){_.readyState=4,_.l=null,_.j=null,_.v=null,kn(_)}e.setRequestHeader=function(_,w){this.u.append(_,w)},e.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],w=this.h.entries();for(var T=w.next();!T.done;)T=T.value,_.push(T[0]+": "+T[1]),T=w.next();return _.join(`\r
`)};function kn(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(_r.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function Mo(_){let w="";return I(_,function(T,M){w+=M,w+=":",w+=T,w+=`\r
`}),w}function wa(_,w,T){e:{for(M in T){var M=!1;break e}M=!0}M||(T=Mo(T),typeof _=="string"?T!=null&&encodeURIComponent(String(T)):ue(_,w,T))}function me(_){Ce.call(this),this.headers=new Map,this.o=_||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(me,Ce);var Ec=/^https?$/i,Tc=["POST","PUT"];e=me.prototype,e.Ha=function(_){this.J=_},e.ea=function(_,w,T,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);w=w?w.toUpperCase():"GET",this.D=_,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():fa.g(),this.v=this.o?oo(this.o):oo(fa),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(w,String(_),!0),this.B=!1}catch(H){Oo(this,H);return}if(_=T||"",T=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var V in M)T.set(V,M[V]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const H of M.keys())T.set(H,M.get(H));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(T.keys()).find(H=>H.toLowerCase()=="content-type"),V=l.FormData&&_ instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Tc,w,void 0))||M||V||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,B]of T)this.g.setRequestHeader(H,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Lo(this),this.u=!0,this.g.send(_),this.u=!1}catch(H){Oo(this,H)}};function Oo(_,w){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=w,_.m=5,Ro(_),ur(_)}function Ro(_){_.A||(_.A=!0,$e(_,"complete"),$e(_,"error"))}e.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=_||7,$e(this,"complete"),$e(this,"abort"),ur(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ur(this,!0)),me.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Po(this):this.bb())},e.bb=function(){Po(this)};function Po(_){if(_.h&&typeof o<"u"&&(!_.v[1]||lt(_)!=4||_.Z()!=2)){if(_.u&&lt(_)==4)no(_.Ea,0,_);else if($e(_,"readystatechange"),lt(_)==4){_.h=!1;try{const B=_.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var T;if(!(T=w)){var M;if(M=B===0){var V=String(_.D).match(To)[1]||null;!V&&l.self&&l.self.location&&(V=l.self.location.protocol.slice(0,-1)),M=!Ec.test(V?V.toLowerCase():"")}T=M}if(T)$e(_,"complete"),$e(_,"success");else{_.m=6;try{var H=2<lt(_)?_.g.statusText:""}catch{H=""}_.l=H+" ["+_.Z()+"]",Ro(_)}}finally{ur(_)}}}}function ur(_,w){if(_.g){Lo(_);const T=_.g,M=_.v[0]?()=>{}:null;_.g=null,_.v=null,w||$e(_,"ready");try{T.onreadystatechange=M}catch{}}}function Lo(_){_.I&&(l.clearTimeout(_.I),_.I=null)}e.isActive=function(){return!!this.g};function lt(_){return _.g?_.g.readyState:0}e.Z=function(){try{return 2<lt(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(_){if(this.g){var w=this.g.responseText;return _&&w.indexOf(_)==0&&(w=w.substring(_.length)),rc(w)}};function Vo(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.H){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function Ac(_){const w={};_=(_.g&&2<=lt(_)&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<_.length;M++){if(x(_[M]))continue;var T=E(_[M]);const V=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const H=w[V]||[];w[V]=H,H.push(T)}A(w,function(M){return M.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function En(_,w,T){return T&&T.internalChannelParams&&T.internalChannelParams[_]||w}function $o(_){this.Aa=0,this.i=[],this.j=new gn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=En("failFast",!1,_),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=En("baseRetryDelayMs",5e3,_),this.cb=En("retryDelaySeedMs",1e4,_),this.Wa=En("forwardChannelMaxRetries",2,_),this.wa=En("forwardChannelRequestTimeoutMs",2e4,_),this.pa=_&&_.xmlHttpFactory||void 0,this.Xa=_&&_.Tb||void 0,this.Ca=_&&_.useFetchStreams||!1,this.L=void 0,this.J=_&&_.supportsCrossDomainXhr||!1,this.K="",this.h=new yo(_&&_.concurrentRequestLimit),this.Da=new xc,this.P=_&&_.fastHandshake||!1,this.O=_&&_.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=_&&_.Rb||!1,_&&_.xa&&this.j.xa(),_&&_.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&_&&_.detectBufferingProxy||!1,this.ja=void 0,_&&_.longPollingTimeout&&0<_.longPollingTimeout&&(this.ja=_.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=$o.prototype,e.la=8,e.G=1,e.connect=function(_,w,T,M){He(0),this.W=_,this.H=w||{},T&&M!==void 0&&(this.H.OSID=T,this.H.OAID=M),this.F=this.X,this.I=Wo(this,null,this.W),fr(this)};function xa(_){if(Ho(_),_.G==3){var w=_.U++,T=st(_.I);if(ue(T,"SID",_.K),ue(T,"RID",w),ue(T,"TYPE","terminate"),Tn(_,T),w=new ft(_,_.j,w),w.L=2,w.v=dr(st(T)),T=!1,l.navigator&&l.navigator.sendBeacon)try{T=l.navigator.sendBeacon(w.v.toString(),"")}catch{}!T&&l.Image&&(new Image().src=w.v,T=!0),T||(w.g=Ko(w.j,null),w.g.ea(w.v)),w.F=Date.now(),or(w)}Yo(_)}function hr(_){_.g&&(Ea(_),_.g.cancel(),_.g=null)}function Ho(_){hr(_),_.u&&(l.clearTimeout(_.u),_.u=null),pr(_),_.h.cancel(),_.s&&(typeof _.s=="number"&&l.clearTimeout(_.s),_.s=null)}function fr(_){if(!bo(_.h)&&!_.s){_.s=!0;var w=_.Ga;q||te(),$||(q(),$=!0),X.add(w,_),_.B=0}}function Sc(_,w){return wo(_.h)>=_.h.j-(_.s?1:0)?!1:_.s?(_.i=w.D.concat(_.i),!0):_.G==1||_.G==2||_.B>=(_.Va?0:_.Wa)?!1:(_.s=mn(f(_.Ga,_,w),Bo(_,_.B)),_.B++,!0)}e.Ga=function(_){if(this.s)if(this.s=null,this.G==1){if(!_){this.U=Math.floor(1e5*Math.random()),_=this.U++;const V=new ft(this,this.j,_);let H=this.o;if(this.S&&(H?(H=m(H),k(H,this.S)):H=this.S),this.m!==null||this.O||(V.H=H,H=null),this.P)e:{for(var w=0,T=0;T<this.i.length;T++){t:{var M=this.i[T];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(w+=M,4096<w){w=T;break e}if(w===4096||T===this.i.length-1){w=T+1;break e}}w=1e3}else w=1e3;w=Uo(this,V,w),T=st(this.I),ue(T,"RID",_),ue(T,"CVER",22),this.D&&ue(T,"X-HTTP-Session-Id",this.D),Tn(this,T),H&&(this.O?w="headers="+encodeURIComponent(String(Mo(H)))+"&"+w:this.m&&wa(T,this.m,H)),ba(this.h,V),this.Ua&&ue(T,"TYPE","init"),this.P?(ue(T,"$req",w),ue(T,"SID","null"),V.T=!0,ma(V,T,null)):ma(V,T,w),this.G=2}}else this.G==3&&(_?Fo(this,_):this.i.length==0||bo(this.h)||Fo(this))};function Fo(_,w){var T;w?T=w.l:T=_.U++;const M=st(_.I);ue(M,"SID",_.K),ue(M,"RID",T),ue(M,"AID",_.T),Tn(_,M),_.m&&_.o&&wa(M,_.m,_.o),T=new ft(_,_.j,T,_.B+1),_.m===null&&(T.H=_.o),w&&(_.i=w.D.concat(_.i)),w=Uo(_,T,1e3),T.I=Math.round(.5*_.wa)+Math.round(.5*_.wa*Math.random()),ba(_.h,T),ma(T,M,w)}function Tn(_,w){_.H&&I(_.H,function(T,M){ue(w,M,T)}),_.l&&Eo({},function(T,M){ue(w,M,T)})}function Uo(_,w,T){T=Math.min(_.i.length,T);var M=_.l?f(_.l.Na,_.l,_):null;e:{var V=_.i;let H=-1;for(;;){const B=["count="+T];H==-1?0<T?(H=V[0].g,B.push("ofs="+H)):H=0:B.push("ofs="+H);let de=!0;for(let Ee=0;Ee<T;Ee++){let oe=V[Ee].g;const Ne=V[Ee].map;if(oe-=H,0>oe)H=Math.max(0,V[Ee].g-100),de=!1;else try{kc(Ne,B,"req"+oe+"_")}catch{M&&M(Ne)}}if(de){M=B.join("&");break e}}}return _=_.i.splice(0,T),w.D=_,M}function zo(_){if(!_.g&&!_.u){_.Y=1;var w=_.Fa;q||te(),$||(q(),$=!0),X.add(w,_),_.v=0}}function ka(_){return _.g||_.u||3<=_.v?!1:(_.Y++,_.u=mn(f(_.Fa,_),Bo(_,_.v)),_.v++,!0)}e.Fa=function(){if(this.u=null,qo(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var _=2*this.R;this.j.info("BP detection timer enabled: "+_),this.A=mn(f(this.ab,this),_)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,He(10),hr(this),qo(this))};function Ea(_){_.A!=null&&(l.clearTimeout(_.A),_.A=null)}function qo(_){_.g=new ft(_,_.j,"rpc",_.Y),_.m===null&&(_.g.H=_.o),_.g.O=0;var w=st(_.qa);ue(w,"RID","rpc"),ue(w,"SID",_.K),ue(w,"AID",_.T),ue(w,"CI",_.F?"0":"1"),!_.F&&_.ja&&ue(w,"TO",_.ja),ue(w,"TYPE","xmlhttp"),Tn(_,w),_.m&&_.o&&wa(w,_.m,_.o),_.L&&(_.g.I=_.L);var T=_.g;_=_.ia,T.L=1,T.v=dr(st(w)),T.m=null,T.P=!0,mo(T,_)}e.Za=function(){this.C!=null&&(this.C=null,hr(this),ka(this),He(19))};function pr(_){_.C!=null&&(l.clearTimeout(_.C),_.C=null)}function jo(_,w){var T=null;if(_.g==w){pr(_),Ea(_),_.g=null;var M=2}else if(ya(_.h,w))T=w.D,xo(_.h,w),M=1;else return;if(_.G!=0){if(w.o)if(M==1){T=w.m?w.m.length:0,w=Date.now()-w.F;var V=_.B;M=rr(),$e(M,new uo(M,T)),fr(_)}else zo(_);else if(V=w.s,V==3||V==0&&0<w.X||!(M==1&&Sc(_,w)||M==2&&ka(_)))switch(T&&0<T.length&&(w=_.h,w.i=w.i.concat(T)),V){case 1:Mt(_,5);break;case 4:Mt(_,10);break;case 3:Mt(_,6);break;default:Mt(_,2)}}}function Bo(_,w){let T=_.Ta+Math.floor(Math.random()*_.cb);return _.isActive()||(T*=2),T*w}function Mt(_,w){if(_.j.info("Error code "+w),w==2){var T=f(_.fb,_),M=_.Xa;const V=!M;M=new It(M||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||sr(M,"https"),dr(M),V?bc(M.toString(),T):wc(M.toString(),T)}else He(2);_.G=0,_.l&&_.l.sa(w),Yo(_),Ho(_)}e.fb=function(_){_?(this.j.info("Successfully pinged google.com"),He(2)):(this.j.info("Failed to ping google.com"),He(1))};function Yo(_){if(_.G=0,_.ka=[],_.l){const w=ko(_.h);(w.length!=0||_.i.length!=0)&&(p(_.ka,w),p(_.ka,_.i),_.h.i.length=0,h(_.i),_.i.length=0),_.l.ra()}}function Wo(_,w,T){var M=T instanceof It?st(T):new It(T);if(M.g!="")w&&(M.g=w+"."+M.g),lr(M,M.s);else{var V=l.location;M=V.protocol,w=w?w+"."+V.hostname:V.hostname,V=+V.port;var H=new It(null);M&&sr(H,M),w&&(H.g=w),V&&lr(H,V),T&&(H.l=T),M=H}return T=_.D,w=_.ya,T&&w&&ue(M,T,w),ue(M,"VER",_.la),Tn(_,M),M}function Ko(_,w,T){if(w&&!_.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=_.Ca&&!_.pa?new me(new cr({eb:T})):new me(_.pa),w.Ha(_.J),w}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Go(){}e=Go.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function mr(){}mr.prototype.g=function(_,w){return new qe(_,w)};function qe(_,w){Ce.call(this),this.g=new $o(w),this.l=_,this.h=w&&w.messageUrlParams||null,_=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(_?_["X-WebChannel-Content-Type"]=w.messageContentType:_={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(_?_["X-WebChannel-Client-Profile"]=w.va:_={"X-WebChannel-Client-Profile":w.va}),this.g.S=_,(_=w&&w.Sb)&&!x(_)&&(this.g.m=_),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!x(w)&&(this.g.D=w,_=this.h,_!==null&&w in _&&(_=this.h,w in _&&delete _[w])),this.j=new Wt(this)}g(qe,Ce),qe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qe.prototype.close=function(){xa(this.g)},qe.prototype.o=function(_){var w=this.g;if(typeof _=="string"){var T={};T.__data__=_,_=T}else this.u&&(T={},T.__data__=ca(_),_=T);w.i.push(new cc(w.Ya++,_)),w.G==3&&fr(w)},qe.prototype.N=function(){this.g.l=null,delete this.j,xa(this.g),delete this.g,qe.aa.N.call(this)};function Jo(_){ua.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var w=_.__sm__;if(w){e:{for(const T in w){_=T;break e}_=void 0}(this.i=_)&&(_=this.i,w=w!==null&&_ in w?w[_]:void 0),this.data=w}else this.data=_}g(Jo,ua);function Qo(){ha.call(this),this.status=1}g(Qo,ha);function Wt(_){this.g=_}g(Wt,Go),Wt.prototype.ua=function(){$e(this.g,"a")},Wt.prototype.ta=function(_){$e(this.g,new Jo(_))},Wt.prototype.sa=function(_){$e(this.g,new Qo)},Wt.prototype.ra=function(){$e(this.g,"b")},mr.prototype.createWebChannel=mr.prototype.g,qe.prototype.send=qe.prototype.o,qe.prototype.open=qe.prototype.m,qe.prototype.close=qe.prototype.close,Wl=function(){return new mr},Yl=function(){return rr()},Bl=Ct,Xa={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ar.NO_ERROR=0,ar.TIMEOUT=8,ar.HTTP_ERROR=6,kr=ar,ho.COMPLETE="complete",jl=ho,so.EventType=fn,fn.OPEN="a",fn.CLOSE="b",fn.ERROR="c",fn.MESSAGE="d",Ce.prototype.listen=Ce.prototype.K,Nn=so,me.prototype.listenOnce=me.prototype.L,me.prototype.getLastError=me.prototype.Ka,me.prototype.getLastErrorCode=me.prototype.Ba,me.prototype.getStatus=me.prototype.Z,me.prototype.getResponseJson=me.prototype.Oa,me.prototype.getResponseText=me.prototype.oa,me.prototype.send=me.prototype.ea,me.prototype.setWithCredentials=me.prototype.Ha,ql=me}).apply(typeof vr<"u"?vr:typeof self<"u"?self:typeof window<"u"?window:{});const Cs="@firebase/firestore",Ns="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Pe.UNAUTHENTICATED=new Pe(null),Pe.GOOGLE_CREDENTIALS=new Pe("google-credentials-uid"),Pe.FIRST_PARTY=new Pe("first-party-uid"),Pe.MOCK_USER=new Pe("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cn="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ht=new Vl("@firebase/firestore");function Qt(){return Ht.logLevel}function K(e,...t){if(Ht.logLevel<=ae.DEBUG){const n=t.map(ki);Ht.debug(`Firestore (${cn}): ${e}`,...n)}}function Ft(e,...t){if(Ht.logLevel<=ae.ERROR){const n=t.map(ki);Ht.error(`Firestore (${cn}): ${e}`,...n)}}function Yr(e,...t){if(Ht.logLevel<=ae.WARN){const n=t.map(ki);Ht.warn(`Firestore (${cn}): ${e}`,...n)}}function ki(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,Kl(e,r,n)}function Kl(e,t,n){let r=`FIRESTORE (${cn}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ft(r),new Error(r)}function ge(e,t,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,e||Kl(t,i,r)}function _e(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends dn{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class sf{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Pe.UNAUTHENTICATED))}shutdown(){}}class lf{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class df{constructor(t){this.t=t,this.currentUser=Pe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ge(this.o===void 0,42304);let r=this.i;const i=s=>this.i!==r?(r=this.i,n(s)):Promise.resolve();let a=new Lt;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Lt,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const s=a;t.enqueueRetryable(async()=>{await s.promise,await i(this.currentUser)})},l=s=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=s,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(s=>l(s)),setTimeout(()=>{if(!this.auth){const s=this.t.getImmediate({optional:!0});s?l(s):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Lt)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ge(typeof r.accessToken=="string",31837,{l:r}),new Gl(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ge(t===null||typeof t=="string",2055,{h:t}),new Pe(t)}}class cf{constructor(t,n,r){this.P=t,this.T=n,this.I=r,this.type="FirstParty",this.user=Pe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class _f{constructor(t,n,r){this.P=t,this.T=n,this.I=r}getToken(){return Promise.resolve(new cf(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(Pe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Is{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uf{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qh(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ge(this.o===void 0,3512);const r=a=>{a.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>r(a))};const i=a=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Is(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ge(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Is(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=hf(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<n&&(r+=t.charAt(i[a]%62))}return r}}function ie(e,t){return e<t?-1:e>t?1:0}function Za(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return ie(r,i);{const a=ff(),o=pf(a.encode(Ms(e,n)),a.encode(Ms(t,n)));return o!==0?o:ie(r,i)}}n+=r>65535?2:1}return ie(e.length,t.length)}function Ms(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function pf(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return ie(e[n],t[n]);return ie(e.length,t.length)}function rn(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os=-62135596800,Rs=1e6;class ve{static now(){return ve.fromMillis(Date.now())}static fromDate(t){return ve.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*Rs);return new ve(n,r)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<Os)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Rs}_compareTo(t){return this.seconds===t.seconds?ie(this.nanoseconds,t.nanoseconds):ie(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-Os;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{static fromTimestamp(t){return new he(t)}static min(){return new he(new ve(0,0))}static max(){return new he(new ve(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps="__name__";class nt{constructor(t,n,r){n===void 0?n=0:n>t.length&&ne(637,{offset:n,range:t.length}),r===void 0?r=t.length-n:r>t.length-n&&ne(1746,{length:r,range:t.length-n}),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return nt.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof nt?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let i=0;i<r;i++){const a=nt.compareSegments(t.get(i),n.get(i));if(a!==0)return a}return ie(t.length,n.length)}static compareSegments(t,n){const r=nt.isNumericId(t),i=nt.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?nt.extractNumericId(t).compare(nt.extractNumericId(n)):Za(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return xi.fromString(t.substring(4,t.length-2))}}class pe extends nt{construct(t,n,r){return new pe(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new G(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new pe(n)}static emptyPath(){return new pe([])}}const mf=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Se extends nt{construct(t,n,r){return new Se(t,n,r)}static isValidIdentifier(t){return mf.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Se.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ps}static keyField(){return new Se([Ps])}static fromServerFormat(t){const n=[];let r="",i=0;const a=()=>{if(r.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<t.length;){const l=t[i];if(l==="\\"){if(i+1===t.length)throw new G(z.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const s=t[i+1];if(s!=="\\"&&s!=="."&&s!=="`")throw new G(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=s,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(a(),i++)}if(a(),o)throw new G(z.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Se(n)}static emptyPath(){return new Se([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(t){this.path=t}static fromPath(t){return new Z(pe.fromString(t))}static fromName(t){return new Z(pe.fromString(t).popFirst(5))}static empty(){return new Z(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&pe.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return pe.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Z(new pe(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn=-1;function gf(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=he.fromTimestamp(r===1e9?new ve(n+1,0):new ve(n,r));return new Tt(i,Z.empty(),t)}function vf(e){return new Tt(e.readTime,e.key,Fn)}class Tt{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new Tt(he.min(),Z.empty(),Fn)}static max(){return new Tt(he.max(),Z.empty(),Fn)}}function yf(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Z.comparator(e.documentKey,t.documentKey),n!==0?n:ie(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wf{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ei(e){if(e.code!==z.FAILED_PRECONDITION||e.message!==bf)throw e;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new U((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(n,a).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):U.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):U.reject(n)}static resolve(t){return new U((n,r)=>{n(t)})}static reject(t){return new U((n,r)=>{r(t)})}static waitFor(t){return new U((n,r)=>{let i=0,a=0,o=!1;t.forEach(l=>{++i,l.next(()=>{++a,o&&a===i&&n()},s=>r(s))}),o=!0,a===i&&n()})}static or(t){let n=U.resolve(!1);for(const r of t)n=n.next(i=>i?U.resolve(i):r());return n}static forEach(t,n){const r=[];return t.forEach((i,a)=>{r.push(n.call(this,i,a))}),this.waitFor(r)}static mapArray(t,n){return new U((r,i)=>{const a=t.length,o=new Array(a);let l=0;for(let s=0;s<a;s++){const d=s;n(t[d]).next(c=>{o[d]=c,++l,l===a&&r(o)},c=>i(c))}})}static doWhile(t,n){return new U((r,i)=>{const a=()=>{t()===!0?n().next(()=>{a()},i):r()};a()})}}function xf(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Wn(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ce&&this.ce(t),t}}Ti.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ai=-1;function Si(e){return e==null}function Pr(e){return e===0&&1/e==-1/0}function kf(e){return typeof e=="number"&&Number.isInteger(e)&&!Pr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql="";function Ef(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ls(t)),t=Tf(e.get(n),t);return Ls(t)}function Tf(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const a=e.charAt(i);switch(a){case"\0":n+="";break;case Ql:n+="";break;default:n+=a}}return n}function Ls(e){return e+Ql+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function qt(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Xl(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(t,n){this.comparator=t,this.root=n||Te.EMPTY}insert(t,n){return new ze(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Te.BLACK,null,null))}remove(t){return new ze(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Te.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new yr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new yr(this.root,t,this.comparator,!1)}getReverseIterator(){return new yr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new yr(this.root,t,this.comparator,!0)}}class yr{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Te{constructor(t,n,r,i,a){this.key=t,this.value=n,this.color=r??Te.RED,this.left=i??Te.EMPTY,this.right=a??Te.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,a){return new Te(t??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const a=r(t,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(t,n,r),null):a===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Te.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return Te.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Te.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Te.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ne(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw ne(27949);return t+(this.isRed()?0:1)}}Te.EMPTY=null,Te.RED=!0,Te.BLACK=!1;Te.EMPTY=new class{constructor(){this.size=0}get key(){throw ne(57766)}get value(){throw ne(16141)}get color(){throw ne(16727)}get left(){throw ne(29726)}get right(){throw ne(36894)}copy(t,n,r,i,a){return this}insert(t,n,r){return new Te(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(t){this.comparator=t,this.data=new ze(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new $s(this.data.getIterator())}getIteratorFrom(t){return new $s(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof De)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new De(this.comparator);return n.data=t,n}}class $s{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(t){this.fields=t,t.sort(Se.comparator)}static empty(){return new Ye([])}unionWith(t){let n=new De(Se.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Ye(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return rn(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Af("Invalid base64 string: "+a):a}}(t);return new at(n)}static fromUint8Array(t){const n=function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a}(t);return new at(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ie(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}at.EMPTY_BYTE_STRING=new at("");const Sf=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ut(e){if(ge(!!e,39018),typeof e=="string"){let t=0;const n=Sf.exec(e);if(ge(!!n,46558,{timestamp:e}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Ae(e.seconds),nanos:Ae(e.nanos)}}function Ae(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function an(e){return typeof e=="string"?at.fromBase64String(e):at.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl="server_timestamp",ed="__type__",td="__previous_value__",nd="__local_write_time__";function Di(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[ed])===null||n===void 0?void 0:n.stringValue)===Zl}function Ci(e){const t=e.mapValue.fields[td];return Di(t)?Ci(t):t}function Lr(e){const t=Ut(e.mapValue.fields[nd].timestampValue);return new ve(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(t,n,r,i,a,o,l,s,d,c){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=s,this.useFetchStreams=d,this.isUsingEmulator=c}}const Vr="(default)";class $r{constructor(t,n){this.projectId=t,this.database=n||Vr}static empty(){return new $r("","")}get isDefaultDatabase(){return this.database===Vr}isEqual(t){return t instanceof $r&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd="__type__",Cf="__max__",br={mapValue:{}},ad="__vector__",ei="value";function zt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Di(e)?4:If(e)?9007199254740991:Nf(e)?10:11:ne(28295,{value:e})}function it(e,t){if(e===t)return!0;const n=zt(e);if(n!==zt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Lr(e).isEqual(Lr(t));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Ut(i.timestampValue),l=Ut(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,a){return an(i.bytesValue).isEqual(an(a.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,a){return Ae(i.geoPointValue.latitude)===Ae(a.geoPointValue.latitude)&&Ae(i.geoPointValue.longitude)===Ae(a.geoPointValue.longitude)}(e,t);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return Ae(i.integerValue)===Ae(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=Ae(i.doubleValue),l=Ae(a.doubleValue);return o===l?Pr(o)===Pr(l):isNaN(o)&&isNaN(l)}return!1}(e,t);case 9:return rn(e.arrayValue.values||[],t.arrayValue.values||[],it);case 10:case 11:return function(i,a){const o=i.mapValue.fields||{},l=a.mapValue.fields||{};if(Vs(o)!==Vs(l))return!1;for(const s in o)if(o.hasOwnProperty(s)&&(l[s]===void 0||!it(o[s],l[s])))return!1;return!0}(e,t);default:return ne(52216,{left:e})}}function Un(e,t){return(e.values||[]).find(n=>it(n,t))!==void 0}function on(e,t){if(e===t)return 0;const n=zt(e),r=zt(t);if(n!==r)return ie(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ie(e.booleanValue,t.booleanValue);case 2:return function(a,o){const l=Ae(a.integerValue||a.doubleValue),s=Ae(o.integerValue||o.doubleValue);return l<s?-1:l>s?1:l===s?0:isNaN(l)?isNaN(s)?0:-1:1}(e,t);case 3:return Hs(e.timestampValue,t.timestampValue);case 4:return Hs(Lr(e),Lr(t));case 5:return Za(e.stringValue,t.stringValue);case 6:return function(a,o){const l=an(a),s=an(o);return l.compareTo(s)}(e.bytesValue,t.bytesValue);case 7:return function(a,o){const l=a.split("/"),s=o.split("/");for(let d=0;d<l.length&&d<s.length;d++){const c=ie(l[d],s[d]);if(c!==0)return c}return ie(l.length,s.length)}(e.referenceValue,t.referenceValue);case 8:return function(a,o){const l=ie(Ae(a.latitude),Ae(o.latitude));return l!==0?l:ie(Ae(a.longitude),Ae(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Fs(e.arrayValue,t.arrayValue);case 10:return function(a,o){var l,s,d,c;const u=a.fields||{},f=o.fields||{},y=(l=u[ei])===null||l===void 0?void 0:l.arrayValue,g=(s=f[ei])===null||s===void 0?void 0:s.arrayValue,h=ie(((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0,((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0);return h!==0?h:Fs(y,g)}(e.mapValue,t.mapValue);case 11:return function(a,o){if(a===br.mapValue&&o===br.mapValue)return 0;if(a===br.mapValue)return 1;if(o===br.mapValue)return-1;const l=a.fields||{},s=Object.keys(l),d=o.fields||{},c=Object.keys(d);s.sort(),c.sort();for(let u=0;u<s.length&&u<c.length;++u){const f=Za(s[u],c[u]);if(f!==0)return f;const y=on(l[s[u]],d[c[u]]);if(y!==0)return y}return ie(s.length,c.length)}(e.mapValue,t.mapValue);default:throw ne(23264,{Pe:n})}}function Hs(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ie(e,t);const n=Ut(e),r=Ut(t),i=ie(n.seconds,r.seconds);return i!==0?i:ie(n.nanos,r.nanos)}function Fs(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const a=on(n[i],r[i]);if(a)return a}return ie(n.length,r.length)}function sn(e){return ti(e)}function ti(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=Ut(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return an(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Z.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(const a of n.values||[])i?i=!1:r+=",",r+=ti(a);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${ti(n.fields[o])}`;return i+"}"}(e.mapValue):ne(61005,{value:e})}function Er(e){switch(zt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Ci(e);return t?16+Er(t):16;case 5:return 2*e.stringValue.length;case 6:return an(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,a)=>i+Er(a),0)}(e.arrayValue);case 10:case 11:return function(r){let i=0;return qt(r.fields,(a,o)=>{i+=a.length+Er(o)}),i}(e.mapValue);default:throw ne(13486,{value:e})}}function Us(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function ni(e){return!!e&&"integerValue"in e}function Ni(e){return!!e&&"arrayValue"in e}function Tr(e){return!!e&&"mapValue"in e}function Nf(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[rd])===null||n===void 0?void 0:n.stringValue)===ad}function On(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return qt(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=On(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=On(e.arrayValue.values[n]);return t}return Object.assign({},e)}function If(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Cf}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(t){this.value=t}static empty(){return new je({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!Tr(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=On(n)}setAll(t){let n=Se.emptyPath(),r={},i=[];t.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const s=this.getFieldsMap(n);this.applyChanges(s,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=On(o):i.push(l.lastSegment())});const a=this.getFieldsMap(n);this.applyChanges(a,r,i)}delete(t){const n=this.field(t.popLast());Tr(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return it(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];Tr(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){qt(n,(i,a)=>t[i]=a);for(const i of r)delete t[i]}clone(){return new je(On(this.value))}}function id(e){const t=[];return qt(e.fields,(n,r)=>{const i=new Se([n]);if(Tr(r)){const a=id(r.mapValue).fields;if(a.length===0)t.push(i);else for(const o of a)t.push(i.child(o))}else t.push(i)}),new Ye(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(t,n,r,i,a,o,l){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(t){return new Xe(t,0,he.min(),he.min(),he.min(),je.empty(),0)}static newFoundDocument(t,n,r,i){return new Xe(t,1,n,he.min(),r,i,0)}static newNoDocument(t,n){return new Xe(t,2,n,he.min(),he.min(),je.empty(),0)}static newUnknownDocument(t,n){return new Xe(t,3,n,he.min(),he.min(),je.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(he.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=je.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=he.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Xe&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(t,n){this.position=t,this.inclusive=n}}function zs(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const a=t[i],o=e.position[i];if(a.field.isKeyField()?r=Z.comparator(Z.fromName(o.referenceValue),n.key):r=on(o,n.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function qs(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!it(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(t,n="asc"){this.field=t,this.dir=n}}function Mf(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{}class we extends od{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new Rf(t,n,r):n==="array-contains"?new Vf(t,r):n==="in"?new $f(t,r):n==="not-in"?new Hf(t,r):n==="array-contains-any"?new Ff(t,r):new we(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new Pf(t,r):new Lf(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(on(n,this.value)):n!==null&&zt(this.value)===zt(n)&&this.matchesComparison(on(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ht extends od{constructor(t,n){super(),this.filters=t,this.op=n,this.Te=null}static create(t,n){return new ht(t,n)}matches(t){return sd(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function sd(e){return e.op==="and"}function ld(e){return Of(e)&&sd(e)}function Of(e){for(const t of e.filters)if(t instanceof ht)return!1;return!0}function ri(e){if(e instanceof we)return e.field.canonicalString()+e.op.toString()+sn(e.value);if(ld(e))return e.filters.map(t=>ri(t)).join(",");{const t=e.filters.map(n=>ri(n)).join(",");return`${e.op}(${t})`}}function dd(e,t){return e instanceof we?function(r,i){return i instanceof we&&r.op===i.op&&r.field.isEqual(i.field)&&it(r.value,i.value)}(e,t):e instanceof ht?function(r,i){return i instanceof ht&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((a,o,l)=>a&&dd(o,i.filters[l]),!0):!1}(e,t):void ne(19439)}function cd(e){return e instanceof we?function(n){return`${n.field.canonicalString()} ${n.op} ${sn(n.value)}`}(e):e instanceof ht?function(n){return n.op.toString()+" {"+n.getFilters().map(cd).join(" ,")+"}"}(e):"Filter"}class Rf extends we{constructor(t,n,r){super(t,n,r),this.key=Z.fromName(r.referenceValue)}matches(t){const n=Z.comparator(t.key,this.key);return this.matchesComparison(n)}}class Pf extends we{constructor(t,n){super(t,"in",n),this.keys=_d("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class Lf extends we{constructor(t,n){super(t,"not-in",n),this.keys=_d("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function _d(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Z.fromName(r.referenceValue))}class Vf extends we{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return Ni(n)&&Un(n.arrayValue,this.value)}}class $f extends we{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Un(this.value.arrayValue,n)}}class Hf extends we{constructor(t,n){super(t,"not-in",n)}matches(t){if(Un(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Un(this.value.arrayValue,n)}}class Ff extends we{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!Ni(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Un(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(t,n=null,r=[],i=[],a=null,o=null,l=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=l,this.Ie=null}}function js(e,t=null,n=[],r=[],i=null,a=null,o=null){return new Uf(e,t,n,r,i,a,o)}function Ii(e){const t=_e(e);if(t.Ie===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>ri(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),Si(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>sn(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>sn(r)).join(",")),t.Ie=n}return t.Ie}function Mi(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Mf(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!dd(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!qs(e.startAt,t.startAt)&&qs(e.endAt,t.endAt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(t,n=null,r=[],i=[],a=null,o="F",l=null,s=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=s,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function zf(e,t,n,r,i,a,o,l){return new _n(e,t,n,r,i,a,o,l)}function qf(e){return new _n(e)}function Bs(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function ud(e){return e.collectionGroup!==null}function Rn(e){const t=_e(e);if(t.Ee===null){t.Ee=[];const n=new Set;for(const a of t.explicitOrderBy)t.Ee.push(a),n.add(a.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new De(Se.comparator);return o.filters.forEach(s=>{s.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(t).forEach(a=>{n.has(a.canonicalString())||a.isKeyField()||t.Ee.push(new zn(a,r))}),n.has(Se.keyField().canonicalString())||t.Ee.push(new zn(Se.keyField(),r))}return t.Ee}function Vt(e){const t=_e(e);return t.de||(t.de=jf(t,Rn(e))),t.de}function jf(e,t){if(e.limitType==="F")return js(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new zn(i.field,a)});const n=e.endAt?new Hr(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Hr(e.startAt.position,e.startAt.inclusive):null;return js(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function ai(e,t){const n=e.filters.concat([t]);return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function ii(e,t,n){return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function hd(e,t){return Mi(Vt(e),Vt(t))&&e.limitType===t.limitType}function fd(e){return`${Ii(Vt(e))}|lt:${e.limitType}`}function Sn(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>cd(i)).join(", ")}]`),Si(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>sn(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>sn(i)).join(",")),`Target(${r})`}(Vt(e))}; limitType=${e.limitType})`}function Oi(e,t){return t.isFoundDocument()&&function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):Z.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(e,t)&&function(r,i){for(const a of Rn(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(e,t)&&function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(o,l,s){const d=zs(o,l,s);return o.inclusive?d<=0:d<0}(r.startAt,Rn(r),i)||r.endAt&&!function(o,l,s){const d=zs(o,l,s);return o.inclusive?d>=0:d>0}(r.endAt,Rn(r),i))}(e,t)}function Bf(e){return(t,n)=>{let r=!1;for(const i of Rn(e)){const a=Yf(i,t,n);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function Yf(e,t,n){const r=e.field.isKeyField()?Z.comparator(t.key,n.key):function(a,o,l){const s=o.data.field(a),d=l.data.field(a);return s!==null&&d!==null?on(s,d):ne(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ne(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,t))return a}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],t))return void(i[a]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){qt(this.inner,(n,r)=>{for(const[i,a]of r)t(i,a)})}isEmpty(){return Xl(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wf=new ze(Z.comparator);function Fr(){return Wf}const pd=new ze(Z.comparator);function wr(...e){let t=pd;for(const n of e)t=t.insert(n.key,n);return t}function md(e){let t=pd;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function Rt(){return Pn()}function gd(){return Pn()}function Pn(){return new jt(e=>e.toString(),(e,t)=>e.isEqual(t))}const Kf=new ze(Z.comparator),Gf=new De(Z.comparator);function Le(...e){let t=Gf;for(const n of e)t=t.add(n);return t}const Jf=new De(ie);function Qf(){return Jf}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pr(t)?"-0":t}}function vd(e){return{integerValue:""+e}}function Xf(e,t){return kf(t)?vd(t):Ri(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(){this._=void 0}}function Zf(e,t,n){return e instanceof Ur?function(i,a){const o={fields:{[ed]:{stringValue:Zl},[nd]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Di(a)&&(a=Ci(a)),a&&(o.fields[td]=a),{mapValue:o}}(n,t):e instanceof qn?bd(e,t):e instanceof jn?wd(e,t):function(i,a){const o=yd(i,a),l=Ys(o)+Ys(i.Re);return ni(o)&&ni(i.Re)?vd(l):Ri(i.serializer,l)}(e,t)}function ep(e,t,n){return e instanceof qn?bd(e,t):e instanceof jn?wd(e,t):n}function yd(e,t){return e instanceof zr?function(r){return ni(r)||function(a){return!!a&&"doubleValue"in a}(r)}(t)?t:{integerValue:0}:null}class Ur extends Wr{}class qn extends Wr{constructor(t){super(),this.elements=t}}function bd(e,t){const n=xd(t);for(const r of e.elements)n.some(i=>it(i,r))||n.push(r);return{arrayValue:{values:n}}}class jn extends Wr{constructor(t){super(),this.elements=t}}function wd(e,t){let n=xd(t);for(const r of e.elements)n=n.filter(i=>!it(i,r));return{arrayValue:{values:n}}}class zr extends Wr{constructor(t,n){super(),this.serializer=t,this.Re=n}}function Ys(e){return Ae(e.integerValue||e.doubleValue)}function xd(e){return Ni(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function tp(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof qn&&i instanceof qn||r instanceof jn&&i instanceof jn?rn(r.elements,i.elements,it):r instanceof zr&&i instanceof zr?it(r.Re,i.Re):r instanceof Ur&&i instanceof Ur}(e.transform,t.transform)}class np{constructor(t,n){this.version=t,this.transformResults=n}}class Ze{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Ze}static exists(t){return new Ze(void 0,t)}static updateTime(t){return new Ze(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Ar(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Kr{}function kd(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Pi(e.key,Ze.none()):new Kn(e.key,e.data,Ze.none());{const n=e.data,r=je.empty();let i=new De(Se.comparator);for(let a of t.fields)if(!i.has(a)){let o=n.field(a);o===null&&a.length>1&&(a=a.popLast(),o=n.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Dt(e.key,r,new Ye(i.toArray()),Ze.none())}}function rp(e,t,n){e instanceof Kn?function(i,a,o){const l=i.value.clone(),s=Ks(i.fieldTransforms,a,o.transformResults);l.setAll(s),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):e instanceof Dt?function(i,a,o){if(!Ar(i.precondition,a))return void a.convertToUnknownDocument(o.version);const l=Ks(i.fieldTransforms,a,o.transformResults),s=a.data;s.setAll(Ed(i)),s.setAll(l),a.convertToFoundDocument(o.version,s).setHasCommittedMutations()}(e,t,n):function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Ln(e,t,n,r){return e instanceof Kn?function(a,o,l,s){if(!Ar(a.precondition,o))return l;const d=a.value.clone(),c=Gs(a.fieldTransforms,s,o);return d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(e,t,n,r):e instanceof Dt?function(a,o,l,s){if(!Ar(a.precondition,o))return l;const d=Gs(a.fieldTransforms,s,o),c=o.data;return c.setAll(Ed(a)),c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(u=>u.field))}(e,t,n,r):function(a,o,l){return Ar(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(e,t,n)}function ap(e,t){let n=null;for(const r of e.fieldTransforms){const i=t.data.field(r.field),a=yd(r.transform,i||null);a!=null&&(n===null&&(n=je.empty()),n.set(r.field,a))}return n||null}function Ws(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&rn(r,i,(a,o)=>tp(a,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Kn extends Kr{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Dt extends Kr{constructor(t,n,r,i,a=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Ed(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Ks(e,t,n){const r=new Map;ge(e.length===n.length,32656,{Ve:n.length,me:e.length});for(let i=0;i<n.length;i++){const a=e[i],o=a.transform,l=t.data.field(a.field);r.set(a.field,ep(o,l,n[i]))}return r}function Gs(e,t,n){const r=new Map;for(const i of e){const a=i.transform,o=n.data.field(i.field);r.set(i.field,Zf(a,o,t))}return r}class Pi extends Kr{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ip extends Kr{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(t.key)&&rp(a,t,r[i])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=Ln(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=Ln(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=gd();return this.mutations.forEach(i=>{const a=t.get(i.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=n.has(i.key)?null:l;const s=kd(o,l);s!==null&&r.set(i.key,s),o.isValidDocument()||o.convertToNoDocument(he.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),Le())}isEqual(t){return this.batchId===t.batchId&&rn(this.mutations,t.mutations,(n,r)=>Ws(n,r))&&rn(this.baseMutations,t.baseMutations,(n,r)=>Ws(n,r))}}class Li{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){ge(t.mutations.length===r.length,58842,{fe:t.mutations.length,ge:r.length});let i=function(){return Kf}();const a=t.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new Li(t,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye,re;function lp(e){switch(e){case z.OK:return ne(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return ne(15467,{code:e})}}function dp(e){if(e===void 0)return Ft("GRPC error has no .code"),z.UNKNOWN;switch(e){case ye.OK:return z.OK;case ye.CANCELLED:return z.CANCELLED;case ye.UNKNOWN:return z.UNKNOWN;case ye.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case ye.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case ye.INTERNAL:return z.INTERNAL;case ye.UNAVAILABLE:return z.UNAVAILABLE;case ye.UNAUTHENTICATED:return z.UNAUTHENTICATED;case ye.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case ye.NOT_FOUND:return z.NOT_FOUND;case ye.ALREADY_EXISTS:return z.ALREADY_EXISTS;case ye.PERMISSION_DENIED:return z.PERMISSION_DENIED;case ye.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case ye.ABORTED:return z.ABORTED;case ye.OUT_OF_RANGE:return z.OUT_OF_RANGE;case ye.UNIMPLEMENTED:return z.UNIMPLEMENTED;case ye.DATA_LOSS:return z.DATA_LOSS;default:return ne(39323,{code:e})}}(re=ye||(ye={}))[re.OK=0]="OK",re[re.CANCELLED=1]="CANCELLED",re[re.UNKNOWN=2]="UNKNOWN",re[re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",re[re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",re[re.NOT_FOUND=5]="NOT_FOUND",re[re.ALREADY_EXISTS=6]="ALREADY_EXISTS",re[re.PERMISSION_DENIED=7]="PERMISSION_DENIED",re[re.UNAUTHENTICATED=16]="UNAUTHENTICATED",re[re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",re[re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",re[re.ABORTED=10]="ABORTED",re[re.OUT_OF_RANGE=11]="OUT_OF_RANGE",re[re.UNIMPLEMENTED=12]="UNIMPLEMENTED",re[re.INTERNAL=13]="INTERNAL",re[re.UNAVAILABLE=14]="UNAVAILABLE",re[re.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new xi([4294967295,4294967295],0);class cp{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function oi(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function _p(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function up(e,t){return oi(e,t.toTimestamp())}function nn(e){return ge(!!e,49232),he.fromTimestamp(function(n){const r=Ut(n);return new ve(r.seconds,r.nanos)}(e))}function Td(e,t){return si(e,t).canonicalString()}function si(e,t){const n=function(i){return new pe(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function hp(e){const t=pe.fromString(e);return ge(wp(t),10190,{key:t.toString()}),t}function li(e,t){return Td(e.databaseId,t.path)}function fp(e){const t=hp(e);return t.length===4?pe.emptyPath():mp(t)}function pp(e){return new pe(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function mp(e){return ge(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Js(e,t,n){return{name:li(e,t),fields:n.value.mapValue.fields}}function gp(e,t){let n;if(t instanceof Kn)n={update:Js(e,t.key,t.value)};else if(t instanceof Pi)n={delete:li(e,t.key)};else if(t instanceof Dt)n={update:Js(e,t.key,t.data),updateMask:bp(t.fieldMask)};else{if(!(t instanceof ip))return ne(16599,{ft:t.type});n={verify:li(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(a,o){const l=o.transform;if(l instanceof Ur)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof qn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof jn)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof zr)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw ne(20930,{transform:o.transform})}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:up(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ne(27497)}(e,t.precondition)),n}function vp(e,t){return e&&e.length>0?(ge(t!==void 0,14353),e.map(n=>function(i,a){let o=i.updateTime?nn(i.updateTime):nn(a);return o.isEqual(he.min())&&(o=nn(a)),new np(o,i.transformResults||[])}(n,t))):[]}function yp(e){let t=fp(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ge(r===1,65062);const c=n.from[0];c.allDescendants?i=c.collectionId:t=t.child(c.collectionId)}let a=[];n.where&&(a=function(u){const f=Ad(u);return f instanceof ht&&ld(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(u){return u.map(f=>function(g){return new zn(Xt(g.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(n.orderBy));let l=null;n.limit&&(l=function(u){let f;return f=typeof u=="object"?u.value:u,Si(f)?null:f}(n.limit));let s=null;n.startAt&&(s=function(u){const f=!!u.before,y=u.values||[];return new Hr(y,f)}(n.startAt));let d=null;return n.endAt&&(d=function(u){const f=!u.before,y=u.values||[];return new Hr(y,f)}(n.endAt)),zf(t,i,o,a,l,"F",s,d)}function Ad(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Xt(n.unaryFilter.field);return we.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Xt(n.unaryFilter.field);return we.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Xt(n.unaryFilter.field);return we.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Xt(n.unaryFilter.field);return we.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ne(61313);default:return ne(60726)}}(e):e.fieldFilter!==void 0?function(n){return we.create(Xt(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ne(58110);default:return ne(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return ht.create(n.compositeFilter.filters.map(r=>Ad(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ne(1026)}}(n.compositeFilter.op))}(e):ne(30097,{filter:e})}function Xt(e){return Se.fromServerFormat(e.fieldPath)}function bp(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function wp(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(t){this.wt=t}}function kp(e){const t=yp({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?ii(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(){this.Cn=new Tp}addToCollectionParentIndex(t,n){return this.Cn.add(n),U.resolve()}getCollectionParents(t,n){return U.resolve(this.Cn.getEntries(n))}addFieldIndex(t,n){return U.resolve()}deleteFieldIndex(t,n){return U.resolve()}deleteAllFieldIndexes(t){return U.resolve()}createTargetIndexes(t,n){return U.resolve()}getDocumentsMatchingTarget(t,n){return U.resolve(null)}getIndexType(t,n){return U.resolve(0)}getFieldIndexes(t,n){return U.resolve([])}getNextCollectionGroupToUpdate(t){return U.resolve(null)}getMinOffset(t,n){return U.resolve(Tt.min())}getMinOffsetFromCollectionGroup(t,n){return U.resolve(Tt.min())}updateCollectionGroup(t,n,r){return U.resolve()}updateIndexEntries(t,n){return U.resolve()}}class Tp{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new De(pe.comparator),a=!i.has(r);return this.index[n]=i.add(r),a}has(t){const n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new De(pe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sd=41943040;class Ue{static withCacheSize(t){return new Ue(t,Ue.DEFAULT_COLLECTION_PERCENTILE,Ue.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ue.DEFAULT_COLLECTION_PERCENTILE=10,Ue.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ue.DEFAULT=new Ue(Sd,Ue.DEFAULT_COLLECTION_PERCENTILE,Ue.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ue.DISABLED=new Ue(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(t){this.ur=t}next(){return this.ur+=2,this.ur}static cr(){return new ln(0)}static lr(){return new ln(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="LruGarbageCollector",Ap=1048576;function Zs([e,t],[n,r]){const i=ie(e,n);return i===0?ie(t,r):i}class Sp{constructor(t){this.Er=t,this.buffer=new De(Zs),this.dr=0}Ar(){return++this.dr}Rr(t){const n=[t,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Zs(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Dp{constructor(t,n,r){this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(t){K(Xs,`Garbage collection scheduled in ${t}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Wn(n)?K(Xs,"Ignoring IndexedDB error during garbage collection: ",n):await Ei(n)}await this.mr(3e5)})}}class Cp{constructor(t,n){this.gr=t,this.params=n}calculateTargetCount(t,n){return this.gr.pr(t).next(r=>Math.floor(n/100*r))}nthSequenceNumber(t,n){if(n===0)return U.resolve(Ti.le);const r=new Sp(n);return this.gr.forEachTarget(t,i=>r.Rr(i.sequenceNumber)).next(()=>this.gr.yr(t,i=>r.Rr(i))).next(()=>r.maxValue)}removeTargets(t,n,r){return this.gr.removeTargets(t,n,r)}removeOrphanedDocuments(t,n){return this.gr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(Qs)):this.getCacheSize(t).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Qs):this.wr(t,n))}getCacheSize(t){return this.gr.getCacheSize(t)}wr(t,n){let r,i,a,o,l,s,d;const c=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),i=this.params.maximumSequenceNumbersToCollect):i=u,o=Date.now(),this.nthSequenceNumber(t,i))).next(u=>(r=u,l=Date.now(),this.removeTargets(t,r,n))).next(u=>(a=u,s=Date.now(),this.removeOrphanedDocuments(t,r))).next(u=>(d=Date.now(),Qt()<=ae.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-c}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${a} targets in `+(s-l)+`ms
	Removed ${u} documents in `+(d-s)+`ms
Total Duration: ${d-c}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:u})))}}function Np(e,t){return new Cp(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(){this.changes=new jt(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Xe.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&Ln(r.mutation,i,Ye.empty(),ve.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,Le()).next(()=>r))}getLocalViewOfDocuments(t,n,r=Le()){const i=Rt();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(a=>{let o=wr();return a.forEach((l,s)=>{o=o.insert(l,s.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=Rt();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,Le()))}populateOverlays(t,n,r){const i=[];return r.forEach(a=>{n.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(t,i).next(a=>{a.forEach((o,l)=>{n.set(o,l)})})}computeViews(t,n,r,i){let a=Fr();const o=Pn(),l=function(){return Pn()}();return n.forEach((s,d)=>{const c=r.get(d.key);i.has(d.key)&&(c===void 0||c.mutation instanceof Dt)?a=a.insert(d.key,d):c!==void 0?(o.set(d.key,c.mutation.getFieldMask()),Ln(c.mutation,d,c.mutation.getFieldMask(),ve.now())):o.set(d.key,Ye.empty())}),this.recalculateAndSaveOverlays(t,a).next(s=>(s.forEach((d,c)=>o.set(d,c)),n.forEach((d,c)=>{var u;return l.set(d,new Mp(c,(u=o.get(d))!==null&&u!==void 0?u:null))}),l))}recalculateAndSaveOverlays(t,n){const r=Pn();let i=new ze((o,l)=>o-l),a=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const l of o)l.keys().forEach(s=>{const d=n.get(s);if(d===null)return;let c=r.get(s)||Ye.empty();c=l.applyToLocalView(d,c),r.set(s,c);const u=(i.get(l.batchId)||Le()).add(s);i=i.insert(l.batchId,u)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const s=l.getNext(),d=s.key,c=s.value,u=gd();c.forEach(f=>{if(!a.has(f)){const y=kd(n.get(f),r.get(f));y!==null&&u.set(f,y),a=a.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,d,u))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(o){return Z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):ud(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-a.size):U.resolve(Rt());let l=Fn,s=a;return o.next(d=>U.forEach(d,(c,u)=>(l<u.largestBatchId&&(l=u.largestBatchId),a.get(c)?U.resolve():this.remoteDocumentCache.getEntry(t,c).next(f=>{s=s.insert(c,f)}))).next(()=>this.populateOverlays(t,d,a)).next(()=>this.computeViews(t,s,d,Le())).next(c=>({batchId:l,changes:md(c)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Z(n)).next(r=>{let i=wr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){const a=n.collectionGroup;let o=wr();return this.indexManager.getCollectionParents(t,a).next(l=>U.forEach(l,s=>{const d=function(u,f){return new _n(f,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,s.child(a));return this.getDocumentsMatchingCollectionQuery(t,d,r,i).next(c=>{c.forEach((u,f)=>{o=o.insert(u,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,a,i))).next(o=>{a.forEach((s,d)=>{const c=d.getKey();o.get(c)===null&&(o=o.insert(c,Xe.newInvalidDocument(c)))});let l=wr();return o.forEach((s,d)=>{const c=a.get(s);c!==void 0&&Ln(c.mutation,d,Ye.empty(),ve.now()),Oi(n,d)&&(l=l.insert(s,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(t){this.serializer=t,this.kr=new Map,this.qr=new Map}getBundleMetadata(t,n){return U.resolve(this.kr.get(n))}saveBundleMetadata(t,n){return this.kr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:nn(i.createTime)}}(n)),U.resolve()}getNamedQuery(t,n){return U.resolve(this.qr.get(n))}saveNamedQuery(t,n){return this.qr.set(n.name,function(i){return{name:i.name,query:kp(i.bundledQuery),readTime:nn(i.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(){this.overlays=new ze(Z.comparator),this.Qr=new Map}getOverlay(t,n){return U.resolve(this.overlays.get(n))}getOverlays(t,n){const r=Rt();return U.forEach(n,i=>this.getOverlay(t,i).next(a=>{a!==null&&r.set(i,a)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,a)=>{this.St(t,n,a)}),U.resolve()}removeOverlaysForBatchId(t,n,r){const i=this.Qr.get(r);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Qr.delete(r)),U.resolve()}getOverlaysForCollection(t,n,r){const i=Rt(),a=n.length+1,o=new Z(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const s=l.getNext().value,d=s.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===a&&s.largestBatchId>r&&i.set(s.getKey(),s)}return U.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let a=new ze((d,c)=>d-c);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let c=a.get(d.largestBatchId);c===null&&(c=Rt(),a=a.insert(d.largestBatchId,c)),c.set(d.getKey(),d)}}const l=Rt(),s=a.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach((d,c)=>l.set(d,c)),!(l.size()>=i)););return U.resolve(l)}St(t,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Qr.get(i.largestBatchId).delete(r.key);this.Qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new sp(n,r));let a=this.Qr.get(n);a===void 0&&(a=Le(),this.Qr.set(n,a)),this.Qr.set(n,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(){this.sessionToken=at.EMPTY_BYTE_STRING}getSessionToken(t){return U.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(){this.$r=new De(xe.Ur),this.Kr=new De(xe.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(t,n){const r=new xe(t,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.zr(new xe(t,n))}jr(t,n){t.forEach(r=>this.removeReference(r,n))}Hr(t){const n=new Z(new pe([])),r=new xe(n,t),i=new xe(n,t+1),a=[];return this.Kr.forEachInRange([r,i],o=>{this.zr(o),a.push(o.key)}),a}Jr(){this.$r.forEach(t=>this.zr(t))}zr(t){this.$r=this.$r.delete(t),this.Kr=this.Kr.delete(t)}Yr(t){const n=new Z(new pe([])),r=new xe(n,t),i=new xe(n,t+1);let a=Le();return this.Kr.forEachInRange([r,i],o=>{a=a.add(o.key)}),a}containsKey(t){const n=new xe(t,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class xe{constructor(t,n){this.key=t,this.Zr=n}static Ur(t,n){return Z.comparator(t.key,n.key)||ie(t.Zr,n.Zr)}static Wr(t,n){return ie(t.Zr,n.Zr)||Z.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new De(xe.Ur)}checkEmpty(t){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){const a=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new op(a,n,r,i);this.mutationQueue.push(o);for(const l of i)this.Xr=this.Xr.add(new xe(l.key,a)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(t,n){return U.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,i=this.ti(r),a=i<0?0:i;return U.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Ai:this.nr-1)}getAllMutationBatches(t){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new xe(n,0),i=new xe(n,Number.POSITIVE_INFINITY),a=[];return this.Xr.forEachInRange([r,i],o=>{const l=this.ei(o.Zr);a.push(l)}),U.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new De(ie);return n.forEach(i=>{const a=new xe(i,0),o=new xe(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([a,o],l=>{r=r.add(l.Zr)})}),U.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,i=r.length+1;let a=r;Z.isDocumentKey(a)||(a=a.child(""));const o=new xe(new Z(a),0);let l=new De(ie);return this.Xr.forEachWhile(s=>{const d=s.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(l=l.add(s.Zr)),!0)},o),U.resolve(this.ni(l))}ni(t){const n=[];return t.forEach(r=>{const i=this.ei(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){ge(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return U.forEach(n.mutations,i=>{const a=new xe(i.key,n.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Xr=r})}sr(t){}containsKey(t,n){const r=new xe(n,0),i=this.Xr.firstAfterOrEqual(r);return U.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,U.resolve()}ri(t,n){return this.ti(t)}ti(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}ei(t){const n=this.ti(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(t){this.ii=t,this.docs=function(){return new ze(Z.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,i=this.docs.get(r),a=i?i.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Xe.newInvalidDocument(n))}getEntries(t,n){let r=Fr();return n.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Xe.newInvalidDocument(i))}),U.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let a=Fr();const o=n.path,l=new Z(o.child("__id-9223372036854775808__")),s=this.docs.getIteratorFrom(l);for(;s.hasNext();){const{key:d,value:{document:c}}=s.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||yf(vf(c),r)<=0||(i.has(c.key)||Oi(n,c))&&(a=a.insert(c.key,c.mutableCopy()))}return U.resolve(a)}getAllFromCollectionGroup(t,n,r,i){ne(9500)}si(t,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new Hp(this)}getSize(t){return U.resolve(this.size)}}class Hp extends Ip{constructor(t){super(),this.Br=t}applyChanges(t){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Br.addEntry(t,i)):this.Br.removeEntry(r)}),U.waitFor(n)}getFromCache(t,n){return this.Br.getEntry(t,n)}getAllFromCache(t,n){return this.Br.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(t){this.persistence=t,this.oi=new jt(n=>Ii(n),Mi),this.lastRemoteSnapshotVersion=he.min(),this.highestTargetId=0,this._i=0,this.ai=new Vi,this.targetCount=0,this.ui=ln.cr()}forEachTarget(t,n){return this.oi.forEach((r,i)=>n(i)),U.resolve()}getLastRemoteSnapshotVersion(t){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return U.resolve(this._i)}allocateTargetId(t){return this.highestTargetId=this.ui.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),U.resolve()}Tr(t){this.oi.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.ui=new ln(n),this.highestTargetId=n),t.sequenceNumber>this._i&&(this._i=t.sequenceNumber)}addTargetData(t,n){return this.Tr(n),this.targetCount+=1,U.resolve()}updateTargetData(t,n){return this.Tr(n),U.resolve()}removeTargetData(t,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(t,n,r){let i=0;const a=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.oi.delete(o),a.push(this.removeMatchingKeysForTargetId(t,l.targetId)),i++)}),U.waitFor(a).next(()=>i)}getTargetCount(t){return U.resolve(this.targetCount)}getTargetData(t,n){const r=this.oi.get(n)||null;return U.resolve(r)}addMatchingKeys(t,n,r){return this.ai.Gr(n,r),U.resolve()}removeMatchingKeys(t,n,r){this.ai.jr(n,r);const i=this.persistence.referenceDelegate,a=[];return i&&n.forEach(o=>{a.push(i.markPotentiallyOrphaned(t,o))}),U.waitFor(a)}removeMatchingKeysForTargetId(t,n){return this.ai.Hr(n),U.resolve()}getMatchingKeysForTargetId(t,n){const r=this.ai.Yr(n);return U.resolve(r)}containsKey(t,n){return U.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(t,n){this.ci={},this.overlays={},this.li=new Ti(0),this.hi=!1,this.hi=!0,this.Pi=new Lp,this.referenceDelegate=t(this),this.Ti=new Fp(this),this.indexManager=new Ep,this.remoteDocumentCache=function(i){return new $p(i)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new xp(n),this.Ei=new Rp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new Pp,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.ci[t.toKey()];return r||(r=new Vp(n,this.referenceDelegate),this.ci[t.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(t,n,r){K("MemoryPersistence","Starting transaction:",t);const i=new Up(this.li.next());return this.referenceDelegate.di(),r(i).next(a=>this.referenceDelegate.Ai(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ri(t,n){return U.or(Object.values(this.ci).map(r=>()=>r.containsKey(t,n)))}}class Up extends wf{constructor(t){super(),this.currentSequenceNumber=t}}class $i{constructor(t){this.persistence=t,this.Vi=new Vi,this.mi=null}static fi(t){return new $i(t)}get gi(){if(this.mi)return this.mi;throw ne(60996)}addReference(t,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),U.resolve()}removeReference(t,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(t,n){return this.gi.add(n.toString()),U.resolve()}removeTarget(t,n){this.Vi.Hr(n.targetId).forEach(i=>this.gi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(a=>this.gi.add(a.toString()))}).next(()=>r.removeTargetData(t,n))}di(){this.mi=new Set}Ai(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.gi,r=>{const i=Z.fromPath(r);return this.pi(t,i).next(a=>{a||n.removeEntry(i,he.min())})}).next(()=>(this.mi=null,n.apply(t)))}updateLimboDocument(t,n){return this.pi(t,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(t){return 0}pi(t,n){return U.or([()=>U.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ri(t,n)])}}class qr{constructor(t,n){this.persistence=t,this.yi=new jt(r=>Ef(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Np(this,n)}static fi(t,n){return new qr(t,n)}di(){}Ai(t){return U.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}pr(t){const n=this.br(t);return this.persistence.getTargetCache().getTargetCount(t).next(r=>n.next(i=>r+i))}br(t){let n=0;return this.yr(t,r=>{n++}).next(()=>n)}yr(t,n){return U.forEach(this.yi,(r,i)=>this.Dr(t,r,i).next(a=>a?U.resolve():n(i)))}removeTargets(t,n,r){return this.persistence.getTargetCache().removeTargets(t,n,r)}removeOrphanedDocuments(t,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.si(t,o=>this.Dr(t,o,n).next(l=>{l||(r++,a.removeEntry(o,he.min()))})).next(()=>a.apply(t)).next(()=>r)}markPotentiallyOrphaned(t,n){return this.yi.set(n,t.currentSequenceNumber),U.resolve()}removeTarget(t,n){const r=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,n,r){return this.yi.set(r,t.currentSequenceNumber),U.resolve()}removeReference(t,n,r){return this.yi.set(r,t.currentSequenceNumber),U.resolve()}updateLimboDocument(t,n){return this.yi.set(n,t.currentSequenceNumber),U.resolve()}Ii(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=Er(t.data.value)),n}Dr(t,n,r){return U.or([()=>this.persistence.Ri(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const i=this.yi.get(n);return U.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.ds=r,this.As=i}static Rs(t,n){let r=Le(),i=Le();for(const a of n.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Hi(t,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return Fu()?8:xf($u())>0?6:4}()}initialize(t,n){this.ys=t,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(t,n,r,i){const a={result:null};return this.ws(t,n).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.bs(t,n,i,r).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new zp;return this.Ss(t,n,o).next(l=>{if(a.result=l,this.fs)return this.Ds(t,n,o,l.size)})}).next(()=>a.result)}Ds(t,n,r,i){return r.documentReadCount<this.gs?(Qt()<=ae.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Sn(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),U.resolve()):(Qt()<=ae.DEBUG&&K("QueryEngine","Query:",Sn(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ps*i?(Qt()<=ae.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Sn(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Vt(n))):U.resolve())}ws(t,n){if(Bs(n))return U.resolve(null);let r=Vt(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=ii(n,null,"F"),r=Vt(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(a=>{const o=Le(...a);return this.ys.getDocuments(t,o).next(l=>this.indexManager.getMinOffset(t,r).next(s=>{const d=this.vs(n,l);return this.Cs(n,d,o,s.readTime)?this.ws(t,ii(n,null,"F")):this.Fs(t,d,n,s)}))})))}bs(t,n,r,i){return Bs(n)||i.isEqual(he.min())?U.resolve(null):this.ys.getDocuments(t,r).next(a=>{const o=this.vs(n,a);return this.Cs(n,o,r,i)?U.resolve(null):(Qt()<=ae.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Sn(n)),this.Fs(t,o,n,gf(i,Fn)).next(l=>l))})}vs(t,n){let r=new De(Bf(t));return n.forEach((i,a)=>{Oi(t,a)&&(r=r.add(a))}),r}Cs(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const a=t.limitType==="F"?n.last():n.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(t,n,r){return Qt()<=ae.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Sn(n)),this.ys.getDocumentsMatchingQuery(t,n,Tt.min(),r)}Fs(t,n,r,i){return this.ys.getDocumentsMatchingQuery(t,r,i).next(a=>(n.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp="LocalStore";class Bp{constructor(t,n,r,i){this.persistence=t,this.Ms=n,this.serializer=i,this.xs=new ze(ie),this.Os=new jt(a=>Ii(a),Mi),this.Ns=new Map,this.Bs=t.getRemoteDocumentCache(),this.Ti=t.getTargetCache(),this.Ei=t.getBundleCache(),this.Ls(r)}Ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Op(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.xs))}}function Yp(e,t,n,r){return new Bp(e,t,n,r)}async function Cd(e,t){const n=_e(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,n.Ls(t),n.mutationQueue.getAllMutationBatches(r))).next(a=>{const o=[],l=[];let s=Le();for(const d of i){o.push(d.batchId);for(const c of d.mutations)s=s.add(c.key)}for(const d of a){l.push(d.batchId);for(const c of d.mutations)s=s.add(c.key)}return n.localDocuments.getDocuments(r,s).next(d=>({ks:d,removedBatchIds:o,addedBatchIds:l}))})})}function Wp(e,t){const n=_e(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),a=n.Bs.newChangeBuffer({trackRemovals:!0});return function(l,s,d,c){const u=d.batch,f=u.keys();let y=U.resolve();return f.forEach(g=>{y=y.next(()=>c.getEntry(s,g)).next(h=>{const p=d.docVersions.get(g);ge(p!==null,48541),h.version.compareTo(p)<0&&(u.applyToRemoteDocument(h,d),h.isValidDocument()&&(h.setReadTime(d.commitVersion),c.addEntry(h)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(s,u))}(n,r,t,a).next(()=>a.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let s=Le();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(s=s.add(l.batch.mutations[d].key));return s}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function Kp(e){const t=_e(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Ti.getLastRemoteSnapshotVersion(n))}function Gp(e,t){const n=_e(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=Ai),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}class el{constructor(){this.activeTargetIds=Qf()}js(t){this.activeTargetIds=this.activeTargetIds.add(t)}Hs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}zs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Jp{constructor(){this.xo=new el,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t,n=!0){return n&&this.xo.js(t),this.Oo[t]||"not-current"}updateQueryState(t,n,r){this.Oo[t]=n}removeLocalQueryTarget(t){this.xo.Hs(t)}isLocalQueryTarget(t){return this.xo.activeTargetIds.has(t)}clearQueryState(t){delete this.Oo[t]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(t){return this.xo.activeTargetIds.has(t)}start(){return this.xo=new el,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{No(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl="ConnectivityMonitor";class nl{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(t){this.Qo.push(t)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){K(tl,"Network connectivity changed: AVAILABLE");for(const t of this.Qo)t(0)}qo(){K(tl,"Network connectivity changed: UNAVAILABLE");for(const t of this.Qo)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xr=null;function di(){return xr===null?xr=function(){return 268435456+Math.round(2147483648*Math.random())}():xr++,"0x"+xr.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa="RestConnection",Xp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Zp{get Uo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+t.host,this.Wo=`projects/${r}/databases/${i}`,this.Go=this.databaseId.database===Vr?`project_id=${r}`:`project_id=${r}&database_id=${i}`}zo(t,n,r,i,a){const o=di(),l=this.jo(t,n.toUriEncodedString());K(Pa,`Sending RPC '${t}' ${o}:`,l,r);const s={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(s,i,a);const{host:d}=new URL(l),c=bi(d);return this.Jo(t,l,s,r,c).then(u=>(K(Pa,`Received RPC '${t}' ${o}: `,u),u),u=>{throw Yr(Pa,`RPC '${t}' ${o} failed with error: `,u,"url: ",l,"request:",r),u})}Yo(t,n,r,i,a,o){return this.zo(t,n,r,i,a)}Ho(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cn}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>t[a]=i),r&&r.headers.forEach((i,a)=>t[a]=i)}jo(t,n){const r=Xp[t];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(t){this.Zo=t.Zo,this.Xo=t.Xo}e_(t){this.t_=t}n_(t){this.r_=t}i_(t){this.s_=t}onMessage(t){this.o_=t}close(){this.Xo()}send(t){this.Zo(t)}__(){this.t_()}a_(){this.r_()}u_(t){this.s_(t)}c_(t){this.o_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me="WebChannelConnection";class tm extends Zp{constructor(t){super(t),this.l_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,n,r,i,a){const o=di();return new Promise((l,s)=>{const d=new ql;d.setWithCredentials(!0),d.listenOnce(jl.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case kr.NO_ERROR:const u=d.getResponseJson();K(Me,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(u)),l(u);break;case kr.TIMEOUT:K(Me,`RPC '${t}' ${o} timed out`),s(new G(z.DEADLINE_EXCEEDED,"Request time out"));break;case kr.HTTP_ERROR:const f=d.getStatus();if(K(Me,`RPC '${t}' ${o} failed with status:`,f,"response text:",d.getResponseText()),f>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const g=y==null?void 0:y.error;if(g&&g.status&&g.message){const h=function(v){const x=v.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(x)>=0?x:z.UNKNOWN}(g.status);s(new G(h,g.message))}else s(new G(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else s(new G(z.UNAVAILABLE,"Connection failed."));break;default:ne(9055,{h_:t,streamId:o,P_:d.getLastErrorCode(),T_:d.getLastError()})}}finally{K(Me,`RPC '${t}' ${o} completed.`)}});const c=JSON.stringify(i);K(Me,`RPC '${t}' ${o} sending request:`,i),d.send(n,"POST",c,r,15)})}I_(t,n,r){const i=di(),a=[this.Ko,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Wl(),l=Yl(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(s.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(s.useFetchStreams=!0),this.Ho(s.initMessageHeaders,n,r),s.encodeInitMessageHeaders=!0;const c=a.join("");K(Me,`Creating RPC '${t}' stream ${i}: ${c}`,s);const u=o.createWebChannel(c,s);this.E_(u);let f=!1,y=!1;const g=new em({Zo:p=>{y?K(Me,`Not sending because RPC '${t}' stream ${i} is closed:`,p):(f||(K(Me,`Opening RPC '${t}' stream ${i} transport.`),u.open(),f=!0),K(Me,`RPC '${t}' stream ${i} sending:`,p),u.send(p))},Xo:()=>u.close()}),h=(p,v,x)=>{p.listen(v,S=>{try{x(S)}catch(O){setTimeout(()=>{throw O},0)}})};return h(u,Nn.EventType.OPEN,()=>{y||(K(Me,`RPC '${t}' stream ${i} transport opened.`),g.__())}),h(u,Nn.EventType.CLOSE,()=>{y||(y=!0,K(Me,`RPC '${t}' stream ${i} transport closed`),g.u_(),this.d_(u))}),h(u,Nn.EventType.ERROR,p=>{y||(y=!0,Yr(Me,`RPC '${t}' stream ${i} transport errored. Name:`,p.name,"Message:",p.message),g.u_(new G(z.UNAVAILABLE,"The operation could not be completed")))}),h(u,Nn.EventType.MESSAGE,p=>{var v;if(!y){const x=p.data[0];ge(!!x,16349);const S=x,O=(S==null?void 0:S.error)||((v=S[0])===null||v===void 0?void 0:v.error);if(O){K(Me,`RPC '${t}' stream ${i} received error:`,O);const N=O.status;let I=function(b){const k=ye[b];if(k!==void 0)return dp(k)}(N),A=O.message;I===void 0&&(I=z.INTERNAL,A="Unknown error status: "+N+" with message "+O.message),y=!0,g.u_(new G(I,A)),u.close()}else K(Me,`RPC '${t}' stream ${i} received:`,x),g.c_(x)}}),h(l,Bl.STAT_EVENT,p=>{p.stat===Xa.PROXY?K(Me,`RPC '${t}' stream ${i} detected buffering proxy`):p.stat===Xa.NOPROXY&&K(Me,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.a_()},0),g}terminate(){this.l_.forEach(t=>t.close()),this.l_=[]}E_(t){this.l_.push(t)}d_(t){this.l_=this.l_.filter(n=>n===t)}}function La(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(e){return new cp(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(t,n,r=1e3,i=1.5,a=6e4){this.xi=t,this.timerId=n,this.A_=r,this.R_=i,this.V_=a,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(t){this.cancel();const n=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),i=Math.max(0,n-r);i>0&&K("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),t())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl="PersistentStream";class nm{constructor(t,n,r,i,a,o,l,s){this.xi=t,this.S_=r,this.D_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=s,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Nd(t,n)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(t){this.U_(),this.stream.send(t)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(t,n){this.U_(),this.K_(),this.x_.cancel(),this.v_++,t!==4?this.x_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(Ft(n.toString()),Ft("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.i_(n)}W_(){}auth(){this.state=1;const t=this.G_(this.v_),n=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.v_===n&&this.z_(r,i)},r=>{t(()=>{const i=new G(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(i)})})}z_(t,n){const r=this.G_(this.v_);this.stream=this.H_(t,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{r(()=>this.j_(i))}),this.stream.onMessage(i=>{r(()=>++this.M_==1?this.J_(i):this.onNext(i))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(t){return K(rl,`close with error: ${t}`),this.stream=null,this.close(4,t)}G_(t){return n=>{this.xi.enqueueAndForget(()=>this.v_===t?n():(K(rl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rm extends nm{constructor(t,n,r,i,a,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(t,n){return this.connection.I_("Write",t,n)}J_(t){return ge(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ge(!t.writeResults||t.writeResults.length===0,55816),this.listener.na()}onNext(t){ge(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.x_.reset();const n=vp(t.writeResults,t.commitTime),r=nn(t.commitTime);return this.listener.ra(r,n)}ia(){const t={};t.database=pp(this.serializer),this.Q_(t)}ta(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>gp(this.serializer,r))};this.Q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{}class im extends am{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.")}zo(t,n,r,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.zo(t,si(n,r),i,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new G(z.UNKNOWN,a.toString())})}Yo(t,n,r,i,a){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(t,si(n,r),i,o,l,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(z.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class om{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(t){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.la("Offline")))}set(t){this.Ta(),this._a=0,t==="Online"&&(this.ua=!1),this.la(t)}la(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ha(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ft(n),this.ua=!1):K("OnlineStateTracker",n)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="RemoteStore";class sm{constructor(t,n,r,i,a){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=a,this.Ra.No(o=>{r.enqueueAndForget(async()=>{Qn(this)&&(K(Gn,"Restarting streams for network reachability change."),await async function(s){const d=_e(s);d.da.add(4),await Jn(d),d.Va.set("Unknown"),d.da.delete(4),await Jr(d)}(this))})}),this.Va=new om(r,i)}}async function Jr(e){if(Qn(e))for(const t of e.Aa)await t(!0)}async function Jn(e){for(const t of e.Aa)await t(!1)}function Qn(e){return _e(e).da.size===0}async function Id(e,t,n){if(!Wn(t))throw t;e.da.add(1),await Jn(e),e.Va.set("Offline"),n||(n=()=>Kp(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{K(Gn,"Retrying IndexedDB access"),await n(),e.da.delete(1),await Jr(e)})}function Md(e,t){return t().catch(n=>Id(e,n,t))}async function Qr(e){const t=_e(e),n=At(t);let r=t.Ia.length>0?t.Ia[t.Ia.length-1].batchId:Ai;for(;lm(t);)try{const i=await Gp(t.localStore,r);if(i===null){t.Ia.length===0&&n.k_();break}r=i.batchId,dm(t,i)}catch(i){await Id(t,i)}Od(t)&&Rd(t)}function lm(e){return Qn(e)&&e.Ia.length<10}function dm(e,t){e.Ia.push(t);const n=At(e);n.N_()&&n.ea&&n.ta(t.mutations)}function Od(e){return Qn(e)&&!At(e).O_()&&e.Ia.length>0}function Rd(e){At(e).start()}async function cm(e){At(e).ia()}async function _m(e){const t=At(e);for(const n of e.Ia)t.ta(n.mutations)}async function um(e,t,n){const r=e.Ia.shift(),i=Li.from(r,t,n);await Md(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Qr(e)}async function hm(e,t){t&&At(e).ea&&await async function(r,i){if(function(o){return lp(o)&&o!==z.ABORTED}(i.code)){const a=r.Ia.shift();At(r).L_(),await Md(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Qr(r)}}(e,t),Od(e)&&Rd(e)}async function al(e,t){const n=_e(e);n.asyncQueue.verifyOperationInProgress(),K(Gn,"RemoteStore received new credentials");const r=Qn(n);n.da.add(3),await Jn(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.da.delete(3),await Jr(n)}async function fm(e,t){const n=_e(e);t?(n.da.delete(2),await Jr(n)):t||(n.da.add(2),await Jn(n),n.Va.set("Unknown"))}function At(e){return e.ga||(e.ga=function(n,r,i){const a=_e(n);return a.oa(),new rm(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(e.datastore,e.asyncQueue,{e_:()=>Promise.resolve(),n_:cm.bind(null,e),i_:hm.bind(null,e),na:_m.bind(null,e),ra:um.bind(null,e)}),e.Aa.push(async t=>{t?(e.ga.L_(),await Qr(e)):(await e.ga.stop(),e.Ia.length>0&&(K(Gn,`Stopping write stream with ${e.Ia.length} pending writes`),e.Ia=[]))})),e.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(t,n,r,i,a){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Lt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,a){const o=Date.now()+r,l=new Fi(t,n,o,i,a);return l.start(r),l}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(z.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pd(e,t){if(Ft("AsyncQueue",`${t}: ${e}`),Wn(e))return new G(z.UNAVAILABLE,`${t}: ${e}`);throw e}class pm{constructor(){this.queries=il(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=_e(n),a=i.queries;i.queries=il(),a.forEach((o,l)=>{for(const s of l.Sa)s.onError(r)})})(this,new G(z.ABORTED,"Firestore shutting down"))}}function il(){return new jt(e=>fd(e),hd)}function mm(e){e.Ca.forEach(t=>{t.next()})}var ol,sl;(sl=ol||(ol={})).xa="default",sl.Cache="cache";const gm="SyncEngine";class vm{constructor(t,n,r,i,a,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new jt(l=>fd(l),hd),this.Pu=new Map,this.Tu=new Set,this.Iu=new ze(Z.comparator),this.Eu=new Map,this.du=new Vi,this.Au={},this.Ru=new Map,this.Vu=ln.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function ym(e,t,n){const r=km(e);try{const i=await function(o,l){const s=_e(o),d=ve.now(),c=l.reduce((y,g)=>y.add(g.key),Le());let u,f;return s.persistence.runTransaction("Locally write mutations","readwrite",y=>{let g=Fr(),h=Le();return s.Bs.getEntries(y,c).next(p=>{g=p,g.forEach((v,x)=>{x.isValidDocument()||(h=h.add(v))})}).next(()=>s.localDocuments.getOverlayedDocuments(y,g)).next(p=>{u=p;const v=[];for(const x of l){const S=ap(x,u.get(x.key).overlayedDocument);S!=null&&v.push(new Dt(x.key,S,id(S.value.mapValue),Ze.exists(!0)))}return s.mutationQueue.addMutationBatch(y,d,v,l)}).next(p=>{f=p;const v=p.applyToLocalDocumentSet(u,h);return s.documentOverlayCache.saveOverlays(y,p.batchId,v)})}).then(()=>({batchId:f.batchId,changes:md(u)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,s){let d=o.Au[o.currentUser.toKey()];d||(d=new ze(ie)),d=d.insert(l,s),o.Au[o.currentUser.toKey()]=d}(r,i.batchId,n),await Xr(r,i.changes),await Qr(r.remoteStore)}catch(i){const a=Pd(i,"Failed to persist write");n.reject(a)}}function ll(e,t,n){const r=_e(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.hu.forEach((a,o)=>{const l=o.view.Fa(t);l.snapshot&&i.push(l.snapshot)}),function(o,l){const s=_e(o);s.onlineState=l;let d=!1;s.queries.forEach((c,u)=>{for(const f of u.Sa)f.Fa(l)&&(d=!0)}),d&&mm(s)}(r.eventManager,t),i.length&&r.lu.Y_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function bm(e,t){const n=_e(e),r=t.batch.batchId;try{const i=await Wp(n.localStore,t);Vd(n,r,null),Ld(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Xr(n,i)}catch(i){await Ei(i)}}async function wm(e,t,n){const r=_e(e);try{const i=await function(o,l){const s=_e(o);return s.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let c;return s.mutationQueue.lookupMutationBatch(d,l).next(u=>(ge(u!==null,37113),c=u.keys(),s.mutationQueue.removeMutationBatch(d,u))).next(()=>s.mutationQueue.performConsistencyCheck(d)).next(()=>s.documentOverlayCache.removeOverlaysForBatchId(d,c,l)).next(()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,c)).next(()=>s.localDocuments.getDocuments(d,c))})}(r.localStore,t);Vd(r,t,n),Ld(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Xr(r,i)}catch(i){await Ei(i)}}function Ld(e,t){(e.Ru.get(t)||[]).forEach(n=>{n.resolve()}),e.Ru.delete(t)}function Vd(e,t,n){const r=_e(e);let i=r.Au[r.currentUser.toKey()];if(i){const a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.Au[r.currentUser.toKey()]=i}}async function Xr(e,t,n){const r=_e(e),i=[],a=[],o=[];r.hu.isEmpty()||(r.hu.forEach((l,s)=>{o.push(r.fu(s,t,n).then(d=>{var c;if((d||n)&&r.isPrimaryClient){const u=d?!d.fromCache:(c=void 0)===null||c===void 0?void 0:c.current;r.sharedClientState.updateQueryState(s.targetId,u?"current":"not-current")}if(d){i.push(d);const u=Hi.Rs(s.targetId,d);a.push(u)}}))}),await Promise.all(o),r.lu.Y_(i),await async function(s,d){const c=_e(s);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>U.forEach(d,f=>U.forEach(f.ds,y=>c.persistence.referenceDelegate.addReference(u,f.targetId,y)).next(()=>U.forEach(f.As,y=>c.persistence.referenceDelegate.removeReference(u,f.targetId,y)))))}catch(u){if(!Wn(u))throw u;K(jp,"Failed to update sequence numbers: "+u)}for(const u of d){const f=u.targetId;if(!u.fromCache){const y=c.xs.get(f),g=y.snapshotVersion,h=y.withLastLimboFreeSnapshotVersion(g);c.xs=c.xs.insert(f,h)}}}(r.localStore,a))}async function xm(e,t){const n=_e(e);if(!n.currentUser.isEqual(t)){K(gm,"User change. New user:",t.toKey());const r=await Cd(n.localStore,t);n.currentUser=t,function(a,o){a.Ru.forEach(l=>{l.forEach(s=>{s.reject(new G(z.CANCELLED,o))})}),a.Ru.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await Xr(n,r.ks)}}function km(e){const t=_e(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=bm.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=wm.bind(null,t),t}class jr{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Gr(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Su(t),await this.persistence.start(),this.localStore=this.Du(t),this.gcScheduler=this.vu(t,this.localStore),this.indexBackfillerScheduler=this.Cu(t,this.localStore)}vu(t,n){return null}Cu(t,n){return null}Du(t){return Yp(this.persistence,new qp,t.initialUser,this.serializer)}Su(t){return new Dd($i.fi,this.serializer)}bu(t){return new Jp}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jr.provider={build:()=>new jr};class Em extends jr{constructor(t){super(),this.cacheSizeBytes=t}vu(t,n){ge(this.persistence.referenceDelegate instanceof qr,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Dp(r,t.asyncQueue,n)}Su(t){const n=this.cacheSizeBytes!==void 0?Ue.withCacheSize(this.cacheSizeBytes):Ue.DEFAULT;return new Dd(r=>qr.fi(r,n),this.serializer)}}class ci{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ll(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=xm.bind(null,this.syncEngine),await fm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new pm}()}createDatastore(t){const n=Gr(t.databaseInfo.databaseId),r=function(a){return new tm(a)}(t.databaseInfo);return function(a,o,l,s){return new im(a,o,l,s)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,a,o,l){return new sm(r,i,a,o,l)}(this.localStore,this.datastore,t.asyncQueue,n=>ll(this.syncEngine,n,0),function(){return nl.C()?new nl:new Qp}())}createSyncEngine(t,n){return function(i,a,o,l,s,d,c){const u=new vm(i,a,o,l,s,d);return c&&(u.mu=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(i){const a=_e(i);K(Gn,"RemoteStore shutting down."),a.da.add(5),await Jn(a),a.Ra.shutdown(),a.Va.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}ci.provider={build:()=>new ci};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="FirestoreClient";class Tm{constructor(t,n,r,i,a){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Pe.UNAUTHENTICATED,this.clientId=Jl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async o=>{K(St,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(K(St,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Lt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=Pd(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function Va(e,t){e.asyncQueue.verifyOperationInProgress(),K(St,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Cd(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function dl(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Am(e);K(St,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>al(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>al(t.remoteStore,i)),e._onlineComponents=t}async function Am(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){K(St,"Using user provided OfflineComponentProvider");try{await Va(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(i){return i.name==="FirebaseError"?i.code===z.FAILED_PRECONDITION||i.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Yr("Error using user provided cache. Falling back to memory cache: "+n),await Va(e,new jr)}}else K(St,"Using default OfflineComponentProvider"),await Va(e,new Em(void 0));return e._offlineComponents}async function Sm(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(K(St,"Using user provided OnlineComponentProvider"),await dl(e,e._uninitializedComponentsProvider._online)):(K(St,"Using default OnlineComponentProvider"),await dl(e,new ci))),e._onlineComponents}function Dm(e){return Sm(e).then(t=>t.syncEngine)}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $d(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(e,t,n){if(!n)throw new G(z.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Cm(e,t,n,r){if(t===!0&&r===!0)throw new G(z.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function _l(e){if(!Z.isDocumentKey(e))throw new G(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ul(e){if(Z.isDocumentKey(e))throw new G(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Zr(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":ne(12329,{type:typeof e})}function Bn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new G(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Zr(e);throw new G(z.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd="firestore.googleapis.com",hl=!0;class fl{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new G(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Fd,this.ssl=hl}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:hl;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Sd;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<Ap)throw new G(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}Cm("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$d((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ea{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new G(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fl(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new sf;switch(r.type){case"firstParty":return new _f(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=cl.get(n);r&&(K("ComponentProvider","Removing Datastore"),cl.delete(n),r.terminate())}(this),Promise.resolve()}}function Nm(e,t,n,r={}){var i;e=Bn(e,ea);const a=bi(t),o=e._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),s=`${t}:${n}`;a&&(Ou(`https://${s}`),Vu("Firestore",!0)),o.host!==Fd&&o.host!==s&&Yr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:s,ssl:a,emulatorOptions:r});if(!Mr(d,l)&&(e._setSettings(d),r.mockUserToken)){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=Pe.MOCK_USER;else{c=Ru(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new G(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Pe(f)}e._authCredentials=new lf(new Gl(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new un(this.firestore,t,this._query)}}class et{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Et(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new et(this.firestore,t,this._key)}}class Et extends un{constructor(t,n,r){super(t,n,qf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new et(this.firestore,null,new Z(t))}withConverter(t){return new Et(this.firestore,t,this._path)}}function Im(e,t,...n){if(e=_t(e),Hd("collection","path",t),e instanceof ea){const r=pe.fromString(t,...n);return ul(r),new Et(e,null,r)}{if(!(e instanceof et||e instanceof Et))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(pe.fromString(t,...n));return ul(r),new Et(e.firestore,null,r)}}function _i(e,t,...n){if(e=_t(e),arguments.length===1&&(t=Jl.newId()),Hd("doc","path",t),e instanceof ea){const r=pe.fromString(t,...n);return _l(r),new et(e,null,new Z(r))}{if(!(e instanceof et||e instanceof Et))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(pe.fromString(t,...n));return _l(r),new et(e.firestore,e instanceof Et?e.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl="AsyncQueue";class ml{constructor(t=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Nd(this,"async_queue_retry"),this.rc=()=>{const r=La();r&&K(pl,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=t;const n=La();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.oc(),this._c(t)}enterRestrictedMode(t){if(!this.Yu){this.Yu=!0,this.tc=t||!1;const n=La();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.rc)}}enqueue(t){if(this.oc(),this.Yu)return new Promise(()=>{});const n=new Lt;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ju.push(t),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(t){if(!Wn(t))throw t;K(pl,"Operation failed with retryable error: "+t)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(t){const n=this.sc.then(()=>(this.ec=!0,t().catch(r=>{throw this.Xu=r,this.ec=!1,Ft("INTERNAL UNHANDLED ERROR: ",gl(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=n,n}enqueueAfterDelay(t,n,r){this.oc(),this.nc.indexOf(t)>-1&&(n=0);const i=Fi.createAndSchedule(this,t,n,r,a=>this.uc(a));return this.Zu.push(i),i}oc(){this.Xu&&ne(47125,{cc:gl(this.Xu)})}verifyOperationInProgress(){}async lc(){let t;do t=this.sc,await t;while(t!==this.sc)}hc(t){for(const n of this.Zu)if(n.timerId===t)return!0;return!1}Pc(t){return this.lc().then(()=>{this.Zu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Zu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.lc()})}Tc(t){this.nc.push(t)}uc(t){const n=this.Zu.indexOf(t);this.Zu.splice(n,1)}}function gl(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class ta extends ea{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=new ml,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new ml(t),this._firestoreClient=void 0,await t}}}function Mm(e,t){const n=typeof e=="object"?e:Wh(),r=typeof e=="string"?e:Vr,i=zh(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=Iu("firestore");a&&Nm(i,...a)}return i}function Om(e){if(e._terminated)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Rm(e),e._firestoreClient}function Rm(e){var t,n,r;const i=e._freezeSettings(),a=function(l,s,d,c){return new Df(l,s,d,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,$d(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Tm(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(l){const s=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(s),_online:s}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Yn(at.fromBase64String(t))}catch(n){throw new G(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Yn(at.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new G(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Se(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new G(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new G(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ie(this._lat,t._lat)||ie(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm=/^__.*__$/;class Lm{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Dt(t,this.data,this.fieldMask,n,this.fieldTransforms):new Kn(t,this.data,n,this.fieldTransforms)}}class qd{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return new Dt(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function jd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne(40011,{Ic:e})}}class qi{constructor(t,n,r,i,a,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Ec(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(t){return new qi(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.dc({path:r,Rc:!1});return i.Vc(t),i}mc(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.dc({path:r,Rc:!1});return i.Ec(),i}fc(t){return this.dc({path:void 0,Rc:!0})}gc(t){return Br(t,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Ec(){if(this.path)for(let t=0;t<this.path.length;t++)this.Vc(this.path.get(t))}Vc(t){if(t.length===0)throw this.gc("Document fields must not be empty");if(jd(this.Ic)&&Pm.test(t))throw this.gc('Document fields cannot begin and end with "__"')}}class Vm{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Gr(t)}bc(t,n,r,i=!1){return new qi({Ic:t,methodName:n,wc:r,path:Se.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ji(e){const t=e._freezeSettings(),n=Gr(e._databaseId);return new Vm(e._databaseId,!!t.ignoreUndefinedProperties,n)}function $m(e,t,n,r,i,a={}){const o=e.bc(a.merge||a.mergeFields?2:0,t,n,i);Bi("Data must be an object, but it was:",o,r);const l=Bd(r,o);let s,d;if(a.merge)s=new Ye(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const c=[];for(const u of a.mergeFields){const f=ui(t,u,n);if(!o.contains(f))throw new G(z.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Wd(c,f)||c.push(f)}s=new Ye(c),d=o.fieldTransforms.filter(u=>s.covers(u.field))}else s=null,d=o.fieldTransforms;return new Lm(new je(l),s,d)}class na extends zi{_toFieldTransform(t){if(t.Ic!==2)throw t.Ic===1?t.gc(`${this._methodName}() can only appear at the top level of your update data`):t.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof na}}function Hm(e,t,n,r){const i=e.bc(1,t,n);Bi("Data must be an object, but it was:",i,r);const a=[],o=je.empty();qt(r,(s,d)=>{const c=Yi(t,s,n);d=_t(d);const u=i.mc(c);if(d instanceof na)a.push(c);else{const f=Xn(d,u);f!=null&&(a.push(c),o.set(c,f))}});const l=new Ye(a);return new qd(o,l,i.fieldTransforms)}function Fm(e,t,n,r,i,a){const o=e.bc(1,t,n),l=[ui(t,r,n)],s=[i];if(a.length%2!=0)throw new G(z.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<a.length;f+=2)l.push(ui(t,a[f])),s.push(a[f+1]);const d=[],c=je.empty();for(let f=l.length-1;f>=0;--f)if(!Wd(d,l[f])){const y=l[f];let g=s[f];g=_t(g);const h=o.mc(y);if(g instanceof na)d.push(y);else{const p=Xn(g,h);p!=null&&(d.push(y),c.set(y,p))}}const u=new Ye(d);return new qd(c,u,o.fieldTransforms)}function Um(e,t,n,r=!1){return Xn(n,e.bc(r?4:3,t))}function Xn(e,t){if(Yd(e=_t(e)))return Bi("Unsupported field value:",t,e),Bd(e,t);if(e instanceof zi)return function(r,i){if(!jd(i.Ic))throw i.gc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.gc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Rc&&t.Ic!==4)throw t.gc("Nested arrays are not supported");return function(r,i){const a=[];let o=0;for(const l of r){let s=Xn(l,i.fc(o));s==null&&(s={nullValue:"NULL_VALUE"}),a.push(s),o++}return{arrayValue:{values:a}}}(e,t)}return function(r,i){if((r=_t(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Xf(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=ve.fromDate(r);return{timestampValue:oi(i.serializer,a)}}if(r instanceof ve){const a=new ve(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:oi(i.serializer,a)}}if(r instanceof Ud)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Yn)return{bytesValue:_p(i.serializer,r._byteString)};if(r instanceof et){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Td(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof zd)return function(o,l){return{mapValue:{fields:{[rd]:{stringValue:ad},[ei]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.gc("VectorValues must only contain numeric values.");return Ri(l.serializer,d)})}}}}}}(r,i);throw i.gc(`Unsupported field value: ${Zr(r)}`)}(e,t)}function Bd(e,t){const n={};return Xl(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):qt(e,(r,i)=>{const a=Xn(i,t.Ac(r));a!=null&&(n[r]=a)}),{mapValue:{fields:n}}}function Yd(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof ve||e instanceof Ud||e instanceof Yn||e instanceof et||e instanceof zi||e instanceof zd)}function Bi(e,t,n){if(!Yd(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Zr(n);throw r==="an object"?t.gc(e+" a custom object"):t.gc(e+" "+r)}}function ui(e,t,n){if((t=_t(t))instanceof Ui)return t._internalPath;if(typeof t=="string")return Yi(e,t);throw Br("Field path arguments must be of type string or ",e,!1,void 0,n)}const zm=new RegExp("[~\\*/\\[\\]]");function Yi(e,t,n){if(t.search(zm)>=0)throw Br(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ui(...t.split("."))._internalPath}catch{throw Br(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Br(e,t,n,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${t}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let s="";return(a||o)&&(s+=" (found",a&&(s+=` in field ${r}`),o&&(s+=` in document ${i}`),s+=")"),new G(z.INVALID_ARGUMENT,l+e+s)}function Wd(e,t){return e.some(n=>n.isEqual(t))}function qm(e,t){return Yi(e,t)}class Wi{}class Kd extends Wi{}function jm(e,t,...n){let r=[];t instanceof Wi&&r.push(t),r=r.concat(n),function(a){const o=a.filter(s=>s instanceof Gi).length,l=a.filter(s=>s instanceof Ki).length;if(o>1||o>0&&l>0)throw new G(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class Ki extends Kd{constructor(t,n,r){super(),this._field=t,this._op=n,this._value=r,this.type="where"}static _create(t,n,r){return new Ki(t,n,r)}_apply(t){const n=this._parse(t);return Gd(t._query,n),new un(t.firestore,t.converter,ai(t._query,n))}_parse(t){const n=ji(t.firestore);return function(a,o,l,s,d,c,u){let f;if(d.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new G(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){yl(u,c);const g=[];for(const h of u)g.push(vl(s,a,h));f={arrayValue:{values:g}}}else f=vl(s,a,u)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||yl(u,c),f=Um(l,o,u,c==="in"||c==="not-in");return we.create(d,c,f)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}class Gi extends Wi{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new Gi(t,n)}_parse(t){const n=this._queryConstraints.map(r=>r._parse(t)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ht.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(i,a){let o=i;const l=a.getFlattenedFilters();for(const s of l)Gd(o,s),o=ai(o,s)}(t._query,n),new un(t.firestore,t.converter,ai(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ji extends Kd{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new Ji(t,n)}_apply(t){const n=function(i,a,o){if(i.startAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zn(a,o)}(t._query,this._field,this._direction);return new un(t.firestore,t.converter,function(i,a){const o=i.explicitOrderBy.concat([a]);return new _n(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,n))}}function Bm(e,t="asc"){const n=t,r=qm("orderBy",e);return Ji._create(r,n)}function vl(e,t,n){if(typeof(n=_t(n))=="string"){if(n==="")throw new G(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ud(t)&&n.indexOf("/")!==-1)throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(pe.fromString(n));if(!Z.isDocumentKey(r))throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Us(e,new Z(r))}if(n instanceof et)return Us(e,n._key);throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zr(n)}.`)}function yl(e,t){if(!Array.isArray(e)||e.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Gd(e,t){const n=function(i,a){for(const o of i)for(const l of o.getFlattenedFilters())if(a.indexOf(l.op)>=0)return l.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ym(e,t,n){let r;return r=e?e.toFirestore(t):t,r}function Wm(e,t,n,...r){e=Bn(e,et);const i=Bn(e.firestore,ta),a=ji(i);let o;return o=typeof(t=_t(t))=="string"||t instanceof Ui?Fm(a,"updateDoc",e._key,t,n,r):Hm(a,"updateDoc",e._key,t),Qi(i,[o.toMutation(e._key,Ze.exists(!0))])}function Km(e){return Qi(Bn(e.firestore,ta),[new Pi(e._key,Ze.none())])}function Gm(e,t){const n=Bn(e.firestore,ta),r=_i(e),i=Ym(e.converter,t);return Qi(n,[$m(ji(e.firestore),"addDoc",r._key,i,e.converter!==null,{}).toMutation(r._key,Ze.exists(!1))]).then(()=>r)}function Qi(e,t){return function(r,i){const a=new Lt;return r.asyncQueue.enqueueAndForget(async()=>ym(await Dm(r),i,a)),a.promise}(Om(e),t)}(function(t,n=!0){(function(i){cn=i})(Yh),Rr(new $n("firestore",(r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),l=new ta(new df(r.getProvider("auth-internal")),new uf(o,r.getProvider("app-check-internal")),function(d,c){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new G(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $r(d.options.projectId,c)}(o,i),o);return a=Object.assign({useFetchStreams:n},a),l._setSettings(a),l},"PUBLIC").setMultipleInstances(!0)),tn(Cs,Ns,t),tn(Cs,Ns,"esm2017")})();const Jm={apiKey:"AIzaSyAP6cwDpAiCK7AQgXvf0c5MzJDZGlXfcA0",authDomain:"version-2-3e1ba.firebaseapp.com",projectId:"version-2-3e1ba",storageBucket:"version-2-3e1ba.firebasestorage.app",messagingSenderId:"764827077218",appId:"1:764827077218:web:568f42d454d68991475f3b",measurementId:"G-85B4WPRX4N"},Qm=Fl(Jm),hi=Mm(Qm);$t.plugins({recurring:!0});$t.config.header=["day","week","month","date","prev","today","next"];$t.init("scheduler_here",new Date(2022,3,20),"week");const Jd=Im(hi,"events");$t.createDataProcessor(async function(e,t,n,r){switch(t){case"create":{if(n._fromFirestore)return;const i=await Gm(Jd,bl(n));if(i.id)return{action:"inserted",tid:i.id}}break;case"update":return Wm(_i(hi,"events",r),bl(n));case"delete":if(await Km(_i(hi,"events",r)))return{action:"deleted"};break}});jm(Jd,Bm("text","desc"));const bl=e=>{const n={...Object.fromEntries(Object.entries(e).filter(([r])=>!r.startsWith("_")&&r!=="id"&&r!=="!nativeeditor_status"))};return n._fromFirestore=!0,e.start_date instanceof Date&&(n.start_date=ve.fromDate(e.start_date)),e.end_date instanceof Date&&(n.end_date=ve.fromDate(e.end_date)),e.original_start instanceof Date&&(n.original_start=ve.fromDate(e.original_start)),n};
